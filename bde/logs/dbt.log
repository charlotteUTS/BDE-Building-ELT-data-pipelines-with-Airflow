[0m17:51:52.543887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e21cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cefe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cec20>]}


============================== 17:51:52.546824 | a34c8fd1-f744-4c2e-88c5-a88cddbfce6f ==============================
[0m17:51:52.546824 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:51:52.547255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:52.547576 [info ] [MainThread]: dbt version: 1.6.5
[0m17:51:52.547741 [info ] [MainThread]: python version: 3.10.5
[0m17:51:52.547901 [info ] [MainThread]: python path: /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/.venv/bin/python
[0m17:51:52.548059 [info ] [MainThread]: os info: macOS-12.6-arm64-arm-64bit
[0m17:51:52.584136 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m17:51:52.584444 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m17:51:52.584620 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/dbt_project.yml
[0m17:51:52.584952 [info ] [MainThread]: adapter type: postgres
[0m17:51:52.585125 [info ] [MainThread]: adapter version: 1.6.5
[0m17:51:52.596749 [info ] [MainThread]: Configuration:
[0m17:51:52.597025 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:51:52.597194 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:51:52.597350 [info ] [MainThread]: Required dependencies:
[0m17:51:52.597559 [debug] [MainThread]: Executing "git --help"
[0m17:51:52.609534 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:51:52.610156 [debug] [MainThread]: STDERR: "b''"
[0m17:51:52.610391 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:51:52.610590 [info ] [MainThread]: Connection:
[0m17:51:52.610790 [info ] [MainThread]:   host: 34.116.121.126
[0m17:51:52.610938 [info ] [MainThread]:   port: 5432
[0m17:51:52.611086 [info ] [MainThread]:   user: postgres
[0m17:51:52.611229 [info ] [MainThread]:   database: postgres
[0m17:51:52.611374 [info ] [MainThread]:   schema: public
[0m17:51:52.611517 [info ] [MainThread]:   connect_timeout: 10
[0m17:51:52.611662 [info ] [MainThread]:   role: None
[0m17:51:52.611808 [info ] [MainThread]:   search_path: None
[0m17:51:52.611950 [info ] [MainThread]:   keepalives_idle: 0
[0m17:51:52.612094 [info ] [MainThread]:   sslmode: None
[0m17:51:52.612235 [info ] [MainThread]:   sslcert: None
[0m17:51:52.612379 [info ] [MainThread]:   sslkey: None
[0m17:51:52.612518 [info ] [MainThread]:   sslrootcert: None
[0m17:51:52.612657 [info ] [MainThread]:   application_name: dbt
[0m17:51:52.612798 [info ] [MainThread]:   retries: 1
[0m17:51:52.613076 [info ] [MainThread]: Registered adapter: postgres=1.6.5
[0m17:51:52.664414 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:51:52.665124 [debug] [MainThread]: Using postgres connection "debug"
[0m17:51:52.665354 [debug] [MainThread]: On debug: select 1 as id
[0m17:51:52.665565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:02.671812 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "34.116.121.126", port 5432 failed: timeout expired

[0m17:52:12.675427 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:52:12.678070 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:52:12.679510 [debug] [MainThread]: On debug: No close available on handle
[0m17:52:12.680879 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:52:12.682012 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:52:12.684160 [debug] [MainThread]: Command `dbt debug` succeeded at 17:52:12.683859 after 20.16 seconds
[0m17:52:12.685130 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:52:12.686106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e21cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b365c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b359c0>]}
[0m17:52:12.687407 [debug] [MainThread]: Flushing usage events
[0m17:52:30.512912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff2980>]}


============================== 17:52:30.515620 | 08524c4d-eedb-4fe9-946c-a0a21031b7e2 ==============================
[0m17:52:30.515620 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:52:30.515950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:30.516266 [info ] [MainThread]: dbt version: 1.6.5
[0m17:52:30.516429 [info ] [MainThread]: python version: 3.10.5
[0m17:52:30.516589 [info ] [MainThread]: python path: /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/.venv/bin/python
[0m17:52:30.516741 [info ] [MainThread]: os info: macOS-12.6-arm64-arm-64bit
[0m17:52:30.544171 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m17:52:30.544450 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m17:52:30.544629 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/dbt_project.yml
[0m17:52:30.544929 [info ] [MainThread]: adapter type: postgres
[0m17:52:30.545139 [info ] [MainThread]: adapter version: 1.6.5
[0m17:52:30.557032 [info ] [MainThread]: Configuration:
[0m17:52:30.557323 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:52:30.557488 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:52:30.557638 [info ] [MainThread]: Required dependencies:
[0m17:52:30.557845 [debug] [MainThread]: Executing "git --help"
[0m17:52:30.568358 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:52:30.569165 [debug] [MainThread]: STDERR: "b''"
[0m17:52:30.569378 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:52:30.569572 [info ] [MainThread]: Connection:
[0m17:52:30.569768 [info ] [MainThread]:   host: 34.116.121.126
[0m17:52:30.569926 [info ] [MainThread]:   port: 5432
[0m17:52:30.570076 [info ] [MainThread]:   user: postgres
[0m17:52:30.570226 [info ] [MainThread]:   database: postgres
[0m17:52:30.570374 [info ] [MainThread]:   schema: public
[0m17:52:30.570521 [info ] [MainThread]:   connect_timeout: 10
[0m17:52:30.570666 [info ] [MainThread]:   role: None
[0m17:52:30.570810 [info ] [MainThread]:   search_path: None
[0m17:52:30.570954 [info ] [MainThread]:   keepalives_idle: 0
[0m17:52:30.571097 [info ] [MainThread]:   sslmode: None
[0m17:52:30.571239 [info ] [MainThread]:   sslcert: None
[0m17:52:30.571385 [info ] [MainThread]:   sslkey: None
[0m17:52:30.571526 [info ] [MainThread]:   sslrootcert: None
[0m17:52:30.571669 [info ] [MainThread]:   application_name: dbt
[0m17:52:30.571810 [info ] [MainThread]:   retries: 1
[0m17:52:30.572106 [info ] [MainThread]: Registered adapter: postgres=1.6.5
[0m17:52:30.575053 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:52:30.575712 [debug] [MainThread]: Using postgres connection "debug"
[0m17:52:30.575905 [debug] [MainThread]: On debug: select 1 as id
[0m17:52:30.576084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:40.579381 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "34.116.121.126", port 5432 failed: timeout expired

[0m17:52:50.584676 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:52:50.586818 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:52:50.588022 [debug] [MainThread]: On debug: No close available on handle
[0m17:52:50.589297 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:52:50.590445 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:52:50.593371 [debug] [MainThread]: Command `dbt debug` succeeded at 17:52:50.593074 after 20.09 seconds
[0m17:52:50.594079 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:52:50.594904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714dde0>]}
[0m17:52:50.595901 [debug] [MainThread]: Flushing usage events
[0m17:57:37.702869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918e980>]}


============================== 17:57:37.705832 | 2b4f3403-dddf-4c6d-8835-db74569cf580 ==============================
[0m17:57:37.705832 [info ] [MainThread]: Running with dbt=1.6.5
[0m17:57:37.706169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:57:37.706467 [info ] [MainThread]: dbt version: 1.6.5
[0m17:57:37.706646 [info ] [MainThread]: python version: 3.10.5
[0m17:57:37.706800 [info ] [MainThread]: python path: /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/.venv/bin/python
[0m17:57:37.706949 [info ] [MainThread]: os info: macOS-12.6-arm64-arm-64bit
[0m17:57:37.742034 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m17:57:37.742317 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m17:57:37.742489 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/dbt_project.yml
[0m17:57:37.742766 [info ] [MainThread]: adapter type: postgres
[0m17:57:37.742930 [info ] [MainThread]: adapter version: 1.6.5
[0m17:57:37.754839 [info ] [MainThread]: Configuration:
[0m17:57:37.755107 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:37.755276 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:37.755431 [info ] [MainThread]: Required dependencies:
[0m17:57:37.755637 [debug] [MainThread]: Executing "git --help"
[0m17:57:37.768794 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:57:37.769409 [debug] [MainThread]: STDERR: "b''"
[0m17:57:37.769624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:57:37.769799 [info ] [MainThread]: Connection:
[0m17:57:37.770008 [info ] [MainThread]:   host: 34.116.121.126
[0m17:57:37.770163 [info ] [MainThread]:   port: 5432
[0m17:57:37.770309 [info ] [MainThread]:   user: postgres
[0m17:57:37.770452 [info ] [MainThread]:   database: postgres
[0m17:57:37.770608 [info ] [MainThread]:   schema: public
[0m17:57:37.770751 [info ] [MainThread]:   connect_timeout: 10
[0m17:57:37.770899 [info ] [MainThread]:   role: None
[0m17:57:37.771040 [info ] [MainThread]:   search_path: None
[0m17:57:37.771182 [info ] [MainThread]:   keepalives_idle: 0
[0m17:57:37.771323 [info ] [MainThread]:   sslmode: None
[0m17:57:37.771465 [info ] [MainThread]:   sslcert: None
[0m17:57:37.771604 [info ] [MainThread]:   sslkey: None
[0m17:57:37.771744 [info ] [MainThread]:   sslrootcert: None
[0m17:57:37.771882 [info ] [MainThread]:   application_name: dbt
[0m17:57:37.772022 [info ] [MainThread]:   retries: 1
[0m17:57:37.772331 [info ] [MainThread]: Registered adapter: postgres=1.6.5
[0m17:57:37.775760 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:57:37.776582 [debug] [MainThread]: Using postgres connection "debug"
[0m17:57:37.776765 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:37.776948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:47.782094 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "34.116.121.126", port 5432 failed: timeout expired

[0m17:57:57.786684 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:57:57.788008 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:57:57.788846 [debug] [MainThread]: On debug: No close available on handle
[0m17:57:57.789789 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:57:57.791023 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:57:57.792871 [debug] [MainThread]: Command `dbt debug` succeeded at 17:57:57.792481 after 20.10 seconds
[0m17:57:57.794328 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:57.795032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ed330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ef1c0>]}
[0m17:57:57.795804 [debug] [MainThread]: Flushing usage events
[0m18:12:13.421215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d65cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f6cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f6a40>]}


============================== 18:12:13.424073 | ad0bb9d5-75a9-4d97-b37a-96ef84d66f1c ==============================
[0m18:12:13.424073 [info ] [MainThread]: Running with dbt=1.6.5
[0m18:12:13.424407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:13.424709 [info ] [MainThread]: dbt version: 1.6.5
[0m18:12:13.424875 [info ] [MainThread]: python version: 3.10.5
[0m18:12:13.425033 [info ] [MainThread]: python path: /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/.venv/bin/python
[0m18:12:13.425191 [info ] [MainThread]: os info: macOS-12.6-arm64-arm-64bit
[0m18:12:13.461508 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m18:12:13.461820 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m18:12:13.461996 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/dbt_project.yml
[0m18:12:13.462275 [info ] [MainThread]: adapter type: postgres
[0m18:12:13.462444 [info ] [MainThread]: adapter version: 1.6.5
[0m18:12:13.474313 [info ] [MainThread]: Configuration:
[0m18:12:13.474585 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:12:13.474751 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:12:13.474903 [info ] [MainThread]: Required dependencies:
[0m18:12:13.475106 [debug] [MainThread]: Executing "git --help"
[0m18:12:13.488634 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:12:13.489291 [debug] [MainThread]: STDERR: "b''"
[0m18:12:13.489496 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:12:13.489678 [info ] [MainThread]: Connection:
[0m18:12:13.489888 [info ] [MainThread]:   host: 34.116.121.126
[0m18:12:13.490047 [info ] [MainThread]:   port: 5432
[0m18:12:13.490192 [info ] [MainThread]:   user: postgres
[0m18:12:13.490338 [info ] [MainThread]:   database: postgres
[0m18:12:13.490483 [info ] [MainThread]:   schema: public
[0m18:12:13.490624 [info ] [MainThread]:   connect_timeout: 10
[0m18:12:13.490767 [info ] [MainThread]:   role: None
[0m18:12:13.490909 [info ] [MainThread]:   search_path: None
[0m18:12:13.491048 [info ] [MainThread]:   keepalives_idle: 0
[0m18:12:13.491185 [info ] [MainThread]:   sslmode: None
[0m18:12:13.491326 [info ] [MainThread]:   sslcert: None
[0m18:12:13.491465 [info ] [MainThread]:   sslkey: None
[0m18:12:13.491604 [info ] [MainThread]:   sslrootcert: None
[0m18:12:13.491744 [info ] [MainThread]:   application_name: dbt
[0m18:12:13.491894 [info ] [MainThread]:   retries: 1
[0m18:12:13.492177 [info ] [MainThread]: Registered adapter: postgres=1.6.5
[0m18:12:13.495504 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:12:13.496054 [debug] [MainThread]: Using postgres connection "debug"
[0m18:12:13.496307 [debug] [MainThread]: On debug: select 1 as id
[0m18:12:13.496477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:13.774348 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:12:13.776495 [debug] [MainThread]: On debug: Close
[0m18:12:13.777429 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:12:13.778069 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:12:13.779087 [debug] [MainThread]: Command `dbt debug` succeeded at 18:12:13.778944 after 0.37 seconds
[0m18:12:13.779599 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:12:13.780144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d65cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a59510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5b9d0>]}
[0m18:12:13.780795 [debug] [MainThread]: Flushing usage events
[0m17:58:38.930254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe086e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe28ae040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe28ae130>]}


============================== 17:58:38.934412 | 022698e2-245b-409c-a7ee-e842d01b273c ==============================
[0m17:58:38.934412 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:58:38.935067 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt snapshot', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m17:58:38.939357 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m17:58:38.939829 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "bde", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m17:58:38.940805 [debug] [MainThread]: Command `dbt snapshot` failed at 17:58:38.940299 after 0.05 seconds
[0m17:58:38.941147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe086e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe28ae640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabe28ae130>]}
[0m17:58:38.941451 [debug] [MainThread]: Flushing usage events
[0m18:00:32.711696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4388416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43af38850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43af38940>]}


============================== 18:00:32.715687 | ee777ff5-ef83-44bf-ab09-b4ecfbb3e619 ==============================
[0m18:00:32.715687 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:00:32.716351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:34.408168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee777ff5-ef83-44bf-ab09-b4ecfbb3e619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43af38880>]}
[0m18:00:34.418971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee777ff5-ef83-44bf-ab09-b4ecfbb3e619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43b02d280>]}
[0m18:00:34.419570 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:00:34.706107 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:00:34.707315 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:00:34.707902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee777ff5-ef83-44bf-ab09-b4ecfbb3e619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43b031d00>]}
[0m18:00:35.252808 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A snapshot configured with the check strategy must specify a check_cols configuration.
[0m18:00:35.253755 [debug] [MainThread]: Command `dbt snapshot` failed at 18:00:35.253457 after 2.57 seconds
[0m18:00:35.254141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4388416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43b031640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa428a2fa90>]}
[0m18:00:35.254464 [debug] [MainThread]: Flushing usage events
[0m18:06:17.542876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b8b096a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bac41820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bac41910>]}


============================== 18:06:17.547147 | ab61b507-d822-49ab-9a09-c61891889b5e ==============================
[0m18:06:17.547147 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:06:17.547782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:17.665218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab61b507-d822-49ab-9a09-c61891889b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bac417f0>]}
[0m18:06:17.675848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab61b507-d822-49ab-9a09-c61891889b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bad75250>]}
[0m18:06:17.676380 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:06:17.692356 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:06:17.693084 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:06:17.693425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab61b507-d822-49ab-9a09-c61891889b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bad7bcd0>]}
[0m18:06:18.295368 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.host_snapshot' (snapshots/host_snapshot.sql) depends on a source named 'raw.house' which was not found
[0m18:06:18.296219 [debug] [MainThread]: Command `dbt snapshot` failed at 18:06:18.295923 after 0.78 seconds
[0m18:06:18.296563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b8b096a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bae4c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bae4c040>]}
[0m18:06:18.296869 [debug] [MainThread]: Flushing usage events
[0m18:34:38.994693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e0c216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e3389850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e3389940>]}


============================== 18:34:38.998772 | a0205b44-f013-4129-b697-5376ca0d2178 ==============================
[0m18:34:38.998772 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:34:38.999467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:39.144886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0205b44-f013-4129-b697-5376ca0d2178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e33898e0>]}
[0m18:34:39.156045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0205b44-f013-4129-b697-5376ca0d2178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c01be280>]}
[0m18:34:39.156686 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:34:39.173555 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:34:39.174362 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:34:39.174730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0205b44-f013-4129-b697-5376ca0d2178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c01d4c70>]}
[0m18:34:39.809530 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.dm_host_neighbourhood' (models/datamart/dm_host_neighbourhood.sql) depends on a node named 'dim_suburb' which was not found
[0m18:34:39.810377 [debug] [MainThread]: Command `dbt snapshot` failed at 18:34:39.810075 after 0.86 seconds
[0m18:34:39.810713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e0c216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b067d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b067d070>]}
[0m18:34:39.811006 [debug] [MainThread]: Flushing usage events
[0m18:38:19.492448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd830b04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd832cd18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd832cd19a0>]}


============================== 18:38:19.496657 | 07f6d751-81c5-49d2-8695-54de820a3608 ==============================
[0m18:38:19.496657 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:38:19.497341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:38:19.642522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f6d751-81c5-49d2-8695-54de820a3608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd832cd1940>]}
[0m18:38:19.653322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f6d751-81c5-49d2-8695-54de820a3608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd832dc82e0>]}
[0m18:38:19.653860 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:38:19.670698 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:38:19.671508 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:38:19.671862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07f6d751-81c5-49d2-8695-54de820a3608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd832dcbc40>]}
[0m18:38:20.289128 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.suburb_stg' (models/staging/suburb_stg.sql) depends on a node named 'listings_snapshot' which was not found
[0m18:38:20.289966 [debug] [MainThread]: Command `dbt snapshot` failed at 18:38:20.289680 after 0.83 seconds
[0m18:38:20.290295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd830b04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd810818be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd810818ca0>]}
[0m18:38:20.290610 [debug] [MainThread]: Flushing usage events
[0m18:39:00.782591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda98b51160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9b05a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9b05a8b0>]}


============================== 18:39:00.786549 | 7e2581a6-decb-4424-bf1c-9ea450dba880 ==============================
[0m18:39:00.786549 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:39:00.787189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:39:00.893465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e2581a6-decb-4424-bf1c-9ea450dba880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9b0742e0>]}
[0m18:39:00.904127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e2581a6-decb-4424-bf1c-9ea450dba880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda781ce1f0>]}
[0m18:39:00.904829 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:39:00.922528 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:39:00.923633 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:39:00.923991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e2581a6-decb-4424-bf1c-9ea450dba880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda781e4c70>]}
[0m18:39:01.545397 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.suburb_stg' (models/staging/suburb_stg.sql) depends on a node named 'listings_snapshot' which was not found
[0m18:39:01.546234 [debug] [MainThread]: Command `dbt snapshot` failed at 18:39:01.545946 after 0.79 seconds
[0m18:39:01.546573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda98b51160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9b271af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9b271bb0>]}
[0m18:39:01.546887 [debug] [MainThread]: Flushing usage events
[0m18:39:35.263143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91489316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914ad19820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914ad19910>]}


============================== 18:39:35.267173 | 1b0fc1bd-87bc-4173-83a5-759c888302f4 ==============================
[0m18:39:35.267173 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:39:35.267813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:39:35.367158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b0fc1bd-87bc-4173-83a5-759c888302f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914ad198b0>]}
[0m18:39:35.377909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b0fc1bd-87bc-4173-83a5-759c888302f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914ad8d250>]}
[0m18:39:35.378825 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:39:35.397269 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:39:35.398022 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:39:35.398368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b0fc1bd-87bc-4173-83a5-759c888302f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914ad91d00>]}
[0m18:39:36.000461 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.suburb_stg' (models/staging/suburb_stg.sql) depends on a node named 'listings_snapshot' which was not found
[0m18:39:36.001260 [debug] [MainThread]: Command `dbt snapshot` failed at 18:39:36.000993 after 0.77 seconds
[0m18:39:36.001619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91489316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914af31b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914af31c10>]}
[0m18:39:36.001941 [debug] [MainThread]: Flushing usage events
[0m18:43:57.933042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40bb1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee430917c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee430918b0>]}


============================== 18:43:57.936842 | d0e73c00-2580-4f1f-8be5-58bc8cc829a0 ==============================
[0m18:43:57.936842 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:43:57.937487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:43:58.041773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee430ab2b0>]}
[0m18:43:58.052449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee431c51f0>]}
[0m18:43:58.052975 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:43:58.069018 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:43:58.069860 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:43:58.070233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee431cbd00>]}
[0m18:43:58.645975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.staging
- models.bde.datamart
[0m18:43:58.649752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee207b3a30>]}
[0m18:43:58.661108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee207b37c0>]}
[0m18:43:58.661540 [info ] [MainThread]: Found 5 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:43:58.661833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee207e0910>]}
[0m18:43:58.663074 [info ] [MainThread]: 
[0m18:43:58.663675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:58.664536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:43:58.672367 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:43:58.672739 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:43:58.672991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:59.101603 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:43:59.102923 [debug] [ThreadPool]: On list_postgres: Close
[0m18:43:59.104175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_raw)
[0m18:43:59.105027 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "raw"
"
[0m18:43:59.109290 [debug] [ThreadPool]: Using postgres connection "create_postgres_raw"
[0m18:43:59.109592 [debug] [ThreadPool]: On create_postgres_raw: BEGIN
[0m18:43:59.109846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:59.284180 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:59.284823 [debug] [ThreadPool]: Using postgres connection "create_postgres_raw"
[0m18:43:59.285219 [debug] [ThreadPool]: On create_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_raw"} */
create schema if not exists "raw"
[0m18:43:59.307133 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:43:59.308282 [debug] [ThreadPool]: On create_postgres_raw: COMMIT
[0m18:43:59.308665 [debug] [ThreadPool]: Using postgres connection "create_postgres_raw"
[0m18:43:59.309013 [debug] [ThreadPool]: On create_postgres_raw: COMMIT
[0m18:43:59.328771 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:43:59.329346 [debug] [ThreadPool]: On create_postgres_raw: Close
[0m18:43:59.331628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_raw, now list_postgres_raw)
[0m18:43:59.338492 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:43:59.339001 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:43:59.339331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:59.510509 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:59.511599 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:43:59.512404 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:43:59.537758 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:43:59.540944 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:43:59.557793 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:43:59.569218 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.570038 [debug] [MainThread]: On master: BEGIN
[0m18:43:59.570713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:59.741801 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:59.742840 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.743845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:59.767035 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:43:59.769925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee20a0e610>]}
[0m18:43:59.770962 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:59.786707 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.787776 [debug] [MainThread]: On master: BEGIN
[0m18:43:59.822851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:59.823737 [debug] [MainThread]: On master: COMMIT
[0m18:43:59.824340 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:59.824898 [debug] [MainThread]: On master: COMMIT
[0m18:43:59.840164 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:59.840772 [debug] [MainThread]: On master: Close
[0m18:43:59.842176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:59.842799 [info ] [MainThread]: 
[0m18:43:59.847278 [debug] [Thread-1  ]: Began running node snapshot.bde.code_snapshot
[0m18:43:59.848087 [debug] [Thread-2  ]: Began running node snapshot.bde.host_snapshot
[0m18:43:59.848899 [debug] [Thread-3  ]: Began running node snapshot.bde.listing_snapshot
[0m18:43:59.849548 [debug] [Thread-4  ]: Began running node snapshot.bde.property_snapshot
[0m18:43:59.850273 [info ] [Thread-1  ]: 1 of 5 START snapshot raw.code_snapshot ........................................ [RUN]
[0m18:43:59.851093 [info ] [Thread-2  ]: 2 of 5 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:43:59.851828 [info ] [Thread-3  ]: 3 of 5 START snapshot raw.listing_snapshot ..................................... [RUN]
[0m18:43:59.852542 [info ] [Thread-4  ]: 4 of 5 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:43:59.853626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.code_snapshot)
[0m18:43:59.854717 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m18:43:59.855708 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m18:43:59.856705 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m18:43:59.857324 [debug] [Thread-1  ]: Began compiling node snapshot.bde.code_snapshot
[0m18:43:59.857919 [debug] [Thread-2  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:43:59.858491 [debug] [Thread-3  ]: Began compiling node snapshot.bde.listing_snapshot
[0m18:43:59.859038 [debug] [Thread-4  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:43:59.870512 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (compile): 18:43:59.859403 => 18:43:59.870196
[0m18:43:59.874537 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:43:59.870924 => 18:43:59.874202
[0m18:43:59.878743 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (compile): 18:43:59.874998 => 18:43:59.878471
[0m18:43:59.882090 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:43:59.879108 => 18:43:59.881882
[0m18:43:59.882525 [debug] [Thread-1  ]: Began executing node snapshot.bde.code_snapshot
[0m18:43:59.882919 [debug] [Thread-2  ]: Began executing node snapshot.bde.host_snapshot
[0m18:43:59.883302 [debug] [Thread-3  ]: Began executing node snapshot.bde.listing_snapshot
[0m18:43:59.883674 [debug] [Thread-4  ]: Began executing node snapshot.bde.property_snapshot
[0m18:43:59.950769 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:43:59.953104 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m18:43:59.953681 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.code_snapshot"
[0m18:43:59.956167 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:43:59.957009 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m18:43:59.957322 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m18:43:59.957595 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:43:59.958006 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m18:43:59.958341 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: BEGIN
[0m18:43:59.958645 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:43:59.958954 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:43:59.959245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:59.959541 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:43:59.959828 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:43:59.960191 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:43:59.960631 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:44:00.127148 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:44:00.127917 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:44:00.128633 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:44:00.129233 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:44:00.129876 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id,
        host_since as dbt_updated_at,
        host_since as dbt_valid_from,
        nullif(host_since, host_since) as dbt_valid_to
    from (
        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:44:00.130568 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      
  
    

  create  table "postgres"."raw"."property_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select id, scraped_date, property_type, room_type from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:44:00.131396 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:44:00.131935 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m18:44:00.132455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:44:00.132980 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      
  
    

  create  table "postgres"."raw"."listing_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select id,listing_id,scrape_id,scraped_date,listing_neighbourhood,accommodates,price,has_availability, availability_30, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:44:00.133528 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m18:44:00.134147 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      
  
    

  create  table "postgres"."raw"."code_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



select * from "postgres"."raw"."nsw_lga_code"

    ) sbq



  );
  
  
[0m18:44:00.146098 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "raw.listings" does not exist
LINE 27: ...t_since,host_is_superhost,host_neighbourhood from "postgres"...
                                                              ^

[0m18:44:00.146723 [debug] [Thread-4  ]: Postgres adapter: Postgres error: relation "raw.listings" does not exist
LINE 27: ...t id, scraped_date, property_type, room_type from "postgres"...
                                                              ^

[0m18:44:00.147342 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: ROLLBACK
[0m18:44:00.147911 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: ROLLBACK
[0m18:44:00.150115 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "raw.listings" does not exist
LINE 27: ...IEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"...
                                                              ^

[0m18:44:00.150693 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: ROLLBACK
[0m18:44:00.151517 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.nsw_lga_code" does not exist
LINE 27: select * from "postgres"."raw"."nsw_lga_code"
                       ^

[0m18:44:00.152084 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: ROLLBACK
[0m18:44:00.164035 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:43:59.909369 => 18:44:00.163738
[0m18:44:00.164841 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:43:59.953983 => 18:44:00.164545
[0m18:44:00.165457 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: Close
[0m18:44:00.166041 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: Close
[0m18:44:00.168445 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (execute): 18:43:59.934643 => 18:44:00.168137
[0m18:44:00.169354 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (execute): 18:43:59.883951 => 18:44:00.169067
[0m18:44:00.169899 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: Close
[0m18:44:00.170749 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: Close
[0m18:44:00.178932 [debug] [Thread-1  ]: Database Error in snapshot code_snapshot (snapshots/code_snapshot.sql)
  relation "raw.nsw_lga_code" does not exist
  LINE 27: select * from "postgres"."raw"."nsw_lga_code"
                         ^
  compiled Code at target/run/bde/snapshots/code_snapshot.sql
[0m18:44:00.180015 [debug] [Thread-3  ]: Database Error in snapshot listing_snapshot (snapshots/listings_snapshot.sql)
  relation "raw.listings" does not exist
  LINE 27: ...IEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"...
                                                                ^
  compiled Code at target/run/bde/snapshots/listings_snapshot.sql
[0m18:44:00.180732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee20a77790>]}
[0m18:44:00.181600 [debug] [Thread-4  ]: Database Error in snapshot property_snapshot (snapshots/property_snapshot.sql)
  relation "raw.listings" does not exist
  LINE 27: ...t id, scraped_date, property_type, room_type from "postgres"...
                                                                ^
  compiled Code at target/run/bde/snapshots/property_snapshot.sql
[0m18:44:00.182508 [debug] [Thread-2  ]: Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  relation "raw.listings" does not exist
  LINE 27: ...t_since,host_is_superhost,host_neighbourhood from "postgres"...
                                                                ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:44:00.183036 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee20927af0>]}
[0m18:44:00.183598 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee20a64a30>]}
[0m18:44:00.184733 [error] [Thread-1  ]: 1 of 5 ERROR snapshotting raw.code_snapshot .................................... [[31mERROR[0m in 0.33s]
[0m18:44:00.185305 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee209fbe20>]}
[0m18:44:00.186137 [error] [Thread-3  ]: 3 of 5 ERROR snapshotting raw.listing_snapshot ................................. [[31mERROR[0m in 0.33s]
[0m18:44:00.187028 [error] [Thread-4  ]: 4 of 5 ERROR snapshotting raw.property_snapshot ................................ [[31mERROR[0m in 0.33s]
[0m18:44:00.187796 [debug] [Thread-1  ]: Finished running node snapshot.bde.code_snapshot
[0m18:44:00.188576 [error] [Thread-2  ]: 2 of 5 ERROR snapshotting raw.host_snapshot .................................... [[31mERROR[0m in 0.33s]
[0m18:44:00.189299 [debug] [Thread-3  ]: Finished running node snapshot.bde.listing_snapshot
[0m18:44:00.189968 [debug] [Thread-4  ]: Finished running node snapshot.bde.property_snapshot
[0m18:44:00.190516 [debug] [Thread-1  ]: Began running node snapshot.bde.suburb_snapshot
[0m18:44:00.191232 [debug] [Thread-2  ]: Finished running node snapshot.bde.host_snapshot
[0m18:44:00.191889 [info ] [Thread-1  ]: 5 of 5 START snapshot raw.suburb_snapshot ...................................... [RUN]
[0m18:44:00.192687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.bde.code_snapshot, now snapshot.bde.suburb_snapshot)
[0m18:44:00.193087 [debug] [Thread-1  ]: Began compiling node snapshot.bde.suburb_snapshot
[0m18:44:00.196798 [debug] [Thread-1  ]: Timing info for snapshot.bde.suburb_snapshot (compile): 18:44:00.193364 => 18:44:00.196578
[0m18:44:00.197221 [debug] [Thread-1  ]: Began executing node snapshot.bde.suburb_snapshot
[0m18:44:00.201770 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.suburb_snapshot"
[0m18:44:00.202451 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m18:44:00.202826 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: BEGIN
[0m18:44:00.203164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:00.362830 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:44:00.363773 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m18:44:00.364521 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      
  
    

  create  table "postgres"."raw"."suburb_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



select * from "postgres"."raw"."nsw_lga_suburb"

    ) sbq



  );
  
  
[0m18:44:00.389478 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.nsw_lga_suburb" does not exist
LINE 27: select * from "postgres"."raw"."nsw_lga_suburb"
                       ^

[0m18:44:00.390238 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: ROLLBACK
[0m18:44:00.406425 [debug] [Thread-1  ]: Timing info for snapshot.bde.suburb_snapshot (execute): 18:44:00.197502 => 18:44:00.405988
[0m18:44:00.407319 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: Close
[0m18:44:00.410339 [debug] [Thread-1  ]: Database Error in snapshot suburb_snapshot (snapshots/suburb_snapshot.sql)
  relation "raw.nsw_lga_suburb" does not exist
  LINE 27: select * from "postgres"."raw"."nsw_lga_suburb"
                         ^
  compiled Code at target/run/bde/snapshots/suburb_snapshot.sql
[0m18:44:00.411364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e73c00-2580-4f1f-8be5-58bc8cc829a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee432e5910>]}
[0m18:44:00.413003 [error] [Thread-1  ]: 5 of 5 ERROR snapshotting raw.suburb_snapshot .................................. [[31mERROR[0m in 0.22s]
[0m18:44:00.414320 [debug] [Thread-1  ]: Finished running node snapshot.bde.suburb_snapshot
[0m18:44:00.416744 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.417412 [debug] [MainThread]: On master: BEGIN
[0m18:44:00.417997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:00.593322 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:00.594367 [debug] [MainThread]: On master: COMMIT
[0m18:44:00.594977 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.595548 [debug] [MainThread]: On master: COMMIT
[0m18:44:00.612112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:00.612890 [debug] [MainThread]: On master: Close
[0m18:44:00.614378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:00.614951 [debug] [MainThread]: Connection 'snapshot.bde.suburb_snapshot' was properly closed.
[0m18:44:00.615467 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:44:00.615978 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m18:44:00.616486 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:44:00.617105 [info ] [MainThread]: 
[0m18:44:00.617670 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m18:44:00.619558 [debug] [MainThread]: Command end result
[0m18:44:00.630167 [info ] [MainThread]: 
[0m18:44:00.630816 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m18:44:00.631265 [info ] [MainThread]: 
[0m18:44:00.631696 [error] [MainThread]:   Database Error in snapshot code_snapshot (snapshots/code_snapshot.sql)
  relation "raw.nsw_lga_code" does not exist
  LINE 27: select * from "postgres"."raw"."nsw_lga_code"
                         ^
  compiled Code at target/run/bde/snapshots/code_snapshot.sql
[0m18:44:00.632149 [info ] [MainThread]: 
[0m18:44:00.632579 [error] [MainThread]:   Database Error in snapshot listing_snapshot (snapshots/listings_snapshot.sql)
  relation "raw.listings" does not exist
  LINE 27: ...IEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"...
                                                                ^
  compiled Code at target/run/bde/snapshots/listings_snapshot.sql
[0m18:44:00.633001 [info ] [MainThread]: 
[0m18:44:00.633417 [error] [MainThread]:   Database Error in snapshot property_snapshot (snapshots/property_snapshot.sql)
  relation "raw.listings" does not exist
  LINE 27: ...t id, scraped_date, property_type, room_type from "postgres"...
                                                                ^
  compiled Code at target/run/bde/snapshots/property_snapshot.sql
[0m18:44:00.633847 [info ] [MainThread]: 
[0m18:44:00.634264 [error] [MainThread]:   Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  relation "raw.listings" does not exist
  LINE 27: ...t_since,host_is_superhost,host_neighbourhood from "postgres"...
                                                                ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:44:00.634804 [info ] [MainThread]: 
[0m18:44:00.635321 [error] [MainThread]:   Database Error in snapshot suburb_snapshot (snapshots/suburb_snapshot.sql)
  relation "raw.nsw_lga_suburb" does not exist
  LINE 27: select * from "postgres"."raw"."nsw_lga_suburb"
                         ^
  compiled Code at target/run/bde/snapshots/suburb_snapshot.sql
[0m18:44:00.635781 [info ] [MainThread]: 
[0m18:44:00.636277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m18:44:00.637102 [debug] [MainThread]: Command `dbt snapshot` failed at 18:44:00.636977 after 2.73 seconds
[0m18:44:00.637615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee40bb1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee431c51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee207e0910>]}
[0m18:44:00.638102 [debug] [MainThread]: Flushing usage events
[0m18:49:39.171311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0c3d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a358a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a358a850>]}


============================== 18:49:39.175313 | cd22a331-7a35-4fd5-b1bb-8319acd786f6 ==============================
[0m18:49:39.175313 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:49:39.176014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:49:39.309916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd22a331-7a35-4fd5-b1bb-8319acd786f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a35a43a0>]}
[0m18:49:39.320566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd22a331-7a35-4fd5-b1bb-8319acd786f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a36bf190>]}
[0m18:49:39.321090 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:49:39.337270 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:49:39.365051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:49:39.365660 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m18:49:39.366001 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m18:49:39.366313 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/code_snapshot.sql
[0m18:49:39.366628 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/suburb_snapshot.sql
[0m18:49:39.366934 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:49:39.412119 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.property_snapshot' (snapshots/property_snapshot.sql) depends on a source named 'at3.listings' which was not found
[0m18:49:39.413059 [debug] [MainThread]: Command `dbt snapshot` failed at 18:49:39.412743 after 0.27 seconds
[0m18:49:39.413458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0c3d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97008d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb970099250>]}
[0m18:49:39.413831 [debug] [MainThread]: Flushing usage events
[0m18:51:31.982641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca01b96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc92fe8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc92fe8940>]}


============================== 18:51:31.986630 | a84f4b34-6e39-4c35-80d5-ac7b92534357 ==============================
[0m18:51:31.986630 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:51:31.987330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:51:32.122185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a84f4b34-6e39-4c35-80d5-ac7b92534357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc92fe8880>]}
[0m18:51:32.133208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a84f4b34-6e39-4c35-80d5-ac7b92534357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc931212b0>]}
[0m18:51:32.133830 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:51:32.150839 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:51:32.184344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:51:32.184951 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/suburb_snapshot.sql
[0m18:51:32.185294 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m18:51:32.185614 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:51:32.185920 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m18:51:32.186214 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/code_snapshot.sql
[0m18:51:32.230331 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.suburb_snapshot' (snapshots/suburb_snapshot.sql) depends on a source named 'at3.nsw_lga_suburb' which was not found
[0m18:51:32.231370 [debug] [MainThread]: Command `dbt run` failed at 18:51:32.231006 after 0.28 seconds
[0m18:51:32.231812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca01b96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca0535400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca0542370>]}
[0m18:51:32.232200 [debug] [MainThread]: Flushing usage events
[0m18:55:17.643378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae8c64ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aeb2b18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aeb2b19a0>]}


============================== 18:55:17.647675 | 42b20681-361d-4965-898b-4c7f603a111d ==============================
[0m18:55:17.647675 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:55:17.648356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:55:17.786373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42b20681-361d-4965-898b-4c7f603a111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aeb2b1940>]}
[0m18:55:17.797293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42b20681-361d-4965-898b-4c7f603a111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aeb3e72e0>]}
[0m18:55:17.797849 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:55:17.815815 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:55:17.842573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:55:17.843237 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/code_snapshot.sql
[0m18:55:17.843622 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:55:17.843962 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/suburb_snapshot.sql
[0m18:55:17.844293 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m18:55:17.844617 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m18:55:17.888571 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.code_snapshot' (snapshots/code_snapshot.sql) depends on a source named 'at3.nsw_lga_code' which was not found
[0m18:55:17.889526 [debug] [MainThread]: Command `dbt snapshot` failed at 18:55:17.889197 after 0.28 seconds
[0m18:55:17.889919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae8c64ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad83b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad83c33a0>]}
[0m18:55:17.890286 [debug] [MainThread]: Flushing usage events
[0m19:06:11.330574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f0c916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f3388880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f3388970>]}


============================== 19:06:11.334747 | 3189da54-dd00-4972-a3d4-8216d0ff329e ==============================
[0m19:06:11.334747 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:06:11.335377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m19:06:11.485024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f3388910>]}
[0m19:06:11.495820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f34c12b0>]}
[0m19:06:11.496367 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m19:06:11.512663 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:06:11.540138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m19:06:11.540993 [debug] [MainThread]: Partial parsing: updated file: bde://models/sources.yml
[0m19:06:11.541307 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m19:06:11.541590 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m19:06:11.541863 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/suburb_snapshot.sql
[0m19:06:11.542124 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/code_snapshot.sql
[0m19:06:11.542380 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m19:06:11.608346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.staging
- models.bde.datamart
[0m19:06:11.612196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e069adc0>]}
[0m19:06:11.625856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e062e610>]}
[0m19:06:11.626324 [info ] [MainThread]: Found 5 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m19:06:11.626622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e062e6a0>]}
[0m19:06:11.628070 [info ] [MainThread]: 
[0m19:06:11.628671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:06:11.629659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:06:11.637129 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:06:11.637500 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:06:11.637767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:12.112802 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:06:12.114417 [debug] [ThreadPool]: On list_postgres: Close
[0m19:06:12.116308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m19:06:12.121778 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m19:06:12.122195 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m19:06:12.122478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:12.308968 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:06:12.310052 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m19:06:12.310875 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m19:06:12.331985 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:06:12.335995 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m19:06:12.353263 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m19:06:12.368758 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:12.369562 [debug] [MainThread]: On master: BEGIN
[0m19:06:12.370153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:12.556997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:12.558529 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:12.559778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:12.580954 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:06:12.585044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e062e6a0>]}
[0m19:06:12.586535 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:12.603304 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:12.604321 [debug] [MainThread]: On master: BEGIN
[0m19:06:12.642225 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:12.644265 [debug] [MainThread]: On master: COMMIT
[0m19:06:12.645717 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:12.646417 [debug] [MainThread]: On master: COMMIT
[0m19:06:12.660324 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:12.661845 [debug] [MainThread]: On master: Close
[0m19:06:12.664999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:12.666144 [info ] [MainThread]: 
[0m19:06:12.673536 [debug] [Thread-1  ]: Began running node snapshot.bde.code_snapshot
[0m19:06:12.674565 [debug] [Thread-2  ]: Began running node snapshot.bde.host_snapshot
[0m19:06:12.675581 [debug] [Thread-3  ]: Began running node snapshot.bde.listing_snapshot
[0m19:06:12.677025 [info ] [Thread-1  ]: 1 of 5 START snapshot at3.code_snapshot ........................................ [RUN]
[0m19:06:12.678008 [debug] [Thread-4  ]: Began running node snapshot.bde.property_snapshot
[0m19:06:12.679049 [info ] [Thread-2  ]: 2 of 5 START snapshot at3.host_snapshot ........................................ [RUN]
[0m19:06:12.680161 [info ] [Thread-3  ]: 3 of 5 START snapshot at3.listing_snapshot ..................................... [RUN]
[0m19:06:12.681740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.code_snapshot)
[0m19:06:12.682710 [info ] [Thread-4  ]: 4 of 5 START snapshot at3.property_snapshot .................................... [RUN]
[0m19:06:12.684031 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m19:06:12.685263 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m19:06:12.686020 [debug] [Thread-1  ]: Began compiling node snapshot.bde.code_snapshot
[0m19:06:12.687212 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m19:06:12.687909 [debug] [Thread-2  ]: Began compiling node snapshot.bde.host_snapshot
[0m19:06:12.688572 [debug] [Thread-3  ]: Began compiling node snapshot.bde.listing_snapshot
[0m19:06:12.702689 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (compile): 19:06:12.689088 => 19:06:12.702321
[0m19:06:12.703279 [debug] [Thread-4  ]: Began compiling node snapshot.bde.property_snapshot
[0m19:06:12.707926 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (compile): 19:06:12.703670 => 19:06:12.707554
[0m19:06:12.712885 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (compile): 19:06:12.708472 => 19:06:12.712533
[0m19:06:12.713545 [debug] [Thread-1  ]: Began executing node snapshot.bde.code_snapshot
[0m19:06:12.717361 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (compile): 19:06:12.713951 => 19:06:12.717113
[0m19:06:12.717856 [debug] [Thread-2  ]: Began executing node snapshot.bde.host_snapshot
[0m19:06:12.718370 [debug] [Thread-3  ]: Began executing node snapshot.bde.listing_snapshot
[0m19:06:12.744079 [debug] [Thread-4  ]: Began executing node snapshot.bde.property_snapshot
[0m19:06:12.808949 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.code_snapshot"
[0m19:06:12.810216 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m19:06:12.812602 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m19:06:12.814865 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m19:06:12.815547 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m19:06:12.815957 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:06:12.816381 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: BEGIN
[0m19:06:12.816710 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m19:06:12.817022 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: BEGIN
[0m19:06:12.817315 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:06:12.817611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:06:12.817895 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m19:06:12.818174 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:06:12.818447 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: BEGIN
[0m19:06:12.818833 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:06:12.819216 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:06:12.991563 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:06:12.992334 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:06:12.992897 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."at3"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id,
        host_since as dbt_updated_at,
        host_since as dbt_valid_from,
        nullif(host_since, host_since) as dbt_valid_to
    from (
        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"

    ) sbq



  );
  
  
[0m19:06:12.997994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:06:12.998550 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:06:12.999084 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m19:06:12.999621 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:06:13.000197 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      
  
    

  create  table "postgres"."at3"."code_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



select * from "postgres"."at3"."nsw_lga_code"

    ) sbq



  );
  
  
[0m19:06:13.000775 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:06:13.001320 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      
  
    

  create  table "postgres"."at3"."property_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select id, scraped_date, property_type, room_type from "postgres"."at3"."listings"

    ) sbq



  );
  
  
[0m19:06:13.001957 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m19:06:13.002604 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      
  
    

  create  table "postgres"."at3"."listing_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select id,listing_id,scrape_id,scraped_date,listing_neighbourhood,accommodates,price,has_availability, availability_30, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"

    ) sbq



  );
  
  
[0m19:06:13.023212 [debug] [Thread-1  ]: SQL status: SELECT 129 in 0.0 seconds
[0m19:06:13.045632 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: COMMIT
[0m19:06:13.046098 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m19:06:13.046495 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: COMMIT
[0m19:06:13.072182 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:06:13.073219 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (execute): 19:06:12.718726 => 19:06:13.072995
[0m19:06:13.073701 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: Close
[0m19:06:13.074672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e069a040>]}
[0m19:06:13.075842 [info ] [Thread-1  ]: 1 of 5 OK snapshotted at3.code_snapshot ........................................ [[32mSELECT 129[0m in 0.39s]
[0m19:06:13.076576 [debug] [Thread-1  ]: Finished running node snapshot.bde.code_snapshot
[0m19:06:13.077083 [debug] [Thread-1  ]: Began running node snapshot.bde.suburb_snapshot
[0m19:06:13.077661 [info ] [Thread-1  ]: 5 of 5 START snapshot at3.suburb_snapshot ...................................... [RUN]
[0m19:06:13.078438 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.bde.code_snapshot, now snapshot.bde.suburb_snapshot)
[0m19:06:13.078899 [debug] [Thread-1  ]: Began compiling node snapshot.bde.suburb_snapshot
[0m19:06:13.082889 [debug] [Thread-1  ]: Timing info for snapshot.bde.suburb_snapshot (compile): 19:06:13.079216 => 19:06:13.082658
[0m19:06:13.083341 [debug] [Thread-1  ]: Began executing node snapshot.bde.suburb_snapshot
[0m19:06:13.086917 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.suburb_snapshot"
[0m19:06:13.088448 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m19:06:13.088871 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: BEGIN
[0m19:06:13.089258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:06:13.273980 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:06:13.275203 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m19:06:13.276021 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      
  
    

  create  table "postgres"."at3"."suburb_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        



select * from "postgres"."at3"."nsw_lga_suburb"

    ) sbq



  );
  
  
[0m19:06:13.336920 [debug] [Thread-1  ]: SQL status: SELECT 4470 in 0.0 seconds
[0m19:06:13.344918 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: COMMIT
[0m19:06:13.345992 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m19:06:13.346793 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: COMMIT
[0m19:06:13.404368 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:06:13.409441 [debug] [Thread-1  ]: Timing info for snapshot.bde.suburb_snapshot (execute): 19:06:13.083647 => 19:06:13.408524
[0m19:06:13.411357 [debug] [Thread-1  ]: On snapshot.bde.suburb_snapshot: Close
[0m19:06:13.413991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e0685100>]}
[0m19:06:13.415518 [info ] [Thread-1  ]: 5 of 5 OK snapshotted at3.suburb_snapshot ...................................... [[32mSELECT 4470[0m in 0.34s]
[0m19:06:13.416670 [debug] [Thread-1  ]: Finished running node snapshot.bde.suburb_snapshot
[0m19:06:15.979179 [debug] [Thread-2  ]: SQL status: SELECT 412122 in 3.0 seconds
[0m19:06:15.990677 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m19:06:15.992654 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:06:15.994444 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m19:06:16.157599 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:06:16.163483 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (execute): 19:06:12.763280 => 19:06:16.162523
[0m19:06:16.165413 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: Close
[0m19:06:16.169368 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d020e5e0>]}
[0m19:06:16.172281 [info ] [Thread-2  ]: 2 of 5 OK snapshotted at3.host_snapshot ........................................ [[32mSELECT 412122[0m in 3.49s]
[0m19:06:16.174243 [debug] [Thread-2  ]: Finished running node snapshot.bde.host_snapshot
[0m19:06:16.230770 [debug] [Thread-4  ]: SQL status: SELECT 412122 in 3.0 seconds
[0m19:06:16.234923 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:06:16.235834 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:06:16.236640 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:06:16.261383 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:06:16.263312 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (execute): 19:06:12.812859 => 19:06:16.262904
[0m19:06:16.264181 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: Close
[0m19:06:16.266073 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e06a8fd0>]}
[0m19:06:16.267693 [info ] [Thread-4  ]: 4 of 5 OK snapshotted at3.property_snapshot .................................... [[32mSELECT 412122[0m in 3.58s]
[0m19:06:16.269024 [debug] [Thread-4  ]: Finished running node snapshot.bde.property_snapshot
[0m19:06:16.716231 [debug] [Thread-3  ]: SQL status: SELECT 412122 in 4.0 seconds
[0m19:06:16.725540 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m19:06:16.726971 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m19:06:16.727807 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m19:06:16.785385 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:06:16.789978 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (execute): 19:06:12.810497 => 19:06:16.789390
[0m19:06:16.791103 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: Close
[0m19:06:16.793665 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3189da54-dd00-4972-a3d4-8216d0ff329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f2548280>]}
[0m19:06:16.795835 [info ] [Thread-3  ]: 3 of 5 OK snapshotted at3.listing_snapshot ..................................... [[32mSELECT 412122[0m in 4.11s]
[0m19:06:16.797200 [debug] [Thread-3  ]: Finished running node snapshot.bde.listing_snapshot
[0m19:06:16.801257 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:16.802031 [debug] [MainThread]: On master: BEGIN
[0m19:06:16.802705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:16.976742 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:16.978892 [debug] [MainThread]: On master: COMMIT
[0m19:06:16.980141 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:16.981073 [debug] [MainThread]: On master: COMMIT
[0m19:06:16.994968 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:16.996104 [debug] [MainThread]: On master: Close
[0m19:06:16.998249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:16.999264 [debug] [MainThread]: Connection 'snapshot.bde.suburb_snapshot' was properly closed.
[0m19:06:16.999973 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m19:06:17.000592 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m19:06:17.001201 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m19:06:17.001972 [info ] [MainThread]: 
[0m19:06:17.002834 [info ] [MainThread]: Finished running 5 snapshots in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m19:06:17.005629 [debug] [MainThread]: Command end result
[0m19:06:17.019549 [info ] [MainThread]: 
[0m19:06:17.020304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:17.020842 [info ] [MainThread]: 
[0m19:06:17.021390 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:06:17.022359 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:06:17.022196 after 5.73 seconds
[0m19:06:17.022997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f0c916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f34c12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e062e7c0>]}
[0m19:06:17.023598 [debug] [MainThread]: Flushing usage events
[0m23:23:51.867982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3380816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35ae61820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35ae61910>]}


============================== 23:23:51.872335 | d887ea47-43e6-42e8-bca2-60df3a13d7e4 ==============================
[0m23:23:51.872335 [info ] [MainThread]: Running with dbt=1.6.6
[0m23:23:51.873016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:23:52.015485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35ae61850>]}
[0m23:23:52.026254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35af56280>]}
[0m23:23:52.026799 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m23:23:52.043742 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m23:23:52.074753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m23:23:52.075302 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/code_stg.sql
[0m23:23:52.075589 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m23:23:52.075855 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m23:23:52.076112 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/host_stg.sql
[0m23:23:52.076367 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/listings_stg.sql
[0m23:23:52.076621 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/all_listings_stg.sql
[0m23:23:52.118752 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m23:23:52.123041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe348a3f0d0>]}
[0m23:23:52.137781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35b103d00>]}
[0m23:23:52.138240 [info ] [MainThread]: Found 5 snapshots, 6 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m23:23:52.138542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35b163e50>]}
[0m23:23:52.140070 [info ] [MainThread]: 
[0m23:23:52.140666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:52.141643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:23:52.149595 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:23:52.150031 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:23:52.150327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:52.899506 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m23:23:52.906179 [debug] [ThreadPool]: On list_postgres: Close
[0m23:23:52.910071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_staging)
[0m23:23:52.912219 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "staging"
"
[0m23:23:52.923455 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m23:23:52.924146 [debug] [ThreadPool]: On create_postgres_staging: BEGIN
[0m23:23:52.924716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:53.419601 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:23:53.422393 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m23:23:53.423612 [debug] [ThreadPool]: On create_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_staging"} */
create schema if not exists "staging"
[0m23:23:53.473364 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:23:53.478229 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m23:23:53.479225 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m23:23:53.479957 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m23:23:53.519138 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:23:53.521969 [debug] [ThreadPool]: On create_postgres_staging: Close
[0m23:23:53.529496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_staging, now list_postgres_staging)
[0m23:23:53.531349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m23:23:53.544172 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:23:53.547668 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:23:53.548358 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m23:23:53.548948 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m23:23:53.549502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:53.550038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:53.946233 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:23:53.948469 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:23:53.950182 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:23:53.951246 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:23:53.952308 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m23:23:53.953808 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:23:54.002713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:23:54.004639 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:23:54.009043 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m23:23:54.012790 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m23:23:54.060008 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m23:23:54.061012 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m23:23:54.078861 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:54.079719 [debug] [MainThread]: On master: BEGIN
[0m23:23:54.080403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:54.510294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:23:54.511183 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:54.512178 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:23:54.564035 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:23:54.565785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35b1030a0>]}
[0m23:23:54.566440 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:54.607075 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:54.607709 [debug] [MainThread]: On master: BEGIN
[0m23:23:54.700497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:23:54.702590 [debug] [MainThread]: On master: COMMIT
[0m23:23:54.704084 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:54.705114 [debug] [MainThread]: On master: COMMIT
[0m23:23:54.755402 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:23:54.757263 [debug] [MainThread]: On master: Close
[0m23:23:54.760611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:54.761815 [info ] [MainThread]: 
[0m23:23:54.769625 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m23:23:54.770721 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m23:23:54.771754 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m23:23:54.775546 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.all_listings_stg ........................... [RUN]
[0m23:23:54.776580 [debug] [Thread-4  ]: Began running node model.bde.listings_stg
[0m23:23:54.777579 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.code_stg ................................... [RUN]
[0m23:23:54.778553 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.host_stg ................................... [RUN]
[0m23:23:54.779800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.all_listings_stg)
[0m23:23:54.780667 [info ] [Thread-4  ]: 4 of 6 START sql view model staging.listings_stg ............................... [RUN]
[0m23:23:54.781825 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m23:23:54.783006 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m23:23:54.783741 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m23:23:54.785097 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.listings_stg'
[0m23:23:54.785833 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m23:23:54.786508 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m23:23:54.800066 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m23:23:54.800802 [debug] [Thread-4  ]: Began compiling node model.bde.listings_stg
[0m23:23:54.804947 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m23:23:54.808692 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m23:23:54.812370 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m23:23:54.813857 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 23:23:54.805443 => 23:23:54.813552
[0m23:23:54.814489 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 23:23:54.801218 => 23:23:54.814202
[0m23:23:54.815000 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m23:23:54.815526 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m23:23:54.816079 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 23:23:54.787093 => 23:23:54.815860
[0m23:23:54.816635 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (compile): 23:23:54.809288 => 23:23:54.816406
[0m23:23:54.853251 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m23:23:54.855109 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m23:23:54.855476 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m23:23:54.855779 [debug] [Thread-4  ]: Began executing node model.bde.listings_stg
[0m23:23:54.859373 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m23:23:54.862228 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m23:23:54.862851 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:23:54.863171 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:23:54.863465 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:23:54.863754 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:23:54.864058 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m23:23:54.864344 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m23:23:54.864626 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m23:23:54.864906 [debug] [Thread-4  ]: On model.bde.listings_stg: BEGIN
[0m23:23:54.865182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:54.865445 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:23:54.865705 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:23:54.865958 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:23:55.306264 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:23:55.308072 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:23:55.309058 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:23:55.309930 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:23:55.311220 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:23:55.312639 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:23:55.313538 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:23:55.314447 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:23:55.315434 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m23:23:55.316444 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)
  );
[0m23:23:55.317453 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 
FROM at3.listings;



select * from to_date_format
  );
[0m23:23:55.318460 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m23:23:55.372354 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:   );
           ^

[0m23:23:55.374381 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 44: FROM at3.listings;
         ^

[0m23:23:55.375592 [debug] [Thread-3  ]: On model.bde.host_stg: ROLLBACK
[0m23:23:55.376515 [debug] [Thread-1  ]: On model.bde.all_listings_stg: ROLLBACK
[0m23:23:55.379010 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:23:55.379837 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:23:55.395100 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:23:55.400364 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:23:55.401119 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m23:23:55.401861 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m23:23:55.425891 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 23:23:54.856112 => 23:23:55.425378
[0m23:23:55.426848 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 23:23:54.816934 => 23:23:55.426501
[0m23:23:55.427573 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m23:23:55.428161 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m23:23:55.436516 [debug] [Thread-3  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near ")"
  LINE 32:   );
             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m23:23:55.437451 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35af7fa90>]}
[0m23:23:55.438526 [debug] [Thread-1  ]: Database Error in model all_listings_stg (models/staging/all_listings_stg.sql)
  syntax error at or near "FROM"
  LINE 44: FROM at3.listings;
           ^
  compiled Code at target/run/bde/models/staging/all_listings_stg.sql
[0m23:23:55.439687 [error] [Thread-3  ]: 3 of 6 ERROR creating sql view model staging.host_stg .......................... [[31mERROR[0m in 0.65s]
[0m23:23:55.440383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35afa8400>]}
[0m23:23:55.441193 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m23:23:55.441885 [error] [Thread-1  ]: 1 of 6 ERROR creating sql view model staging.all_listings_stg .................. [[31mERROR[0m in 0.66s]
[0m23:23:55.442482 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m23:23:55.443231 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m23:23:55.443761 [info ] [Thread-3  ]: 5 of 6 START sql view model staging.property_stg ............................... [RUN]
[0m23:23:55.444345 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m23:23:55.445176 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m23:23:55.445802 [info ] [Thread-1  ]: 6 of 6 START sql view model staging.suburb_stg ................................. [RUN]
[0m23:23:55.446381 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m23:23:55.447248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.all_listings_stg, now model.bde.suburb_stg)
[0m23:23:55.451279 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m23:23:55.451782 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:23:55.452245 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m23:23:55.459057 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:23:55.467599 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:23:55.470813 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m23:23:55.471412 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 23:23:55.447649 => 23:23:55.471196
[0m23:23:55.472784 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:23:55.473177 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:23:55.473597 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m23:23:55.473967 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:23:55.474317 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:23:55.474717 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 23:23:55.468051 => 23:23:55.474533
[0m23:23:55.478014 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m23:23:55.478354 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:23:55.478718 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m23:23:55.483360 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m23:23:55.483921 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:23:55.484266 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m23:23:55.484598 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:23:55.484911 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:23:55.485203 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m23:23:55.485586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:55.528302 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:23:55.565364 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:23:55.571063 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:23:55.573026 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:23:55.573350 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m23:23:55.573649 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m23:23:55.622342 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:23:55.623941 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 23:23:54.848322 => 23:23:55.623741
[0m23:23:55.624361 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m23:23:55.625208 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3383262b0>]}
[0m23:23:55.625668 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:23:55.627055 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (execute): 23:23:54.859674 => 23:23:55.626870
[0m23:23:55.628027 [debug] [Thread-4  ]: On model.bde.listings_stg: Close
[0m23:23:55.627671 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.84s]
[0m23:23:55.628870 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe348a26c70>]}
[0m23:23:55.629466 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m23:23:55.630115 [info ] [Thread-4  ]: 4 of 6 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.84s]
[0m23:23:55.630824 [debug] [Thread-4  ]: Finished running node model.bde.listings_stg
[0m23:23:55.929008 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:23:55.931769 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:23:55.933426 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:23:55.934539 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:23:55.935684 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m23:23:55.936653 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m23:23:55.977773 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:23:55.980191 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:23:55.990417 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:23:55.996946 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:23:55.997946 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m23:23:55.998816 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m23:23:56.042008 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:23:56.043259 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:23:56.047827 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m23:23:56.051694 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:23:56.052558 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:23:56.053473 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:23:56.054271 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m23:23:56.055028 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:23:56.094074 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:23:56.095484 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:23:56.103316 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:23:56.108821 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:23:56.109724 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m23:23:56.110426 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m23:23:56.162969 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:23:56.164587 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:23:56.170123 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 23:23:55.474958 => 23:23:56.169632
[0m23:23:56.173159 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 23:23:55.479077 => 23:23:56.172776
[0m23:23:56.174027 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m23:23:56.174844 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m23:23:56.176640 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe348a66d90>]}
[0m23:23:56.178209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd887ea47-43e6-42e8-bca2-60df3a13d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33832b0d0>]}
[0m23:23:56.179480 [info ] [Thread-3  ]: 5 of 6 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.73s]
[0m23:23:56.180741 [info ] [Thread-1  ]: 6 of 6 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.73s]
[0m23:23:56.181874 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m23:23:56.182862 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m23:23:56.185352 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:56.185954 [debug] [MainThread]: On master: BEGIN
[0m23:23:56.186494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:56.467053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:23:56.469762 [debug] [MainThread]: On master: COMMIT
[0m23:23:56.471045 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:56.472444 [debug] [MainThread]: On master: COMMIT
[0m23:23:56.505501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:23:56.508515 [debug] [MainThread]: On master: Close
[0m23:23:56.512096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:56.513256 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m23:23:56.514220 [debug] [MainThread]: Connection 'model.bde.code_stg' was properly closed.
[0m23:23:56.515606 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m23:23:56.516544 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m23:23:56.517421 [info ] [MainThread]: 
[0m23:23:56.518242 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m23:23:56.521267 [debug] [MainThread]: Command end result
[0m23:23:56.538027 [info ] [MainThread]: 
[0m23:23:56.538763 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:23:56.539271 [info ] [MainThread]: 
[0m23:23:56.539770 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near ")"
  LINE 32:   );
             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m23:23:56.540267 [info ] [MainThread]: 
[0m23:23:56.540760 [error] [MainThread]:   Database Error in model all_listings_stg (models/staging/all_listings_stg.sql)
  syntax error at or near "FROM"
  LINE 44: FROM at3.listings;
           ^
  compiled Code at target/run/bde/models/staging/all_listings_stg.sql
[0m23:23:56.541266 [info ] [MainThread]: 
[0m23:23:56.541803 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m23:23:56.542706 [debug] [MainThread]: Command `dbt run` failed at 23:23:56.542563 after 4.71 seconds
[0m23:23:56.543327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3380816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35b163fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35af99a30>]}
[0m23:23:56.543921 [debug] [MainThread]: Flushing usage events
[0m23:29:41.905765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd98ca4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88a698b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88a699a0>]}


============================== 23:29:41.909696 | d0ba76f3-ea66-466d-802e-fa49a1078383 ==============================
[0m23:29:41.909696 [info ] [MainThread]: Running with dbt=1.6.6
[0m23:29:41.910367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:42.053070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88a69940>]}
[0m23:29:42.063834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9aef02e0>]}
[0m23:29:42.064412 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m23:29:42.087936 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m23:29:42.118131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:29:42.118740 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/all_listings_stg.sql
[0m23:29:42.119081 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m23:29:42.152579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m23:29:42.156784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd800f60d0>]}
[0m23:29:42.170234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd78175d90>]}
[0m23:29:42.170684 [info ] [MainThread]: Found 5 snapshots, 6 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m23:29:42.170981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd78175c40>]}
[0m23:29:42.172639 [info ] [MainThread]: 
[0m23:29:42.173293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:42.174466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:29:42.182401 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:29:42.182730 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:29:42.182980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:42.410378 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:29:42.412457 [debug] [ThreadPool]: On list_postgres: Close
[0m23:29:42.415103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m23:29:42.415963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m23:29:42.422313 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:29:42.424601 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:29:42.425016 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m23:29:42.425359 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m23:29:42.425679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:42.426020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:42.605660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:29:42.606564 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:29:42.607460 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:29:42.608191 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:29:42.608902 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m23:29:42.609642 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:29:42.632726 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:29:42.633456 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:29:42.636248 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m23:29:42.638898 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m23:29:42.652046 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m23:29:42.652700 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m23:29:42.667466 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:42.668191 [debug] [MainThread]: On master: BEGIN
[0m23:29:42.668769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:42.857152 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:29:42.859084 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:42.860648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:42.889686 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:29:42.897177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9afc2100>]}
[0m23:29:42.898439 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:42.914066 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:42.915299 [debug] [MainThread]: On master: BEGIN
[0m23:29:42.952674 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:29:42.955292 [debug] [MainThread]: On master: COMMIT
[0m23:29:42.956769 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:42.957885 [debug] [MainThread]: On master: COMMIT
[0m23:29:42.974249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:29:42.975797 [debug] [MainThread]: On master: Close
[0m23:29:42.978872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:42.979983 [info ] [MainThread]: 
[0m23:29:42.987341 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m23:29:42.988406 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m23:29:42.989420 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m23:29:42.990299 [debug] [Thread-4  ]: Began running node model.bde.listings_stg
[0m23:29:42.991363 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.all_listings_stg ........................... [RUN]
[0m23:29:42.992443 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.code_stg ................................... [RUN]
[0m23:29:42.993395 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.host_stg ................................... [RUN]
[0m23:29:42.994308 [info ] [Thread-4  ]: 4 of 6 START sql view model staging.listings_stg ............................... [RUN]
[0m23:29:42.995654 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.all_listings_stg)
[0m23:29:42.996772 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m23:29:42.998031 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m23:29:42.999251 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.listings_stg'
[0m23:29:42.999987 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m23:29:43.000637 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m23:29:43.001267 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m23:29:43.001904 [debug] [Thread-4  ]: Began compiling node model.bde.listings_stg
[0m23:29:43.016624 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m23:29:43.020403 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m23:29:43.024131 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m23:29:43.027573 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m23:29:43.029236 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 23:29:43.002398 => 23:29:43.028938
[0m23:29:43.029795 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 23:29:43.020911 => 23:29:43.029570
[0m23:29:43.030287 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (compile): 23:29:43.024595 => 23:29:43.030089
[0m23:29:43.030822 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 23:29:43.017182 => 23:29:43.030602
[0m23:29:43.031259 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m23:29:43.031712 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m23:29:43.032168 [debug] [Thread-4  ]: Began executing node model.bde.listings_stg
[0m23:29:43.032608 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m23:29:43.073645 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m23:29:43.074801 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m23:29:43.077727 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m23:29:43.081255 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m23:29:43.082126 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:29:43.082464 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:29:43.082761 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:29:43.083036 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:29:43.083297 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m23:29:43.083585 [debug] [Thread-4  ]: On model.bde.listings_stg: BEGIN
[0m23:29:43.083859 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m23:29:43.084129 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m23:29:43.084393 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:29:43.084659 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:29:43.084934 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:29:43.085194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:29:43.248176 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.249123 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:29:43.249845 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m23:29:43.252307 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.252884 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:29:43.253582 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    with
source as (
    select * from "postgres"."at3"."host_snapshot"
),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)
  );
[0m23:29:43.258411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.259063 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.259674 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:29:43.260313 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:29:43.261005 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 




select * from to_date_format
  );
[0m23:29:43.261764 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m23:29:43.274433 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:29:43.282006 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 27:   );
           ^

[0m23:29:43.286034 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:29:43.286624 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:29:43.287133 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:29:43.287596 [debug] [Thread-3  ]: On model.bde.host_stg: ROLLBACK
[0m23:29:43.288133 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m23:29:43.292337 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:29:43.296102 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:29:43.296944 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m23:29:43.297494 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg__dbt_tmp" rename to "all_listings_stg"
[0m23:29:43.310522 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 23:29:43.058046 => 23:29:43.310245
[0m23:29:43.311045 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m23:29:43.315211 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.315765 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.316311 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.319807 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:29:43.336165 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m23:29:43.338847 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:29:43.339338 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m23:29:43.339786 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:29:43.340560 [debug] [Thread-3  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near ")"
  LINE 27:   );
             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m23:29:43.340932 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m23:29:43.341358 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m23:29:43.341814 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b0f6640>]}
[0m23:29:43.342691 [error] [Thread-3  ]: 3 of 6 ERROR creating sql view model staging.host_stg .......................... [[31mERROR[0m in 0.34s]
[0m23:29:43.343255 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m23:29:43.343640 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m23:29:43.344098 [info ] [Thread-3  ]: 5 of 6 START sql view model staging.property_stg ............................... [RUN]
[0m23:29:43.344666 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m23:29:43.344996 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m23:29:43.347494 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m23:29:43.348154 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 23:29:43.345230 => 23:29:43.347988
[0m23:29:43.348482 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m23:29:43.352753 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m23:29:43.353420 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:29:43.353749 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m23:29:43.354047 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:29:43.354908 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.358285 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:29:43.358659 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:29:43.358981 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:29:43.361249 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.361578 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:29:43.362925 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:29:43.398356 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:29:43.403994 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:29:43.406918 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:29:43.408831 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:29:43.409134 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
drop view if exists "postgres"."staging"."all_listings_stg__dbt_backup" cascade
[0m23:29:43.409411 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:29:43.409682 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m23:29:43.425305 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:29:43.426574 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 23:29:43.032942 => 23:29:43.426407
[0m23:29:43.426928 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:29:43.427268 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m23:29:43.427571 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:29:43.429895 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:29:43.431089 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (execute): 23:29:43.075066 => 23:29:43.430936
[0m23:29:43.431711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b0ebf10>]}
[0m23:29:43.432058 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m23:29:43.432403 [debug] [Thread-4  ]: On model.bde.listings_stg: Close
[0m23:29:43.432931 [info ] [Thread-1  ]: 1 of 6 OK created sql view model staging.all_listings_stg ...................... [[32mCREATE VIEW[0m in 0.44s]
[0m23:29:43.433610 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m23:29:43.434009 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m23:29:43.434554 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b1131f0>]}
[0m23:29:43.434986 [info ] [Thread-1  ]: 6 of 6 START sql view model staging.suburb_stg ................................. [RUN]
[0m23:29:43.435460 [info ] [Thread-4  ]: 4 of 6 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.44s]
[0m23:29:43.436006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.all_listings_stg, now model.bde.suburb_stg)
[0m23:29:43.436452 [debug] [Thread-4  ]: Finished running node model.bde.listings_stg
[0m23:29:43.436760 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m23:29:43.439222 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m23:29:43.439889 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 23:29:43.437052 => 23:29:43.439730
[0m23:29:43.440203 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m23:29:43.443385 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m23:29:43.443918 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:29:43.444229 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m23:29:43.444516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:29:43.453058 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:29:43.454296 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 23:29:43.077983 => 23:29:43.454139
[0m23:29:43.454648 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m23:29:43.455403 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b05b880>]}
[0m23:29:43.455965 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m23:29:43.456506 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m23:29:43.512762 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.513371 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:29:43.513828 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m23:29:43.532866 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:29:43.536850 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:29:43.537315 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m23:29:43.554408 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.557119 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:29:43.557500 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m23:29:43.575688 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.577347 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:29:43.577764 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:29:43.578137 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:29:43.593567 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:29:43.597817 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:29:43.598245 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m23:29:43.600549 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.600935 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:29:43.601329 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m23:29:43.613351 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:29:43.614916 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 23:29:43.348711 => 23:29:43.614694
[0m23:29:43.615367 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m23:29:43.616317 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b0a8eb0>]}
[0m23:29:43.616993 [info ] [Thread-3  ]: 5 of 6 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m23:29:43.617681 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m23:29:43.618157 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:29:43.622058 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:29:43.622490 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m23:29:43.637094 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.640441 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:29:43.640936 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m23:29:43.658947 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:29:43.661077 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m23:29:43.661539 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:29:43.661958 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m23:29:43.677894 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:29:43.681682 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:29:43.682161 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m23:29:43.698515 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:29:43.700335 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 23:29:43.440429 => 23:29:43.700087
[0m23:29:43.700851 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m23:29:43.701923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ba76f3-ea66-466d-802e-fa49a1078383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a54baf0>]}
[0m23:29:43.702701 [info ] [Thread-1  ]: 6 of 6 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.27s]
[0m23:29:43.703463 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m23:29:43.705132 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:43.705625 [debug] [MainThread]: On master: BEGIN
[0m23:29:43.706042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:43.869935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:29:43.870920 [debug] [MainThread]: On master: COMMIT
[0m23:29:43.871490 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:43.871863 [debug] [MainThread]: On master: COMMIT
[0m23:29:43.888819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:29:43.890154 [debug] [MainThread]: On master: Close
[0m23:29:43.892295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:43.893227 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m23:29:43.893870 [debug] [MainThread]: Connection 'model.bde.code_stg' was properly closed.
[0m23:29:43.894481 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m23:29:43.895058 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m23:29:43.895625 [info ] [MainThread]: 
[0m23:29:43.896181 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m23:29:43.898286 [debug] [MainThread]: Command end result
[0m23:29:43.910275 [info ] [MainThread]: 
[0m23:29:43.910986 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:29:43.911560 [info ] [MainThread]: 
[0m23:29:43.912139 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near ")"
  LINE 27:   );
             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m23:29:43.912655 [info ] [MainThread]: 
[0m23:29:43.913184 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:29:43.914086 [debug] [MainThread]: Command `dbt run` failed at 23:29:43.913945 after 2.04 seconds
[0m23:29:43.914703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd98ca4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9aef02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd88bfff40>]}
[0m23:29:43.915311 [debug] [MainThread]: Flushing usage events
[0m23:30:17.039446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f069cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f28288b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f28289a0>]}


============================== 23:30:17.043327 | 74ba7a76-685a-4f29-b29d-75f6fe889147 ==============================
[0m23:30:17.043327 [info ] [MainThread]: Running with dbt=1.6.6
[0m23:30:17.043954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:30:17.142339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f28288e0>]}
[0m23:30:17.153035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f29502e0>]}
[0m23:30:17.153945 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m23:30:17.170759 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m23:30:17.198871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:30:17.199485 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m23:30:17.230069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m23:30:17.234258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f29dd0d0>]}
[0m23:30:17.247723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e10b38b0>]}
[0m23:30:17.248182 [info ] [MainThread]: Found 5 snapshots, 6 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m23:30:17.248481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e10b3940>]}
[0m23:30:17.249974 [info ] [MainThread]: 
[0m23:30:17.250565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:17.251544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:30:17.259649 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:30:17.260038 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:30:17.260286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:17.486182 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:30:17.489183 [debug] [ThreadPool]: On list_postgres: Close
[0m23:30:17.492381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m23:30:17.493547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m23:30:17.502253 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:30:17.504869 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:30:17.505356 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m23:30:17.505756 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m23:30:17.506111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:17.506476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:17.686619 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:30:17.688367 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:30:17.689930 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:30:17.690771 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:30:17.691558 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:30:17.692379 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m23:30:17.716850 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:30:17.718048 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:30:17.721713 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m23:30:17.724755 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m23:30:17.739343 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m23:30:17.740199 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m23:30:17.755652 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:17.756414 [debug] [MainThread]: On master: BEGIN
[0m23:30:17.756992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:17.942523 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:30:17.944556 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:17.945789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:17.968872 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m23:30:17.977778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f29dd490>]}
[0m23:30:17.978822 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:17.995339 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:17.996049 [debug] [MainThread]: On master: BEGIN
[0m23:30:18.029538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.030929 [debug] [MainThread]: On master: COMMIT
[0m23:30:18.031809 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:18.032668 [debug] [MainThread]: On master: COMMIT
[0m23:30:18.048309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:30:18.050231 [debug] [MainThread]: On master: Close
[0m23:30:18.054342 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:18.055413 [info ] [MainThread]: 
[0m23:30:18.063687 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m23:30:18.064738 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m23:30:18.065731 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m23:30:18.067572 [debug] [Thread-4  ]: Began running node model.bde.listings_stg
[0m23:30:18.066849 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.all_listings_stg ........................... [RUN]
[0m23:30:18.068863 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.code_stg ................................... [RUN]
[0m23:30:18.069907 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.host_stg ................................... [RUN]
[0m23:30:18.070915 [info ] [Thread-4  ]: 4 of 6 START sql view model staging.listings_stg ............................... [RUN]
[0m23:30:18.072275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.all_listings_stg)
[0m23:30:18.073345 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m23:30:18.074498 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m23:30:18.075715 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.listings_stg'
[0m23:30:18.076512 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m23:30:18.077178 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m23:30:18.077800 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m23:30:18.078412 [debug] [Thread-4  ]: Began compiling node model.bde.listings_stg
[0m23:30:18.092272 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m23:30:18.098017 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m23:30:18.101820 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m23:30:18.105440 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m23:30:18.107015 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 23:30:18.078904 => 23:30:18.106688
[0m23:30:18.107568 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 23:30:18.092949 => 23:30:18.107355
[0m23:30:18.108096 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m23:30:18.108654 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 23:30:18.098562 => 23:30:18.108435
[0m23:30:18.109216 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (compile): 23:30:18.102265 => 23:30:18.108957
[0m23:30:18.109683 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m23:30:18.134165 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m23:30:18.143451 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m23:30:18.143842 [debug] [Thread-4  ]: Began executing node model.bde.listings_stg
[0m23:30:18.147036 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m23:30:18.149930 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m23:30:18.153649 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m23:30:18.154180 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:30:18.154541 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:30:18.154909 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m23:30:18.155262 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:18.155552 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m23:30:18.155853 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:18.156136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:18.156419 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m23:30:18.156697 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:18.156984 [debug] [Thread-4  ]: On model.bde.listings_stg: BEGIN
[0m23:30:18.157385 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:30:18.157745 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:30:18.331272 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.332309 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:18.333082 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m23:30:18.336882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.337599 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.338353 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.338981 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:30:18.339593 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:30:18.340151 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:18.340792 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 




select * from to_date_format
  );
[0m23:30:18.341451 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m23:30:18.342108 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    --where host_name <> '' and host_since <> ''
)
  );
[0m23:30:18.352248 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:18.364030 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:18.364651 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:18.365219 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:18.365862 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 32:   );
           ^

[0m23:30:18.366450 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m23:30:18.370808 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:30:18.374922 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:30:18.375505 [debug] [Thread-3  ]: On model.bde.host_stg: ROLLBACK
[0m23:30:18.376088 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m23:30:18.376556 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg" rename to "all_listings_stg__dbt_backup"
[0m23:30:18.390630 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.394382 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:18.394943 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m23:30:18.395688 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.396427 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 23:30:18.147278 => 23:30:18.396162
[0m23:30:18.396930 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.400763 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:30:18.401315 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m23:30:18.404731 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:30:18.405194 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m23:30:18.405712 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg__dbt_tmp" rename to "all_listings_stg"
[0m23:30:18.410503 [debug] [Thread-3  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near ")"
  LINE 32:   );
             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m23:30:18.410959 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.411501 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f2a5e730>]}
[0m23:30:18.428045 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:30:18.428800 [error] [Thread-3  ]: 3 of 6 ERROR creating sql view model staging.host_stg .......................... [[31mERROR[0m in 0.34s]
[0m23:30:18.429189 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.429506 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.429844 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:18.430317 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m23:30:18.431719 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:30:18.433086 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m23:30:18.433424 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:30:18.433792 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m23:30:18.434194 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:30:18.434528 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:30:18.434961 [info ] [Thread-3  ]: 5 of 6 START sql view model staging.property_stg ............................... [RUN]
[0m23:30:18.435303 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:30:18.435597 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m23:30:18.436108 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m23:30:18.436500 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m23:30:18.438993 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m23:30:18.439628 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 23:30:18.436723 => 23:30:18.439471
[0m23:30:18.439936 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m23:30:18.444158 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m23:30:18.444709 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:18.445004 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m23:30:18.445270 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:18.450577 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:18.486266 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:18.486703 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:18.492193 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:18.494194 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:30:18.495985 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:30:18.496282 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m23:30:18.496562 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m23:30:18.496849 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
drop view if exists "postgres"."staging"."all_listings_stg__dbt_backup" cascade
[0m23:30:18.517728 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:18.519136 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 23:30:18.144085 => 23:30:18.518954
[0m23:30:18.519522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:18.519852 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:18.520186 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m23:30:18.521454 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 23:30:18.110009 => 23:30:18.521289
[0m23:30:18.522609 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (execute): 23:30:18.150249 => 23:30:18.522454
[0m23:30:18.522999 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m23:30:18.523370 [debug] [Thread-4  ]: On model.bde.listings_stg: Close
[0m23:30:18.523941 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f1ceaaf0>]}
[0m23:30:18.524553 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m23:30:18.525153 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f2928d30>]}
[0m23:30:18.525771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e1267cd0>]}
[0m23:30:18.526302 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m23:30:18.526793 [info ] [Thread-4  ]: 4 of 6 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.45s]
[0m23:30:18.527305 [info ] [Thread-1  ]: 1 of 6 OK created sql view model staging.all_listings_stg ...................... [[32mCREATE VIEW[0m in 0.45s]
[0m23:30:18.527698 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m23:30:18.528215 [debug] [Thread-4  ]: Finished running node model.bde.listings_stg
[0m23:30:18.528688 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m23:30:18.529067 [info ] [Thread-2  ]: 6 of 6 START sql view model staging.suburb_stg ................................. [RUN]
[0m23:30:18.529735 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.suburb_stg)
[0m23:30:18.530039 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m23:30:18.532568 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m23:30:18.533244 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 23:30:18.530255 => 23:30:18.533090
[0m23:30:18.533570 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m23:30:18.536732 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m23:30:18.537336 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:18.537649 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m23:30:18.537941 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:18.607054 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.607623 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:18.608052 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m23:30:18.627674 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:18.631734 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:18.632220 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m23:30:18.650551 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.654201 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:18.654691 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m23:30:18.668446 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.670530 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:30:18.671034 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:18.671498 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:30:18.688079 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:18.691484 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:18.691999 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m23:30:18.706783 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:18.707332 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:18.707896 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m23:30:18.711243 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:18.713307 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 23:30:18.440150 => 23:30:18.713032
[0m23:30:18.713868 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m23:30:18.714961 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f2a32d90>]}
[0m23:30:18.715718 [info ] [Thread-3  ]: 5 of 6 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:30:18.716470 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m23:30:18.726796 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:18.733547 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:18.734090 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m23:30:18.750415 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.754977 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:18.755665 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m23:30:18.770912 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:18.773222 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m23:30:18.773803 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:18.774276 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m23:30:18.790646 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:18.794605 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:18.795128 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m23:30:18.812570 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:18.814584 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 23:30:18.533790 => 23:30:18.814317
[0m23:30:18.815161 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m23:30:18.816370 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ba7a76-685a-4f29-b29d-75f6fe889147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f2a24f70>]}
[0m23:30:18.817225 [info ] [Thread-2  ]: 6 of 6 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m23:30:18.818099 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m23:30:18.820045 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:18.820557 [debug] [MainThread]: On master: BEGIN
[0m23:30:18.820973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:18.998960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:30:19.001126 [debug] [MainThread]: On master: COMMIT
[0m23:30:19.002008 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:19.002886 [debug] [MainThread]: On master: COMMIT
[0m23:30:19.018408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:30:19.019682 [debug] [MainThread]: On master: Close
[0m23:30:19.022481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:19.023251 [debug] [MainThread]: Connection 'model.bde.all_listings_stg' was properly closed.
[0m23:30:19.023892 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m23:30:19.024734 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m23:30:19.025985 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m23:30:19.026973 [info ] [MainThread]: 
[0m23:30:19.027799 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m23:30:19.030906 [debug] [MainThread]: Command end result
[0m23:30:19.046120 [info ] [MainThread]: 
[0m23:30:19.046945 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:30:19.047522 [info ] [MainThread]: 
[0m23:30:19.048078 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near ")"
  LINE 32:   );
             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m23:30:19.048589 [info ] [MainThread]: 
[0m23:30:19.049115 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:30:19.050009 [debug] [MainThread]: Command `dbt run` failed at 23:30:19.049866 after 2.04 seconds
[0m23:30:19.050621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f069cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f2a38190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e10b3b80>]}
[0m23:30:19.051210 [debug] [MainThread]: Flushing usage events
[0m23:33:05.793425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8b64ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadae298b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadae299a0>]}


============================== 23:33:05.797550 | f7a10c3a-69ef-4f72-8b0c-7663e1fb4299 ==============================
[0m23:33:05.797550 [info ] [MainThread]: Running with dbt=1.6.6
[0m23:33:05.798237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:33:05.932240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadae29880>]}
[0m23:33:05.943158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadaf612e0>]}
[0m23:33:05.957103 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m23:33:05.980815 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m23:33:06.012173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:06.012759 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m23:33:06.043983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
[0m23:33:06.048056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8ae70d0>]}
[0m23:33:06.062110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadb08b8b0>]}
[0m23:33:06.062552 [info ] [MainThread]: Found 5 snapshots, 6 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m23:33:06.062856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadb08b940>]}
[0m23:33:06.064318 [info ] [MainThread]: 
[0m23:33:06.064919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:06.065889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:33:06.073324 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:33:06.073694 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:33:06.073954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:06.287902 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:33:06.290446 [debug] [ThreadPool]: On list_postgres: Close
[0m23:33:06.293216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m23:33:06.294358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m23:33:06.302045 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:33:06.304395 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:33:06.304835 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m23:33:06.305225 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m23:33:06.305586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:06.305959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:06.484267 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:33:06.485585 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m23:33:06.486658 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m23:33:06.489206 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:33:06.489922 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:33:06.490693 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:33:06.505909 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:33:06.509803 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m23:33:06.512569 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:33:06.515553 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m23:33:06.525528 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m23:33:06.531248 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m23:33:06.543605 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:06.544321 [debug] [MainThread]: On master: BEGIN
[0m23:33:06.544904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:06.733244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:33:06.734760 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:06.736019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:33:06.761414 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m23:33:06.772228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8c09280>]}
[0m23:33:06.774111 [debug] [MainThread]: On master: ROLLBACK
[0m23:33:06.789587 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:06.790903 [debug] [MainThread]: On master: BEGIN
[0m23:33:06.826139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:33:06.827800 [debug] [MainThread]: On master: COMMIT
[0m23:33:06.829094 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:06.830148 [debug] [MainThread]: On master: COMMIT
[0m23:33:06.844506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:33:06.846191 [debug] [MainThread]: On master: Close
[0m23:33:06.850414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:06.851413 [info ] [MainThread]: 
[0m23:33:06.858769 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m23:33:06.859844 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m23:33:06.860863 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m23:33:06.861729 [debug] [Thread-4  ]: Began running node model.bde.listings_stg
[0m23:33:06.862748 [info ] [Thread-1  ]: 1 of 6 START sql view model staging.all_listings_stg ........................... [RUN]
[0m23:33:06.863834 [info ] [Thread-2  ]: 2 of 6 START sql view model staging.code_stg ................................... [RUN]
[0m23:33:06.864792 [info ] [Thread-3  ]: 3 of 6 START sql view model staging.host_stg ................................... [RUN]
[0m23:33:06.865689 [info ] [Thread-4  ]: 4 of 6 START sql view model staging.listings_stg ............................... [RUN]
[0m23:33:06.866953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.all_listings_stg)
[0m23:33:06.868022 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m23:33:06.869244 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m23:33:06.870448 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.listings_stg'
[0m23:33:06.871195 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m23:33:06.871846 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m23:33:06.872480 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m23:33:06.873101 [debug] [Thread-4  ]: Began compiling node model.bde.listings_stg
[0m23:33:06.886575 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m23:33:06.892000 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m23:33:06.896278 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m23:33:06.899686 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m23:33:06.901153 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 23:33:06.887085 => 23:33:06.900830
[0m23:33:06.901757 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 23:33:06.892708 => 23:33:06.901503
[0m23:33:06.902282 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 23:33:06.873601 => 23:33:06.902073
[0m23:33:06.902767 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (compile): 23:33:06.896689 => 23:33:06.902570
[0m23:33:06.903191 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m23:33:06.903654 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m23:33:06.904119 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m23:33:06.904635 [debug] [Thread-4  ]: Began executing node model.bde.listings_stg
[0m23:33:06.945594 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m23:33:06.946562 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m23:33:06.949634 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m23:33:06.953148 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m23:33:06.953946 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:33:06.954317 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:33:06.954611 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m23:33:06.954875 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:33:06.955135 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:33:06.955413 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m23:33:06.955710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:33:06.956006 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m23:33:06.956282 [debug] [Thread-4  ]: On model.bde.listings_stg: BEGIN
[0m23:33:06.956545 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:33:06.956906 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:33:06.957198 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:33:07.136323 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.136997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.137536 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.138108 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:33:07.138618 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:33:07.139146 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:33:07.139743 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m23:33:07.140357 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 




select * from to_date_format
  );
[0m23:33:07.140971 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.141607 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m23:33:07.142364 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:33:07.143004 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m23:33:07.165501 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:33:07.166024 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:33:07.172993 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:33:07.176061 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:33:07.176677 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:33:07.180515 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:33:07.183805 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:33:07.184316 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m23:33:07.187827 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:33:07.188417 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg" rename to "all_listings_stg__dbt_backup"
[0m23:33:07.189012 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m23:33:07.189540 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m23:33:07.203574 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.207120 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:33:07.207602 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m23:33:07.208027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.208396 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.208788 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.211861 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:33:07.214765 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:33:07.227790 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.228996 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m23:33:07.229341 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg__dbt_tmp" rename to "all_listings_stg"
[0m23:33:07.229698 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m23:33:07.232532 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:33:07.232874 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:33:07.233316 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:33:07.233660 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m23:33:07.233968 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m23:33:07.247908 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.248287 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.249765 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m23:33:07.251186 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:33:07.251560 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:33:07.251895 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:33:07.252218 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m23:33:07.252528 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m23:33:07.253107 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.253446 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.293182 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.293606 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.298294 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:33:07.300294 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m23:33:07.302232 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m23:33:07.304223 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m23:33:07.304592 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m23:33:07.304902 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m23:33:07.305186 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m23:33:07.305463 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
drop view if exists "postgres"."staging"."all_listings_stg__dbt_backup" cascade
[0m23:33:07.319429 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:33:07.320819 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 23:33:06.930151 => 23:33:07.320645
[0m23:33:07.321161 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:33:07.321522 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:33:07.321874 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m23:33:07.322178 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:33:07.323406 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 23:33:06.905045 => 23:33:07.323233
[0m23:33:07.324586 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (execute): 23:33:06.949909 => 23:33:07.324437
[0m23:33:07.325851 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 23:33:06.946836 => 23:33:07.325683
[0m23:33:07.326480 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8b06c70>]}
[0m23:33:07.326864 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m23:33:07.327185 [debug] [Thread-4  ]: On model.bde.listings_stg: Close
[0m23:33:07.327494 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m23:33:07.328175 [info ] [Thread-3  ]: 3 of 6 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m23:33:07.328925 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa81a5eb0>]}
[0m23:33:07.329399 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m23:33:07.329920 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8c1cb50>]}
[0m23:33:07.330440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8b2a070>]}
[0m23:33:07.330905 [info ] [Thread-4  ]: 4 of 6 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.46s]
[0m23:33:07.331332 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m23:33:07.331783 [info ] [Thread-2  ]: 2 of 6 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m23:33:07.332325 [info ] [Thread-1  ]: 1 of 6 OK created sql view model staging.all_listings_stg ...................... [[32mCREATE VIEW[0m in 0.46s]
[0m23:33:07.332777 [debug] [Thread-4  ]: Finished running node model.bde.listings_stg
[0m23:33:07.333136 [info ] [Thread-3  ]: 5 of 6 START sql view model staging.property_stg ............................... [RUN]
[0m23:33:07.333634 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m23:33:07.334077 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m23:33:07.334422 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m23:33:07.334981 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m23:33:07.335567 [info ] [Thread-4  ]: 6 of 6 START sql view model staging.suburb_stg ................................. [RUN]
[0m23:33:07.335961 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m23:33:07.336546 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.suburb_stg)
[0m23:33:07.339726 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m23:33:07.340199 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m23:33:07.342611 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m23:33:07.343404 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 23:33:07.336827 => 23:33:07.343209
[0m23:33:07.343721 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m23:33:07.344087 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 23:33:07.340509 => 23:33:07.343932
[0m23:33:07.347153 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m23:33:07.347514 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m23:33:07.350553 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m23:33:07.351116 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:33:07.351446 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m23:33:07.351735 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:33:07.352022 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:33:07.352305 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m23:33:07.352687 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:33:07.527846 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.528534 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.529163 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:33:07.529681 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:33:07.530220 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m23:33:07.530797 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m23:33:07.549788 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:33:07.550359 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:33:07.556614 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:33:07.560907 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:33:07.561412 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m23:33:07.561868 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m23:33:07.579185 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.579696 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.583467 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:33:07.587078 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:33:07.587616 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m23:33:07.588119 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m23:33:07.608802 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.609372 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:33:07.611996 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:33:07.614440 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m23:33:07.614985 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:33:07.615484 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:33:07.615969 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m23:33:07.616431 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m23:33:07.632831 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.633423 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.637595 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m23:33:07.641307 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:33:07.641844 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m23:33:07.642379 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m23:33:07.658766 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:33:07.660806 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 23:33:07.344285 => 23:33:07.660524
[0m23:33:07.661441 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m23:33:07.662823 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8c4e730>]}
[0m23:33:07.664191 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:33:07.663742 [info ] [Thread-3  ]: 5 of 6 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.33s]
[0m23:33:07.666056 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 23:33:07.347802 => 23:33:07.665822
[0m23:33:07.666841 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m23:33:07.667351 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m23:33:07.668552 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7a10c3a-69ef-4f72-8b0c-7663e1fb4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8b2a070>]}
[0m23:33:07.669273 [info ] [Thread-4  ]: 6 of 6 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.33s]
[0m23:33:07.670037 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m23:33:07.671766 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:07.672213 [debug] [MainThread]: On master: BEGIN
[0m23:33:07.672609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:07.844196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:33:07.844873 [debug] [MainThread]: On master: COMMIT
[0m23:33:07.845412 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:07.845863 [debug] [MainThread]: On master: COMMIT
[0m23:33:07.862402 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:33:07.863165 [debug] [MainThread]: On master: Close
[0m23:33:07.864682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:07.865565 [debug] [MainThread]: Connection 'model.bde.all_listings_stg' was properly closed.
[0m23:33:07.866197 [debug] [MainThread]: Connection 'model.bde.code_stg' was properly closed.
[0m23:33:07.866793 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m23:33:07.867386 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m23:33:07.868161 [info ] [MainThread]: 
[0m23:33:07.868773 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m23:33:07.870743 [debug] [MainThread]: Command end result
[0m23:33:07.883027 [info ] [MainThread]: 
[0m23:33:07.883795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:07.884369 [info ] [MainThread]: 
[0m23:33:07.884901 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:33:07.885811 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:07.885652 after 2.12 seconds
[0m23:33:07.886413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8b64ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac8c489d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadaee6f70>]}
[0m23:33:07.887011 [debug] [MainThread]: Flushing usage events
[0m13:29:48.106663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe520bc96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe523191820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe523191910>]}


============================== 13:29:48.111156 | e2cdd4b0-c809-49e3-b489-794f5f2f5ff4 ==============================
[0m13:29:48.111156 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:29:48.111782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:48.266714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2cdd4b0-c809-49e3-b489-794f5f2f5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5231918b0>]}
[0m13:29:48.277514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2cdd4b0-c809-49e3-b489-794f5f2f5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5232c7250>]}
[0m13:29:48.278052 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:29:48.306086 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:29:48.340426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 0 files changed.
[0m13:29:48.340978 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_code.sql
[0m13:29:48.341272 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m13:29:48.341544 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m13:29:48.341819 [debug] [MainThread]: Partial parsing: added file: bde://snapshots/fact_snapshot.sql
[0m13:29:48.342083 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m13:29:48.342347 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m13:29:48.342601 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m13:29:48.402289 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.fact_census_G01' (models/warehouse/fact_census_G01.sql) depends on a source named 'raw.census_g01_nsw_lga' which was not found
[0m13:29:48.403254 [debug] [MainThread]: Command `dbt snapshot` failed at 13:29:48.402952 after 0.33 seconds
[0m13:29:48.403651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe520bc96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe523304340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe523304370>]}
[0m13:29:48.404025 [debug] [MainThread]: Flushing usage events
[0m13:32:35.210210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe628b496a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62adc8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62adc8940>]}


============================== 13:32:35.214231 | f3b9611a-f3ff-4c13-8308-4ccb1085c0f0 ==============================
[0m13:32:35.214231 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:32:35.214905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:32:35.367522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b9611a-f3ff-4c13-8308-4ccb1085c0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62adc88e0>]}
[0m13:32:35.378426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3b9611a-f3ff-4c13-8308-4ccb1085c0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e801f280>]}
[0m13:32:35.378979 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:32:35.396545 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:32:35.426730 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 1 files added, 0 files changed.
[0m13:32:35.427270 [debug] [MainThread]: Partial parsing: added file: bde://snapshots/fact_snapshot.sql
[0m13:32:35.427546 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/all_listings_stg.sql
[0m13:32:35.427791 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/property_stg.sql
[0m13:32:35.428026 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/suburb_stg.sql
[0m13:32:35.428252 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/code_stg.sql
[0m13:32:35.428477 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/host_stg.sql
[0m13:32:35.428705 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/listings_stg.sql
[0m13:32:35.461477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.warehouse
- models.bde.datamart
[0m13:32:35.465504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3b9611a-f3ff-4c13-8308-4ccb1085c0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6082280d0>]}
[0m13:32:35.479697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3b9611a-f3ff-4c13-8308-4ccb1085c0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6081ba490>]}
[0m13:32:35.480139 [info ] [MainThread]: Found 6 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:32:35.480439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3b9611a-f3ff-4c13-8308-4ccb1085c0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6081dfe50>]}
[0m13:32:35.481883 [info ] [MainThread]: 
[0m13:32:35.482508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:35.483624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:32:35.491835 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:32:35.492201 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:32:35.492451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:45.499905 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "34.116.121.126", port 5432 failed: timeout expired

[0m13:32:55.508297 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:32:55.512170 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:32:55.514661 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:32:55.515918 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:32:55.517328 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m13:32:55.521849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:55.522932 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:32:55.525031 [info ] [MainThread]: 
[0m13:32:55.526117 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.04 seconds (20.04s).
[0m13:32:55.527498 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "34.116.121.126", port 5432 failed: timeout expired
  
[0m13:32:55.529254 [debug] [MainThread]: Command `dbt snapshot` failed at 13:32:55.528997 after 20.35 seconds
[0m13:32:55.530127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe628b496a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6081dfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe62b07bee0>]}
[0m13:32:55.530967 [debug] [MainThread]: Flushing usage events
[0m13:37:08.565538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78c04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae585588b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae585589a0>]}


============================== 13:37:08.569755 | 40692a45-ae37-49c8-96c9-5fb5b2a1d7a1 ==============================
[0m13:37:08.569755 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:37:08.570416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:08.710272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40692a45-ae37-49c8-96c9-5fb5b2a1d7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae58558940>]}
[0m13:37:08.721029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40692a45-ae37-49c8-96c9-5fb5b2a1d7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7b45f2e0>]}
[0m13:37:08.721578 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:37:08.739150 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:37:08.770177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:08.770640 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:08.771324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m13:37:08.776025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40692a45-ae37-49c8-96c9-5fb5b2a1d7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae681340d0>]}
[0m13:37:08.790813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40692a45-ae37-49c8-96c9-5fb5b2a1d7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5873e9a0>]}
[0m13:37:08.791281 [info ] [MainThread]: Found 6 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:37:08.791572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40692a45-ae37-49c8-96c9-5fb5b2a1d7a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5873ed00>]}
[0m13:37:08.793042 [info ] [MainThread]: 
[0m13:37:08.793644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:08.794708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:37:08.802634 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:37:08.803034 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:37:08.803309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:18.810228 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "34.116.121.126", port 5432 failed: timeout expired

[0m13:37:28.814495 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:37:28.816490 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:37:28.817591 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:37:28.818458 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:37:28.819362 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m13:37:28.822485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:28.823461 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:37:28.825304 [info ] [MainThread]: 
[0m13:37:28.826258 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.03 seconds (20.03s).
[0m13:37:28.827362 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "34.116.121.126", port 5432 failed: timeout expired
  
[0m13:37:28.829011 [debug] [MainThread]: Command `dbt snapshot` failed at 13:37:28.828771 after 20.31 seconds
[0m13:37:28.830009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78c04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5873eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae681343d0>]}
[0m13:37:28.830938 [debug] [MainThread]: Flushing usage events
[0m13:39:50.081292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee08c716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b2f97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b2f98e0>]}


============================== 13:39:50.085250 | 5504eabe-d652-4b71-acb3-7729b2711331 ==============================
[0m13:39:50.085250 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:39:50.085943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:39:50.224406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b2f9880>]}
[0m13:39:50.235308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8508220>]}
[0m13:39:50.235995 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:39:50.253417 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:39:50.282387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:50.282809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:50.283454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.staging
- models.bde.datamart
[0m13:39:50.288468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b5cc0d0>]}
[0m13:39:50.303007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b51d8e0>]}
[0m13:39:50.303538 [info ] [MainThread]: Found 6 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:39:50.303860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b51dc40>]}
[0m13:39:50.305577 [info ] [MainThread]: 
[0m13:39:50.306434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:50.307877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:39:50.315637 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:39:50.315943 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:39:50.316193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:50.845312 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m13:39:50.852035 [debug] [ThreadPool]: On list_postgres: Close
[0m13:39:50.857307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m13:39:50.869573 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:39:50.870263 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m13:39:50.870839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:51.123514 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.126106 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:39:51.127184 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m13:39:51.162994 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:51.170143 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m13:39:51.187842 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m13:39:51.204817 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:51.205595 [debug] [MainThread]: On master: BEGIN
[0m13:39:51.206183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:51.433764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.436189 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:51.438302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:51.475111 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m13:39:51.484929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf851cca0>]}
[0m13:39:51.485960 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:51.508217 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:51.509851 [debug] [MainThread]: On master: BEGIN
[0m13:39:51.558436 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.560306 [debug] [MainThread]: On master: COMMIT
[0m13:39:51.561473 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:51.562798 [debug] [MainThread]: On master: COMMIT
[0m13:39:51.583396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:39:51.584856 [debug] [MainThread]: On master: Close
[0m13:39:51.587298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:51.588713 [info ] [MainThread]: 
[0m13:39:51.595526 [debug] [Thread-1  ]: Began running node snapshot.bde.code_snapshot
[0m13:39:51.596599 [debug] [Thread-2  ]: Began running node snapshot.bde.fact_snapshot
[0m13:39:51.597541 [debug] [Thread-3  ]: Began running node snapshot.bde.host_snapshot
[0m13:39:51.598515 [debug] [Thread-4  ]: Began running node snapshot.bde.listing_snapshot
[0m13:39:51.599588 [info ] [Thread-1  ]: 1 of 6 START snapshot at3.code_snapshot ........................................ [RUN]
[0m13:39:51.600701 [info ] [Thread-2  ]: 2 of 6 START snapshot at3.fact_snapshot ........................................ [RUN]
[0m13:39:51.601796 [info ] [Thread-3  ]: 3 of 6 START snapshot at3.host_snapshot ........................................ [RUN]
[0m13:39:51.602734 [info ] [Thread-4  ]: 4 of 6 START snapshot at3.listing_snapshot ..................................... [RUN]
[0m13:39:51.603985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.code_snapshot)
[0m13:39:51.605217 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.fact_snapshot'
[0m13:39:51.606419 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m13:39:51.607592 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m13:39:51.608360 [debug] [Thread-1  ]: Began compiling node snapshot.bde.code_snapshot
[0m13:39:51.609027 [debug] [Thread-2  ]: Began compiling node snapshot.bde.fact_snapshot
[0m13:39:51.609680 [debug] [Thread-3  ]: Began compiling node snapshot.bde.host_snapshot
[0m13:39:51.610316 [debug] [Thread-4  ]: Began compiling node snapshot.bde.listing_snapshot
[0m13:39:51.624620 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (compile): 13:39:51.610874 => 13:39:51.624159
[0m13:39:51.630553 [debug] [Thread-2  ]: Timing info for snapshot.bde.fact_snapshot (compile): 13:39:51.625169 => 13:39:51.630265
[0m13:39:51.634593 [debug] [Thread-3  ]: Timing info for snapshot.bde.host_snapshot (compile): 13:39:51.630990 => 13:39:51.634356
[0m13:39:51.638515 [debug] [Thread-4  ]: Timing info for snapshot.bde.listing_snapshot (compile): 13:39:51.634961 => 13:39:51.638181
[0m13:39:51.639129 [debug] [Thread-1  ]: Began executing node snapshot.bde.code_snapshot
[0m13:39:51.639575 [debug] [Thread-2  ]: Began executing node snapshot.bde.fact_snapshot
[0m13:39:51.640006 [debug] [Thread-3  ]: Began executing node snapshot.bde.host_snapshot
[0m13:39:51.640443 [debug] [Thread-4  ]: Began executing node snapshot.bde.listing_snapshot
[0m13:39:51.705412 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.fact_snapshot"
[0m13:39:51.705991 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:51.715412 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:51.718809 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:51.719243 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: BEGIN
[0m13:39:51.719546 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m13:39:51.719833 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */
select * from (
        select id, lga_code, lga_name from (
                



select * from "postgres"."at3"."nsw_lga_code"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m13:39:51.720110 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:39:51.720376 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:39:51.720631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:51.721873 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m13:39:51.722160 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: BEGIN
[0m13:39:51.722419 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:39:51.917934 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.918791 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m13:39:51.919473 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      
  
    

  create  table "postgres"."at3"."fact_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select id,listing_id,scrape_id,scraped_date,accommodates,price, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"

    ) sbq



  );
  
  
[0m13:39:51.926405 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.927045 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m13:39:51.927635 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:51.932410 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:51.933120 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:51.933736 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: BEGIN
[0m13:39:51.941866 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.942436 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:51.943007 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:51.951239 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:51.951777 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:51.952343 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:51.985224 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:51.986079 [debug] [Thread-4  ]: SQL status: SELECT 20 in 0.0 seconds
[0m13:39:51.997291 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:51.998081 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:52.023847 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:52.026128 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:52.029305 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:52.030041 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

        
  
    

  create temporary table "listing_snapshot__dbt_tmp133952017494"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,listing_neighbourhood,accommodates,price,has_availability, availability_30, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."listing_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m13:39:52.030821 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp133952028199"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            nullif(host_since, host_since) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            host_since as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.host_since)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.host_since)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m13:39:52.051871 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:52.055136 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.055943 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

        
  
    

  create temporary table "code_snapshot__dbt_tmp133952054122"
  
  
    as
  
  (
    with snapshot_query as (

        



select * from "postgres"."at3"."nsw_lga_code"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."code_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_code" != source_data."lga_code"
        or
        (
            ((snapshotted_data."lga_code" is null) and not (source_data."lga_code" is null))
            or
            ((not snapshotted_data."lga_code" is null) and (source_data."lga_code" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_code" != source_data."lga_code"
        or
        (
            ((snapshotted_data."lga_code" is null) and not (source_data."lga_code" is null))
            or
            ((not snapshotted_data."lga_code" is null) and (source_data."lga_code" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m13:39:52.093886 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m13:39:52.098049 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.098694 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot__dbt_tmp133952054122'
        
      order by ordinal_position

  
[0m13:39:52.127249 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:52.133029 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.133837 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:52.152251 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:52.159905 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.160650 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot__dbt_tmp133952054122'
        
      order by ordinal_position

  
[0m13:39:52.185887 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:52.192601 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.193401 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:52.219907 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:52.228514 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.229109 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot__dbt_tmp133952054122'
        
      order by ordinal_position

  
[0m13:39:52.253932 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:52.261088 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.code_snapshot"
[0m13:39:52.263043 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.263598 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      update "postgres"."at3"."code_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "code_snapshot__dbt_tmp133952054122" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."code_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."code_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."code_snapshot" ("lga_code", "lga_name", "id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."lga_code",DBT_INTERNAL_SOURCE."lga_name",DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "code_snapshot__dbt_tmp133952054122" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:39:52.287719 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:39:52.304353 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: COMMIT
[0m13:39:52.304802 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m13:39:52.305188 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: COMMIT
[0m13:39:52.329508 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:52.332689 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (execute): 13:39:51.640779 => 13:39:52.332467
[0m13:39:52.333182 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: Close
[0m13:39:52.334165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf866bca0>]}
[0m13:39:52.335269 [info ] [Thread-1  ]: 1 of 6 OK snapshotted at3.code_snapshot ........................................ [[32mINSERT 0 0[0m in 0.73s]
[0m13:39:52.335930 [debug] [Thread-1  ]: Finished running node snapshot.bde.code_snapshot
[0m13:39:52.336384 [debug] [Thread-1  ]: Began running node snapshot.bde.property_snapshot
[0m13:39:52.336917 [info ] [Thread-1  ]: 5 of 6 START snapshot at3.property_snapshot .................................... [RUN]
[0m13:39:52.337632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.bde.code_snapshot, now snapshot.bde.property_snapshot)
[0m13:39:52.338036 [debug] [Thread-1  ]: Began compiling node snapshot.bde.property_snapshot
[0m13:39:52.341426 [debug] [Thread-1  ]: Timing info for snapshot.bde.property_snapshot (compile): 13:39:52.338315 => 13:39:52.341200
[0m13:39:52.341862 [debug] [Thread-1  ]: Began executing node snapshot.bde.property_snapshot
[0m13:39:52.346265 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:52.346689 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: BEGIN
[0m13:39:52.347040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:52.572642 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:52.574147 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:52.575336 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:52.623925 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:39:52.632830 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:52.634037 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp133952630894"
  
  
    as
  
  (
    with snapshot_query as (

        



select id, scraped_date, property_type, room_type from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m13:39:55.165730 [debug] [Thread-2  ]: SQL status: SELECT 412122 in 3.0 seconds
[0m13:39:55.179470 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m13:39:55.180239 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m13:39:55.180747 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m13:39:55.215583 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:55.218174 [debug] [Thread-2  ]: Timing info for snapshot.bde.fact_snapshot (execute): 13:39:51.665985 => 13:39:55.217705
[0m13:39:55.219006 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: Close
[0m13:39:55.219934 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf86d5cd0>]}
[0m13:39:55.220609 [info ] [Thread-2  ]: 2 of 6 OK snapshotted at3.fact_snapshot ........................................ [[32mSELECT 412122[0m in 3.62s]
[0m13:39:55.221168 [debug] [Thread-2  ]: Finished running node snapshot.bde.fact_snapshot
[0m13:39:55.221570 [debug] [Thread-2  ]: Began running node snapshot.bde.suburb_snapshot
[0m13:39:55.221965 [info ] [Thread-2  ]: 6 of 6 START snapshot at3.suburb_snapshot ...................................... [RUN]
[0m13:39:55.222638 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly snapshot.bde.fact_snapshot, now snapshot.bde.suburb_snapshot)
[0m13:39:55.223039 [debug] [Thread-2  ]: Began compiling node snapshot.bde.suburb_snapshot
[0m13:39:55.226334 [debug] [Thread-2  ]: Timing info for snapshot.bde.suburb_snapshot (compile): 13:39:55.223310 => 13:39:55.226124
[0m13:39:55.226696 [debug] [Thread-2  ]: Began executing node snapshot.bde.suburb_snapshot
[0m13:39:55.230888 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.231341 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */
select * from (
        select id, lga_name, suburb_name from (
                



select * from "postgres"."at3"."nsw_lga_suburb"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m13:39:55.231670 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:39:55.477591 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.0 seconds
[0m13:39:55.548601 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.549170 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: BEGIN
[0m13:39:55.567626 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:55.568048 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.568477 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:55.618334 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:55.623560 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.624156 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:55.643736 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:55.647551 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.648499 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

        
  
    

  create temporary table "suburb_snapshot__dbt_tmp133955646352"
  
  
    as
  
  (
    with snapshot_query as (

        



select * from "postgres"."at3"."nsw_lga_suburb"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."suburb_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ) or snapshotted_data."suburb_name" != source_data."suburb_name"
        or
        (
            ((snapshotted_data."suburb_name" is null) and not (source_data."suburb_name" is null))
            or
            ((not snapshotted_data."suburb_name" is null) and (source_data."suburb_name" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ) or snapshotted_data."suburb_name" != source_data."suburb_name"
        or
        (
            ((snapshotted_data."suburb_name" is null) and not (source_data."suburb_name" is null))
            or
            ((not snapshotted_data."suburb_name" is null) and (source_data."suburb_name" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m13:39:55.727930 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.0 seconds
[0m13:39:55.735614 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.736543 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot__dbt_tmp133955646352'
        
      order by ordinal_position

  
[0m13:39:55.760917 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:55.768660 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.769606 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:55.794633 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:55.802239 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.803132 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot__dbt_tmp133955646352'
        
      order by ordinal_position

  
[0m13:39:55.828200 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:55.836360 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.837362 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:55.861012 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.0 seconds
[0m13:39:55.868998 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.869955 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot__dbt_tmp133955646352'
        
      order by ordinal_position

  
[0m13:39:55.895046 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:55.901027 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.suburb_snapshot"
[0m13:39:55.904655 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.905613 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      update "postgres"."at3"."suburb_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "suburb_snapshot__dbt_tmp133955646352" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."suburb_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."suburb_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."suburb_snapshot" ("lga_name", "suburb_name", "id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."lga_name",DBT_INTERNAL_SOURCE."suburb_name",DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "suburb_snapshot__dbt_tmp133955646352" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:39:55.928182 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:39:55.932217 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: COMMIT
[0m13:39:55.933074 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m13:39:55.933845 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: COMMIT
[0m13:39:55.953380 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:55.956702 [debug] [Thread-2  ]: Timing info for snapshot.bde.suburb_snapshot (execute): 13:39:55.226932 => 13:39:55.956205
[0m13:39:55.957680 [debug] [Thread-2  ]: On snapshot.bde.suburb_snapshot: Close
[0m13:39:55.960338 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b657e80>]}
[0m13:39:55.962490 [info ] [Thread-2  ]: 6 of 6 OK snapshotted at3.suburb_snapshot ...................................... [[32mINSERT 0 0[0m in 0.74s]
[0m13:39:55.963909 [debug] [Thread-2  ]: Finished running node snapshot.bde.suburb_snapshot
[0m13:39:57.720502 [debug] [Thread-1  ]: SQL status: SELECT 0 in 5.0 seconds
[0m13:39:57.731338 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:57.732519 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp133952630894'
        
      order by ordinal_position

  
[0m13:39:57.782111 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:57.796339 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:57.797419 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:57.845274 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:39:57.855784 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:57.856746 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp133952630894'
        
      order by ordinal_position

  
[0m13:39:57.882422 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:57.908204 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:57.909211 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:57.932231 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:39:57.941967 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:57.942958 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp133952630894'
        
      order by ordinal_position

  
[0m13:39:57.973858 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:57.980428 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m13:39:57.983286 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:57.984283 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."at3"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp133952630894" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."property_snapshot" ("id", "scraped_date", "property_type", "room_type", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp133952630894" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:39:58.015691 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:39:58.020588 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: COMMIT
[0m13:39:58.021693 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m13:39:58.022472 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: COMMIT
[0m13:39:58.040392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:58.043233 [debug] [Thread-1  ]: Timing info for snapshot.bde.property_snapshot (execute): 13:39:52.342150 => 13:39:58.042724
[0m13:39:58.044252 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: Close
[0m13:39:58.046102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8646f70>]}
[0m13:39:58.047730 [info ] [Thread-1  ]: 5 of 6 OK snapshotted at3.property_snapshot .................................... [[32mINSERT 0 0[0m in 5.71s]
[0m13:39:58.049065 [debug] [Thread-1  ]: Finished running node snapshot.bde.property_snapshot
[0m13:39:58.216857 [debug] [Thread-3  ]: SQL status: SELECT 0 in 6.0 seconds
[0m13:39:58.227808 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.229018 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp133952028199'
        
      order by ordinal_position

  
[0m13:39:58.249535 [debug] [Thread-3  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:39:58.258446 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.259386 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:58.282749 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:58.289567 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.290451 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp133952028199'
        
      order by ordinal_position

  
[0m13:39:58.316504 [debug] [Thread-3  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:39:58.325439 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.326445 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:58.357984 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.0 seconds
[0m13:39:58.366630 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.367574 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp133952028199'
        
      order by ordinal_position

  
[0m13:39:58.391403 [debug] [Thread-3  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:39:58.396993 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m13:39:58.398519 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.399523 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."at3"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp133952028199" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."host_snapshot" ("id", "host_id", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp133952028199" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:39:58.416491 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:39:58.420168 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: COMMIT
[0m13:39:58.421026 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m13:39:58.421790 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: COMMIT
[0m13:39:58.441806 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:58.444635 [debug] [Thread-3  ]: Timing info for snapshot.bde.host_snapshot (execute): 13:39:51.691056 => 13:39:58.444142
[0m13:39:58.445778 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: Close
[0m13:39:58.447706 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf855a220>]}
[0m13:39:58.449306 [info ] [Thread-3  ]: 3 of 6 OK snapshotted at3.host_snapshot ........................................ [[32mINSERT 0 0[0m in 6.84s]
[0m13:39:58.450631 [debug] [Thread-3  ]: Finished running node snapshot.bde.host_snapshot
[0m13:39:58.819921 [debug] [Thread-4  ]: SQL status: SELECT 0 in 7.0 seconds
[0m13:39:58.833839 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:58.835168 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp133952017494'
        
      order by ordinal_position

  
[0m13:39:58.859104 [debug] [Thread-4  ]: SQL status: SELECT 22 in 0.0 seconds
[0m13:39:58.868070 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:58.869146 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:58.892193 [debug] [Thread-4  ]: SQL status: SELECT 20 in 0.0 seconds
[0m13:39:58.900806 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:58.901725 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp133952017494'
        
      order by ordinal_position

  
[0m13:39:58.925377 [debug] [Thread-4  ]: SQL status: SELECT 22 in 0.0 seconds
[0m13:39:58.933333 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:58.934290 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m13:39:58.958807 [debug] [Thread-4  ]: SQL status: SELECT 20 in 0.0 seconds
[0m13:39:58.967418 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:58.968370 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp133952017494'
        
      order by ordinal_position

  
[0m13:39:58.992296 [debug] [Thread-4  ]: SQL status: SELECT 22 in 0.0 seconds
[0m13:39:58.999060 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m13:39:59.001646 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:59.002742 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      update "postgres"."at3"."listing_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "listing_snapshot__dbt_tmp133952017494" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."listing_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."listing_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."listing_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "accommodates", "price", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "listing_snapshot__dbt_tmp133952017494" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m13:39:59.025697 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m13:39:59.029295 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m13:39:59.030132 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m13:39:59.030907 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m13:39:59.050621 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:59.053475 [debug] [Thread-4  ]: Timing info for snapshot.bde.listing_snapshot (execute): 13:39:51.712496 => 13:39:59.052949
[0m13:39:59.054526 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: Close
[0m13:39:59.056301 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504eabe-d652-4b71-acb3-7729b2711331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b5cc700>]}
[0m13:39:59.057824 [info ] [Thread-4  ]: 4 of 6 OK snapshotted at3.listing_snapshot ..................................... [[32mINSERT 0 0[0m in 7.45s]
[0m13:39:59.059173 [debug] [Thread-4  ]: Finished running node snapshot.bde.listing_snapshot
[0m13:39:59.063002 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:59.063737 [debug] [MainThread]: On master: BEGIN
[0m13:39:59.064399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:59.302240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:39:59.305297 [debug] [MainThread]: On master: COMMIT
[0m13:39:59.306658 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:59.307398 [debug] [MainThread]: On master: COMMIT
[0m13:39:59.326535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:39:59.328264 [debug] [MainThread]: On master: Close
[0m13:39:59.331013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:59.331866 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m13:39:59.332515 [debug] [MainThread]: Connection 'snapshot.bde.suburb_snapshot' was properly closed.
[0m13:39:59.333592 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m13:39:59.334616 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m13:39:59.335469 [info ] [MainThread]: 
[0m13:39:59.336286 [info ] [MainThread]: Finished running 6 snapshots in 0 hours 0 minutes and 9.03 seconds (9.03s).
[0m13:39:59.339254 [debug] [MainThread]: Command end result
[0m13:39:59.355577 [info ] [MainThread]: 
[0m13:39:59.356432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:59.357037 [info ] [MainThread]: 
[0m13:39:59.357614 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:39:59.358605 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:39:59.358444 after 9.31 seconds
[0m13:39:59.359286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee08c716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedf8508220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0b613a90>]}
[0m13:39:59.359898 [debug] [MainThread]: Flushing usage events
[0m13:45:17.385803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce08bb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde83b8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde83b8940>]}


============================== 13:45:17.390172 | f6b7fd63-acf9-46c0-83ca-1f3740269fed ==============================
[0m13:45:17.390172 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:45:17.390842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:45:17.533935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde83b88e0>]}
[0m13:45:17.544658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0afb62b0>]}
[0m13:45:17.545194 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:45:17.561965 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:45:17.594796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 0 files changed.
[0m13:45:17.595337 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m13:45:17.595650 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/code_stg.sql
[0m13:45:17.595915 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/fact_stg.sql
[0m13:45:17.596180 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/all_listings_stg.sql
[0m13:45:17.596450 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/host_stg.sql
[0m13:45:17.596711 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m13:45:17.596974 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/listings_stg.sql
[0m13:45:17.643665 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m13:45:17.647720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0b0100d0>]}
[0m13:45:17.662848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde847ce20>]}
[0m13:45:17.663301 [info ] [MainThread]: Found 6 snapshots, 7 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:45:17.663613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde847cf10>]}
[0m13:45:17.665106 [info ] [MainThread]: 
[0m13:45:17.665708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:17.666728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:45:17.674480 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:45:17.674865 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:45:17.675111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:17.957502 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:45:17.960507 [debug] [ThreadPool]: On list_postgres: Close
[0m13:45:17.964838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m13:45:17.966076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m13:45:17.974461 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:45:17.976886 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:45:17.977328 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m13:45:17.977705 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:45:17.978071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:17.978427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:18.208494 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.210132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.211801 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:45:18.213393 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:45:18.215084 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m13:45:18.216593 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:45:18.240134 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m13:45:18.241098 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:45:18.243893 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m13:45:18.245691 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:45:18.265184 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:45:18.266295 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m13:45:18.285865 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:18.286634 [debug] [MainThread]: On master: BEGIN
[0m13:45:18.287196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:18.521073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.522142 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:18.523436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:18.554647 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m13:45:18.561994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0afba670>]}
[0m13:45:18.563105 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:18.579296 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:18.580329 [debug] [MainThread]: On master: BEGIN
[0m13:45:18.621864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.623970 [debug] [MainThread]: On master: COMMIT
[0m13:45:18.625462 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:18.626940 [debug] [MainThread]: On master: COMMIT
[0m13:45:18.646694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:45:18.648661 [debug] [MainThread]: On master: Close
[0m13:45:18.652211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:18.653233 [info ] [MainThread]: 
[0m13:45:18.661035 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m13:45:18.662033 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m13:45:18.662995 [debug] [Thread-3  ]: Began running node model.bde.fact_stg
[0m13:45:18.664833 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m13:45:18.664080 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.all_listings_stg ........................... [RUN]
[0m13:45:18.666086 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.code_stg ................................... [RUN]
[0m13:45:18.667176 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.fact_stg ................................... [RUN]
[0m13:45:18.668165 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.host_stg ................................... [RUN]
[0m13:45:18.669429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.all_listings_stg)
[0m13:45:18.670563 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.code_stg)
[0m13:45:18.671818 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.fact_stg'
[0m13:45:18.673015 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m13:45:18.673720 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m13:45:18.674365 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m13:45:18.674997 [debug] [Thread-3  ]: Began compiling node model.bde.fact_stg
[0m13:45:18.675629 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m13:45:18.689638 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m13:45:18.693655 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m13:45:18.697372 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_stg"
[0m13:45:18.700862 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m13:45:18.702702 [debug] [Thread-3  ]: Timing info for model.bde.fact_stg (compile): 13:45:18.694107 => 13:45:18.702380
[0m13:45:18.703310 [debug] [Thread-3  ]: Began executing node model.bde.fact_stg
[0m13:45:18.709587 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 13:45:18.690199 => 13:45:18.709307
[0m13:45:18.728888 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m13:45:18.729388 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 13:45:18.697816 => 13:45:18.729208
[0m13:45:18.739139 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_stg"
[0m13:45:18.739541 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 13:45:18.676155 => 13:45:18.739384
[0m13:45:18.743557 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m13:45:18.743925 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m13:45:18.744310 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m13:45:18.747528 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m13:45:18.747877 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:45:18.751034 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m13:45:18.751353 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:45:18.751714 [debug] [Thread-3  ]: On model.bde.fact_stg: BEGIN
[0m13:45:18.752087 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m13:45:18.752366 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:45:18.752670 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:45:18.752968 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:45:18.753247 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:45:18.753534 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m13:45:18.753922 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m13:45:18.754279 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:45:18.754551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:18.961124 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.962175 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:45:18.962995 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 




select * from to_date_format
  );
[0m13:45:18.964051 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.964761 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.965449 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:18.966134 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:45:18.966825 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:45:18.967481 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:45:18.968252 [debug] [Thread-3  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */

  create view "postgres"."staging"."fact_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."fact_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        accommodates,
        price,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source


select * from to_date_format
  );
[0m13:45:18.969131 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m13:45:18.969934 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m13:45:18.989735 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 38: select * from to_date_format
         ^

[0m13:45:18.990486 [debug] [Thread-3  ]: On model.bde.fact_stg: ROLLBACK
[0m13:45:18.996615 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:45:18.997473 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:45:19.004523 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:45:19.010473 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:45:19.015435 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:45:19.016492 [debug] [Thread-3  ]: Timing info for model.bde.fact_stg (execute): 13:45:18.703803 => 13:45:19.016149
[0m13:45:19.021168 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:45:19.021728 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m13:45:19.022283 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m13:45:19.022830 [debug] [Thread-3  ]: On model.bde.fact_stg: Close
[0m13:45:19.023364 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg" rename to "all_listings_stg__dbt_backup"
[0m13:45:19.029656 [debug] [Thread-3  ]: Database Error in model fact_stg (models/staging/fact_stg.sql)
  syntax error at or near "select"
  LINE 38: select * from to_date_format
           ^
  compiled Code at target/run/bde/models/staging/fact_stg.sql
[0m13:45:19.030308 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde84ca790>]}
[0m13:45:19.031437 [error] [Thread-3  ]: 3 of 7 ERROR creating sql view model staging.fact_stg .......................... [[31mERROR[0m in 0.36s]
[0m13:45:19.032231 [debug] [Thread-3  ]: Finished running node model.bde.fact_stg
[0m13:45:19.032771 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m13:45:19.033408 [info ] [Thread-3  ]: 5 of 7 START sql view model staging.listings_stg ............................... [RUN]
[0m13:45:19.034202 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_stg, now model.bde.listings_stg)
[0m13:45:19.034649 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m13:45:19.038292 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m13:45:19.038823 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.042063 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:45:19.042494 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m13:45:19.043141 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 13:45:19.034959 => 13:45:19.042939
[0m13:45:19.043544 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m13:45:19.048511 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m13:45:19.048921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.049256 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.088932 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.091176 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:45:19.093399 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:45:19.093734 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:45:19.105857 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m13:45:19.106226 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg__dbt_tmp" rename to "all_listings_stg"
[0m13:45:19.106520 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m13:45:19.106795 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m13:45:19.107069 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:45:19.107485 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:45:19.107792 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m13:45:19.125868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.126269 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.126700 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.128768 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m13:45:19.130296 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m13:45:19.137458 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:45:19.137802 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:45:19.138110 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:45:19.138421 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m13:45:19.138725 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m13:45:19.139014 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m13:45:19.157808 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.158182 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.158552 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:45:19.161079 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:45:19.163453 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:45:19.164798 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 13:45:18.739809 => 13:45:19.164635
[0m13:45:19.165151 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
drop view if exists "postgres"."staging"."all_listings_stg__dbt_backup" cascade
[0m13:45:19.165493 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m13:45:19.165836 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m13:45:19.166659 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0b079250>]}
[0m13:45:19.167217 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.50s]
[0m13:45:19.167763 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m13:45:19.168148 [debug] [Thread-2  ]: Began running node model.bde.property_stg
[0m13:45:19.168584 [info ] [Thread-2  ]: 6 of 7 START sql view model staging.property_stg ............................... [RUN]
[0m13:45:19.169166 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.property_stg)
[0m13:45:19.169494 [debug] [Thread-2  ]: Began compiling node model.bde.property_stg
[0m13:45:19.171905 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.property_stg"
[0m13:45:19.172922 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (compile): 13:45:19.169730 => 13:45:19.172761
[0m13:45:19.173237 [debug] [Thread-2  ]: Began executing node model.bde.property_stg
[0m13:45:19.177540 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.property_stg"
[0m13:45:19.178342 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m13:45:19.178663 [debug] [Thread-2  ]: On model.bde.property_stg: BEGIN
[0m13:45:19.178957 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:45:19.183878 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:45:19.184230 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:45:19.185521 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 13:45:18.748136 => 13:45:19.185359
[0m13:45:19.186705 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 13:45:18.744654 => 13:45:19.186556
[0m13:45:19.187068 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m13:45:19.187410 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m13:45:19.188314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf89e39d0>]}
[0m13:45:19.188932 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0b10b970>]}
[0m13:45:19.189526 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.all_listings_stg ...................... [[32mCREATE VIEW[0m in 0.52s]
[0m13:45:19.189992 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.52s]
[0m13:45:19.190466 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m13:45:19.190881 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m13:45:19.191223 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m13:45:19.191692 [info ] [Thread-1  ]: 7 of 7 START sql view model staging.suburb_stg ................................. [RUN]
[0m13:45:19.192250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.all_listings_stg, now model.bde.suburb_stg)
[0m13:45:19.192551 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m13:45:19.195009 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m13:45:19.195606 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 13:45:19.192761 => 13:45:19.195454
[0m13:45:19.195934 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m13:45:19.199010 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m13:45:19.199547 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:45:19.199837 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m13:45:19.200107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:19.306579 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:19.307222 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:45:19.307744 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m13:45:19.331401 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:45:19.335487 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:45:19.335975 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m13:45:19.356535 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.359686 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:45:19.360116 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m13:45:19.373075 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:19.373502 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m13:45:19.373933 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m13:45:19.381453 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.383341 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:45:19.383798 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:45:19.384209 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:45:19.403280 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:45:19.403719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:19.404138 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.408269 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m13:45:19.408744 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:45:19.411695 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:45:19.412165 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m13:45:19.412643 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m13:45:19.413143 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m13:45:19.435571 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.436123 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:45:19.436614 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:45:19.440174 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m13:45:19.443828 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:45:19.445403 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 13:45:19.043823 => 13:45:19.445179
[0m13:45:19.445866 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m13:45:19.446319 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m13:45:19.446734 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m13:45:19.447708 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde84d1d90>]}
[0m13:45:19.448326 [info ] [Thread-3  ]: 5 of 7 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.41s]
[0m13:45:19.448952 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m13:45:19.463660 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.464117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.466032 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m13:45:19.470628 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:45:19.471090 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m13:45:19.471488 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m13:45:19.471875 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m13:45:19.496091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:19.496660 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.498665 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m13:45:19.501560 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m13:45:19.502012 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:45:19.502429 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m13:45:19.502821 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m13:45:19.520915 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:45:19.521404 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.523216 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (execute): 13:45:19.173459 => 13:45:19.522990
[0m13:45:19.526359 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:45:19.526854 [debug] [Thread-2  ]: On model.bde.property_stg: Close
[0m13:45:19.527307 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m13:45:19.528226 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0afaec40>]}
[0m13:45:19.528834 [info ] [Thread-2  ]: 6 of 7 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m13:45:19.529460 [debug] [Thread-2  ]: Finished running node model.bde.property_stg
[0m13:45:19.547625 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:45:19.549358 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 13:45:19.196146 => 13:45:19.549157
[0m13:45:19.549787 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m13:45:19.550739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6b7fd63-acf9-46c0-83ca-1f3740269fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf89d0f40>]}
[0m13:45:19.551352 [info ] [Thread-1  ]: 7 of 7 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.36s]
[0m13:45:19.551992 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m13:45:19.553318 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:19.553669 [debug] [MainThread]: On master: BEGIN
[0m13:45:19.553984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:19.755951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:19.756851 [debug] [MainThread]: On master: COMMIT
[0m13:45:19.757462 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:19.758018 [debug] [MainThread]: On master: COMMIT
[0m13:45:19.780965 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:45:19.781894 [debug] [MainThread]: On master: Close
[0m13:45:19.783765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:19.784445 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m13:45:19.785073 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m13:45:19.785694 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m13:45:19.786297 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m13:45:19.787131 [info ] [MainThread]: 
[0m13:45:19.787897 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m13:45:19.790561 [debug] [MainThread]: Command end result
[0m13:45:19.803992 [info ] [MainThread]: 
[0m13:45:19.804764 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:45:19.805280 [info ] [MainThread]: 
[0m13:45:19.805772 [error] [MainThread]:   Database Error in model fact_stg (models/staging/fact_stg.sql)
  syntax error at or near "select"
  LINE 38: select * from to_date_format
           ^
  compiled Code at target/run/bde/models/staging/fact_stg.sql
[0m13:45:19.806285 [info ] [MainThread]: 
[0m13:45:19.806840 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:45:19.807864 [debug] [MainThread]: Command `dbt run` failed at 13:45:19.807713 after 2.45 seconds
[0m13:45:19.808491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce08bb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0afb62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0a539d60>]}
[0m13:45:19.809105 [debug] [MainThread]: Flushing usage events
[0m13:46:41.473876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee30cb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32e90820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32e90910>]}


============================== 13:46:41.478237 | 49f36c23-451d-45e5-afc5-9bc96243964a ==============================
[0m13:46:41.478237 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:46:41.478938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:41.619470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32e908b0>]}
[0m13:46:41.630666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32fb8280>]}
[0m13:46:41.631224 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:46:41.648377 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:46:41.681542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:41.682162 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/fact_stg.sql
[0m13:46:41.715044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
[0m13:46:41.721637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10a730d0>]}
[0m13:46:41.737452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee330e61f0>]}
[0m13:46:41.738000 [info ] [MainThread]: Found 6 snapshots, 7 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:46:41.738365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee330e6280>]}
[0m13:46:41.740233 [info ] [MainThread]: 
[0m13:46:41.741021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:41.742091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:46:41.749741 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:46:41.750070 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:46:41.750324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:42.199242 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:46:42.201210 [debug] [ThreadPool]: On list_postgres: Close
[0m13:46:42.204401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m13:46:42.205288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m13:46:42.211736 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:46:42.213737 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:46:42.214075 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m13:46:42.214363 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:46:42.214633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:42.214897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:42.599169 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:46:42.601469 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:46:42.602923 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:46:42.603881 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:46:42.604808 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:46:42.605672 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m13:46:42.654458 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m13:46:42.656678 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:46:42.661844 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m13:46:42.665455 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:46:42.706788 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:46:42.708855 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m13:46:42.727502 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:42.728423 [debug] [MainThread]: On master: BEGIN
[0m13:46:42.729023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:43.110350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:43.111449 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:43.112514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:43.158109 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m13:46:43.166344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10a5b730>]}
[0m13:46:43.167447 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:43.204873 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:43.205847 [debug] [MainThread]: On master: BEGIN
[0m13:46:43.283020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:43.284538 [debug] [MainThread]: On master: COMMIT
[0m13:46:43.285894 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:43.287024 [debug] [MainThread]: On master: COMMIT
[0m13:46:43.326502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:46:43.328518 [debug] [MainThread]: On master: Close
[0m13:46:43.331349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:43.332547 [info ] [MainThread]: 
[0m13:46:43.341567 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m13:46:43.342676 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m13:46:43.343642 [debug] [Thread-3  ]: Began running node model.bde.fact_stg
[0m13:46:43.344448 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m13:46:43.345348 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.all_listings_stg ........................... [RUN]
[0m13:46:43.346400 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.code_stg ................................... [RUN]
[0m13:46:43.347343 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.fact_stg ................................... [RUN]
[0m13:46:43.348205 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.host_stg ................................... [RUN]
[0m13:46:43.349489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.all_listings_stg)
[0m13:46:43.350577 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.code_stg)
[0m13:46:43.351805 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.fact_stg'
[0m13:46:43.353019 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m13:46:43.353722 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m13:46:43.354374 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m13:46:43.355007 [debug] [Thread-3  ]: Began compiling node model.bde.fact_stg
[0m13:46:43.355620 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m13:46:43.368199 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m13:46:43.372292 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m13:46:43.376588 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_stg"
[0m13:46:43.380709 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m13:46:43.382944 [debug] [Thread-3  ]: Timing info for model.bde.fact_stg (compile): 13:46:43.372772 => 13:46:43.382629
[0m13:46:43.383525 [debug] [Thread-3  ]: Began executing node model.bde.fact_stg
[0m13:46:43.384092 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 13:46:43.356044 => 13:46:43.383869
[0m13:46:43.384666 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 13:46:43.368754 => 13:46:43.384418
[0m13:46:43.385157 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 13:46:43.377105 => 13:46:43.384968
[0m13:46:43.411227 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m13:46:43.418928 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_stg"
[0m13:46:43.419326 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m13:46:43.419635 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m13:46:43.423017 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m13:46:43.427333 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m13:46:43.430466 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m13:46:43.430830 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:46:43.431412 [debug] [Thread-3  ]: On model.bde.fact_stg: BEGIN
[0m13:46:43.431796 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:46:43.432104 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:46:43.432418 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:46:43.432718 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:46:43.433080 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m13:46:43.433381 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m13:46:43.433666 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m13:46:43.433933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:43.434204 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:46:43.434469 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:46:43.822634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:43.824463 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:46:43.826633 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 




select * from to_date_format
  );
[0m13:46:43.828091 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:43.829314 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:46:43.830361 [debug] [Thread-3  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */

  create view "postgres"."staging"."fact_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."fact_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        accommodates,
        price,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source


select * from to_date_format
  );
[0m13:46:43.831272 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:43.832273 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:46:43.833178 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m13:46:43.835975 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:43.836896 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:46:43.837784 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m13:46:43.868802 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 39: select * from to_date_format
         ^

[0m13:46:43.870133 [debug] [Thread-3  ]: On model.bde.fact_stg: ROLLBACK
[0m13:46:43.873144 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:43.883744 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:43.884974 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:46:43.885609 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:43.890341 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:46:43.891003 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg" rename to "all_listings_stg__dbt_backup"
[0m13:46:43.895310 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:46:43.895867 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m13:46:43.896475 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m13:46:43.908156 [debug] [Thread-3  ]: Timing info for model.bde.fact_stg (execute): 13:46:43.385421 => 13:46:43.907769
[0m13:46:43.908748 [debug] [Thread-3  ]: On model.bde.fact_stg: Close
[0m13:46:43.914200 [debug] [Thread-3  ]: Database Error in model fact_stg (models/staging/fact_stg.sql)
  syntax error at or near "select"
  LINE 39: select * from to_date_format
           ^
  compiled Code at target/run/bde/models/staging/fact_stg.sql
[0m13:46:43.914902 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10a9abb0>]}
[0m13:46:43.915827 [error] [Thread-3  ]: 3 of 7 ERROR creating sql view model staging.fact_stg .......................... [[31mERROR[0m in 0.56s]
[0m13:46:43.916519 [debug] [Thread-3  ]: Finished running node model.bde.fact_stg
[0m13:46:43.917003 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m13:46:43.917576 [info ] [Thread-3  ]: 5 of 7 START sql view model staging.listings_stg ............................... [RUN]
[0m13:46:43.918295 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_stg, now model.bde.listings_stg)
[0m13:46:43.918677 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m13:46:43.921897 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m13:46:43.923006 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 13:46:43.918941 => 13:46:43.922815
[0m13:46:43.923384 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m13:46:43.927139 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m13:46:43.927796 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:46:43.928145 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m13:46:43.928456 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:46:43.936579 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:43.937029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:43.939923 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:46:43.941415 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:43.984436 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:46:43.984876 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m13:46:43.987160 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:46:43.987523 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg__dbt_tmp" rename to "all_listings_stg"
[0m13:46:43.987915 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m13:46:44.027151 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.027569 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.033913 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.041818 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m13:46:44.043236 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m13:46:44.044498 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m13:46:44.044804 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:46:44.045094 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:46:44.045375 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:46:44.045658 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m13:46:44.045935 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m13:46:44.046209 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m13:46:44.083363 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:46:44.083817 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:46:44.084234 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:46:44.093051 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:46:44.095593 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:46:44.098065 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:46:44.098439 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
drop view if exists "postgres"."staging"."all_listings_stg__dbt_backup" cascade
[0m13:46:44.098782 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m13:46:44.099114 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m13:46:44.139435 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:44.139909 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:44.140351 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:44.142016 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 13:46:43.419856 => 13:46:44.141785
[0m13:46:44.143518 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 13:46:43.423569 => 13:46:44.143335
[0m13:46:44.144860 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 13:46:43.427680 => 13:46:44.144680
[0m13:46:44.145279 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m13:46:44.145675 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m13:46:44.146058 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m13:46:44.146930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2028ecd0>]}
[0m13:46:44.147628 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee00114d00>]}
[0m13:46:44.148304 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10a5b790>]}
[0m13:46:44.148904 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.all_listings_stg ...................... [[32mCREATE VIEW[0m in 0.80s]
[0m13:46:44.149492 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.80s]
[0m13:46:44.150088 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.80s]
[0m13:46:44.150687 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m13:46:44.151225 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m13:46:44.151724 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m13:46:44.152163 [debug] [Thread-1  ]: Began running node model.bde.property_stg
[0m13:46:44.152626 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m13:46:44.153161 [info ] [Thread-1  ]: 6 of 7 START sql view model staging.property_stg ............................... [RUN]
[0m13:46:44.153605 [info ] [Thread-2  ]: 7 of 7 START sql view model staging.suburb_stg ................................. [RUN]
[0m13:46:44.154219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.all_listings_stg, now model.bde.property_stg)
[0m13:46:44.154786 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.suburb_stg)
[0m13:46:44.155151 [debug] [Thread-1  ]: Began compiling node model.bde.property_stg
[0m13:46:44.155492 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m13:46:44.158430 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.property_stg"
[0m13:46:44.160857 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m13:46:44.162534 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 13:46:44.158737 => 13:46:44.162360
[0m13:46:44.162954 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (compile): 13:46:44.155756 => 13:46:44.162785
[0m13:46:44.163276 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m13:46:44.163614 [debug] [Thread-1  ]: Began executing node model.bde.property_stg
[0m13:46:44.168081 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m13:46:44.171311 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.property_stg"
[0m13:46:44.172031 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:46:44.172363 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m13:46:44.172669 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:46:44.173180 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:46:44.173568 [debug] [Thread-1  ]: On model.bde.property_stg: BEGIN
[0m13:46:44.173888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:44.285989 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:44.286780 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:46:44.287468 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m13:46:44.329920 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:44.336454 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:46:44.337249 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m13:46:44.375097 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.381461 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:46:44.382364 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m13:46:44.421888 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.425193 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:46:44.425943 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:46:44.426617 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:46:44.468729 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:46:44.474709 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:46:44.475611 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m13:46:44.520502 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:44.530669 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 13:46:43.923645 => 13:46:44.530147
[0m13:46:44.531836 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m13:46:44.533903 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee10a933d0>]}
[0m13:46:44.535563 [info ] [Thread-3  ]: 5 of 7 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.62s]
[0m13:46:44.537038 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m13:46:44.543388 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:44.544251 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:46:44.544977 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m13:46:44.552567 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:46:44.553506 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:46:44.554396 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m13:46:44.585477 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:44.592605 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:46:44.593556 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m13:46:44.594763 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:44.600654 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:46:44.601544 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m13:46:44.636990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.643189 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:46:44.644025 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.644776 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m13:46:44.649821 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:46:44.650693 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m13:46:44.692282 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.698961 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m13:46:44.699912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:44.700586 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:46:44.705936 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m13:46:44.706667 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m13:46:44.707336 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:46:44.708105 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m13:46:44.754207 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:46:44.755207 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:46:44.761330 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:46:44.767045 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:46:44.767948 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m13:46:44.768771 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m13:46:44.812431 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:44.813755 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:44.817662 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (execute): 13:46:44.168361 => 13:46:44.817225
[0m13:46:44.820560 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 13:46:44.163870 => 13:46:44.820165
[0m13:46:44.821462 [debug] [Thread-1  ]: On model.bde.property_stg: Close
[0m13:46:44.822293 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m13:46:44.824186 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2029ca60>]}
[0m13:46:44.825608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f36c23-451d-45e5-afc5-9bc96243964a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2027e670>]}
[0m13:46:44.826871 [info ] [Thread-2  ]: 7 of 7 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.67s]
[0m13:46:44.828292 [info ] [Thread-1  ]: 6 of 7 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.67s]
[0m13:46:44.829458 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m13:46:44.830450 [debug] [Thread-1  ]: Finished running node model.bde.property_stg
[0m13:46:44.832922 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:44.833527 [debug] [MainThread]: On master: BEGIN
[0m13:46:44.834054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:45.225207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:45.227417 [debug] [MainThread]: On master: COMMIT
[0m13:46:45.228358 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:45.229229 [debug] [MainThread]: On master: COMMIT
[0m13:46:45.269907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:46:45.272787 [debug] [MainThread]: On master: Close
[0m13:46:45.276078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:45.277618 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m13:46:45.278508 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m13:46:45.279278 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m13:46:45.279906 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m13:46:45.280767 [info ] [MainThread]: 
[0m13:46:45.282651 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m13:46:45.285820 [debug] [MainThread]: Command end result
[0m13:46:45.300467 [info ] [MainThread]: 
[0m13:46:45.301280 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:46:45.301866 [info ] [MainThread]: 
[0m13:46:45.302439 [error] [MainThread]:   Database Error in model fact_stg (models/staging/fact_stg.sql)
  syntax error at or near "select"
  LINE 39: select * from to_date_format
           ^
  compiled Code at target/run/bde/models/staging/fact_stg.sql
[0m13:46:45.302995 [info ] [MainThread]: 
[0m13:46:45.303525 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:46:45.304475 [debug] [MainThread]: Command `dbt run` failed at 13:46:45.304321 after 3.87 seconds
[0m13:46:45.305096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee30cb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32fcb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee32fcc670>]}
[0m13:46:45.305690 [debug] [MainThread]: Flushing usage events
[0m13:47:07.350753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c8a84ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79caad98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79caad99a0>]}


============================== 13:47:07.354747 | 4157e414-06a4-41b4-88ba-52b793e20233 ==============================
[0m13:47:07.354747 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:47:07.355375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:47:07.458965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79caad98e0>]}
[0m13:47:07.469871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79cac522e0>]}
[0m13:47:07.470449 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:47:07.487180 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:47:07.517795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:07.518409 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/fact_stg.sql
[0m13:47:07.568761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m13:47:07.573609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79a811c0d0>]}
[0m13:47:07.594514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d83a4250>]}
[0m13:47:07.595008 [info ] [MainThread]: Found 6 snapshots, 7 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:47:07.595318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d83a42e0>]}
[0m13:47:07.596883 [info ] [MainThread]: 
[0m13:47:07.597491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:07.598528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:47:07.610733 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:47:07.611164 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:47:07.611428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:07.890144 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:47:07.893188 [debug] [ThreadPool]: On list_postgres: Close
[0m13:47:07.896915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m13:47:07.898200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m13:47:07.908489 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:47:07.911620 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:47:07.912212 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:47:07.912657 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m13:47:07.913105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:07.913512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:08.143321 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.144977 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.146193 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m13:47:08.147166 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:47:08.148225 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m13:47:08.149338 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:47:08.174647 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m13:47:08.175940 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:47:08.180624 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m13:47:08.184312 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:47:08.210601 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m13:47:08.211766 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:47:08.229859 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:08.230569 [debug] [MainThread]: On master: BEGIN
[0m13:47:08.231122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:08.450183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.451378 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:08.453404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:08.483695 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m13:47:08.489658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d83a4310>]}
[0m13:47:08.491105 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:08.517178 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:08.518743 [debug] [MainThread]: On master: BEGIN
[0m13:47:08.559275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.560773 [debug] [MainThread]: On master: COMMIT
[0m13:47:08.562201 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:08.562900 [debug] [MainThread]: On master: COMMIT
[0m13:47:08.576980 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:47:08.578958 [debug] [MainThread]: On master: Close
[0m13:47:08.581523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:08.582669 [info ] [MainThread]: 
[0m13:47:08.591234 [debug] [Thread-1  ]: Began running node model.bde.all_listings_stg
[0m13:47:08.592214 [debug] [Thread-2  ]: Began running node model.bde.code_stg
[0m13:47:08.592981 [debug] [Thread-3  ]: Began running node model.bde.fact_stg
[0m13:47:08.593796 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m13:47:08.594723 [info ] [Thread-1  ]: 1 of 7 START sql view model staging.all_listings_stg ........................... [RUN]
[0m13:47:08.595744 [info ] [Thread-2  ]: 2 of 7 START sql view model staging.code_stg ................................... [RUN]
[0m13:47:08.596708 [info ] [Thread-3  ]: 3 of 7 START sql view model staging.fact_stg ................................... [RUN]
[0m13:47:08.597593 [info ] [Thread-4  ]: 4 of 7 START sql view model staging.host_stg ................................... [RUN]
[0m13:47:08.598864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.all_listings_stg)
[0m13:47:08.599930 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m13:47:08.601127 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.fact_stg'
[0m13:47:08.602517 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m13:47:08.603378 [debug] [Thread-1  ]: Began compiling node model.bde.all_listings_stg
[0m13:47:08.604141 [debug] [Thread-2  ]: Began compiling node model.bde.code_stg
[0m13:47:08.604822 [debug] [Thread-3  ]: Began compiling node model.bde.fact_stg
[0m13:47:08.605620 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m13:47:08.619616 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.all_listings_stg"
[0m13:47:08.623543 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.code_stg"
[0m13:47:08.627472 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_stg"
[0m13:47:08.631046 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m13:47:08.632209 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (compile): 13:47:08.606288 => 13:47:08.631902
[0m13:47:08.632761 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (compile): 13:47:08.620056 => 13:47:08.632550
[0m13:47:08.633290 [debug] [Thread-1  ]: Began executing node model.bde.all_listings_stg
[0m13:47:08.633857 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 13:47:08.627910 => 13:47:08.633616
[0m13:47:08.634345 [debug] [Thread-2  ]: Began executing node model.bde.code_stg
[0m13:47:08.634868 [debug] [Thread-3  ]: Timing info for model.bde.fact_stg (compile): 13:47:08.624082 => 13:47:08.634651
[0m13:47:08.660648 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m13:47:08.670150 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.all_listings_stg"
[0m13:47:08.673795 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.code_stg"
[0m13:47:08.674173 [debug] [Thread-3  ]: Began executing node model.bde.fact_stg
[0m13:47:08.677951 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m13:47:08.681216 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_stg"
[0m13:47:08.681759 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:47:08.682086 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:47:08.682413 [debug] [Thread-1  ]: On model.bde.all_listings_stg: BEGIN
[0m13:47:08.682768 [debug] [Thread-2  ]: On model.bde.code_stg: BEGIN
[0m13:47:08.683066 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:47:08.683345 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:47:08.683636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:08.683936 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:47:08.684242 [debug] [Thread-3  ]: On model.bde.fact_stg: BEGIN
[0m13:47:08.684525 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m13:47:08.685010 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:47:08.685303 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:47:08.863962 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.864622 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.865252 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:47:08.865820 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:47:08.866342 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."code_snapshot"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m13:47:08.866861 [debug] [Thread-3  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */

  create view "postgres"."staging"."fact_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."fact_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        accommodates,
        price,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m13:47:08.879539 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.880073 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:47:08.880628 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */

  create view "postgres"."staging"."all_listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listings"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') AS scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        listing_neighbourhood,
        accommodates,
        price,
        property_type,
        room_type,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE
    from source
) 




select * from to_date_format
  );
[0m13:47:08.888578 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:08.889246 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:08.900181 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:47:08.901233 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:08.909790 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:08.917912 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:47:08.918572 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m13:47:08.919585 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:47:08.925331 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:47:08.925831 [debug] [Thread-3  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg__dbt_tmp" rename to "fact_stg"
[0m13:47:08.927592 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m13:47:08.928067 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg" rename to "all_listings_stg__dbt_backup"
[0m13:47:08.946621 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:08.947088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:08.949874 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:47:08.950288 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:08.952928 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:47:08.953332 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m13:47:08.959724 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:08.967017 [debug] [Thread-3  ]: On model.bde.fact_stg: COMMIT
[0m13:47:08.967421 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
alter table "postgres"."staging"."all_listings_stg__dbt_tmp" rename to "all_listings_stg"
[0m13:47:08.971048 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:47:08.971476 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:47:08.971849 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m13:47:08.972170 [debug] [Thread-3  ]: On model.bde.fact_stg: COMMIT
[0m13:47:08.980343 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:08.983447 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m13:47:08.983790 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:47:08.984093 [debug] [Thread-2  ]: On model.bde.code_stg: COMMIT
[0m13:47:08.988678 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:08.990224 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m13:47:08.990576 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:47:08.990896 [debug] [Thread-1  ]: On model.bde.all_listings_stg: COMMIT
[0m13:47:08.997004 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:08.997354 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.044673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.045038 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.046233 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:47:09.052176 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_stg"
[0m13:47:09.054271 [debug] [Thread-1  ]: Using postgres connection "model.bde.all_listings_stg"
[0m13:47:09.056200 [debug] [Thread-2  ]: Using postgres connection "model.bde.code_stg"
[0m13:47:09.056504 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m13:47:09.056787 [debug] [Thread-3  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
drop view if exists "postgres"."staging"."fact_stg__dbt_backup" cascade
[0m13:47:09.057085 [debug] [Thread-1  ]: On model.bde.all_listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.all_listings_stg"} */
drop view if exists "postgres"."staging"."all_listings_stg__dbt_backup" cascade
[0m13:47:09.057363 [debug] [Thread-2  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m13:47:09.072146 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.073310 [debug] [Thread-3  ]: Timing info for model.bde.fact_stg (execute): 13:47:08.678384 => 13:47:09.073164
[0m13:47:09.073623 [debug] [Thread-3  ]: On model.bde.fact_stg: Close
[0m13:47:09.074302 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b8bd6e20>]}
[0m13:47:09.075002 [info ] [Thread-3  ]: 3 of 7 OK created sql view model staging.fact_stg .............................. [[32mCREATE VIEW[0m in 0.47s]
[0m13:47:09.075478 [debug] [Thread-3  ]: Finished running node model.bde.fact_stg
[0m13:47:09.075822 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m13:47:09.076253 [info ] [Thread-3  ]: 5 of 7 START sql view model staging.listings_stg ............................... [RUN]
[0m13:47:09.076760 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_stg, now model.bde.listings_stg)
[0m13:47:09.077051 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m13:47:09.079377 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m13:47:09.080004 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 13:47:09.077259 => 13:47:09.079861
[0m13:47:09.080304 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m13:47:09.083262 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m13:47:09.083694 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.083983 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.084324 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.085346 [debug] [Thread-1  ]: Timing info for model.bde.all_listings_stg (execute): 13:47:08.635203 => 13:47:09.085211
[0m13:47:09.086659 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m13:47:09.086996 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:47:09.088063 [debug] [Thread-2  ]: Timing info for model.bde.code_stg (execute): 13:47:08.670534 => 13:47:09.087928
[0m13:47:09.088370 [debug] [Thread-1  ]: On model.bde.all_listings_stg: Close
[0m13:47:09.088651 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:47:09.088919 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m13:47:09.089190 [debug] [Thread-2  ]: On model.bde.code_stg: Close
[0m13:47:09.089515 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m13:47:09.090025 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d84e0df0>]}
[0m13:47:09.090303 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:47:09.090882 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b8bd5e80>]}
[0m13:47:09.091419 [info ] [Thread-1  ]: 1 of 7 OK created sql view model staging.all_listings_stg ...................... [[32mCREATE VIEW[0m in 0.49s]
[0m13:47:09.091887 [info ] [Thread-2  ]: 2 of 7 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.49s]
[0m13:47:09.092369 [debug] [Thread-1  ]: Finished running node model.bde.all_listings_stg
[0m13:47:09.092800 [debug] [Thread-2  ]: Finished running node model.bde.code_stg
[0m13:47:09.093119 [debug] [Thread-1  ]: Began running node model.bde.property_stg
[0m13:47:09.093477 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m13:47:09.093840 [info ] [Thread-1  ]: 6 of 7 START sql view model staging.property_stg ............................... [RUN]
[0m13:47:09.094221 [info ] [Thread-2  ]: 7 of 7 START sql view model staging.suburb_stg ................................. [RUN]
[0m13:47:09.094725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.all_listings_stg, now model.bde.property_stg)
[0m13:47:09.095164 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.suburb_stg)
[0m13:47:09.095442 [debug] [Thread-1  ]: Began compiling node model.bde.property_stg
[0m13:47:09.095718 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m13:47:09.098167 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.property_stg"
[0m13:47:09.100204 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m13:47:09.100792 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (compile): 13:47:09.095930 => 13:47:09.100650
[0m13:47:09.101066 [debug] [Thread-1  ]: Began executing node model.bde.property_stg
[0m13:47:09.104869 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.property_stg"
[0m13:47:09.105243 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 13:47:09.098426 => 13:47:09.105100
[0m13:47:09.105560 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m13:47:09.108419 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m13:47:09.108854 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:47:09.109144 [debug] [Thread-1  ]: On model.bde.property_stg: BEGIN
[0m13:47:09.109425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:09.109720 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:47:09.110140 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m13:47:09.110418 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:47:09.115794 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.117737 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m13:47:09.118025 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m13:47:09.141439 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.142942 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 13:47:08.674400 => 13:47:09.142772
[0m13:47:09.143374 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m13:47:09.144321 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d84b9cd0>]}
[0m13:47:09.144880 [info ] [Thread-4  ]: 4 of 7 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.54s]
[0m13:47:09.145408 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m13:47:09.273122 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.273926 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:47:09.274548 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m13:47:09.298053 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:09.302542 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:47:09.303179 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m13:47:09.305317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.305757 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:47:09.306180 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m13:47:09.322989 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.326935 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:47:09.327441 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m13:47:09.332025 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:09.332552 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.337038 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:47:09.337672 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:47:09.338209 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m13:47:09.338757 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."suburb_snapshot"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m13:47:09.349114 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.351775 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:47:09.352380 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:47:09.352894 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:47:09.357441 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.358075 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:47:09.362177 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:47:09.366695 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:47:09.367270 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m13:47:09.367709 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m13:47:09.374152 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.378686 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:47:09.379301 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m13:47:09.381900 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.382662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.385893 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:47:09.387669 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m13:47:09.388186 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m13:47:09.388555 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:47:09.388997 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m13:47:09.399621 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.401109 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 13:47:09.080516 => 13:47:09.400957
[0m13:47:09.401450 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m13:47:09.402216 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d844ef70>]}
[0m13:47:09.402700 [info ] [Thread-3  ]: 5 of 7 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.33s]
[0m13:47:09.403163 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m13:47:09.417424 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.417848 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.419285 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m13:47:09.421505 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m13:47:09.421835 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:47:09.422139 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m13:47:09.422429 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m13:47:09.442599 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.443165 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.444792 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (execute): 13:47:09.101267 => 13:47:09.444622
[0m13:47:09.447486 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:47:09.448023 [debug] [Thread-1  ]: On model.bde.property_stg: Close
[0m13:47:09.448355 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m13:47:09.449216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79cac989d0>]}
[0m13:47:09.449755 [info ] [Thread-1  ]: 6 of 7 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.35s]
[0m13:47:09.450272 [debug] [Thread-1  ]: Finished running node model.bde.property_stg
[0m13:47:09.473930 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:47:09.478264 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 13:47:09.105760 => 13:47:09.477996
[0m13:47:09.479317 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m13:47:09.481455 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4157e414-06a4-41b4-88ba-52b793e20233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79cac9b280>]}
[0m13:47:09.482256 [info ] [Thread-2  ]: 7 of 7 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.39s]
[0m13:47:09.482806 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m13:47:09.483987 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.484289 [debug] [MainThread]: On master: BEGIN
[0m13:47:09.484528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:09.698519 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.699820 [debug] [MainThread]: On master: COMMIT
[0m13:47:09.700634 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.701459 [debug] [MainThread]: On master: COMMIT
[0m13:47:09.723504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.724656 [debug] [MainThread]: On master: Close
[0m13:47:09.726527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:09.727851 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m13:47:09.728612 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m13:47:09.729244 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m13:47:09.729889 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m13:47:09.730912 [info ] [MainThread]: 
[0m13:47:09.731818 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m13:47:09.736734 [debug] [MainThread]: Command end result
[0m13:47:09.748507 [info ] [MainThread]: 
[0m13:47:09.749058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:09.749432 [info ] [MainThread]: 
[0m13:47:09.749838 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:47:09.750511 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:09.750405 after 2.43 seconds
[0m13:47:09.750935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c8a84ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79cac522e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79a811c280>]}
[0m13:47:09.751346 [debug] [MainThread]: Flushing usage events
[0m14:20:06.320516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8c516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bb481820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bb481910>]}


============================== 14:20:06.324500 | 583333fc-71ba-4f3d-a6f7-c71513ceea92 ==============================
[0m14:20:06.324500 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:20:06.325176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:06.478414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '583333fc-71ba-4f3d-a6f7-c71513ceea92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bb481850>]}
[0m14:20:06.489210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '583333fc-71ba-4f3d-a6f7-c71513ceea92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bb569280>]}
[0m14:20:06.489748 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:20:06.506290 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:20:06.538724 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m14:20:06.539251 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m14:20:06.539563 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m14:20:06.539842 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m14:20:06.540112 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m14:20:06.540380 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m14:20:06.540636 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:20:06.540876 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/all_listings_stg.sql
[0m14:20:06.541184 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/suburb_stg.sql
[0m14:20:06.541494 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/code_stg.sql
[0m14:20:06.586169 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.fact_census_G02' (models/warehouse/fact_census_G02.sql) depends on a source named 'raw.census_g02_nsw_lga' which was not found
[0m14:20:06.587080 [debug] [MainThread]: Command `dbt run` failed at 14:20:06.586804 after 0.31 seconds
[0m14:20:06.587465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8c516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68818ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68808e9d0>]}
[0m14:20:06.587836 [debug] [MainThread]: Flushing usage events
[0m14:20:45.755581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf8b916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cfaf21850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cfaf21940>]}


============================== 14:20:45.759995 | 912c26bb-80e3-4b70-9c4c-31868488d077 ==============================
[0m14:20:45.759995 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:20:45.760664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:45.864395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912c26bb-80e3-4b70-9c4c-31868488d077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cfaf218e0>]}
[0m14:20:45.875165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912c26bb-80e3-4b70-9c4c-31868488d077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cfafd62b0>]}
[0m14:20:45.875753 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:20:45.900981 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:20:45.931216 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m14:20:45.931922 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m14:20:45.932580 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:20:45.932874 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m14:20:45.933146 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m14:20:45.933404 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m14:20:45.933660 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m14:20:45.933901 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/all_listings_stg.sql
[0m14:20:45.934212 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/suburb_stg.sql
[0m14:20:45.934519 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/code_stg.sql
[0m14:20:45.978936 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.suburb_stg' (models/staging/suburb_stg.sql) depends on a source named 'raw.nsw_lga_suburb' which was not found
[0m14:20:45.980353 [debug] [MainThread]: Command `dbt run` failed at 14:20:45.979630 after 0.26 seconds
[0m14:20:45.980831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf8b916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce82ffeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ce016d220>]}
[0m14:20:45.981273 [debug] [MainThread]: Flushing usage events
[0m14:24:20.006030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a0bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a2a417c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a2a418b0>]}


============================== 14:24:20.010339 | ace9d706-03b3-46a1-a62e-169caff47713 ==============================
[0m14:24:20.010339 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:24:20.011073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:20.163078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ace9d706-03b3-46a1-a62e-169caff47713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a2a417f0>]}
[0m14:24:20.173971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ace9d706-03b3-46a1-a62e-169caff47713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a2ab7220>]}
[0m14:24:20.174528 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:24:20.198881 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:24:20.231992 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m14:24:20.232531 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m14:24:20.232825 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m14:24:20.233102 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:24:20.233371 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m14:24:20.233646 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m14:24:20.233903 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m14:24:20.234148 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/all_listings_stg.sql
[0m14:24:20.234450 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/code_stg.sql
[0m14:24:20.234752 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/suburb_stg.sql
[0m14:24:20.283833 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.code_stg' (models/staging/code_stg.sql) depends on a source named 'raw.nsw_lga_code' which was not found
[0m14:24:20.285255 [debug] [MainThread]: Command `dbt run` failed at 14:24:20.284768 after 0.32 seconds
[0m14:24:20.285947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a0bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a2ba6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4909e55b0>]}
[0m14:24:20.286515 [debug] [MainThread]: Flushing usage events
[0m14:24:38.473175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea48c316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4afc17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4afc18e0>]}


============================== 14:24:38.477135 | 33ae7c4f-0413-4517-8c90-acb0b8dbeb50 ==============================
[0m14:24:38.477135 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:24:38.477764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:38.578476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33ae7c4f-0413-4517-8c90-acb0b8dbeb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4afc1880>]}
[0m14:24:38.589144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33ae7c4f-0413-4517-8c90-acb0b8dbeb50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea4b0f9250>]}
[0m14:24:38.589687 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:24:38.609043 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:24:38.639492 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m14:24:38.640036 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m14:24:38.640342 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:24:38.640611 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m14:24:38.640875 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m14:24:38.641132 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m14:24:38.641389 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m14:24:38.641623 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/all_listings_stg.sql
[0m14:24:38.641917 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/suburb_stg.sql
[0m14:24:38.642215 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/code_stg.sql
[0m14:24:38.685309 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.fact_listing' (models/warehouse/fact_listing.sql) depends on a node named 'listing_stg' which was not found
[0m14:24:38.686193 [debug] [MainThread]: Command `dbt run` failed at 14:24:38.685918 after 0.24 seconds
[0m14:24:38.686568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea48c316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea3822ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea3830e5b0>]}
[0m14:24:38.686933 [debug] [MainThread]: Flushing usage events
[0m14:25:24.888410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40cb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42bb9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42bb9940>]}


============================== 14:25:24.892354 | 7878c7dd-651b-44d8-b1bb-71d3e274db32 ==============================
[0m14:25:24.892354 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:25:24.892996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:24.996096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42bb98e0>]}
[0m14:25:25.006879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42cf02b0>]}
[0m14:25:25.007478 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:25:25.024663 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:25:25.056742 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m14:25:25.057324 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m14:25:25.057640 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m14:25:25.057937 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m14:25:25.058222 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:25:25.059820 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m14:25:25.060210 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m14:25:25.060567 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/all_listings_stg.sql
[0m14:25:25.061505 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/code_stg.sql
[0m14:25:25.062039 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/suburb_stg.sql
[0m14:25:25.134950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m14:25:25.139960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed30788f40>]}
[0m14:25:25.154169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed208866d0>]}
[0m14:25:25.154671 [info ] [MainThread]: Found 6 snapshots, 12 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m14:25:25.154996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed20886760>]}
[0m14:25:25.156830 [info ] [MainThread]: 
[0m14:25:25.157507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:25.158699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:25:25.159285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:25:25.172260 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:25:25.174338 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:25:25.174710 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:25:25.174989 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:25:25.175258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:25.175486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:25.753672 [debug] [ThreadPool]: SQL status: SELECT 15 in 1.0 seconds
[0m14:25:25.754358 [debug] [ThreadPool]: SQL status: SELECT 15 in 1.0 seconds
[0m14:25:25.758596 [debug] [ThreadPool]: On list_postgres: Close
[0m14:25:25.760464 [debug] [ThreadPool]: On list_postgres: Close
[0m14:25:25.768447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_warehouse)
[0m14:25:25.771904 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "warehouse"
"
[0m14:25:25.785874 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m14:25:25.786728 [debug] [ThreadPool]: On create_postgres_warehouse: BEGIN
[0m14:25:25.787433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:25.964507 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:25.965673 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m14:25:25.966556 [debug] [ThreadPool]: On create_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_warehouse"} */
create schema if not exists "warehouse"
[0m14:25:25.982702 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m14:25:25.985347 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m14:25:25.986191 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m14:25:25.986866 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m14:25:26.004179 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m14:25:26.005429 [debug] [ThreadPool]: On create_postgres_warehouse: Close
[0m14:25:26.012518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m14:25:26.015083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_warehouse, now list_postgres_warehouse)
[0m14:25:26.017094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m14:25:26.030810 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:25:26.032687 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m14:25:26.034157 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m14:25:26.034441 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:25:26.034727 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m14:25:26.035017 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m14:25:26.035268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:26.035502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:26.035724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:26.209478 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.211212 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:25:26.212387 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:25:26.226034 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.227637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.228884 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m14:25:26.230075 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m14:25:26.231593 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m14:25:26.232653 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m14:25:26.233852 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:25:26.236762 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:25:26.253442 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m14:25:26.254697 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:25:26.255828 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:25:26.259986 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m14:25:26.264434 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m14:25:26.279227 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m14:25:26.285817 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m14:25:26.292335 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:26.292781 [debug] [MainThread]: On master: BEGIN
[0m14:25:26.293020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:26.465732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.467290 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:26.468823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:26.493765 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:25:26.500115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed30788f40>]}
[0m14:25:26.501442 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:26.517631 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:26.518669 [debug] [MainThread]: On master: BEGIN
[0m14:25:26.557180 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.559265 [debug] [MainThread]: On master: COMMIT
[0m14:25:26.560733 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:26.562379 [debug] [MainThread]: On master: COMMIT
[0m14:25:26.578187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:25:26.580245 [debug] [MainThread]: On master: Close
[0m14:25:26.588046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:26.592493 [info ] [MainThread]: 
[0m14:25:26.604648 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m14:25:26.605778 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m14:25:26.606596 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m14:25:26.607662 [debug] [Thread-4  ]: Began running node model.bde.fact_stg
[0m14:25:26.609149 [info ] [Thread-1  ]: 1 of 12 START sql view model staging.code_stg .................................. [RUN]
[0m14:25:26.610483 [info ] [Thread-2  ]: 2 of 12 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m14:25:26.611927 [info ] [Thread-3  ]: 3 of 12 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m14:25:26.613839 [info ] [Thread-4  ]: 4 of 12 START sql view model staging.fact_stg .................................. [RUN]
[0m14:25:26.616172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.code_stg)
[0m14:25:26.618388 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.fact_census_G01)
[0m14:25:26.620072 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.fact_census_G02)
[0m14:25:26.621640 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.fact_stg'
[0m14:25:26.622629 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m14:25:26.623461 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m14:25:26.624270 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m14:25:26.625051 [debug] [Thread-4  ]: Began compiling node model.bde.fact_stg
[0m14:25:26.641590 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m14:25:26.645970 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m14:25:26.650232 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m14:25:26.656092 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_stg"
[0m14:25:26.658900 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 14:25:26.646530 => 14:25:26.658557
[0m14:25:26.659471 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 14:25:26.642314 => 14:25:26.659240
[0m14:25:26.660058 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m14:25:26.660521 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m14:25:26.661017 [debug] [Thread-4  ]: Timing info for model.bde.fact_stg (compile): 14:25:26.650774 => 14:25:26.660816
[0m14:25:26.661482 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 14:25:26.625653 => 14:25:26.661279
[0m14:25:26.698803 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m14:25:26.699700 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m14:25:26.700155 [debug] [Thread-4  ]: Began executing node model.bde.fact_stg
[0m14:25:26.700525 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m14:25:26.703914 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_stg"
[0m14:25:26.706811 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m14:25:26.707344 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:25:26.707683 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m14:25:26.707990 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:25:26.708474 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:25:26.708828 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:25:26.709134 [debug] [Thread-4  ]: On model.bde.fact_stg: BEGIN
[0m14:25:26.709424 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m14:25:26.709697 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:25:26.709960 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:25:26.710246 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:25:26.710534 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m14:25:26.710991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:26.871659 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.872293 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.872874 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:25:26.873350 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:25:26.873823 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m14:25:26.874296 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m14:25:26.883111 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.883732 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:25:26.884307 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */

  create view "postgres"."staging"."fact_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."fact_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        accommodates,
        price,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m14:25:26.884891 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:26.885459 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:25:26.886182 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m14:25:26.895570 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:26.902748 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:26.905552 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:25:26.906091 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:26.906499 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:26.910818 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:25:26.911299 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m14:25:26.969955 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:25:26.972448 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:25:26.972764 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m14:25:26.973153 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m14:25:26.973477 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg" rename to "fact_stg__dbt_backup"
[0m14:25:26.987157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:26.989687 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:25:26.990008 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m14:25:26.992072 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:26.998883 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.004753 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.005006 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m14:25:27.006150 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m14:25:27.006494 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.008630 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:25:27.008930 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:25:27.009197 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:25:27.011676 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m14:25:27.011979 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg__dbt_tmp" rename to "fact_stg"
[0m14:25:27.012386 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m14:25:27.012652 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m14:25:27.012910 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:25:27.013317 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m14:25:27.027364 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.028842 [debug] [Thread-4  ]: On model.bde.fact_stg: COMMIT
[0m14:25:27.029212 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:25:27.029512 [debug] [Thread-4  ]: On model.bde.fact_stg: COMMIT
[0m14:25:27.030961 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.031400 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.031698 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.038033 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:25:27.039970 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:25:27.041830 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:25:27.042130 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m14:25:27.042416 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m14:25:27.042689 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m14:25:27.050806 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.053739 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:25:27.054103 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
drop view if exists "postgres"."staging"."fact_stg__dbt_backup" cascade
[0m14:25:27.056578 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.056885 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.057134 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.058173 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 14:25:26.686809 => 14:25:27.058043
[0m14:25:27.059089 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 14:25:26.661807 => 14:25:27.058967
[0m14:25:27.059994 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 14:25:26.704183 => 14:25:27.059874
[0m14:25:27.060282 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m14:25:27.060556 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m14:25:27.060825 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m14:25:27.061520 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed10129b80>]}
[0m14:25:27.062125 [info ] [Thread-2  ]: 2 of 12 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.44s]
[0m14:25:27.062575 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m14:25:27.063077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed30808460>]}
[0m14:25:27.063559 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3074c0d0>]}
[0m14:25:27.063884 [debug] [Thread-2  ]: Began running node model.bde.host_stg
[0m14:25:27.064417 [info ] [Thread-3  ]: 3 of 12 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.44s]
[0m14:25:27.064790 [info ] [Thread-2  ]: 5 of 12 START sql view model staging.host_stg .................................. [RUN]
[0m14:25:27.065232 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m14:25:27.065584 [info ] [Thread-1  ]: 1 of 12 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.45s]
[0m14:25:27.066070 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.host_stg)
[0m14:25:27.066386 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m14:25:27.066906 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m14:25:27.067308 [debug] [Thread-2  ]: Began compiling node model.bde.host_stg
[0m14:25:27.067754 [info ] [Thread-3  ]: 6 of 12 START sql view model staging.listings_stg .............................. [RUN]
[0m14:25:27.068150 [debug] [Thread-1  ]: Began running node model.bde.property_stg
[0m14:25:27.070748 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.host_stg"
[0m14:25:27.071300 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.listings_stg)
[0m14:25:27.071604 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.071915 [info ] [Thread-1  ]: 7 of 12 START sql view model staging.property_stg .............................. [RUN]
[0m14:25:27.072308 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m14:25:27.073426 [debug] [Thread-4  ]: Timing info for model.bde.fact_stg (execute): 14:25:26.700970 => 14:25:27.073290
[0m14:25:27.073950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.property_stg)
[0m14:25:27.074309 [debug] [Thread-2  ]: Timing info for model.bde.host_stg (compile): 14:25:27.068456 => 14:25:27.074176
[0m14:25:27.076541 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m14:25:27.076862 [debug] [Thread-4  ]: On model.bde.fact_stg: Close
[0m14:25:27.077137 [debug] [Thread-1  ]: Began compiling node model.bde.property_stg
[0m14:25:27.077408 [debug] [Thread-2  ]: Began executing node model.bde.host_stg
[0m14:25:27.079973 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.property_stg"
[0m14:25:27.080426 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 14:25:27.074503 => 14:25:27.080280
[0m14:25:27.081065 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42ecff10>]}
[0m14:25:27.084255 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.host_stg"
[0m14:25:27.084689 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m14:25:27.085213 [info ] [Thread-4  ]: 4 of 12 OK created sql view model staging.fact_stg ............................. [[32mCREATE VIEW[0m in 0.46s]
[0m14:25:27.088237 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m14:25:27.088635 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (compile): 14:25:27.077807 => 14:25:27.088481
[0m14:25:27.089073 [debug] [Thread-4  ]: Finished running node model.bde.fact_stg
[0m14:25:27.089446 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m14:25:27.089739 [debug] [Thread-1  ]: Began executing node model.bde.property_stg
[0m14:25:27.090061 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m14:25:27.090414 [debug] [Thread-2  ]: On model.bde.host_stg: BEGIN
[0m14:25:27.090708 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m14:25:27.093761 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.property_stg"
[0m14:25:27.094206 [info ] [Thread-4  ]: 8 of 12 START sql view model staging.suburb_stg ................................ [RUN]
[0m14:25:27.094550 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:25:27.094856 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m14:25:27.095580 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_stg, now model.bde.suburb_stg)
[0m14:25:27.096133 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:25:27.096479 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m14:25:27.099493 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m14:25:27.099939 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m14:25:27.100345 [debug] [Thread-1  ]: On model.bde.property_stg: BEGIN
[0m14:25:27.100647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:27.101265 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 14:25:27.096810 => 14:25:27.101084
[0m14:25:27.101612 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m14:25:27.106293 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m14:25:27.106993 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:25:27.107281 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m14:25:27.107538 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:25:27.255811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.256489 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m14:25:27.256980 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m14:25:27.257486 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.257973 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.258498 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m14:25:27.258956 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m14:25:27.259456 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m14:25:27.260006 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m14:25:27.264688 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.265224 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:25:27.265731 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m14:25:27.277875 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.282324 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m14:25:27.282886 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.283397 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m14:25:27.287420 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m14:25:27.287883 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.288357 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.288857 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m14:25:27.292132 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m14:25:27.295459 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:25:27.295969 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m14:25:27.296399 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m14:25:27.306023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.309387 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m14:25:27.309810 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m14:25:27.310481 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.310894 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.311284 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.314155 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:25:27.317648 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m14:25:27.320479 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m14:25:27.320873 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m14:25:27.321228 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m14:25:27.321560 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m14:25:27.322294 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.323797 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m14:25:27.324139 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m14:25:27.324449 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m14:25:27.337314 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.337732 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.338088 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.339759 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m14:25:27.341263 [debug] [Thread-2  ]: On model.bde.host_stg: COMMIT
[0m14:25:27.344307 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m14:25:27.344671 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.345025 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m14:25:27.345369 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m14:25:27.345703 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:25:27.348201 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m14:25:27.348568 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m14:25:27.348886 [debug] [Thread-2  ]: On model.bde.host_stg: COMMIT
[0m14:25:27.349196 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m14:25:27.349513 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m14:25:27.364194 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.364544 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.364887 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.367343 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:25:27.369615 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m14:25:27.369960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.372184 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m14:25:27.372537 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m14:25:27.372868 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m14:25:27.374058 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (execute): 14:25:27.090916 => 14:25:27.373900
[0m14:25:27.374396 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m14:25:27.374845 [debug] [Thread-1  ]: On model.bde.property_stg: Close
[0m14:25:27.375731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed10118370>]}
[0m14:25:27.376313 [info ] [Thread-1  ]: 7 of 12 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m14:25:27.376882 [debug] [Thread-1  ]: Finished running node model.bde.property_stg
[0m14:25:27.377374 [debug] [Thread-1  ]: Began running node model.bde.dim_property
[0m14:25:27.377752 [info ] [Thread-1  ]: 9 of 12 START sql view model warehouse.dim_property ............................ [RUN]
[0m14:25:27.378262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_property)
[0m14:25:27.378565 [debug] [Thread-1  ]: Began compiling node model.bde.dim_property
[0m14:25:27.380931 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_property"
[0m14:25:27.381525 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (compile): 14:25:27.378783 => 14:25:27.381380
[0m14:25:27.381812 [debug] [Thread-1  ]: Began executing node model.bde.dim_property
[0m14:25:27.384822 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_property"
[0m14:25:27.385456 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m14:25:27.385748 [debug] [Thread-1  ]: On model.bde.dim_property: BEGIN
[0m14:25:27.386015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:27.390493 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.390775 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.391899 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 14:25:27.101835 => 14:25:27.391753
[0m14:25:27.392880 [debug] [Thread-2  ]: Timing info for model.bde.host_stg (execute): 14:25:27.081370 => 14:25:27.392750
[0m14:25:27.393200 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m14:25:27.393499 [debug] [Thread-2  ]: On model.bde.host_stg: Close
[0m14:25:27.394200 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42dcd820>]}
[0m14:25:27.394703 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42edd670>]}
[0m14:25:27.395203 [info ] [Thread-4  ]: 8 of 12 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m14:25:27.395978 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.396398 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m14:25:27.395680 [info ] [Thread-2  ]: 5 of 12 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m14:25:27.397574 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 14:25:27.085542 => 14:25:27.397444
[0m14:25:27.398055 [debug] [Thread-4  ]: Began running node model.bde.dim_lge_code_suburb
[0m14:25:27.398470 [debug] [Thread-2  ]: Finished running node model.bde.host_stg
[0m14:25:27.398773 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m14:25:27.399166 [info ] [Thread-4  ]: 10 of 12 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m14:25:27.399660 [debug] [Thread-2  ]: Began running node model.bde.dim_host
[0m14:25:27.400235 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_lge_code_suburb)
[0m14:25:27.400916 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42ed1040>]}
[0m14:25:27.401481 [info ] [Thread-2  ]: 11 of 12 START sql view model warehouse.dim_host ............................... [RUN]
[0m14:25:27.401835 [debug] [Thread-4  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m14:25:27.402259 [info ] [Thread-3  ]: 6 of 12 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m14:25:27.402799 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.dim_host)
[0m14:25:27.405301 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m14:25:27.405755 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m14:25:27.406038 [debug] [Thread-2  ]: Began compiling node model.bde.dim_host
[0m14:25:27.406565 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m14:25:27.408521 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_host"
[0m14:25:27.408928 [debug] [Thread-4  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 14:25:27.403015 => 14:25:27.408780
[0m14:25:27.409256 [info ] [Thread-3  ]: 12 of 12 START sql view model warehouse.fact_listing ........................... [RUN]
[0m14:25:27.409652 [debug] [Thread-4  ]: Began executing node model.bde.dim_lge_code_suburb
[0m14:25:27.410108 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_listing)
[0m14:25:27.414050 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m14:25:27.414393 [debug] [Thread-2  ]: Timing info for model.bde.dim_host (compile): 14:25:27.406774 => 14:25:27.414258
[0m14:25:27.414692 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m14:25:27.415048 [debug] [Thread-2  ]: Began executing node model.bde.dim_host
[0m14:25:27.417203 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m14:25:27.420192 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_host"
[0m14:25:27.420657 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:25:27.421165 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m14:25:27.421493 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:25:27.422156 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m14:25:27.422477 [debug] [Thread-2  ]: On model.bde.dim_host: BEGIN
[0m14:25:27.422887 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 14:25:27.415283 => 14:25:27.422702
[0m14:25:27.423172 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:25:27.423515 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m14:25:27.426784 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m14:25:27.427339 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m14:25:27.427630 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m14:25:27.427895 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:25:27.553145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.553630 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m14:25:27.553982 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m14:25:27.572882 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.575897 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m14:25:27.576313 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m14:25:27.585667 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.591483 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.596292 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m14:25:27.596745 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.598734 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m14:25:27.615293 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m14:25:27.615812 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:25:27.617160 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m14:25:27.617709 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lga_name = b.lga_name
  );
[0m14:25:27.618202 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m14:25:27.631682 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.635024 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m14:25:27.635480 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m14:25:27.636054 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.636500 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column a.lga_name does not exist
LINE 12: ON a.lga_name = b.lga_name
            ^
HINT:  Perhaps you meant to reference the column "a.lga_code".

[0m14:25:27.639068 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m14:25:27.639475 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: ROLLBACK
[0m14:25:27.639872 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m14:25:27.650071 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.651556 [debug] [Thread-2  ]: On model.bde.dim_host: COMMIT
[0m14:25:27.651982 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m14:25:27.652385 [debug] [Thread-2  ]: On model.bde.dim_host: COMMIT
[0m14:25:27.656515 [debug] [Thread-4  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 14:25:27.410346 => 14:25:27.656293
[0m14:25:27.656953 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.657386 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: Close
[0m14:25:27.658957 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (execute): 14:25:27.382017 => 14:25:27.658757
[0m14:25:27.659470 [debug] [Thread-1  ]: On model.bde.dim_property: Close
[0m14:25:27.660951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42e9c610>]}
[0m14:25:27.661806 [info ] [Thread-1  ]: 9 of 12 OK created sql view model warehouse.dim_property ....................... [[32mCREATE VIEW[0m in 0.28s]
[0m14:25:27.662601 [debug] [Thread-1  ]: Finished running node model.bde.dim_property
[0m14:25:27.666497 [debug] [Thread-4  ]: Database Error in model dim_lge_code_suburb (models/warehouse/dim_lge_code_suburb.sql)
  column a.lga_name does not exist
  LINE 12: ON a.lga_name = b.lga_name
              ^
  HINT:  Perhaps you meant to reference the column "a.lga_code".
  compiled Code at target/run/bde/models/warehouse/dim_lge_code_suburb.sql
[0m14:25:27.666960 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42e44250>]}
[0m14:25:27.667521 [error] [Thread-4  ]: 10 of 12 ERROR creating sql view model warehouse.dim_lge_code_suburb ........... [[31mERROR[0m in 0.27s]
[0m14:25:27.668132 [debug] [Thread-4  ]: Finished running node model.bde.dim_lge_code_suburb
[0m14:25:27.668767 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.671656 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m14:25:27.672062 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m14:25:27.674438 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.674842 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m14:25:27.675202 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m14:25:27.688132 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.689646 [debug] [Thread-2  ]: Timing info for model.bde.dim_host (execute): 14:25:27.417441 => 14:25:27.689443
[0m14:25:27.690063 [debug] [Thread-2  ]: On model.bde.dim_host: Close
[0m14:25:27.690938 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42e9c6d0>]}
[0m14:25:27.691534 [info ] [Thread-2  ]: 11 of 12 OK created sql view model warehouse.dim_host .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m14:25:27.692153 [debug] [Thread-2  ]: Finished running node model.bde.dim_host
[0m14:25:27.696309 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:27.700776 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m14:25:27.701217 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m14:25:27.716358 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:27.718044 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m14:25:27.718495 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m14:25:27.718903 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m14:25:27.736207 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.739621 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m14:25:27.740151 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m14:25:27.755056 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:27.757028 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 14:25:27.423863 => 14:25:27.756755
[0m14:25:27.757635 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m14:25:27.758865 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7878c7dd-651b-44d8-b1bb-71d3e274db32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42ed1040>]}
[0m14:25:27.759741 [info ] [Thread-3  ]: 12 of 12 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.35s]
[0m14:25:27.760642 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m14:25:27.762595 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.763118 [debug] [MainThread]: On master: BEGIN
[0m14:25:27.763588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:27.945056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:27.947828 [debug] [MainThread]: On master: COMMIT
[0m14:25:27.949434 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:27.950912 [debug] [MainThread]: On master: COMMIT
[0m14:25:27.965147 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:25:27.967014 [debug] [MainThread]: On master: Close
[0m14:25:27.971215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:27.972692 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m14:25:27.974044 [debug] [MainThread]: Connection 'model.bde.dim_host' was properly closed.
[0m14:25:27.975446 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m14:25:27.976758 [debug] [MainThread]: Connection 'model.bde.dim_lge_code_suburb' was properly closed.
[0m14:25:27.978870 [info ] [MainThread]: 
[0m14:25:27.980343 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m14:25:27.988225 [debug] [MainThread]: Command end result
[0m14:25:28.008828 [info ] [MainThread]: 
[0m14:25:28.009757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:25:28.010355 [info ] [MainThread]: 
[0m14:25:28.010945 [error] [MainThread]:   Database Error in model dim_lge_code_suburb (models/warehouse/dim_lge_code_suburb.sql)
  column a.lga_name does not exist
  LINE 12: ON a.lga_name = b.lga_name
              ^
  HINT:  Perhaps you meant to reference the column "a.lga_code".
  compiled Code at target/run/bde/models/warehouse/dim_lge_code_suburb.sql
[0m14:25:28.011579 [info ] [MainThread]: 
[0m14:25:28.012233 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m14:25:28.013381 [debug] [MainThread]: Command `dbt run` failed at 14:25:28.013208 after 3.16 seconds
[0m14:25:28.014126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40cb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed42eb37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed30808370>]}
[0m14:25:28.014837 [debug] [MainThread]: Flushing usage events
[0m14:27:40.054653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c40bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c43099850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c43099940>]}


============================== 14:27:40.058865 | 1e7a18b2-d9c7-44f8-b664-799b2908ada1 ==============================
[0m14:27:40.058865 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:27:40.059556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:27:40.198466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c43099880>]}
[0m14:27:40.209079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c431522b0>]}
[0m14:27:40.209608 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:27:40.225937 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:27:40.261561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:40.262186 [debug] [MainThread]: Partial parsing: updated file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:27:40.292660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m14:27:40.297081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c431d8e80>]}
[0m14:27:40.311184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c20138220>]}
[0m14:27:40.311625 [info ] [MainThread]: Found 6 snapshots, 12 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m14:27:40.311922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c20138040>]}
[0m14:27:40.313572 [info ] [MainThread]: 
[0m14:27:40.314216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:40.315472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:27:40.322441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:27:40.324147 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:27:40.325723 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:27:40.326022 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:27:40.326302 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:27:40.326568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:40.326799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:40.572062 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m14:27:40.572777 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m14:27:40.575369 [debug] [ThreadPool]: On list_postgres: Close
[0m14:27:40.577086 [debug] [ThreadPool]: On list_postgres: Close
[0m14:27:40.581405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m14:27:40.582360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m14:27:40.589647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_warehouse'
[0m14:27:40.591451 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m14:27:40.594735 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:27:40.596890 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m14:27:40.597308 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m14:27:40.597698 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:27:40.598061 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m14:27:40.598414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:40.598762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:40.599099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:40.780885 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:27:40.782109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:27:40.783175 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m14:27:40.783938 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:27:40.784786 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m14:27:40.785675 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:27:40.786745 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:27:40.787469 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m14:27:40.788245 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m14:27:40.808894 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:27:40.809743 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m14:27:40.813208 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:27:40.813943 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:27:40.816689 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m14:27:40.819256 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m14:27:40.831800 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:27:40.836883 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m14:27:40.837536 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m14:27:40.853391 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:40.854080 [debug] [MainThread]: On master: BEGIN
[0m14:27:40.854674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:41.031663 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.033727 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:41.035022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:41.060601 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m14:27:41.071205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30a5fd30>]}
[0m14:27:41.072358 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:41.086465 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:41.087156 [debug] [MainThread]: On master: BEGIN
[0m14:27:41.119494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.120722 [debug] [MainThread]: On master: COMMIT
[0m14:27:41.121448 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:41.122542 [debug] [MainThread]: On master: COMMIT
[0m14:27:41.138540 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.139909 [debug] [MainThread]: On master: Close
[0m14:27:41.142841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:41.144037 [info ] [MainThread]: 
[0m14:27:41.151128 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m14:27:41.152112 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m14:27:41.153107 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m14:27:41.154169 [info ] [Thread-1  ]: 1 of 12 START sql view model staging.code_stg .................................. [RUN]
[0m14:27:41.155063 [debug] [Thread-4  ]: Began running node model.bde.fact_stg
[0m14:27:41.155898 [info ] [Thread-2  ]: 2 of 12 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m14:27:41.156757 [info ] [Thread-3  ]: 3 of 12 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m14:27:41.157961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m14:27:41.158756 [info ] [Thread-4  ]: 4 of 12 START sql view model staging.fact_stg .................................. [RUN]
[0m14:27:41.159905 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G01)
[0m14:27:41.161149 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.fact_census_G02)
[0m14:27:41.162066 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m14:27:41.163367 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.fact_stg'
[0m14:27:41.164098 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m14:27:41.164763 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m14:27:41.178012 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m14:27:41.178573 [debug] [Thread-4  ]: Began compiling node model.bde.fact_stg
[0m14:27:41.182549 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m14:27:41.186665 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m14:27:41.190374 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_stg"
[0m14:27:41.191441 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 14:27:41.165272 => 14:27:41.191174
[0m14:27:41.192130 [debug] [Thread-4  ]: Timing info for model.bde.fact_stg (compile): 14:27:41.187243 => 14:27:41.191919
[0m14:27:41.192555 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m14:27:41.193080 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 14:27:41.183073 => 14:27:41.192848
[0m14:27:41.193586 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 14:27:41.178970 => 14:27:41.193380
[0m14:27:41.194041 [debug] [Thread-4  ]: Began executing node model.bde.fact_stg
[0m14:27:41.219941 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m14:27:41.229372 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m14:27:41.229789 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m14:27:41.232911 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_stg"
[0m14:27:41.235818 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m14:27:41.239063 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m14:27:41.239889 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:27:41.240228 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:27:41.240532 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:27:41.240808 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:27:41.241091 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m14:27:41.241394 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m14:27:41.241710 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m14:27:41.241997 [debug] [Thread-4  ]: On model.bde.fact_stg: BEGIN
[0m14:27:41.242269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:41.242547 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:27:41.242814 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:27:41.243071 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:27:41.413084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.413913 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:27:41.414551 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m14:27:41.417110 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.417670 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:27:41.418277 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */

  create view "postgres"."staging"."fact_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."fact_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        accommodates,
        price,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m14:27:41.423634 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.424188 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:27:41.424750 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m14:27:41.425355 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.426063 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:27:41.426633 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m14:27:41.435263 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.435839 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.445840 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:27:41.446449 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.450760 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:27:41.451305 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.451838 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m14:27:41.455829 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:27:41.456319 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg" rename to "fact_stg__dbt_backup"
[0m14:27:41.460700 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:27:41.461270 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02" rename to "fact_census_G02__dbt_backup"
[0m14:27:41.461823 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01" rename to "fact_census_G01__dbt_backup"
[0m14:27:41.475236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.513608 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.514004 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.514297 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.516445 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:27:41.518746 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:27:41.520903 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:27:41.522964 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:27:41.523274 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m14:27:41.523574 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m14:27:41.523873 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m14:27:41.524156 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg__dbt_tmp" rename to "fact_stg"
[0m14:27:41.538551 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.546691 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.547071 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.553666 [debug] [Thread-4  ]: On model.bde.fact_stg: COMMIT
[0m14:27:41.554011 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.555298 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m14:27:41.556572 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m14:27:41.556896 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:27:41.558161 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m14:27:41.558478 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:27:41.558785 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:27:41.559079 [debug] [Thread-4  ]: On model.bde.fact_stg: COMMIT
[0m14:27:41.559369 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:27:41.559658 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m14:27:41.559944 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m14:27:41.560274 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m14:27:41.576403 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.584030 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:27:41.584389 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.584720 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.585015 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
drop view if exists "postgres"."staging"."fact_stg__dbt_backup" cascade
[0m14:27:41.585306 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.587559 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:27:41.589713 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:27:41.592799 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:27:41.593149 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m14:27:41.593479 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m14:27:41.593798 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m14:27:41.605465 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.606778 [debug] [Thread-4  ]: Timing info for model.bde.fact_stg (execute): 14:27:41.230028 => 14:27:41.606601
[0m14:27:41.607167 [debug] [Thread-4  ]: On model.bde.fact_stg: Close
[0m14:27:41.607937 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30b81fa0>]}
[0m14:27:41.608680 [info ] [Thread-4  ]: 4 of 12 OK created sql view model staging.fact_stg ............................. [[32mCREATE VIEW[0m in 0.45s]
[0m14:27:41.609224 [debug] [Thread-4  ]: Finished running node model.bde.fact_stg
[0m14:27:41.609568 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.609944 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m14:27:41.610247 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.611439 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 14:27:41.194385 => 14:27:41.611281
[0m14:27:41.611839 [info ] [Thread-4  ]: 5 of 12 START sql view model staging.host_stg .................................. [RUN]
[0m14:27:41.613039 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 14:27:41.233160 => 14:27:41.612878
[0m14:27:41.613376 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.613710 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m14:27:41.614241 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_stg, now model.bde.host_stg)
[0m14:27:41.614580 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m14:27:41.615731 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 14:27:41.236154 => 14:27:41.615585
[0m14:27:41.616122 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m14:27:41.616687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c432bbbb0>]}
[0m14:27:41.617089 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m14:27:41.617633 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30ba0be0>]}
[0m14:27:41.620197 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m14:27:41.620725 [info ] [Thread-1  ]: 1 of 12 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.46s]
[0m14:27:41.621236 [info ] [Thread-3  ]: 3 of 12 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.46s]
[0m14:27:41.621786 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30ba9820>]}
[0m14:27:41.622356 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m14:27:41.622827 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m14:27:41.623296 [info ] [Thread-2  ]: 2 of 12 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.46s]
[0m14:27:41.623687 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 14:27:41.617881 => 14:27:41.623540
[0m14:27:41.624042 [debug] [Thread-1  ]: Began running node model.bde.listings_stg
[0m14:27:41.624432 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m14:27:41.624933 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m14:27:41.625240 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m14:27:41.625576 [info ] [Thread-1  ]: 6 of 12 START sql view model staging.listings_stg .............................. [RUN]
[0m14:27:41.626000 [info ] [Thread-3  ]: 7 of 12 START sql view model staging.property_stg .............................. [RUN]
[0m14:27:41.626388 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m14:27:41.629622 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m14:27:41.630259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.listings_stg)
[0m14:27:41.630754 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.property_stg)
[0m14:27:41.631266 [info ] [Thread-2  ]: 8 of 12 START sql view model staging.suburb_stg ................................ [RUN]
[0m14:27:41.631748 [debug] [Thread-1  ]: Began compiling node model.bde.listings_stg
[0m14:27:41.632069 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m14:27:41.632581 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.suburb_stg)
[0m14:27:41.635094 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m14:27:41.635447 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m14:27:41.637631 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m14:27:41.637966 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m14:27:41.638380 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m14:27:41.640763 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m14:27:41.641160 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (compile): 14:27:41.632830 => 14:27:41.641008
[0m14:27:41.641457 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:27:41.641806 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 14:27:41.635680 => 14:27:41.641652
[0m14:27:41.642218 [debug] [Thread-1  ]: Began executing node model.bde.listings_stg
[0m14:27:41.642657 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m14:27:41.645644 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m14:27:41.646021 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 14:27:41.638724 => 14:27:41.645879
[0m14:27:41.648969 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m14:27:41.649445 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m14:27:41.653958 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m14:27:41.654642 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:27:41.654998 [debug] [Thread-1  ]: On model.bde.listings_stg: BEGIN
[0m14:27:41.655340 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:27:41.655630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:41.655911 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m14:27:41.656190 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m14:27:41.656572 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m14:27:41.656852 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:27:41.657116 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:27:41.809597 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.810256 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m14:27:41.810763 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m14:27:41.829233 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.833706 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m14:27:41.834189 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.834711 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m14:27:41.835183 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m14:27:41.835732 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m14:27:41.836343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.836814 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:27:41.837300 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m14:27:41.838770 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:41.839194 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:27:41.839639 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m14:27:41.850951 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.854210 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m14:27:41.854671 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.855092 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m14:27:41.858780 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m14:27:41.859229 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.859647 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:41.860155 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m14:27:41.863497 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:27:41.866673 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:27:41.867157 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m14:27:41.867575 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m14:27:41.879435 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.881133 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m14:27:41.881531 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m14:27:41.881896 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m14:27:41.882464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.883004 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.885830 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:27:41.886209 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.888994 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m14:27:41.889379 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m14:27:41.892944 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:27:41.893335 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m14:27:41.893754 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m14:27:41.898061 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.900485 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m14:27:41.900863 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m14:27:41.907557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.909018 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m14:27:41.909384 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:27:41.909720 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m14:27:41.911527 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.911893 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:41.913353 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m14:27:41.914831 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m14:27:41.915202 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m14:27:41.915570 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:27:41.915913 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m14:27:41.916251 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m14:27:41.916748 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.917921 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 14:27:41.626631 => 14:27:41.917764
[0m14:27:41.918261 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m14:27:41.919006 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4330ed60>]}
[0m14:27:41.919514 [info ] [Thread-4  ]: 5 of 12 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.30s]
[0m14:27:41.920030 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m14:27:41.920527 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m14:27:41.920914 [info ] [Thread-4  ]: 9 of 12 START sql view model warehouse.dim_host ................................ [RUN]
[0m14:27:41.921488 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.dim_host)
[0m14:27:41.921812 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m14:27:41.924491 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m14:27:41.925180 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 14:27:41.922041 => 14:27:41.925019
[0m14:27:41.925491 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m14:27:41.928627 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m14:27:41.929029 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.931337 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:27:41.931686 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m14:27:41.932050 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.934108 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m14:27:41.934461 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:41.934827 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m14:27:41.936836 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:27:41.937150 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m14:27:41.937530 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m14:27:41.937851 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m14:27:41.938169 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:27:41.951606 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.953288 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (execute): 14:27:41.642887 => 14:27:41.953115
[0m14:27:41.953663 [debug] [Thread-1  ]: On model.bde.listings_stg: Close
[0m14:27:41.954531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30bd90a0>]}
[0m14:27:41.955072 [info ] [Thread-1  ]: 6 of 12 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m14:27:41.955574 [debug] [Thread-1  ]: Finished running node model.bde.listings_stg
[0m14:27:41.956044 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m14:27:41.956405 [info ] [Thread-1  ]: 10 of 12 START sql view model warehouse.fact_listing ........................... [RUN]
[0m14:27:41.956934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_listing)
[0m14:27:41.957252 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m14:27:41.957575 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.957874 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:41.960354 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m14:27:41.961531 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 14:27:41.646210 => 14:27:41.961379
[0m14:27:41.962794 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 14:27:41.649751 => 14:27:41.962631
[0m14:27:41.963345 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m14:27:41.963767 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m14:27:41.964617 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4317ae80>]}
[0m14:27:41.965050 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 14:27:41.958102 => 14:27:41.964871
[0m14:27:41.965576 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30b81370>]}
[0m14:27:41.965900 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m14:27:41.966318 [info ] [Thread-3  ]: 7 of 12 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m14:27:41.966778 [info ] [Thread-2  ]: 8 of 12 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m14:27:41.970836 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m14:27:41.971324 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m14:27:41.971739 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m14:27:41.972325 [debug] [Thread-3  ]: Began running node model.bde.dim_property
[0m14:27:41.972672 [debug] [Thread-2  ]: Began running node model.bde.dim_lge_code_suburb
[0m14:27:41.972979 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:27:41.973301 [info ] [Thread-3  ]: 11 of 12 START sql view model warehouse.dim_property ........................... [RUN]
[0m14:27:41.973719 [info ] [Thread-2  ]: 12 of 12 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m14:27:41.974110 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m14:27:41.974612 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_property)
[0m14:27:41.975099 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_lge_code_suburb)
[0m14:27:41.975394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:41.975699 [debug] [Thread-3  ]: Began compiling node model.bde.dim_property
[0m14:27:41.976213 [debug] [Thread-2  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m14:27:41.978493 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_property"
[0m14:27:41.980788 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m14:27:41.981537 [debug] [Thread-2  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 14:27:41.978736 => 14:27:41.981366
[0m14:27:41.981847 [debug] [Thread-2  ]: Began executing node model.bde.dim_lge_code_suburb
[0m14:27:41.982182 [debug] [Thread-3  ]: Timing info for model.bde.dim_property (compile): 14:27:41.976526 => 14:27:41.982038
[0m14:27:41.985533 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m14:27:41.985960 [debug] [Thread-3  ]: Began executing node model.bde.dim_property
[0m14:27:41.988803 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_property"
[0m14:27:41.989281 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:27:41.989594 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m14:27:41.989866 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m14:27:41.990138 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:27:41.990424 [debug] [Thread-3  ]: On model.bde.dim_property: BEGIN
[0m14:27:41.990783 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:27:42.096833 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:42.097351 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m14:27:42.097730 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m14:27:42.116137 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:42.119140 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m14:27:42.119615 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m14:27:42.133803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:42.134193 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:42.134578 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:27:42.136018 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m14:27:42.136426 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m14:27:42.136800 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m14:27:42.137200 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m14:27:42.146519 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:42.146901 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m14:27:42.147279 [debug] [Thread-3  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m14:27:42.148845 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:42.149231 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:27:42.149633 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m14:27:42.151642 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:42.154402 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m14:27:42.154826 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:42.155195 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m14:27:42.157933 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:27:42.158371 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m14:27:42.166570 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:42.170104 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m14:27:42.170524 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column b.suburb_name does not exist
LINE 9: SELECT a.lga_code, b.lowercase_lga_name, b.suburb_name 
                                                 ^

[0m14:27:42.170918 [debug] [Thread-3  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m14:27:42.171289 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: ROLLBACK
[0m14:27:42.173664 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:42.174943 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 14:27:41.925714 => 14:27:42.174773
[0m14:27:42.175325 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m14:27:42.175717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:42.176373 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30b9cd90>]}
[0m14:27:42.177711 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m14:27:42.178270 [info ] [Thread-4  ]: 9 of 12 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:27:42.178682 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:27:42.179201 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m14:27:42.179557 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m14:27:42.185369 [debug] [Thread-2  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 14:27:41.982411 => 14:27:42.185179
[0m14:27:42.185747 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:42.186108 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: Close
[0m14:27:42.187501 [debug] [Thread-3  ]: On model.bde.dim_property: COMMIT
[0m14:27:42.187933 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m14:27:42.188725 [debug] [Thread-3  ]: On model.bde.dim_property: COMMIT
[0m14:27:42.193112 [debug] [Thread-2  ]: Database Error in model dim_lge_code_suburb (models/warehouse/dim_lge_code_suburb.sql)
  column b.suburb_name does not exist
  LINE 9: SELECT a.lga_code, b.lowercase_lga_name, b.suburb_name 
                                                   ^
  compiled Code at target/run/bde/models/warehouse/dim_lge_code_suburb.sql
[0m14:27:42.193522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30a98700>]}
[0m14:27:42.194025 [error] [Thread-2  ]: 12 of 12 ERROR creating sql view model warehouse.dim_lge_code_suburb ........... [[31mERROR[0m in 0.22s]
[0m14:27:42.194555 [debug] [Thread-2  ]: Finished running node model.bde.dim_lge_code_suburb
[0m14:27:42.196737 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:42.199646 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:27:42.200111 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m14:27:42.206484 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:27:42.208775 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m14:27:42.209141 [debug] [Thread-3  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m14:27:42.214760 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:42.216206 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 14:27:41.967037 => 14:27:42.216029
[0m14:27:42.216640 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m14:27:42.217462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30bd90a0>]}
[0m14:27:42.217994 [info ] [Thread-1  ]: 10 of 12 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:27:42.218515 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m14:27:42.225112 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:42.226420 [debug] [Thread-3  ]: Timing info for model.bde.dim_property (execute): 14:27:41.986241 => 14:27:42.226259
[0m14:27:42.226776 [debug] [Thread-3  ]: On model.bde.dim_property: Close
[0m14:27:42.227487 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7a18b2-d9c7-44f8-b664-799b2908ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c431a2580>]}
[0m14:27:42.227972 [info ] [Thread-3  ]: 11 of 12 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:27:42.228466 [debug] [Thread-3  ]: Finished running node model.bde.dim_property
[0m14:27:42.229640 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:42.229964 [debug] [MainThread]: On master: BEGIN
[0m14:27:42.230238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:42.400758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:42.401397 [debug] [MainThread]: On master: COMMIT
[0m14:27:42.401831 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:42.402244 [debug] [MainThread]: On master: COMMIT
[0m14:27:42.418203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:27:42.418638 [debug] [MainThread]: On master: Close
[0m14:27:42.419693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:42.420106 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m14:27:42.420494 [debug] [MainThread]: Connection 'model.bde.dim_lge_code_suburb' was properly closed.
[0m14:27:42.420872 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m14:27:42.421226 [debug] [MainThread]: Connection 'model.bde.dim_host' was properly closed.
[0m14:27:42.421733 [info ] [MainThread]: 
[0m14:27:42.422210 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m14:27:42.425135 [debug] [MainThread]: Command end result
[0m14:27:42.435293 [info ] [MainThread]: 
[0m14:27:42.435812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:42.436183 [info ] [MainThread]: 
[0m14:27:42.436532 [error] [MainThread]:   Database Error in model dim_lge_code_suburb (models/warehouse/dim_lge_code_suburb.sql)
  column b.suburb_name does not exist
  LINE 9: SELECT a.lga_code, b.lowercase_lga_name, b.suburb_name 
                                                   ^
  compiled Code at target/run/bde/models/warehouse/dim_lge_code_suburb.sql
[0m14:27:42.436891 [info ] [MainThread]: 
[0m14:27:42.437247 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m14:27:42.437891 [debug] [MainThread]: Command `dbt run` failed at 14:27:42.437793 after 2.41 seconds
[0m14:27:42.438313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c40bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c43099670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c4331fa00>]}
[0m14:27:42.438719 [debug] [MainThread]: Flushing usage events
[0m14:28:28.845174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc0b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3211820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3211910>]}


============================== 14:28:28.849004 | 03b3e276-a814-444c-aa03-1fff632280f7 ==============================
[0m14:28:28.849004 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:28:28.849643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:28:28.952046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3211850>]}
[0m14:28:28.962973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3339280>]}
[0m14:28:28.963507 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:28:28.980460 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:28:29.019050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:29.019670 [debug] [MainThread]: Partial parsing: updated file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m14:28:29.050273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m14:28:29.054461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd09d1f40>]}
[0m14:28:29.068825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb0070580>]}
[0m14:28:29.069270 [info ] [MainThread]: Found 6 snapshots, 12 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m14:28:29.069563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb00a43a0>]}
[0m14:28:29.071174 [info ] [MainThread]: 
[0m14:28:29.071766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:29.072960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:28:29.079781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:28:29.081081 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:28:29.082971 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:28:29.083353 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:28:29.083648 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:28:29.083981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:29.084285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:29.317449 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m14:28:29.318205 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m14:28:29.320949 [debug] [ThreadPool]: On list_postgres: Close
[0m14:28:29.322623 [debug] [ThreadPool]: On list_postgres: Close
[0m14:28:29.326403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m14:28:29.327426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m14:28:29.335548 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m14:28:29.336331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_warehouse'
[0m14:28:29.339561 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:28:29.339998 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m14:28:29.341865 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m14:28:29.342236 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m14:28:29.342563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:29.342890 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m14:28:29.343205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:29.343695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:29.535115 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:28:29.535910 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:28:29.536612 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:28:29.537191 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m14:28:29.537788 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m14:28:29.538387 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m14:28:29.539027 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m14:28:29.539725 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m14:28:29.540421 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m14:28:29.568584 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:28:29.569268 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m14:28:29.572219 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m14:28:29.572977 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:28:29.575791 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m14:28:29.578443 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m14:28:29.592937 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m14:28:29.600526 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m14:28:29.601184 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m14:28:29.617509 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:29.618237 [debug] [MainThread]: On master: BEGIN
[0m14:28:29.618804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:29.799656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:28:29.802082 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:29.803720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:29.838751 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m14:28:29.852438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd09bfee0>]}
[0m14:28:29.853658 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:29.867273 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:29.867981 [debug] [MainThread]: On master: BEGIN
[0m14:28:29.898813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:28:29.900415 [debug] [MainThread]: On master: COMMIT
[0m14:28:29.901651 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:29.902575 [debug] [MainThread]: On master: COMMIT
[0m14:28:29.917368 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:28:29.918288 [debug] [MainThread]: On master: Close
[0m14:28:29.920940 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:29.922206 [info ] [MainThread]: 
[0m14:28:29.929264 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m14:28:29.930230 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m14:28:29.931207 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m14:28:29.932247 [info ] [Thread-1  ]: 1 of 12 START sql view model staging.code_stg .................................. [RUN]
[0m14:28:29.933182 [debug] [Thread-4  ]: Began running node model.bde.fact_stg
[0m14:28:29.934082 [info ] [Thread-2  ]: 2 of 12 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m14:28:29.934945 [info ] [Thread-3  ]: 3 of 12 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m14:28:29.936189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m14:28:29.937035 [info ] [Thread-4  ]: 4 of 12 START sql view model staging.fact_stg .................................. [RUN]
[0m14:28:29.938156 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G01)
[0m14:28:29.939221 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.fact_census_G02)
[0m14:28:29.939959 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m14:28:29.941143 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.fact_stg'
[0m14:28:29.941802 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m14:28:29.942451 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m14:28:29.955431 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m14:28:29.956213 [debug] [Thread-4  ]: Began compiling node model.bde.fact_stg
[0m14:28:29.959759 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m14:28:29.963409 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m14:28:29.967853 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_stg"
[0m14:28:29.968905 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 14:28:29.942940 => 14:28:29.968571
[0m14:28:29.969575 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m14:28:29.970116 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 14:28:29.960186 => 14:28:29.969904
[0m14:28:29.970702 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 14:28:29.956597 => 14:28:29.970468
[0m14:28:29.984846 [debug] [Thread-4  ]: Timing info for model.bde.fact_stg (compile): 14:28:29.964125 => 14:28:29.984563
[0m14:28:30.004110 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m14:28:30.005957 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m14:28:30.006325 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m14:28:30.006647 [debug] [Thread-4  ]: Began executing node model.bde.fact_stg
[0m14:28:30.009807 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m14:28:30.012882 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m14:28:30.016023 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_stg"
[0m14:28:30.016451 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:28:30.016939 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:28:30.017294 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m14:28:30.017620 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m14:28:30.017898 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:28:30.018193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:30.018493 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:28:30.018783 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:28:30.019061 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m14:28:30.019449 [debug] [Thread-4  ]: On model.bde.fact_stg: BEGIN
[0m14:28:30.019837 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:28:30.020124 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:28:30.195162 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.195985 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.196592 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.197234 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:28:30.197807 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:28:30.198369 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:28:30.198987 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m14:28:30.199596 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m14:28:30.200216 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.200732 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m14:28:30.201405 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:28:30.202033 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */

  create view "postgres"."staging"."fact_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."fact_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        accommodates,
        price,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m14:28:30.216756 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.217330 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.224263 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.227478 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:28:30.227986 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.232355 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:28:30.235997 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:28:30.236486 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02" rename to "fact_census_G02__dbt_backup"
[0m14:28:30.240889 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:28:30.241367 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m14:28:30.241815 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg" rename to "fact_stg__dbt_backup"
[0m14:28:30.242349 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01" rename to "fact_census_G01__dbt_backup"
[0m14:28:30.257023 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.257469 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.296934 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.298544 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:28:30.298871 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.301207 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:28:30.303406 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:28:30.303720 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m14:28:30.305776 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:28:30.306083 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m14:28:30.306372 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
alter table "postgres"."staging"."fact_stg__dbt_tmp" rename to "fact_stg"
[0m14:28:30.306728 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m14:28:30.320837 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.333705 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.334033 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.335852 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m14:28:30.336157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.337439 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m14:28:30.338719 [debug] [Thread-4  ]: On model.bde.fact_stg: COMMIT
[0m14:28:30.339047 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:28:30.340327 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m14:28:30.340645 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:28:30.340929 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:28:30.341208 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m14:28:30.341483 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:28:30.341755 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m14:28:30.342017 [debug] [Thread-4  ]: On model.bde.fact_stg: COMMIT
[0m14:28:30.342325 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m14:28:30.356502 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.364276 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m14:28:30.364641 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.364983 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.365297 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m14:28:30.365597 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.367856 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_stg"
[0m14:28:30.369987 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m14:28:30.373154 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m14:28:30.373500 [debug] [Thread-4  ]: On model.bde.fact_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_stg"} */
drop view if exists "postgres"."staging"."fact_stg__dbt_backup" cascade
[0m14:28:30.373829 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m14:28:30.374149 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m14:28:30.386983 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.388292 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 14:28:30.006872 => 14:28:30.388116
[0m14:28:30.388665 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m14:28:30.389443 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc33965b0>]}
[0m14:28:30.390235 [info ] [Thread-3  ]: 3 of 12 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.45s]
[0m14:28:30.390660 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.391150 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m14:28:30.391485 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.391790 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.392897 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 14:28:29.971026 => 14:28:30.392742
[0m14:28:30.393299 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m14:28:30.394507 [debug] [Thread-4  ]: Timing info for model.bde.fact_stg (execute): 14:28:30.013177 => 14:28:30.394356
[0m14:28:30.395626 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 14:28:30.010128 => 14:28:30.395473
[0m14:28:30.395975 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m14:28:30.396359 [info ] [Thread-3  ]: 5 of 12 START sql view model staging.host_stg .................................. [RUN]
[0m14:28:30.396723 [debug] [Thread-4  ]: On model.bde.fact_stg: Close
[0m14:28:30.397049 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m14:28:30.397646 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.host_stg)
[0m14:28:30.398244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc334c790>]}
[0m14:28:30.398676 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m14:28:30.399206 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd09bc1c0>]}
[0m14:28:30.399754 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd0b1fac0>]}
[0m14:28:30.400202 [info ] [Thread-1  ]: 1 of 12 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.46s]
[0m14:28:30.402907 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m14:28:30.403471 [info ] [Thread-2  ]: 2 of 12 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.46s]
[0m14:28:30.403961 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m14:28:30.404344 [info ] [Thread-4  ]: 4 of 12 OK created sql view model staging.fact_stg ............................. [[32mCREATE VIEW[0m in 0.46s]
[0m14:28:30.404912 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m14:28:30.405281 [debug] [Thread-1  ]: Began running node model.bde.listings_stg
[0m14:28:30.405767 [debug] [Thread-4  ]: Finished running node model.bde.fact_stg
[0m14:28:30.406159 [debug] [Thread-2  ]: Began running node model.bde.property_stg
[0m14:28:30.406534 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 14:28:30.400479 => 14:28:30.406386
[0m14:28:30.406921 [info ] [Thread-1  ]: 6 of 12 START sql view model staging.listings_stg .............................. [RUN]
[0m14:28:30.407306 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m14:28:30.407688 [info ] [Thread-2  ]: 7 of 12 START sql view model staging.property_stg .............................. [RUN]
[0m14:28:30.408047 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m14:28:30.408590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.listings_stg)
[0m14:28:30.408970 [info ] [Thread-4  ]: 8 of 12 START sql view model staging.suburb_stg ................................ [RUN]
[0m14:28:30.409453 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.property_stg)
[0m14:28:30.412618 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m14:28:30.412944 [debug] [Thread-1  ]: Began compiling node model.bde.listings_stg
[0m14:28:30.413399 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_stg, now model.bde.suburb_stg)
[0m14:28:30.413696 [debug] [Thread-2  ]: Began compiling node model.bde.property_stg
[0m14:28:30.416245 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m14:28:30.416763 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m14:28:30.417181 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m14:28:30.419666 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.property_stg"
[0m14:28:30.421966 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m14:28:30.422289 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m14:28:30.422777 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (compile): 14:28:30.413992 => 14:28:30.422621
[0m14:28:30.423126 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:28:30.423498 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (compile): 14:28:30.417422 => 14:28:30.423360
[0m14:28:30.423769 [debug] [Thread-1  ]: Began executing node model.bde.listings_stg
[0m14:28:30.424234 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 14:28:30.420023 => 14:28:30.424090
[0m14:28:30.424524 [debug] [Thread-2  ]: Began executing node model.bde.property_stg
[0m14:28:30.427506 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m14:28:30.427815 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m14:28:30.430774 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.property_stg"
[0m14:28:30.435389 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m14:28:30.435948 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:28:30.436311 [debug] [Thread-1  ]: On model.bde.listings_stg: BEGIN
[0m14:28:30.436627 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m14:28:30.436941 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:28:30.437238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:30.437559 [debug] [Thread-2  ]: On model.bde.property_stg: BEGIN
[0m14:28:30.437879 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m14:28:30.438293 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:28:30.438591 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:28:30.590964 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.591702 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m14:28:30.592291 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m14:28:30.611715 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.616631 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m14:28:30.617183 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m14:28:30.617771 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.618289 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.618805 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.619474 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:28:30.619982 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:28:30.620507 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m14:28:30.621027 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m14:28:30.621619 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"

),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as lower_listing_neighbourhood,
        accommodates,
        price,
        has_availability, 
        availability_30, 
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source

    --where price > 5
)



select * from to_date_format
  );
[0m14:28:30.622139 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,   
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m14:28:30.631703 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.635559 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m14:28:30.636086 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m14:28:30.636870 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.640710 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:28:30.641151 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.641598 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.642024 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m14:28:30.645694 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m14:28:30.648999 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:28:30.649471 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m14:28:30.649882 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.650262 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m14:28:30.652022 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m14:28:30.652498 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m14:28:30.652875 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m14:28:30.662927 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.665960 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:28:30.666397 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m14:28:30.669756 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.670158 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.670514 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.673395 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:28:30.677366 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m14:28:30.679911 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m14:28:30.680294 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m14:28:30.680668 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m14:28:30.681023 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m14:28:30.681564 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.683077 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m14:28:30.683443 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:28:30.683780 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m14:28:30.695767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.696132 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.697582 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m14:28:30.697932 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.699412 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m14:28:30.699802 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.700132 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:28:30.701377 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 14:28:30.409685 => 14:28:30.701204
[0m14:28:30.701744 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m14:28:30.704214 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m14:28:30.704554 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m14:28:30.704882 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m14:28:30.705200 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m14:28:30.705514 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m14:28:30.706268 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3396550>]}
[0m14:28:30.706786 [info ] [Thread-3  ]: 5 of 12 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m14:28:30.707298 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m14:28:30.707799 [debug] [Thread-3  ]: Began running node model.bde.dim_host
[0m14:28:30.708189 [info ] [Thread-3  ]: 9 of 12 START sql view model warehouse.dim_host ................................ [RUN]
[0m14:28:30.708743 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.dim_host)
[0m14:28:30.709071 [debug] [Thread-3  ]: Began compiling node model.bde.dim_host
[0m14:28:30.711431 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_host"
[0m14:28:30.712070 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (compile): 14:28:30.709296 => 14:28:30.711921
[0m14:28:30.712393 [debug] [Thread-3  ]: Began executing node model.bde.dim_host
[0m14:28:30.715538 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_host"
[0m14:28:30.716063 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m14:28:30.716367 [debug] [Thread-3  ]: On model.bde.dim_host: BEGIN
[0m14:28:30.716654 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:28:30.719210 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.721331 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m14:28:30.721677 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.721971 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.722261 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m14:28:30.724408 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m14:28:30.725562 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 14:28:30.431234 => 14:28:30.725416
[0m14:28:30.725933 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m14:28:30.726266 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m14:28:30.727004 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd09beee0>]}
[0m14:28:30.727501 [info ] [Thread-4  ]: 8 of 12 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m14:28:30.727963 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m14:28:30.728407 [debug] [Thread-4  ]: Began running node model.bde.dim_lge_code_suburb
[0m14:28:30.728760 [info ] [Thread-4  ]: 10 of 12 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m14:28:30.729266 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_lge_code_suburb)
[0m14:28:30.729551 [debug] [Thread-4  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m14:28:30.732401 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m14:28:30.733148 [debug] [Thread-4  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 14:28:30.729751 => 14:28:30.732953
[0m14:28:30.733476 [debug] [Thread-4  ]: Began executing node model.bde.dim_lge_code_suburb
[0m14:28:30.737509 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m14:28:30.738069 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:28:30.738375 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m14:28:30.738651 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:28:30.742747 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.743861 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (execute): 14:28:30.424734 => 14:28:30.743715
[0m14:28:30.744180 [debug] [Thread-1  ]: On model.bde.listings_stg: Close
[0m14:28:30.744899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd0abed30>]}
[0m14:28:30.745391 [info ] [Thread-1  ]: 6 of 12 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m14:28:30.745892 [debug] [Thread-1  ]: Finished running node model.bde.listings_stg
[0m14:28:30.746247 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.747689 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (execute): 14:28:30.428023 => 14:28:30.747544
[0m14:28:30.748229 [debug] [Thread-2  ]: On model.bde.property_stg: Close
[0m14:28:30.748607 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m14:28:30.749782 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb00b89a0>]}
[0m14:28:30.749108 [info ] [Thread-1  ]: 11 of 12 START sql view model warehouse.fact_listing ........................... [RUN]
[0m14:28:30.750344 [info ] [Thread-2  ]: 7 of 12 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m14:28:30.750898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_listing)
[0m14:28:30.751365 [debug] [Thread-2  ]: Finished running node model.bde.property_stg
[0m14:28:30.751658 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m14:28:30.754250 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m14:28:30.754616 [debug] [Thread-2  ]: Began running node model.bde.dim_property
[0m14:28:30.755093 [info ] [Thread-2  ]: 12 of 12 START sql view model warehouse.dim_property ........................... [RUN]
[0m14:28:30.755637 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_property)
[0m14:28:30.755940 [debug] [Thread-2  ]: Began compiling node model.bde.dim_property
[0m14:28:30.758094 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_property"
[0m14:28:30.758623 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 14:28:30.752025 => 14:28:30.758472
[0m14:28:30.758929 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m14:28:30.761777 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m14:28:30.762306 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (compile): 14:28:30.756149 => 14:28:30.762146
[0m14:28:30.762622 [debug] [Thread-2  ]: Began executing node model.bde.dim_property
[0m14:28:30.766033 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_property"
[0m14:28:30.766575 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:28:30.766933 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m14:28:30.767220 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m14:28:30.767504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:30.767775 [debug] [Thread-2  ]: On model.bde.dim_property: BEGIN
[0m14:28:30.768142 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:28:30.881526 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.882051 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m14:28:30.882435 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m14:28:30.893936 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.894363 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:28:30.894776 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.lowercase_suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m14:28:30.900244 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.903434 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m14:28:30.903852 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m14:28:30.909857 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.912817 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:28:30.913250 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
alter table "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp" rename to "dim_lge_code_suburb"
[0m14:28:30.918474 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.919983 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m14:28:30.920353 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m14:28:30.920691 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m14:28:30.927883 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.928268 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.928648 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:28:30.930198 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m14:28:30.930589 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m14:28:30.930952 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:28:30.931353 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m14:28:30.931718 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:30.932100 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m14:28:30.932465 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m14:28:30.938347 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.940879 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m14:28:30.941255 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m14:28:30.947601 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.951117 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m14:28:30.951504 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.951978 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
drop view if exists "postgres"."warehouse"."dim_lge_code_suburb__dbt_backup" cascade
[0m14:28:30.952319 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:30.954952 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:28:30.955317 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.957997 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m14:28:30.958347 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m14:28:30.959482 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (execute): 14:28:30.712609 => 14:28:30.959324
[0m14:28:30.959818 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m14:28:30.960226 [debug] [Thread-3  ]: On model.bde.dim_host: Close
[0m14:28:30.960999 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc334c820>]}
[0m14:28:30.961516 [info ] [Thread-3  ]: 9 of 12 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:28:30.962039 [debug] [Thread-3  ]: Finished running node model.bde.dim_host
[0m14:28:30.970567 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:30.971947 [debug] [Thread-4  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 14:28:30.733689 => 14:28:30.971774
[0m14:28:30.972300 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: Close
[0m14:28:30.973033 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd0b1faf0>]}
[0m14:28:30.973536 [info ] [Thread-4  ]: 10 of 12 OK created sql view model warehouse.dim_lge_code_suburb ............... [[32mCREATE VIEW[0m in 0.24s]
[0m14:28:30.974035 [debug] [Thread-4  ]: Finished running node model.bde.dim_lge_code_suburb
[0m14:28:30.974525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.975815 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m14:28:30.976155 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:28:30.976467 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m14:28:30.978436 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:30.979783 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m14:28:30.980145 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m14:28:30.980549 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m14:28:30.994268 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:30.996966 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m14:28:30.997361 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m14:28:30.999765 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:31.002517 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m14:28:31.002914 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m14:28:31.012312 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:31.013802 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 14:28:30.759136 => 14:28:31.013615
[0m14:28:31.014233 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m14:28:31.015059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd07e7e20>]}
[0m14:28:31.015584 [info ] [Thread-1  ]: 11 of 12 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:28:31.016099 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m14:28:31.016650 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:31.017871 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (execute): 14:28:30.762867 => 14:28:31.017720
[0m14:28:31.018219 [debug] [Thread-2  ]: On model.bde.dim_property: Close
[0m14:28:31.018918 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b3e276-a814-444c-aa03-1fff632280f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd0a91fd0>]}
[0m14:28:31.019396 [info ] [Thread-2  ]: 12 of 12 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:28:31.019902 [debug] [Thread-2  ]: Finished running node model.bde.dim_property
[0m14:28:31.021043 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:31.021319 [debug] [MainThread]: On master: BEGIN
[0m14:28:31.021566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:31.200658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:28:31.201595 [debug] [MainThread]: On master: COMMIT
[0m14:28:31.202190 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:31.202764 [debug] [MainThread]: On master: COMMIT
[0m14:28:31.219170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:28:31.219878 [debug] [MainThread]: On master: Close
[0m14:28:31.221549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:31.222223 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m14:28:31.222848 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m14:28:31.223453 [debug] [MainThread]: Connection 'model.bde.dim_host' was properly closed.
[0m14:28:31.224036 [debug] [MainThread]: Connection 'model.bde.dim_lge_code_suburb' was properly closed.
[0m14:28:31.224872 [info ] [MainThread]: 
[0m14:28:31.225610 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m14:28:31.229945 [debug] [MainThread]: Command end result
[0m14:28:31.244307 [info ] [MainThread]: 
[0m14:28:31.245052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:31.245584 [info ] [MainThread]: 
[0m14:28:31.246134 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m14:28:31.247102 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:31.246943 after 2.43 seconds
[0m14:28:31.247724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc0b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc3211850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd0bf45e0>]}
[0m14:28:31.248315 [debug] [MainThread]: Flushing usage events
[0m16:49:00.089419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe000ad16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff0f80850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff0f80940>]}


============================== 16:49:00.093657 | dfde41a8-4abe-4322-93bd-058a59c4a86f ==============================
[0m16:49:00.093657 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:49:00.094320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:00.306607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff0f80820>]}
[0m16:49:00.317614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002ac7280>]}
[0m16:49:00.318252 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m16:49:00.341995 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:49:00.381177 [debug] [MainThread]: Partial parsing enabled: 12 files deleted, 0 files added, 2 files changed.
[0m16:49:00.381721 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/listings_stg.sql
[0m16:49:00.381992 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/code_stg.sql
[0m16:49:00.382229 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_census_G01.sql
[0m16:49:00.382454 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_property.sql
[0m16:49:00.382673 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_listing.sql
[0m16:49:00.382889 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_census_G02.sql
[0m16:49:00.383108 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/fact_stg.sql
[0m16:49:00.383330 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/suburb_stg.sql
[0m16:49:00.383550 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_host.sql
[0m16:49:00.383763 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m16:49:00.383988 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/host_stg.sql
[0m16:49:00.384210 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/property_stg.sql
[0m16:49:00.384568 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m16:49:00.384993 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m16:49:00.422238 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.datamart
- models.bde.warehouse
[0m16:49:00.426480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002c682e0>]}
[0m16:49:00.440554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002b200a0>]}
[0m16:49:00.441076 [info ] [MainThread]: Found 6 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m16:49:00.441378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002b980a0>]}
[0m16:49:00.442836 [info ] [MainThread]: 
[0m16:49:00.443457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:00.444469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:49:00.452609 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:49:00.453018 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:49:00.453268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:01.151663 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.0 seconds
[0m16:49:01.157382 [debug] [ThreadPool]: On list_postgres: Close
[0m16:49:01.162248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m16:49:01.174297 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:49:01.175139 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m16:49:01.175713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:01.366535 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:49:01.367814 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:49:01.368842 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m16:49:01.388730 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m16:49:01.393296 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m16:49:01.407286 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m16:49:01.422620 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:01.423331 [debug] [MainThread]: On master: BEGIN
[0m16:49:01.423890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:01.603524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:01.604820 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:01.605911 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:01.631934 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m16:49:01.642929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002ad8a90>]}
[0m16:49:01.644002 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:01.657293 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:01.657981 [debug] [MainThread]: On master: BEGIN
[0m16:49:01.690974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:01.692580 [debug] [MainThread]: On master: COMMIT
[0m16:49:01.693734 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:01.694805 [debug] [MainThread]: On master: COMMIT
[0m16:49:01.708926 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:01.710333 [debug] [MainThread]: On master: Close
[0m16:49:01.713851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:49:01.714852 [info ] [MainThread]: 
[0m16:49:01.724052 [debug] [Thread-1  ]: Began running node snapshot.bde.code_snapshot
[0m16:49:01.725033 [debug] [Thread-2  ]: Began running node snapshot.bde.fact_snapshot
[0m16:49:01.726054 [debug] [Thread-3  ]: Began running node snapshot.bde.host_snapshot
[0m16:49:01.727878 [debug] [Thread-4  ]: Began running node snapshot.bde.listing_snapshot
[0m16:49:01.727125 [info ] [Thread-1  ]: 1 of 6 START snapshot at3.code_snapshot ........................................ [RUN]
[0m16:49:01.728946 [info ] [Thread-2  ]: 2 of 6 START snapshot at3.fact_snapshot ........................................ [RUN]
[0m16:49:01.729776 [info ] [Thread-3  ]: 3 of 6 START snapshot at3.host_snapshot ........................................ [RUN]
[0m16:49:01.730608 [info ] [Thread-4  ]: 4 of 6 START snapshot at3.listing_snapshot ..................................... [RUN]
[0m16:49:01.731862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.code_snapshot)
[0m16:49:01.733067 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.fact_snapshot'
[0m16:49:01.734283 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m16:49:01.735505 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m16:49:01.736234 [debug] [Thread-1  ]: Began compiling node snapshot.bde.code_snapshot
[0m16:49:01.736882 [debug] [Thread-2  ]: Began compiling node snapshot.bde.fact_snapshot
[0m16:49:01.737514 [debug] [Thread-3  ]: Began compiling node snapshot.bde.host_snapshot
[0m16:49:01.738129 [debug] [Thread-4  ]: Began compiling node snapshot.bde.listing_snapshot
[0m16:49:01.752624 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (compile): 16:49:01.738623 => 16:49:01.751504
[0m16:49:01.757355 [debug] [Thread-2  ]: Timing info for snapshot.bde.fact_snapshot (compile): 16:49:01.753128 => 16:49:01.756980
[0m16:49:01.761967 [debug] [Thread-3  ]: Timing info for snapshot.bde.host_snapshot (compile): 16:49:01.757898 => 16:49:01.761690
[0m16:49:01.765646 [debug] [Thread-4  ]: Timing info for snapshot.bde.listing_snapshot (compile): 16:49:01.762365 => 16:49:01.765409
[0m16:49:01.766137 [debug] [Thread-1  ]: Began executing node snapshot.bde.code_snapshot
[0m16:49:01.766584 [debug] [Thread-2  ]: Began executing node snapshot.bde.fact_snapshot
[0m16:49:01.767015 [debug] [Thread-3  ]: Began executing node snapshot.bde.host_snapshot
[0m16:49:01.767445 [debug] [Thread-4  ]: Began executing node snapshot.bde.listing_snapshot
[0m16:49:01.817555 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:01.827127 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:01.837213 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:01.840297 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:01.840609 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: BEGIN
[0m16:49:01.840883 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: BEGIN
[0m16:49:01.841157 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */
select * from (
        select id, lga_code, lga_name from (
                



select * from "postgres"."at3"."nsw_lga_code"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:49:01.841424 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m16:49:01.841679 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:49:01.841931 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:49:01.842183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:01.842430 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:49:02.017079 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:02.017836 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:02.018432 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:02.019065 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:02.019650 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:02.020207 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:02.020802 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.021425 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.021984 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.031408 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:02.036099 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.036699 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: BEGIN
[0m16:49:02.050002 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:49:02.053774 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:02.055549 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:49:02.056571 [debug] [Thread-4  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:49:02.085779 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.099010 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:02.101638 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:02.104131 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:02.104518 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.104977 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp164902085352"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            nullif(host_since, host_since) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            host_since as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.host_since)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.host_since)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:49:02.105523 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

        
  
    

  create temporary table "fact_snapshot__dbt_tmp164902100896"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,accommodates,price, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."fact_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:49:02.106062 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

        
  
    

  create temporary table "listing_snapshot__dbt_tmp164902103446"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."listing_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:49:02.137686 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:02.143064 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.143623 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.162561 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:02.165143 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.165773 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

        
  
    

  create temporary table "code_snapshot__dbt_tmp164902164333"
  
  
    as
  
  (
    with snapshot_query as (

        



select * from "postgres"."at3"."nsw_lga_code"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."code_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_code" != source_data."lga_code"
        or
        (
            ((snapshotted_data."lga_code" is null) and not (source_data."lga_code" is null))
            or
            ((not snapshotted_data."lga_code" is null) and (source_data."lga_code" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_code" != source_data."lga_code"
        or
        (
            ((snapshotted_data."lga_code" is null) and not (source_data."lga_code" is null))
            or
            ((not snapshotted_data."lga_code" is null) and (source_data."lga_code" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:49:02.185929 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:02.226661 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.227127 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot__dbt_tmp164902164333'
        
      order by ordinal_position

  
[0m16:49:02.246352 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m16:49:02.249322 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.249709 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.269124 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:02.272246 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.272676 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot__dbt_tmp164902164333'
        
      order by ordinal_position

  
[0m16:49:02.293897 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m16:49:02.297432 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.297921 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.318477 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:02.327046 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.327576 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'code_snapshot__dbt_tmp164902164333'
        
      order by ordinal_position

  
[0m16:49:02.346417 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m16:49:02.353711 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.code_snapshot"
[0m16:49:02.355693 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.356209 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.code_snapshot"} */

      update "postgres"."at3"."code_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "code_snapshot__dbt_tmp164902164333" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."code_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."code_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."code_snapshot" ("lga_code", "lga_name", "id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."lga_code",DBT_INTERNAL_SOURCE."lga_name",DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "code_snapshot__dbt_tmp164902164333" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:49:02.371509 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:49:02.388569 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: COMMIT
[0m16:49:02.389014 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.code_snapshot"
[0m16:49:02.389405 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: COMMIT
[0m16:49:02.408021 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:02.411192 [debug] [Thread-1  ]: Timing info for snapshot.bde.code_snapshot (execute): 16:49:01.767773 => 16:49:02.410964
[0m16:49:02.411705 [debug] [Thread-1  ]: On snapshot.bde.code_snapshot: Close
[0m16:49:02.412696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002ec0f40>]}
[0m16:49:02.413866 [info ] [Thread-1  ]: 1 of 6 OK snapshotted at3.code_snapshot ........................................ [[32mINSERT 0 0[0m in 0.68s]
[0m16:49:02.414613 [debug] [Thread-1  ]: Finished running node snapshot.bde.code_snapshot
[0m16:49:02.415128 [debug] [Thread-1  ]: Began running node snapshot.bde.property_snapshot
[0m16:49:02.415737 [info ] [Thread-1  ]: 5 of 6 START snapshot at3.property_snapshot .................................... [RUN]
[0m16:49:02.416518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.bde.code_snapshot, now snapshot.bde.property_snapshot)
[0m16:49:02.416934 [debug] [Thread-1  ]: Began compiling node snapshot.bde.property_snapshot
[0m16:49:02.420371 [debug] [Thread-1  ]: Timing info for snapshot.bde.property_snapshot (compile): 16:49:02.417223 => 16:49:02.420135
[0m16:49:02.420806 [debug] [Thread-1  ]: Began executing node snapshot.bde.property_snapshot
[0m16:49:02.426308 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:02.426716 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: BEGIN
[0m16:49:02.427069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:02.604568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:02.605672 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:02.606412 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:02.643031 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m16:49:02.649042 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:02.650179 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp164902647154"
  
  
    as
  
  (
    with snapshot_query as (

        



select id, scraped_date,listing_neighbourhood,property_type, room_type, accommodates, price, has_availability, availability_30 from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:49:07.879323 [debug] [Thread-3  ]: SQL status: SELECT 0 in 6.0 seconds
[0m16:49:07.891611 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:07.893017 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp164902085352'
        
      order by ordinal_position

  
[0m16:49:07.935229 [debug] [Thread-3  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:49:07.945606 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:07.947330 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:07.980817 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:49:07.989158 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:07.990286 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp164902085352'
        
      order by ordinal_position

  
[0m16:49:08.022382 [debug] [Thread-3  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:49:08.032537 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:08.034028 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.059958 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:49:08.073368 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:08.074918 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp164902085352'
        
      order by ordinal_position

  
[0m16:49:08.099891 [debug] [Thread-3  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:49:08.110282 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m16:49:08.114153 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:08.115861 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."at3"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp164902085352" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."host_snapshot" ("id", "host_id", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp164902085352" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:49:08.135117 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:49:08.141396 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:49:08.142821 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:49:08.144070 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:49:08.160731 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:08.167014 [debug] [Thread-3  ]: Timing info for snapshot.bde.host_snapshot (execute): 16:49:01.824179 => 16:49:08.166165
[0m16:49:08.169010 [debug] [Thread-3  ]: On snapshot.bde.host_snapshot: Close
[0m16:49:08.172579 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002c59e50>]}
[0m16:49:08.175346 [info ] [Thread-3  ]: 3 of 6 OK snapshotted at3.host_snapshot ........................................ [[32mINSERT 0 0[0m in 6.44s]
[0m16:49:08.177211 [debug] [Thread-3  ]: Finished running node snapshot.bde.host_snapshot
[0m16:49:08.178246 [debug] [Thread-3  ]: Began running node snapshot.bde.suburb_snapshot
[0m16:49:08.178750 [info ] [Thread-3  ]: 6 of 6 START snapshot at3.suburb_snapshot ...................................... [RUN]
[0m16:49:08.179511 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly snapshot.bde.host_snapshot, now snapshot.bde.suburb_snapshot)
[0m16:49:08.179853 [debug] [Thread-3  ]: Began compiling node snapshot.bde.suburb_snapshot
[0m16:49:08.183452 [debug] [Thread-3  ]: Timing info for snapshot.bde.suburb_snapshot (compile): 16:49:08.180070 => 16:49:08.183187
[0m16:49:08.183836 [debug] [Thread-3  ]: Began executing node snapshot.bde.suburb_snapshot
[0m16:49:08.186648 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.186968 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */
select * from (
        select id, lga_name, suburb_name from (
                



select * from "postgres"."at3"."nsw_lga_suburb"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:49:08.187254 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:49:08.362996 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:08.373309 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.374465 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: BEGIN
[0m16:49:08.389424 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:49:08.390751 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.391643 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.427868 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:08.448003 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.449361 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.475164 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:08.482270 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.484285 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

        
  
    

  create temporary table "suburb_snapshot__dbt_tmp164908479894"
  
  
    as
  
  (
    with snapshot_query as (

        



select * from "postgres"."at3"."nsw_lga_suburb"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."suburb_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ) or snapshotted_data."suburb_name" != source_data."suburb_name"
        or
        (
            ((snapshotted_data."suburb_name" is null) and not (source_data."suburb_name" is null))
            or
            ((not snapshotted_data."suburb_name" is null) and (source_data."suburb_name" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."lga_name" != source_data."lga_name"
        or
        (
            ((snapshotted_data."lga_name" is null) and not (source_data."lga_name" is null))
            or
            ((not snapshotted_data."lga_name" is null) and (source_data."lga_name" is null))
        ) or snapshotted_data."suburb_name" != source_data."suburb_name"
        or
        (
            ((snapshotted_data."suburb_name" is null) and not (source_data."suburb_name" is null))
            or
            ((not snapshotted_data."suburb_name" is null) and (source_data."suburb_name" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:49:08.566939 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:08.575071 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.576225 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot__dbt_tmp164908479894'
        
      order by ordinal_position

  
[0m16:49:08.595844 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.0 seconds
[0m16:49:08.607314 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.608637 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.637035 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:08.649541 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.651380 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot__dbt_tmp164908479894'
        
      order by ordinal_position

  
[0m16:49:08.697846 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.0 seconds
[0m16:49:08.712124 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.715498 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.717149 [debug] [Thread-1  ]: SQL status: SELECT 0 in 6.0 seconds
[0m16:49:08.727207 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.728264 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp164902647154'
        
      order by ordinal_position

  
[0m16:49:08.752612 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.0 seconds
[0m16:49:08.767153 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:49:08.766452 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.770559 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.770938 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'suburb_snapshot__dbt_tmp164908479894'
        
      order by ordinal_position

  
[0m16:49:08.771296 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.796461 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.0 seconds
[0m16:49:08.802052 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.suburb_snapshot"
[0m16:49:08.803939 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m16:49:08.809821 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.810222 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.810588 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp164902647154'
        
      order by ordinal_position

  
[0m16:49:08.811040 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.suburb_snapshot"} */

      update "postgres"."at3"."suburb_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "suburb_snapshot__dbt_tmp164908479894" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."suburb_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."suburb_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."suburb_snapshot" ("lga_name", "suburb_name", "id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."lga_name",DBT_INTERNAL_SOURCE."suburb_name",DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "suburb_snapshot__dbt_tmp164908479894" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:49:08.837213 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:49:08.842201 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: COMMIT
[0m16:49:08.844123 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:49:08.845091 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.suburb_snapshot"
[0m16:49:08.853644 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.854608 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: COMMIT
[0m16:49:08.855488 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:08.875792 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:08.878658 [debug] [Thread-3  ]: Timing info for snapshot.bde.suburb_snapshot (execute): 16:49:08.184051 => 16:49:08.878155
[0m16:49:08.879739 [debug] [Thread-3  ]: On snapshot.bde.suburb_snapshot: Close
[0m16:49:08.880707 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m16:49:08.884751 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.886234 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff0fd09a0>]}
[0m16:49:08.887163 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      alter table "postgres"."at3"."property_snapshot" add column "listing_neighbourhood" character varying(50);
    
[0m16:49:08.888708 [info ] [Thread-3  ]: 6 of 6 OK snapshotted at3.suburb_snapshot ...................................... [[32mINSERT 0 0[0m in 0.71s]
[0m16:49:08.890310 [debug] [Thread-3  ]: Finished running node snapshot.bde.suburb_snapshot
[0m16:49:08.907619 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:08.910190 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.911157 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      alter table "postgres"."at3"."property_snapshot" add column "accommodates" numeric;
    
[0m16:49:08.932742 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:08.935065 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.935933 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      alter table "postgres"."at3"."property_snapshot" add column "price" numeric;
    
[0m16:49:08.952657 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:08.955808 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.957028 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      alter table "postgres"."at3"."property_snapshot" add column "has_availability" character varying(50);
    
[0m16:49:08.976411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:08.980461 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:08.981550 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      alter table "postgres"."at3"."property_snapshot" add column "availability_30" numeric;
    
[0m16:49:08.997414 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:09.005947 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:09.007042 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp164902647154'
        
      order by ordinal_position

  
[0m16:49:09.028029 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:49:09.035440 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m16:49:09.038704 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:09.039809 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."at3"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp164902647154" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."property_snapshot" ("id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "has_availability", "availability_30", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp164902647154" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:49:09.071656 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:49:09.077525 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: COMMIT
[0m16:49:09.078533 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:49:09.079361 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: COMMIT
[0m16:49:09.102311 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:09.107204 [debug] [Thread-1  ]: Timing info for snapshot.bde.property_snapshot (execute): 16:49:02.421097 => 16:49:09.106629
[0m16:49:09.108503 [debug] [Thread-4  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:49:09.110092 [debug] [Thread-1  ]: On snapshot.bde.property_snapshot: Close
[0m16:49:09.120726 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.122399 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp164902103446'
        
      order by ordinal_position

  
[0m16:49:09.124705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff1057f10>]}
[0m16:49:09.127658 [info ] [Thread-1  ]: 5 of 6 OK snapshotted at3.property_snapshot .................................... [[32mINSERT 0 0[0m in 6.71s]
[0m16:49:09.129402 [debug] [Thread-1  ]: Finished running node snapshot.bde.property_snapshot
[0m16:49:09.150699 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:49:09.162259 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.163255 [debug] [Thread-2  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:49:09.164239 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:09.170227 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.171361 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp164902100896'
        
      order by ordinal_position

  
[0m16:49:09.188085 [debug] [Thread-4  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:49:09.194695 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.195552 [debug] [Thread-2  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:49:09.196397 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp164902103446'
        
      order by ordinal_position

  
[0m16:49:09.202125 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.203052 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:09.220156 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:49:09.225615 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.226061 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:49:09.226495 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:09.229926 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.230454 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp164902100896'
        
      order by ordinal_position

  
[0m16:49:09.247598 [debug] [Thread-4  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:49:09.251364 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.251810 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp164902103446'
        
      order by ordinal_position

  
[0m16:49:09.252281 [debug] [Thread-2  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:49:09.255825 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.256299 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:49:09.270090 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:49:09.272691 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m16:49:09.273130 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:49:09.276887 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.277343 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp164902100896'
        
      order by ordinal_position

  
[0m16:49:09.277870 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.278358 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      update "postgres"."at3"."listing_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "listing_snapshot__dbt_tmp164902103446" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."listing_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."listing_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."listing_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "listing_snapshot__dbt_tmp164902103446" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:49:09.292755 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:49:09.294415 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:49:09.294870 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:49:09.295290 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:49:09.295954 [debug] [Thread-2  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:49:09.298825 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.fact_snapshot"
[0m16:49:09.300263 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.300757 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      update "postgres"."at3"."fact_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "fact_snapshot__dbt_tmp164902100896" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."fact_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."fact_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."fact_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "accommodates", "price", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "fact_snapshot__dbt_tmp164902100896" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:49:09.310257 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:09.311349 [debug] [Thread-4  ]: Timing info for snapshot.bde.listing_snapshot (execute): 16:49:01.837475 => 16:49:09.311152
[0m16:49:09.311766 [debug] [Thread-4  ]: On snapshot.bde.listing_snapshot: Close
[0m16:49:09.312652 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002b98fd0>]}
[0m16:49:09.313395 [info ] [Thread-4  ]: 4 of 6 OK snapshotted at3.listing_snapshot ..................................... [[32mINSERT 0 0[0m in 7.58s]
[0m16:49:09.314034 [debug] [Thread-4  ]: Finished running node snapshot.bde.listing_snapshot
[0m16:49:09.315454 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:49:09.316993 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:49:09.317401 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:49:09.317817 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:49:09.333685 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:49:09.334885 [debug] [Thread-2  ]: Timing info for snapshot.bde.fact_snapshot (execute): 16:49:01.792891 => 16:49:09.334679
[0m16:49:09.335347 [debug] [Thread-2  ]: On snapshot.bde.fact_snapshot: Close
[0m16:49:09.336278 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfde41a8-4abe-4322-93bd-058a59c4a86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00211a280>]}
[0m16:49:09.337069 [info ] [Thread-2  ]: 2 of 6 OK snapshotted at3.fact_snapshot ........................................ [[32mINSERT 0 0[0m in 7.60s]
[0m16:49:09.337763 [debug] [Thread-2  ]: Finished running node snapshot.bde.fact_snapshot
[0m16:49:09.339758 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:09.340151 [debug] [MainThread]: On master: BEGIN
[0m16:49:09.340498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:09.526837 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:09.528895 [debug] [MainThread]: On master: COMMIT
[0m16:49:09.529780 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:09.530621 [debug] [MainThread]: On master: COMMIT
[0m16:49:09.545643 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:09.548053 [debug] [MainThread]: On master: Close
[0m16:49:09.553348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:09.555002 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m16:49:09.555794 [debug] [MainThread]: Connection 'snapshot.bde.fact_snapshot' was properly closed.
[0m16:49:09.556567 [debug] [MainThread]: Connection 'snapshot.bde.suburb_snapshot' was properly closed.
[0m16:49:09.557344 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m16:49:09.558547 [info ] [MainThread]: 
[0m16:49:09.559496 [info ] [MainThread]: Finished running 6 snapshots in 0 hours 0 minutes and 9.11 seconds (9.11s).
[0m16:49:09.563584 [debug] [MainThread]: Command end result
[0m16:49:09.581985 [info ] [MainThread]: 
[0m16:49:09.582769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:09.583289 [info ] [MainThread]: 
[0m16:49:09.583852 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:49:09.585123 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:49:09.584958 after 9.54 seconds
[0m16:49:09.585799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe000ad16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfd0095fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe002cb9730>]}
[0m16:49:09.586407 [debug] [MainThread]: Flushing usage events
[0m16:53:53.101873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd380bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3834a8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3834a8970>]}


============================== 16:53:53.105953 | c5705760-d67e-4aa1-8cfe-04e255122def ==============================
[0m16:53:53.105953 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:53:53.106633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:53:53.244358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3834a8910>]}
[0m16:53:53.255347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3835cf2b0>]}
[0m16:53:53.255904 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m16:53:53.274944 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:53:53.302916 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m16:53:53.303389 [debug] [MainThread]: Partial parsing: deleted file: bde://snapshots/suburb_snapshot.sql
[0m16:53:53.303646 [debug] [MainThread]: Partial parsing: deleted file: bde://snapshots/code_snapshot.sql
[0m16:53:53.308039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.warehouse
- models.bde.datamart
[0m16:53:53.312847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd370271fa0>]}
[0m16:53:53.326658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3836b28b0>]}
[0m16:53:53.327104 [info ] [MainThread]: Found 4 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m16:53:53.327396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3836b2940>]}
[0m16:53:53.328752 [info ] [MainThread]: 
[0m16:53:53.329378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:53.330604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:53:53.338968 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:53:53.339370 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:53:53.339646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:53.762313 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m16:53:53.769365 [debug] [ThreadPool]: On list_postgres: Close
[0m16:53:53.774069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m16:53:53.786471 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:53:53.787141 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m16:53:53.787693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:53.970842 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:53:53.971820 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:53:53.972622 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m16:53:53.994180 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:53:53.998933 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m16:53:54.013682 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m16:53:54.029367 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:54.030251 [debug] [MainThread]: On master: BEGIN
[0m16:53:54.030947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:54.226030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:53:54.228174 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:54.229510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:54.255597 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m16:53:54.269062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3836b2850>]}
[0m16:53:54.269984 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:54.285288 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:54.285974 [debug] [MainThread]: On master: BEGIN
[0m16:53:54.319088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:53:54.320600 [debug] [MainThread]: On master: COMMIT
[0m16:53:54.321535 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:54.322498 [debug] [MainThread]: On master: COMMIT
[0m16:53:54.338067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:53:54.339309 [debug] [MainThread]: On master: Close
[0m16:53:54.341955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:54.343062 [info ] [MainThread]: 
[0m16:53:54.351525 [debug] [Thread-1  ]: Began running node snapshot.bde.fact_snapshot
[0m16:53:54.352580 [debug] [Thread-2  ]: Began running node snapshot.bde.host_snapshot
[0m16:53:54.353615 [debug] [Thread-3  ]: Began running node snapshot.bde.listing_snapshot
[0m16:53:54.354477 [debug] [Thread-4  ]: Began running node snapshot.bde.property_snapshot
[0m16:53:54.355354 [info ] [Thread-1  ]: 1 of 4 START snapshot at3.fact_snapshot ........................................ [RUN]
[0m16:53:54.356250 [info ] [Thread-2  ]: 2 of 4 START snapshot at3.host_snapshot ........................................ [RUN]
[0m16:53:54.357068 [info ] [Thread-3  ]: 3 of 4 START snapshot at3.listing_snapshot ..................................... [RUN]
[0m16:53:54.357877 [info ] [Thread-4  ]: 4 of 4 START snapshot at3.property_snapshot .................................... [RUN]
[0m16:53:54.359315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.fact_snapshot)
[0m16:53:54.360562 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m16:53:54.361770 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m16:53:54.362960 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m16:53:54.363691 [debug] [Thread-1  ]: Began compiling node snapshot.bde.fact_snapshot
[0m16:53:54.364351 [debug] [Thread-2  ]: Began compiling node snapshot.bde.host_snapshot
[0m16:53:54.364983 [debug] [Thread-3  ]: Began compiling node snapshot.bde.listing_snapshot
[0m16:53:54.365607 [debug] [Thread-4  ]: Began compiling node snapshot.bde.property_snapshot
[0m16:53:54.378705 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (compile): 16:53:54.366047 => 16:53:54.378281
[0m16:53:54.383268 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (compile): 16:53:54.379180 => 16:53:54.382914
[0m16:53:54.387377 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (compile): 16:53:54.383778 => 16:53:54.387133
[0m16:53:54.391055 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (compile): 16:53:54.387742 => 16:53:54.390814
[0m16:53:54.391559 [debug] [Thread-1  ]: Began executing node snapshot.bde.fact_snapshot
[0m16:53:54.392014 [debug] [Thread-2  ]: Began executing node snapshot.bde.host_snapshot
[0m16:53:54.392468 [debug] [Thread-3  ]: Began executing node snapshot.bde.listing_snapshot
[0m16:53:54.392907 [debug] [Thread-4  ]: Began executing node snapshot.bde.property_snapshot
[0m16:53:54.446540 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:53:54.446908 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:53:54.449989 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:53:54.452982 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:53:54.453304 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: BEGIN
[0m16:53:54.453582 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: BEGIN
[0m16:53:54.453850 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m16:53:54.454113 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: BEGIN
[0m16:53:54.454372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:54.454625 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:53:54.454879 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:53:54.455130 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:53:54.622893 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:53:54.623775 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:53:54.624514 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:53:54.630973 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:53:54.631664 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:53:54.632388 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:53:54.633040 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:53:54.633695 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:53:54.634348 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:53:54.635026 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:53:54.635752 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:53:54.636469 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:53:54.649912 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m16:53:54.669369 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:53:54.682649 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:53:54.683134 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:53:54.691069 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:53:54.693676 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:53:54.696473 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:53:54.699422 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:53:54.699941 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp165354674260"
  
  
    as
  
  (
    with snapshot_query as (

        



select id, scraped_date,listing_neighbourhood,property_type, room_type, accommodates, price, has_availability, availability_30 from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:53:54.700542 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp165354692874"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            nullif(host_since, host_since) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            host_since as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.host_since)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.host_since)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:53:54.701152 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

        
  
    

  create temporary table "fact_snapshot__dbt_tmp165354695669"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,accommodates,price, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."fact_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:53:54.701758 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

        
  
    

  create temporary table "listing_snapshot__dbt_tmp165354698714"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."listing_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:54:01.407703 [debug] [Thread-2  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:54:01.420008 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.423325 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165354692874'
        
      order by ordinal_position

  
[0m16:54:01.444758 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:54:01.454046 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.454827 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:01.474539 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:54:01.482417 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.483311 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165354692874'
        
      order by ordinal_position

  
[0m16:54:01.506050 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:54:01.513628 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.514570 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:01.534055 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:54:01.549128 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.549943 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165354692874'
        
      order by ordinal_position

  
[0m16:54:01.570089 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:54:01.584465 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m16:54:01.586703 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.587561 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."at3"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp165354692874" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."host_snapshot" ("id", "host_id", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp165354692874" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:54:01.603308 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:54:01.630330 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:54:01.630965 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:54:01.631465 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:54:01.646188 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:54:01.650352 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (execute): 16:53:54.418445 => 16:54:01.650033
[0m16:54:01.650976 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: Close
[0m16:54:01.652443 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd383891dc0>]}
[0m16:54:01.655166 [info ] [Thread-2  ]: 2 of 4 OK snapshotted at3.host_snapshot ........................................ [[32mINSERT 0 0[0m in 7.29s]
[0m16:54:01.656086 [debug] [Thread-2  ]: Finished running node snapshot.bde.host_snapshot
[0m16:54:01.812415 [debug] [Thread-4  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:54:01.823576 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:01.824587 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp165354674260'
        
      order by ordinal_position

  
[0m16:54:01.845846 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:54:01.853403 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:01.854374 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:01.875144 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m16:54:01.882302 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:01.883263 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp165354674260'
        
      order by ordinal_position

  
[0m16:54:01.903673 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:54:01.912045 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:01.912949 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:01.931839 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m16:54:01.943675 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:02.001096 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp165354674260'
        
      order by ordinal_position

  
[0m16:54:02.025841 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:54:02.028804 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m16:54:02.030493 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:02.031041 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."at3"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp165354674260" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."property_snapshot" ("id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "has_availability", "availability_30", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp165354674260" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:54:02.047788 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:54:02.049468 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m16:54:02.049923 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:54:02.050340 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m16:54:02.067970 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:54:02.069334 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (execute): 16:53:54.450236 => 16:54:02.069077
[0m16:54:02.069881 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: Close
[0m16:54:02.070984 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3834f5d00>]}
[0m16:54:02.071929 [info ] [Thread-4  ]: 4 of 4 OK snapshotted at3.property_snapshot .................................... [[32mINSERT 0 0[0m in 7.71s]
[0m16:54:02.072743 [debug] [Thread-4  ]: Finished running node snapshot.bde.property_snapshot
[0m16:54:02.545127 [debug] [Thread-3  ]: SQL status: SELECT 0 in 8.0 seconds
[0m16:54:02.547821 [debug] [Thread-1  ]: SQL status: SELECT 0 in 8.0 seconds
[0m16:54:02.557175 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.563271 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.564244 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165354698714'
        
      order by ordinal_position

  
[0m16:54:02.565186 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165354695669'
        
      order by ordinal_position

  
[0m16:54:02.585571 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:54:02.586447 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:54:02.594053 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.600150 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.600929 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:02.601698 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:02.622963 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:54:02.623866 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:54:02.630282 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.636218 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.637060 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165354695669'
        
      order by ordinal_position

  
[0m16:54:02.637842 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165354698714'
        
      order by ordinal_position

  
[0m16:54:02.658250 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:54:02.658962 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:54:02.665001 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.671055 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.671804 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:02.672481 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:54:02.691453 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:54:02.692034 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:54:02.698487 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.702489 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.703009 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165354695669'
        
      order by ordinal_position

  
[0m16:54:02.703461 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165354698714'
        
      order by ordinal_position

  
[0m16:54:02.724512 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:54:02.724967 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:54:02.727678 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m16:54:02.730326 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.fact_snapshot"
[0m16:54:02.731107 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.731642 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      update "postgres"."at3"."listing_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "listing_snapshot__dbt_tmp165354698714" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."listing_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."listing_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."listing_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "listing_snapshot__dbt_tmp165354698714" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:54:02.732237 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.732696 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      update "postgres"."at3"."fact_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "fact_snapshot__dbt_tmp165354695669" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."fact_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."fact_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."fact_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "accommodates", "price", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "fact_snapshot__dbt_tmp165354695669" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:54:02.750496 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:54:02.750886 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:54:02.752708 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:54:02.754146 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:54:02.754559 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:54:02.754945 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:54:02.755325 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:54:02.755700 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:54:02.770083 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:54:02.771377 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (execute): 16:53:54.393224 => 16:54:02.771161
[0m16:54:02.771845 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: Close
[0m16:54:02.772282 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:54:02.773466 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (execute): 16:53:54.447127 => 16:54:02.773255
[0m16:54:02.774226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38384cd30>]}
[0m16:54:02.774616 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: Close
[0m16:54:02.775326 [info ] [Thread-1  ]: 1 of 4 OK snapshotted at3.fact_snapshot ........................................ [[32mINSERT 0 0[0m in 8.42s]
[0m16:54:02.776015 [debug] [Thread-1  ]: Finished running node snapshot.bde.fact_snapshot
[0m16:54:02.776769 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5705760-d67e-4aa1-8cfe-04e255122def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd370304d30>]}
[0m16:54:02.777461 [info ] [Thread-3  ]: 3 of 4 OK snapshotted at3.listing_snapshot ..................................... [[32mINSERT 0 0[0m in 8.42s]
[0m16:54:02.778059 [debug] [Thread-3  ]: Finished running node snapshot.bde.listing_snapshot
[0m16:54:02.779684 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:02.780031 [debug] [MainThread]: On master: BEGIN
[0m16:54:02.780340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:02.945686 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:54:02.946736 [debug] [MainThread]: On master: COMMIT
[0m16:54:02.947454 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:02.948011 [debug] [MainThread]: On master: COMMIT
[0m16:54:02.964149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:54:02.964859 [debug] [MainThread]: On master: Close
[0m16:54:02.966454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:02.967114 [debug] [MainThread]: Connection 'snapshot.bde.fact_snapshot' was properly closed.
[0m16:54:02.967718 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m16:54:02.968303 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m16:54:02.968883 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m16:54:02.969624 [info ] [MainThread]: 
[0m16:54:02.970380 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 9.64 seconds (9.64s).
[0m16:54:02.972538 [debug] [MainThread]: Command end result
[0m16:54:02.985272 [info ] [MainThread]: 
[0m16:54:02.985988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:02.986491 [info ] [MainThread]: 
[0m16:54:02.987038 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:54:02.987979 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:54:02.987819 after 9.92 seconds
[0m16:54:02.988603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd380bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3835db6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3835dbc40>]}
[0m16:54:02.989209 [debug] [MainThread]: Flushing usage events
[0m16:57:42.903891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd20ba96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd230727c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd230728b0>]}


============================== 16:57:42.907895 | 7623b05e-2675-4e16-9698-b1f196be6b15 ==============================
[0m16:57:42.907895 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:57:42.908527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:43.048154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2308c2e0>]}
[0m16:57:43.059110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd231981f0>]}
[0m16:57:43.059678 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m16:57:43.084826 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:57:43.112701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:43.122488 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m16:57:43.156937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m16:57:43.160852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd006f00d0>]}
[0m16:57:43.173318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd231fe8b0>]}
[0m16:57:43.173755 [info ] [MainThread]: Found 4 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m16:57:43.174049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd231fe9a0>]}
[0m16:57:43.175323 [info ] [MainThread]: 
[0m16:57:43.175914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:57:43.176877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:57:43.184956 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:57:43.185337 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:57:43.185584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:43.416676 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m16:57:43.418864 [debug] [ThreadPool]: On list_postgres: Close
[0m16:57:43.421882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m16:57:43.428037 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:57:43.428433 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m16:57:43.428779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:43.604129 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:57:43.605065 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:57:43.605697 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m16:57:43.626466 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:57:43.629168 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m16:57:43.642798 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m16:57:43.653544 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.654221 [debug] [MainThread]: On master: BEGIN
[0m16:57:43.654704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:43.831037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:57:43.833195 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.834489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:57:43.868385 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m16:57:43.878484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd231fe850>]}
[0m16:57:43.879493 [debug] [MainThread]: On master: ROLLBACK
[0m16:57:43.895262 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.895968 [debug] [MainThread]: On master: BEGIN
[0m16:57:43.926734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:57:43.928421 [debug] [MainThread]: On master: COMMIT
[0m16:57:43.929518 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:43.930580 [debug] [MainThread]: On master: COMMIT
[0m16:57:43.946370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:57:43.948266 [debug] [MainThread]: On master: Close
[0m16:57:43.952003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:57:43.953009 [info ] [MainThread]: 
[0m16:57:43.959931 [debug] [Thread-1  ]: Began running node snapshot.bde.fact_snapshot
[0m16:57:43.960935 [debug] [Thread-2  ]: Began running node snapshot.bde.host_snapshot
[0m16:57:43.961958 [debug] [Thread-3  ]: Began running node snapshot.bde.listing_snapshot
[0m16:57:43.962791 [debug] [Thread-4  ]: Began running node snapshot.bde.property_snapshot
[0m16:57:43.963787 [info ] [Thread-1  ]: 1 of 4 START snapshot at3.fact_snapshot ........................................ [RUN]
[0m16:57:43.965054 [info ] [Thread-2  ]: 2 of 4 START snapshot at3.host_snapshot ........................................ [RUN]
[0m16:57:43.966251 [info ] [Thread-3  ]: 3 of 4 START snapshot at3.listing_snapshot ..................................... [RUN]
[0m16:57:43.967179 [info ] [Thread-4  ]: 4 of 4 START snapshot at3.property_snapshot .................................... [RUN]
[0m16:57:43.968495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.fact_snapshot)
[0m16:57:43.969771 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m16:57:43.970986 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m16:57:43.972163 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m16:57:43.972882 [debug] [Thread-1  ]: Began compiling node snapshot.bde.fact_snapshot
[0m16:57:43.973576 [debug] [Thread-2  ]: Began compiling node snapshot.bde.host_snapshot
[0m16:57:43.974204 [debug] [Thread-3  ]: Began compiling node snapshot.bde.listing_snapshot
[0m16:57:43.974840 [debug] [Thread-4  ]: Began compiling node snapshot.bde.property_snapshot
[0m16:57:43.989001 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (compile): 16:57:43.975355 => 16:57:43.988609
[0m16:57:43.994543 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (compile): 16:57:43.989502 => 16:57:43.994247
[0m16:57:43.999009 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (compile): 16:57:43.995011 => 16:57:43.998720
[0m16:57:44.002702 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (compile): 16:57:43.999442 => 16:57:44.002463
[0m16:57:44.003216 [debug] [Thread-1  ]: Began executing node snapshot.bde.fact_snapshot
[0m16:57:44.003675 [debug] [Thread-2  ]: Began executing node snapshot.bde.host_snapshot
[0m16:57:44.004117 [debug] [Thread-3  ]: Began executing node snapshot.bde.listing_snapshot
[0m16:57:44.004549 [debug] [Thread-4  ]: Began executing node snapshot.bde.property_snapshot
[0m16:57:44.055350 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:44.057718 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:44.061428 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:44.064512 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:44.064830 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: BEGIN
[0m16:57:44.065115 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: BEGIN
[0m16:57:44.065384 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m16:57:44.065649 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: BEGIN
[0m16:57:44.065909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:57:44.066165 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:57:44.066418 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:57:44.066673 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:57:44.232820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:57:44.233599 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:57:44.234293 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:44.234816 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:44.235347 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:44.235898 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:44.238421 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:57:44.238934 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:44.239479 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:44.251843 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:57:44.252412 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:44.252989 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:44.263356 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:57:44.275843 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:57:44.300938 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:57:44.313403 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m16:57:44.313916 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:44.314366 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:44.316622 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:44.319013 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:44.319457 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

        
  
    

  create temporary table "fact_snapshot__dbt_tmp165744296333"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,accommodates,price, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."fact_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:57:44.319974 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

        
  
    

  create temporary table "listing_snapshot__dbt_tmp165744290096"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."listing_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:57:44.320481 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp165744315943"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            nullif(host_since, host_since) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            host_since as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.host_since)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.host_since)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:57:44.320986 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp165744318397"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  id,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price,
  has_availability,
  availability_30
from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:57:50.226762 [debug] [Thread-2  ]: SQL status: SELECT 0 in 6.0 seconds
[0m16:57:50.239063 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.240311 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165744315943'
        
      order by ordinal_position

  
[0m16:57:50.261548 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:57:50.270201 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.271299 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:50.290467 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:57:50.297807 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.298894 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165744315943'
        
      order by ordinal_position

  
[0m16:57:50.318428 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:57:50.328598 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.329542 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:50.348461 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:57:50.408975 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.409502 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165744315943'
        
      order by ordinal_position

  
[0m16:57:50.428331 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:57:50.435036 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m16:57:50.436342 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.436786 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."at3"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp165744315943" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."host_snapshot" ("id", "host_id", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp165744315943" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:57:50.452316 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:57:50.466117 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:57:50.466494 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:57:50.466826 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:57:50.603905 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:57:50.610287 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (execute): 16:57:44.028980 => 16:57:50.609829
[0m16:57:50.611201 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: Close
[0m16:57:50.613092 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd221f1fa0>]}
[0m16:57:50.615969 [info ] [Thread-2  ]: 2 of 4 OK snapshotted at3.host_snapshot ........................................ [[32mINSERT 0 0[0m in 6.64s]
[0m16:57:50.617239 [debug] [Thread-2  ]: Finished running node snapshot.bde.host_snapshot
[0m16:57:50.649502 [debug] [Thread-4  ]: SQL status: SELECT 0 in 6.0 seconds
[0m16:57:50.654909 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.655734 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp165744318397'
        
      order by ordinal_position

  
[0m16:57:50.677826 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:57:50.684262 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.685090 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:50.726549 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m16:57:50.733668 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.734663 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp165744318397'
        
      order by ordinal_position

  
[0m16:57:50.757755 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:57:50.764906 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.765838 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:50.789716 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m16:57:50.798937 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.800037 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp165744318397'
        
      order by ordinal_position

  
[0m16:57:50.822461 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m16:57:50.829392 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m16:57:50.832273 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.833437 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."at3"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp165744318397" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."property_snapshot" ("id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "has_availability", "availability_30", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp165744318397" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:57:50.849180 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:57:50.852519 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m16:57:50.853408 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m16:57:50.854197 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m16:57:50.870112 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:57:50.872812 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (execute): 16:57:44.061681 => 16:57:50.872371
[0m16:57:50.873681 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: Close
[0m16:57:50.875560 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd007169d0>]}
[0m16:57:50.877126 [info ] [Thread-4  ]: 4 of 4 OK snapshotted at3.property_snapshot .................................... [[32mINSERT 0 0[0m in 6.90s]
[0m16:57:50.878493 [debug] [Thread-4  ]: Finished running node snapshot.bde.property_snapshot
[0m16:57:51.214943 [debug] [Thread-3  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:57:51.225683 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.226844 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165744290096'
        
      order by ordinal_position

  
[0m16:57:51.269970 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:57:51.282131 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.283264 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:51.297288 [debug] [Thread-1  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:57:51.303308 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.304305 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165744296333'
        
      order by ordinal_position

  
[0m16:57:51.323861 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:57:51.331716 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.332662 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165744290096'
        
      order by ordinal_position

  
[0m16:57:51.344174 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:57:51.351384 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.352371 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:51.373784 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:57:51.381197 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.382136 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:51.395202 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:57:51.402434 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.403353 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165744296333'
        
      order by ordinal_position

  
[0m16:57:51.428114 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:57:51.436503 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.437429 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165744290096'
        
      order by ordinal_position

  
[0m16:57:51.440038 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:57:51.446880 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.447627 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:57:51.472730 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:57:51.478155 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m16:57:51.479725 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.480761 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      update "postgres"."at3"."listing_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "listing_snapshot__dbt_tmp165744290096" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."listing_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."listing_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."listing_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "listing_snapshot__dbt_tmp165744290096" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:57:51.483076 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:57:51.490204 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.490965 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165744296333'
        
      order by ordinal_position

  
[0m16:57:51.518920 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:57:51.522115 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:57:51.522965 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:57:51.523750 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:57:51.527471 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:57:51.536241 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.fact_snapshot"
[0m16:57:51.539001 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.539859 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      update "postgres"."at3"."fact_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "fact_snapshot__dbt_tmp165744296333" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."fact_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."fact_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."fact_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "accommodates", "price", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "fact_snapshot__dbt_tmp165744296333" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:57:51.550094 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:57:51.551970 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (execute): 16:57:44.057941 => 16:57:51.551643
[0m16:57:51.552672 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: Close
[0m16:57:51.554125 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23279940>]}
[0m16:57:51.555404 [info ] [Thread-3  ]: 3 of 4 OK snapshotted at3.listing_snapshot ..................................... [[32mINSERT 0 0[0m in 7.58s]
[0m16:57:51.556490 [debug] [Thread-3  ]: Finished running node snapshot.bde.listing_snapshot
[0m16:57:51.564672 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:57:51.567107 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:57:51.567729 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:57:51.568289 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:57:51.588433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:57:51.590532 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (execute): 16:57:44.004863 => 16:57:51.590251
[0m16:57:51.591192 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: Close
[0m16:57:51.592614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7623b05e-2675-4e16-9698-b1f196be6b15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00838a60>]}
[0m16:57:51.593740 [info ] [Thread-1  ]: 1 of 4 OK snapshotted at3.fact_snapshot ........................................ [[32mINSERT 0 0[0m in 7.62s]
[0m16:57:51.594584 [debug] [Thread-1  ]: Finished running node snapshot.bde.fact_snapshot
[0m16:57:51.596760 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:51.597314 [debug] [MainThread]: On master: BEGIN
[0m16:57:51.597742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:51.773982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:57:51.775842 [debug] [MainThread]: On master: COMMIT
[0m16:57:51.776582 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:51.777318 [debug] [MainThread]: On master: COMMIT
[0m16:57:51.792085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:57:51.793127 [debug] [MainThread]: On master: Close
[0m16:57:51.795279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:51.796144 [debug] [MainThread]: Connection 'snapshot.bde.fact_snapshot' was properly closed.
[0m16:57:51.796784 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m16:57:51.797409 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m16:57:51.798019 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m16:57:51.798760 [info ] [MainThread]: 
[0m16:57:51.799545 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 8.62 seconds (8.62s).
[0m16:57:51.801870 [debug] [MainThread]: Command end result
[0m16:57:51.815135 [info ] [MainThread]: 
[0m16:57:51.816075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:51.816705 [info ] [MainThread]: 
[0m16:57:51.817352 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:57:51.818335 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:57:51.818185 after 8.95 seconds
[0m16:57:51.818933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd20ba96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0083af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd00848f40>]}
[0m16:57:51.819526 [debug] [MainThread]: Flushing usage events
[0m16:58:52.022663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e85a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea719820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea719910>]}


============================== 16:58:52.026658 | a923eee4-4ab8-4dc4-af19-1cf7832eb8d3 ==============================
[0m16:58:52.026658 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:58:52.027373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:52.170013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea719850>]}
[0m16:58:52.180736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea7fd250>]}
[0m16:58:52.181278 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m16:58:52.199406 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:58:52.226870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:52.227466 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m16:58:52.259721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.datamart
- models.bde.warehouse
[0m16:58:52.263678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f86c70d0>]}
[0m16:58:52.277643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f861e910>]}
[0m16:58:52.278163 [info ] [MainThread]: Found 4 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m16:58:52.278479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f861ea00>]}
[0m16:58:52.279957 [info ] [MainThread]: 
[0m16:58:52.280751 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:58:52.281905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:58:52.289537 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:58:52.289867 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:58:52.290126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:52.523782 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m16:58:52.526298 [debug] [ThreadPool]: On list_postgres: Close
[0m16:58:52.529291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m16:58:52.536354 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:58:52.536792 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m16:58:52.537145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:52.704254 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:58:52.710888 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m16:58:52.711593 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m16:58:52.730452 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:58:52.732541 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m16:58:52.748767 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m16:58:52.759019 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:52.759605 [debug] [MainThread]: On master: BEGIN
[0m16:58:52.760074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:52.939885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:58:52.941954 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:52.943171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:58:52.969688 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m16:58:52.980116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f85df1c0>]}
[0m16:58:52.981267 [debug] [MainThread]: On master: ROLLBACK
[0m16:58:52.995567 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:52.996271 [debug] [MainThread]: On master: BEGIN
[0m16:58:53.026991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:58:53.028325 [debug] [MainThread]: On master: COMMIT
[0m16:58:53.029193 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:53.030011 [debug] [MainThread]: On master: COMMIT
[0m16:58:53.045100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:58:53.046449 [debug] [MainThread]: On master: Close
[0m16:58:53.049754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:53.050786 [info ] [MainThread]: 
[0m16:58:53.058425 [debug] [Thread-1  ]: Began running node snapshot.bde.fact_snapshot
[0m16:58:53.059451 [debug] [Thread-2  ]: Began running node snapshot.bde.host_snapshot
[0m16:58:53.060298 [debug] [Thread-3  ]: Began running node snapshot.bde.listing_snapshot
[0m16:58:53.061258 [debug] [Thread-4  ]: Began running node snapshot.bde.property2_snapshot
[0m16:58:53.062351 [info ] [Thread-1  ]: 1 of 4 START snapshot at3.fact_snapshot ........................................ [RUN]
[0m16:58:53.063399 [info ] [Thread-2  ]: 2 of 4 START snapshot at3.host_snapshot ........................................ [RUN]
[0m16:58:53.064419 [info ] [Thread-3  ]: 3 of 4 START snapshot at3.listing_snapshot ..................................... [RUN]
[0m16:58:53.065476 [info ] [Thread-4  ]: 4 of 4 START snapshot at3.property2_snapshot ................................... [RUN]
[0m16:58:53.066986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.fact_snapshot)
[0m16:58:53.068253 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m16:58:53.069402 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.listing_snapshot'
[0m16:58:53.070552 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.property2_snapshot'
[0m16:58:53.071246 [debug] [Thread-1  ]: Began compiling node snapshot.bde.fact_snapshot
[0m16:58:53.071917 [debug] [Thread-2  ]: Began compiling node snapshot.bde.host_snapshot
[0m16:58:53.072582 [debug] [Thread-3  ]: Began compiling node snapshot.bde.listing_snapshot
[0m16:58:53.073222 [debug] [Thread-4  ]: Began compiling node snapshot.bde.property2_snapshot
[0m16:58:53.091719 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (compile): 16:58:53.086468 => 16:58:53.091324
[0m16:58:53.092641 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (compile): 16:58:53.073753 => 16:58:53.092391
[0m16:58:53.097154 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (compile): 16:58:53.093083 => 16:58:53.096809
[0m16:58:53.101125 [debug] [Thread-4  ]: Timing info for snapshot.bde.property2_snapshot (compile): 16:58:53.097655 => 16:58:53.100891
[0m16:58:53.101651 [debug] [Thread-2  ]: Began executing node snapshot.bde.host_snapshot
[0m16:58:53.102108 [debug] [Thread-1  ]: Began executing node snapshot.bde.fact_snapshot
[0m16:58:53.102547 [debug] [Thread-3  ]: Began executing node snapshot.bde.listing_snapshot
[0m16:58:53.102988 [debug] [Thread-4  ]: Began executing node snapshot.bde.property2_snapshot
[0m16:58:53.156812 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:58:53.158956 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:53.162685 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:58:53.173226 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.property2_snapshot"
[0m16:58:53.173541 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: BEGIN
[0m16:58:53.173816 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: BEGIN
[0m16:58:53.174078 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: BEGIN
[0m16:58:53.174465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:58:53.174805 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:58:53.175071 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:58:53.175331 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property2_snapshot"
[0m16:58:53.175988 [debug] [Thread-4  ]: On snapshot.bde.property2_snapshot: BEGIN
[0m16:58:53.176263 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:58:53.333957 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:58:53.334748 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property2_snapshot"
[0m16:58:53.335417 [debug] [Thread-4  ]: On snapshot.bde.property2_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property2_snapshot"} */

      
  
    

  create  table "postgres"."at3"."property2_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        


select
  id,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price,
  has_availability,
  availability_30
from "postgres"."at3"."listings"

    ) sbq



  );
  
  
[0m16:58:53.338074 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:58:53.338568 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:53.339102 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:58:53.345484 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:58:53.346038 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:58:53.346604 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:58:53.352589 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:58:53.353141 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:58:53.353745 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:58:53.368404 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:58:53.385002 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:58:53.391887 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:58:53.402614 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:53.404732 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:58:53.407524 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:58:53.408032 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp165853389591"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            nullif(host_since, host_since) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            host_since as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.host_since)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.host_since)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:58:53.408622 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

        
  
    

  create temporary table "fact_snapshot__dbt_tmp165853394099"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,accommodates,price, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."fact_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:58:53.409212 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

        
  
    

  create temporary table "listing_snapshot__dbt_tmp165853406761"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."listing_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:58:56.535863 [debug] [Thread-4  ]: SQL status: SELECT 412122 in 3.0 seconds
[0m16:58:56.573899 [debug] [Thread-4  ]: On snapshot.bde.property2_snapshot: COMMIT
[0m16:58:56.574723 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property2_snapshot"
[0m16:58:56.575242 [debug] [Thread-4  ]: On snapshot.bde.property2_snapshot: COMMIT
[0m16:58:56.597311 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:58:56.598779 [debug] [Thread-4  ]: Timing info for snapshot.bde.property2_snapshot (execute): 16:58:53.162937 => 16:58:56.598479
[0m16:58:56.599420 [debug] [Thread-4  ]: On snapshot.bde.property2_snapshot: Close
[0m16:58:56.600808 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c8db9d00>]}
[0m16:58:56.603571 [info ] [Thread-4  ]: 4 of 4 OK snapshotted at3.property2_snapshot ................................... [[32mSELECT 412122[0m in 3.53s]
[0m16:58:56.604562 [debug] [Thread-4  ]: Finished running node snapshot.bde.property2_snapshot
[0m16:58:58.789216 [debug] [Thread-2  ]: SQL status: SELECT 0 in 5.0 seconds
[0m16:58:58.799023 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:58.800175 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165853389591'
        
      order by ordinal_position

  
[0m16:58:58.824487 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:58:58.834290 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:58.835359 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:58:58.854670 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:58:58.863165 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:58.864091 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165853389591'
        
      order by ordinal_position

  
[0m16:58:58.883126 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:58:58.891684 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:58.892644 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:58:58.912089 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:58:58.979123 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:58.979643 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp165853389591'
        
      order by ordinal_position

  
[0m16:58:58.999159 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:58:59.005416 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m16:58:59.007048 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:59.007533 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."at3"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp165853389591" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."host_snapshot" ("id", "host_id", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp165853389591" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:58:59.022215 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:58:59.023798 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:58:59.024223 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m16:58:59.024599 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m16:58:59.041088 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:58:59.044494 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (execute): 16:58:53.103309 => 16:58:59.044265
[0m16:58:59.044953 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: Close
[0m16:58:59.045823 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea82edf0>]}
[0m16:58:59.046555 [info ] [Thread-2  ]: 2 of 4 OK snapshotted at3.host_snapshot ........................................ [[32mINSERT 0 0[0m in 5.98s]
[0m16:58:59.047181 [debug] [Thread-2  ]: Finished running node snapshot.bde.host_snapshot
[0m16:58:59.914858 [debug] [Thread-1  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:58:59.917707 [debug] [Thread-3  ]: SQL status: SELECT 0 in 7.0 seconds
[0m16:58:59.929036 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:58:59.934280 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:58:59.935093 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165853394099'
        
      order by ordinal_position

  
[0m16:58:59.935850 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165853406761'
        
      order by ordinal_position

  
[0m16:58:59.964836 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:58:59.965873 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:58:59.973706 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:58:59.980032 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:58:59.980840 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:58:59.981620 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:59:00.007189 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:59:00.014181 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:59:00.014900 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:59:00.015672 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165853394099'
        
      order by ordinal_position

  
[0m16:59:00.021563 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:59:00.022461 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165853406761'
        
      order by ordinal_position

  
[0m16:59:00.047242 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:59:00.048110 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:59:00.054407 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:59:00.062090 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:59:00.062758 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:59:00.063400 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m16:59:00.086571 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:59:00.092967 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:59:00.093703 [debug] [Thread-3  ]: SQL status: SELECT 20 in 0.0 seconds
[0m16:59:00.094437 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp165853394099'
        
      order by ordinal_position

  
[0m16:59:00.099916 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:59:00.100655 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'listing_snapshot__dbt_tmp165853406761'
        
      order by ordinal_position

  
[0m16:59:00.119336 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m16:59:00.124020 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.fact_snapshot"
[0m16:59:00.124727 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.0 seconds
[0m16:59:00.128575 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.listing_snapshot"
[0m16:59:00.129519 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:59:00.130139 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:59:00.130833 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      update "postgres"."at3"."fact_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "fact_snapshot__dbt_tmp165853394099" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."fact_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."fact_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."fact_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "accommodates", "price", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "fact_snapshot__dbt_tmp165853394099" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:59:00.131709 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listing_snapshot"} */

      update "postgres"."at3"."listing_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "listing_snapshot__dbt_tmp165853406761" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."listing_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."listing_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."listing_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "listing_snapshot__dbt_tmp165853406761" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:59:00.146614 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:59:00.147185 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:59:00.149505 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:59:00.151658 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:59:00.152261 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m16:59:00.152835 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listing_snapshot"
[0m16:59:00.153388 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m16:59:00.153980 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: COMMIT
[0m16:59:00.170003 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:59:00.171588 [debug] [Thread-3  ]: Timing info for snapshot.bde.listing_snapshot (execute): 16:58:53.159177 => 16:59:00.171308
[0m16:59:00.172171 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:59:00.172747 [debug] [Thread-3  ]: On snapshot.bde.listing_snapshot: Close
[0m16:59:00.174261 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (execute): 16:58:53.128378 => 16:59:00.174007
[0m16:59:00.174934 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: Close
[0m16:59:00.176045 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c8dafbb0>]}
[0m16:59:00.177076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a923eee4-4ab8-4dc4-af19-1cf7832eb8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea85fe50>]}
[0m16:59:00.178152 [info ] [Thread-3  ]: 3 of 4 OK snapshotted at3.listing_snapshot ..................................... [[32mINSERT 0 0[0m in 7.11s]
[0m16:59:00.179202 [info ] [Thread-1  ]: 1 of 4 OK snapshotted at3.fact_snapshot ........................................ [[32mINSERT 0 0[0m in 7.11s]
[0m16:59:00.180114 [debug] [Thread-3  ]: Finished running node snapshot.bde.listing_snapshot
[0m16:59:00.180887 [debug] [Thread-1  ]: Finished running node snapshot.bde.fact_snapshot
[0m16:59:00.182999 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:00.183473 [debug] [MainThread]: On master: BEGIN
[0m16:59:00.183873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:00.357855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:00.359781 [debug] [MainThread]: On master: COMMIT
[0m16:59:00.360538 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:00.361283 [debug] [MainThread]: On master: COMMIT
[0m16:59:00.375868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:00.377073 [debug] [MainThread]: On master: Close
[0m16:59:00.380128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:00.381411 [debug] [MainThread]: Connection 'snapshot.bde.fact_snapshot' was properly closed.
[0m16:59:00.382147 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m16:59:00.382759 [debug] [MainThread]: Connection 'snapshot.bde.listing_snapshot' was properly closed.
[0m16:59:00.383352 [debug] [MainThread]: Connection 'snapshot.bde.property2_snapshot' was properly closed.
[0m16:59:00.384132 [info ] [MainThread]: 
[0m16:59:00.384941 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m16:59:00.387400 [debug] [MainThread]: Command end result
[0m16:59:00.400923 [info ] [MainThread]: 
[0m16:59:00.401758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:00.402347 [info ] [MainThread]: 
[0m16:59:00.403040 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:59:00.404024 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:59:00.403876 after 8.41 seconds
[0m16:59:00.404639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e85a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea85fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f862bdf0>]}
[0m16:59:00.405252 [debug] [MainThread]: Flushing usage events
[0m17:01:31.888483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe980a996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe983020880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe983020970>]}


============================== 17:01:31.892612 | 258a00c4-f3da-4794-b758-3910518507f3 ==============================
[0m17:01:31.892612 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:01:31.893287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m17:01:32.032647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9830208b0>]}
[0m17:01:32.043552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9831452b0>]}
[0m17:01:32.044153 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:01:32.060971 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:01:32.086906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:01:32.087481 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m17:01:32.087819 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m17:01:32.126443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m17:01:32.130600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9603470d0>]}
[0m17:01:32.143465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe960320670>]}
[0m17:01:32.143914 [info ] [MainThread]: Found 4 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m17:01:32.144212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe960320340>]}
[0m17:01:32.145495 [info ] [MainThread]: 
[0m17:01:32.146159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:01:32.147209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:01:32.154687 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:01:32.155010 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:01:32.155257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:32.455720 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m17:01:32.478501 [debug] [ThreadPool]: On list_postgres: Close
[0m17:01:32.503912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m17:01:32.525773 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:01:32.527572 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m17:01:32.528331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:32.716569 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:01:32.718916 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:01:32.720613 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m17:01:32.739616 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m17:01:32.746300 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m17:01:32.761213 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m17:01:32.786463 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:32.788099 [debug] [MainThread]: On master: BEGIN
[0m17:01:32.789539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:32.975655 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:01:32.976395 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:32.977051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:01:33.001151 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:01:33.004178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe96030d0d0>]}
[0m17:01:33.004898 [debug] [MainThread]: On master: ROLLBACK
[0m17:01:33.018978 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:33.019547 [debug] [MainThread]: On master: BEGIN
[0m17:01:33.052535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:01:33.053355 [debug] [MainThread]: On master: COMMIT
[0m17:01:33.054063 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:33.054724 [debug] [MainThread]: On master: COMMIT
[0m17:01:33.068854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:01:33.069594 [debug] [MainThread]: On master: Close
[0m17:01:33.071288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:01:33.072051 [info ] [MainThread]: 
[0m17:01:33.077157 [debug] [Thread-1  ]: Began running node snapshot.bde.fact_snapshot
[0m17:01:33.078553 [debug] [Thread-2  ]: Began running node snapshot.bde.host_snapshot
[0m17:01:33.079320 [debug] [Thread-3  ]: Began running node snapshot.bde.listings_snapshot
[0m17:01:33.080838 [debug] [Thread-4  ]: Began running node snapshot.bde.property_snapshot
[0m17:01:33.080234 [info ] [Thread-1  ]: 1 of 4 START snapshot at3.fact_snapshot ........................................ [RUN]
[0m17:01:33.081847 [info ] [Thread-2  ]: 2 of 4 START snapshot at3.host_snapshot ........................................ [RUN]
[0m17:01:33.082683 [info ] [Thread-3  ]: 3 of 4 START snapshot at3.listings_snapshot .................................... [RUN]
[0m17:01:33.083500 [info ] [Thread-4  ]: 4 of 4 START snapshot at3.property_snapshot .................................... [RUN]
[0m17:01:33.084951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now snapshot.bde.fact_snapshot)
[0m17:01:33.086119 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.host_snapshot'
[0m17:01:33.087184 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.listings_snapshot'
[0m17:01:33.088269 [debug] [Thread-4  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m17:01:33.088916 [debug] [Thread-1  ]: Began compiling node snapshot.bde.fact_snapshot
[0m17:01:33.089494 [debug] [Thread-2  ]: Began compiling node snapshot.bde.host_snapshot
[0m17:01:33.090076 [debug] [Thread-3  ]: Began compiling node snapshot.bde.listings_snapshot
[0m17:01:33.090624 [debug] [Thread-4  ]: Began compiling node snapshot.bde.property_snapshot
[0m17:01:33.102521 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (compile): 17:01:33.091053 => 17:01:33.102218
[0m17:01:33.107445 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (compile): 17:01:33.102930 => 17:01:33.107199
[0m17:01:33.110767 [debug] [Thread-3  ]: Timing info for snapshot.bde.listings_snapshot (compile): 17:01:33.107813 => 17:01:33.110556
[0m17:01:33.113922 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (compile): 17:01:33.111087 => 17:01:33.113711
[0m17:01:33.114365 [debug] [Thread-1  ]: Began executing node snapshot.bde.fact_snapshot
[0m17:01:33.114758 [debug] [Thread-2  ]: Began executing node snapshot.bde.host_snapshot
[0m17:01:33.115144 [debug] [Thread-3  ]: Began executing node snapshot.bde.listings_snapshot
[0m17:01:33.115525 [debug] [Thread-4  ]: Began executing node snapshot.bde.property_snapshot
[0m17:01:33.156404 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:33.159256 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:33.168318 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.listings_snapshot"
[0m17:01:33.171406 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:33.171715 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: BEGIN
[0m17:01:33.171991 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: BEGIN
[0m17:01:33.172350 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: BEGIN
[0m17:01:33.172651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:33.172956 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:01:33.173231 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:01:33.173657 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listings_snapshot"
[0m17:01:33.174157 [debug] [Thread-3  ]: On snapshot.bde.listings_snapshot: BEGIN
[0m17:01:33.174417 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:01:33.354480 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:01:33.355437 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:01:33.356167 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:01:33.356808 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:01:33.357595 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:33.358291 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:33.358951 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listings_snapshot"
[0m17:01:33.359620 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:33.360336 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:33.361126 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:33.361924 [debug] [Thread-3  ]: On snapshot.bde.listings_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.listings_snapshot"} */

      
  
    

  create  table "postgres"."at3"."listings_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select id,listing_id,scrape_id,scraped_date,number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"

    ) sbq



  );
  
  
[0m17:01:33.362732 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:33.398751 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m17:01:33.399586 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m17:01:33.405923 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m17:01:33.435891 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:33.439261 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:33.442563 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:33.443207 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp170133427558"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            nullif(host_since, host_since) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            host_since as dbt_updated_at,
            host_since as dbt_valid_from,
            host_since as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.host_since)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.host_since)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:01:33.443938 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

        
  
    

  create temporary table "fact_snapshot__dbt_tmp170133438294"
  
  
    as
  
  (
    with snapshot_query as (

        



select id,listing_id,scrape_id,scraped_date,accommodates,price, number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."fact_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:01:33.444611 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp170133441672"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  id,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price,
  has_availability,
  availability_30
from "postgres"."at3"."listings"


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "postgres"."at3"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:01:36.586137 [debug] [Thread-3  ]: SQL status: SELECT 412122 in 3.0 seconds
[0m17:01:36.641117 [debug] [Thread-3  ]: On snapshot.bde.listings_snapshot: COMMIT
[0m17:01:36.642105 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.listings_snapshot"
[0m17:01:36.642731 [debug] [Thread-3  ]: On snapshot.bde.listings_snapshot: COMMIT
[0m17:01:36.665092 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:01:36.666948 [debug] [Thread-3  ]: Timing info for snapshot.bde.listings_snapshot (execute): 17:01:33.159463 => 17:01:36.666531
[0m17:01:36.667690 [debug] [Thread-3  ]: On snapshot.bde.listings_snapshot: Close
[0m17:01:36.669468 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97032ccd0>]}
[0m17:01:36.672094 [info ] [Thread-3  ]: 3 of 4 OK snapshotted at3.listings_snapshot .................................... [[32mSELECT 412122[0m in 3.58s]
[0m17:01:36.673087 [debug] [Thread-3  ]: Finished running node snapshot.bde.listings_snapshot
[0m17:01:39.027430 [debug] [Thread-2  ]: SQL status: SELECT 0 in 6.0 seconds
[0m17:01:39.037684 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.039074 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp170133427558'
        
      order by ordinal_position

  
[0m17:01:39.060632 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m17:01:39.069933 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.071763 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:39.104617 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m17:01:39.116440 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.118592 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp170133427558'
        
      order by ordinal_position

  
[0m17:01:39.170307 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m17:01:39.182905 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.184843 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:39.232891 [debug] [Thread-2  ]: SQL status: SELECT 10 in 0.0 seconds
[0m17:01:39.262827 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.264385 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp170133427558'
        
      order by ordinal_position

  
[0m17:01:39.309508 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m17:01:39.388611 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m17:01:39.390115 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.390532 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."at3"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp170133427558" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."host_snapshot" ("id", "host_id", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp170133427558" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:01:39.436998 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m17:01:39.439031 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m17:01:39.439543 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m17:01:39.440020 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: COMMIT
[0m17:01:39.441759 [debug] [Thread-4  ]: SQL status: SELECT 0 in 6.0 seconds
[0m17:01:39.445157 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.445718 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp170133441672'
        
      order by ordinal_position

  
[0m17:01:39.458770 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:01:39.462697 [debug] [Thread-2  ]: Timing info for snapshot.bde.host_snapshot (execute): 17:01:33.141114 => 17:01:39.462422
[0m17:01:39.463254 [debug] [Thread-2  ]: On snapshot.bde.host_snapshot: Close
[0m17:01:39.464359 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe982321b80>]}
[0m17:01:39.465303 [info ] [Thread-2  ]: 2 of 4 OK snapshotted at3.host_snapshot ........................................ [[32mINSERT 0 0[0m in 6.38s]
[0m17:01:39.466101 [debug] [Thread-2  ]: Finished running node snapshot.bde.host_snapshot
[0m17:01:39.474942 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m17:01:39.479369 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.479941 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:39.510688 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m17:01:39.516101 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.516834 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp170133441672'
        
      order by ordinal_position

  
[0m17:01:39.540933 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m17:01:39.547504 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.548274 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:39.575224 [debug] [Thread-4  ]: SQL status: SELECT 13 in 0.0 seconds
[0m17:01:39.582832 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.583778 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp170133441672'
        
      order by ordinal_position

  
[0m17:01:39.608915 [debug] [Thread-4  ]: SQL status: SELECT 15 in 0.0 seconds
[0m17:01:39.616449 [debug] [Thread-4  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m17:01:39.618250 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.619287 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."at3"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp170133441672" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."property_snapshot" ("id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "has_availability", "availability_30", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp170133441672" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:01:39.636175 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m17:01:39.641941 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m17:01:39.643132 [debug] [Thread-4  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m17:01:39.644139 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: COMMIT
[0m17:01:39.659909 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:01:39.663815 [debug] [Thread-4  ]: Timing info for snapshot.bde.property_snapshot (execute): 17:01:33.168566 => 17:01:39.663222
[0m17:01:39.664847 [debug] [Thread-4  ]: On snapshot.bde.property_snapshot: Close
[0m17:01:39.667244 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9602f23a0>]}
[0m17:01:39.669614 [info ] [Thread-4  ]: 4 of 4 OK snapshotted at3.property_snapshot .................................... [[32mINSERT 0 0[0m in 6.58s]
[0m17:01:39.671478 [debug] [Thread-4  ]: Finished running node snapshot.bde.property_snapshot
[0m17:01:39.781052 [debug] [Thread-1  ]: SQL status: SELECT 0 in 6.0 seconds
[0m17:01:39.794181 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.795716 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp170133438294'
        
      order by ordinal_position

  
[0m17:01:39.817231 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m17:01:39.827360 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.829243 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:39.849543 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m17:01:39.861977 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.863440 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp170133438294'
        
      order by ordinal_position

  
[0m17:01:39.881634 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m17:01:39.893892 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.895347 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot'
        
        and table_schema = 'at3'
        
      order by ordinal_position

  
[0m17:01:39.914108 [debug] [Thread-1  ]: SQL status: SELECT 17 in 0.0 seconds
[0m17:01:39.927271 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.928348 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_snapshot__dbt_tmp170133438294'
        
      order by ordinal_position

  
[0m17:01:39.947206 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0.0 seconds
[0m17:01:39.956038 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.fact_snapshot"
[0m17:01:39.957740 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.958785 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.fact_snapshot"} */

      update "postgres"."at3"."fact_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "fact_snapshot__dbt_tmp170133438294" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."at3"."fact_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."at3"."fact_snapshot".dbt_valid_to is null;

    insert into "postgres"."at3"."fact_snapshot" ("id", "listing_id", "scrape_id", "scraped_date", "accommodates", "price", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "fact_snapshot__dbt_tmp170133438294" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:01:39.978836 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m17:01:39.984702 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m17:01:39.985911 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.fact_snapshot"
[0m17:01:39.986734 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: COMMIT
[0m17:01:40.004141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:01:40.007523 [debug] [Thread-1  ]: Timing info for snapshot.bde.fact_snapshot (execute): 17:01:33.115803 => 17:01:40.006952
[0m17:01:40.008741 [debug] [Thread-1  ]: On snapshot.bde.fact_snapshot: Close
[0m17:01:40.011639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258a00c4-f3da-4794-b758-3910518507f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97030ce20>]}
[0m17:01:40.013966 [info ] [Thread-1  ]: 1 of 4 OK snapshotted at3.fact_snapshot ........................................ [[32mINSERT 0 0[0m in 6.93s]
[0m17:01:40.015663 [debug] [Thread-1  ]: Finished running node snapshot.bde.fact_snapshot
[0m17:01:40.020582 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:40.021348 [debug] [MainThread]: On master: BEGIN
[0m17:01:40.021999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:40.216919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:01:40.219236 [debug] [MainThread]: On master: COMMIT
[0m17:01:40.220188 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:40.221170 [debug] [MainThread]: On master: COMMIT
[0m17:01:40.237665 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:01:40.240159 [debug] [MainThread]: On master: Close
[0m17:01:40.243909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:40.245111 [debug] [MainThread]: Connection 'snapshot.bde.fact_snapshot' was properly closed.
[0m17:01:40.246097 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m17:01:40.247137 [debug] [MainThread]: Connection 'snapshot.bde.listings_snapshot' was properly closed.
[0m17:01:40.248648 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m17:01:40.250459 [info ] [MainThread]: 
[0m17:01:40.251841 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m17:01:40.256118 [debug] [MainThread]: Command end result
[0m17:01:40.275358 [info ] [MainThread]: 
[0m17:01:40.276483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:40.277244 [info ] [MainThread]: 
[0m17:01:40.278039 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:01:40.279360 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:01:40.279166 after 8.42 seconds
[0m17:01:40.280159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe980a996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe98269a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9602f26d0>]}
[0m17:01:40.280886 [debug] [MainThread]: Flushing usage events
[0m17:08:30.140548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5309d16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc532fb87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc532fb88b0>]}


============================== 17:08:30.144619 | 2dceca65-a262-4312-9f18-30076bc80147 ==============================
[0m17:08:30.144619 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:08:30.145313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:30.283289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dceca65-a262-4312-9f18-30076bc80147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc532fb8850>]}
[0m17:08:30.295074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dceca65-a262-4312-9f18-30076bc80147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5330e1220>]}
[0m17:08:30.296052 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:08:30.317961 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:08:30.347464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m17:08:30.348076 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/listings_stg.sql
[0m17:08:30.348399 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/host_stg.sql
[0m17:08:30.348681 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m17:08:30.348964 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/code_stg.sql
[0m17:08:30.349239 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m17:08:30.398152 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.listings_stg' (models/staging/listings_stg.sql) depends on a node named 'listing_snapshot' which was not found
[0m17:08:30.401917 [debug] [MainThread]: Command `dbt run` failed at 17:08:30.401461 after 0.30 seconds
[0m17:08:30.402557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5309d16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc520102d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc52013a670>]}
[0m17:08:30.402953 [debug] [MainThread]: Flushing usage events
[0m17:08:50.778213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f8b3cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fac998b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fac999a0>]}


============================== 17:08:50.782097 | d9274d1a-4793-479e-b9a6-fef15b4a359e ==============================
[0m17:08:50.782097 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:08:50.782726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:50.885921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fac99940>]}
[0m17:08:50.896750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fadbf2e0>]}
[0m17:08:50.897669 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:08:50.915657 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:08:50.942961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m17:08:50.943498 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m17:08:50.943805 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/listings_stg.sql
[0m17:08:50.944088 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m17:08:50.944367 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/code_stg.sql
[0m17:08:50.944646 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/host_stg.sql
[0m17:08:50.944972 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/listings_snapshot.sql
[0m17:08:51.007853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m17:08:51.011782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e83d7f10>]}
[0m17:08:51.024679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d8b6e670>]}
[0m17:08:51.025140 [info ] [MainThread]: Found 4 snapshots, 5 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m17:08:51.025436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d8b6e700>]}
[0m17:08:51.026942 [info ] [MainThread]: 
[0m17:08:51.027576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:51.028731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:08:51.037066 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:08:51.037482 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:08:51.037738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:51.452328 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m17:08:51.455258 [debug] [ThreadPool]: On list_postgres: Close
[0m17:08:51.457296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_staging)
[0m17:08:51.458281 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "staging"
"
[0m17:08:51.466028 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m17:08:51.466494 [debug] [ThreadPool]: On create_postgres_staging: BEGIN
[0m17:08:51.466879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:51.656130 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:08:51.658116 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m17:08:51.658883 [debug] [ThreadPool]: On create_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_staging"} */
create schema if not exists "staging"
[0m17:08:51.673968 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:08:51.678137 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m17:08:51.679428 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m17:08:51.680535 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m17:08:51.696294 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:08:51.697314 [debug] [ThreadPool]: On create_postgres_staging: Close
[0m17:08:51.701950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m17:08:51.710295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_staging, now list_postgres_staging)
[0m17:08:51.715949 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:08:51.719539 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m17:08:51.720127 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m17:08:51.720625 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m17:08:51.721101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:51.721570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:51.892310 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:08:51.893910 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:08:51.895036 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m17:08:51.895921 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:08:51.896744 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:08:51.897655 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m17:08:51.918328 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m17:08:51.919287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:08:51.923360 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m17:08:51.925879 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m17:08:51.940792 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m17:08:51.941617 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m17:08:51.956573 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:51.957302 [debug] [MainThread]: On master: BEGIN
[0m17:08:51.957888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:52.137225 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.138290 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:52.139588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:52.163729 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:08:52.171619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e848d070>]}
[0m17:08:52.172899 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:52.188983 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:52.189676 [debug] [MainThread]: On master: BEGIN
[0m17:08:52.222266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.223909 [debug] [MainThread]: On master: COMMIT
[0m17:08:52.224971 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:52.226019 [debug] [MainThread]: On master: COMMIT
[0m17:08:52.241501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:08:52.242898 [debug] [MainThread]: On master: Close
[0m17:08:52.246033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:08:52.247126 [info ] [MainThread]: 
[0m17:08:52.254419 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m17:08:52.255363 [debug] [Thread-2  ]: Began running node model.bde.host_stg
[0m17:08:52.256321 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m17:08:52.257336 [info ] [Thread-1  ]: 1 of 5 START sql view model staging.code_stg ................................... [RUN]
[0m17:08:52.258604 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m17:08:52.259630 [info ] [Thread-2  ]: 2 of 5 START sql view model staging.host_stg ................................... [RUN]
[0m17:08:52.260671 [info ] [Thread-3  ]: 3 of 5 START sql view model staging.listings_stg ............................... [RUN]
[0m17:08:52.262165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.code_stg)
[0m17:08:52.263323 [info ] [Thread-4  ]: 4 of 5 START sql view model staging.property_stg ............................... [RUN]
[0m17:08:52.264603 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.host_stg)
[0m17:08:52.265827 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.listings_stg'
[0m17:08:52.266650 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m17:08:52.267929 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.property_stg'
[0m17:08:52.268651 [debug] [Thread-2  ]: Began compiling node model.bde.host_stg
[0m17:08:52.269304 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m17:08:52.282780 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m17:08:52.283516 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m17:08:52.287672 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.host_stg"
[0m17:08:52.291282 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m17:08:52.295245 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m17:08:52.296907 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 17:08:52.288102 => 17:08:52.296602
[0m17:08:52.297515 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 17:08:52.269817 => 17:08:52.297245
[0m17:08:52.298034 [debug] [Thread-2  ]: Timing info for model.bde.host_stg (compile): 17:08:52.283961 => 17:08:52.297827
[0m17:08:52.298527 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m17:08:52.299033 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 17:08:52.291838 => 17:08:52.298826
[0m17:08:52.299478 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m17:08:52.299956 [debug] [Thread-2  ]: Began executing node model.bde.host_stg
[0m17:08:52.332213 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m17:08:52.335466 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m17:08:52.338708 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m17:08:52.341521 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.host_stg"
[0m17:08:52.344421 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m17:08:52.345510 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:08:52.345885 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:08:52.346184 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m17:08:52.346523 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m17:08:52.346794 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m17:08:52.347065 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:08:52.347347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:52.347623 [debug] [Thread-2  ]: On model.bde.host_stg: BEGIN
[0m17:08:52.347891 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:08:52.348178 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m17:08:52.348578 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:08:52.348967 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:08:52.517603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.518423 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:08:52.519059 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m17:08:52.523218 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.523786 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:08:52.524408 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m17:08:52.525276 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.525900 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.526507 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:08:52.527091 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m17:08:52.527681 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m17:08:52.528315 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m17:08:52.537004 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:52.545511 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:08:52.546090 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:52.546564 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m17:08:52.550265 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:08:52.550778 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:52.551233 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:52.551749 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m17:08:52.555862 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:08:52.593527 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:52.594832 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m17:08:52.595255 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m17:08:52.606519 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m17:08:52.606850 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m17:08:52.607206 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:08:52.607543 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m17:08:52.608107 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:52.609156 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m17:08:52.609438 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:08:52.609703 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m17:08:52.622812 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:52.624005 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m17:08:52.624336 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:08:52.624651 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m17:08:52.629089 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:52.630673 [debug] [Thread-2  ]: On model.bde.host_stg: COMMIT
[0m17:08:52.631045 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:08:52.631407 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m17:08:52.631726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:08:52.638645 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:08:52.639021 [debug] [Thread-2  ]: On model.bde.host_stg: COMMIT
[0m17:08:52.641164 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:08:52.641486 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:08:52.641778 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m17:08:52.642154 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m17:08:52.644148 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:08:52.644575 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m17:08:52.660476 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:52.660865 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:08:52.661185 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:52.661490 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:52.662799 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 17:08:52.335761 => 17:08:52.662622
[0m17:08:52.665205 [debug] [Thread-2  ]: Using postgres connection "model.bde.host_stg"
[0m17:08:52.666345 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 17:08:52.341770 => 17:08:52.666195
[0m17:08:52.667447 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 17:08:52.300309 => 17:08:52.667299
[0m17:08:52.667797 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m17:08:52.668127 [debug] [Thread-2  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m17:08:52.668464 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m17:08:52.668794 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m17:08:52.669568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e8455dc0>]}
[0m17:08:52.670192 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d8b5cb80>]}
[0m17:08:52.671961 [info ] [Thread-1  ]: 1 of 5 OK created sql view model staging.code_stg .............................. [[32mCREATE VIEW[0m in 0.41s]
[0m17:08:52.672523 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e848d1c0>]}
[0m17:08:52.672989 [info ] [Thread-3  ]: 3 of 5 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.40s]
[0m17:08:52.673464 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m17:08:52.673916 [info ] [Thread-4  ]: 4 of 5 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.41s]
[0m17:08:52.674369 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m17:08:52.674721 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m17:08:52.675219 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m17:08:52.675664 [info ] [Thread-1  ]: 5 of 5 START sql view model staging.suburb_stg ................................. [RUN]
[0m17:08:52.676277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.suburb_stg)
[0m17:08:52.676591 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m17:08:52.679144 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m17:08:52.679840 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 17:08:52.676814 => 17:08:52.679673
[0m17:08:52.680161 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m17:08:52.683297 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m17:08:52.683772 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:08:52.684055 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m17:08:52.684322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:08:52.688625 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:52.689764 [debug] [Thread-2  ]: Timing info for model.bde.host_stg (execute): 17:08:52.338959 => 17:08:52.689617
[0m17:08:52.690085 [debug] [Thread-2  ]: On model.bde.host_stg: Close
[0m17:08:52.690779 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e8449280>]}
[0m17:08:52.691262 [info ] [Thread-2  ]: 2 of 5 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.43s]
[0m17:08:52.691738 [debug] [Thread-2  ]: Finished running node model.bde.host_stg
[0m17:08:52.859866 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:08:52.860734 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:08:52.861381 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m17:08:52.880636 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:52.888451 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:08:52.889207 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m17:08:52.904601 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:52.907207 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m17:08:52.907902 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:08:52.908543 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m17:08:52.925836 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:08:52.931262 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:08:52.931951 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m17:08:52.947287 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:52.950167 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 17:08:52.680389 => 17:08:52.949758
[0m17:08:52.951047 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m17:08:52.952880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9274d1a-4793-479e-b9a6-fef15b4a359e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e84b3a00>]}
[0m17:08:52.953943 [info ] [Thread-1  ]: 5 of 5 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m17:08:52.955049 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m17:08:52.957382 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:52.958052 [debug] [MainThread]: On master: BEGIN
[0m17:08:52.958627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:53.143832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:08:53.146019 [debug] [MainThread]: On master: COMMIT
[0m17:08:53.146891 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:53.147969 [debug] [MainThread]: On master: COMMIT
[0m17:08:53.163067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:08:53.164102 [debug] [MainThread]: On master: Close
[0m17:08:53.166301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:53.167201 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m17:08:53.167997 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m17:08:53.168622 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m17:08:53.169227 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m17:08:53.170049 [info ] [MainThread]: 
[0m17:08:53.170840 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m17:08:53.173527 [debug] [MainThread]: Command end result
[0m17:08:53.187352 [info ] [MainThread]: 
[0m17:08:53.188168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:53.188773 [info ] [MainThread]: 
[0m17:08:53.189430 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:08:53.190422 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:53.190259 after 2.44 seconds
[0m17:08:53.191056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f8b3cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fadbf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d8c4fb20>]}
[0m17:08:53.191706 [debug] [MainThread]: Flushing usage events
[0m17:11:44.346302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa650b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652e017f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652e018e0>]}


============================== 17:11:44.350580 | 77ab8f53-7b7f-477b-8db9-c729225316f7 ==============================
[0m17:11:44.350580 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:11:44.351244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:11:44.488839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652e01880>]}
[0m17:11:44.499612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652f79250>]}
[0m17:11:44.500154 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:11:44.517994 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:11:44.549779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m17:11:44.550349 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m17:11:44.550653 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m17:11:44.550927 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m17:11:44.551196 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m17:11:44.551460 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m17:11:44.551740 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m17:11:44.594164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m17:11:44.598509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6200710d0>]}
[0m17:11:44.611393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640c8bd90>]}
[0m17:11:44.611899 [info ] [MainThread]: Found 4 snapshots, 11 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m17:11:44.612219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640c8bee0>]}
[0m17:11:44.613904 [info ] [MainThread]: 
[0m17:11:44.614605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:44.615979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:11:44.622937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:11:44.624394 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:11:44.625967 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:11:44.626272 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:11:44.626564 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:11:44.626836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:44.627107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:44.870562 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m17:11:44.871283 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m17:11:44.873894 [debug] [ThreadPool]: On list_postgres: Close
[0m17:11:44.875625 [debug] [ThreadPool]: On list_postgres: Close
[0m17:11:44.878062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_warehouse)
[0m17:11:44.880711 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "warehouse"
"
[0m17:11:44.887947 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m17:11:44.888466 [debug] [ThreadPool]: On create_postgres_warehouse: BEGIN
[0m17:11:44.888903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:45.070366 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.072442 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m17:11:45.073297 [debug] [ThreadPool]: On create_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_warehouse"} */
create schema if not exists "warehouse"
[0m17:11:45.088564 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:11:45.092314 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m17:11:45.093695 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m17:11:45.094498 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m17:11:45.110270 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:11:45.111509 [debug] [ThreadPool]: On create_postgres_warehouse: Close
[0m17:11:45.118037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_warehouse, now list_postgres_at3)
[0m17:11:45.125977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m17:11:45.133696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m17:11:45.134758 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:11:45.138023 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m17:11:45.141087 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m17:11:45.141643 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m17:11:45.142148 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m17:11:45.142621 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m17:11:45.143095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:45.143575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:45.144030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:45.324922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.326579 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.327805 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m17:11:45.329082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.330263 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m17:11:45.331346 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:11:45.332371 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:11:45.333145 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:11:45.334183 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m17:11:45.352559 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:11:45.356182 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m17:11:45.363287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:11:45.364185 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m17:11:45.366793 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m17:11:45.369410 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m17:11:45.370437 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m17:11:45.383344 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m17:11:45.389237 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m17:11:45.402793 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:45.403523 [debug] [MainThread]: On master: BEGIN
[0m17:11:45.404105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:45.584455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.586276 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:45.587928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:45.611950 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m17:11:45.619314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640daa220>]}
[0m17:11:45.620346 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:45.634540 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:45.635473 [debug] [MainThread]: On master: BEGIN
[0m17:11:45.667064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.668422 [debug] [MainThread]: On master: COMMIT
[0m17:11:45.669293 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:45.670092 [debug] [MainThread]: On master: COMMIT
[0m17:11:45.685528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:11:45.686871 [debug] [MainThread]: On master: Close
[0m17:11:45.689931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:45.691190 [info ] [MainThread]: 
[0m17:11:45.698638 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m17:11:45.699635 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m17:11:45.700683 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m17:11:45.701757 [info ] [Thread-1  ]: 1 of 11 START sql view model staging.code_stg .................................. [RUN]
[0m17:11:45.702710 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m17:11:45.703771 [info ] [Thread-2  ]: 2 of 11 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m17:11:45.704803 [info ] [Thread-3  ]: 3 of 11 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m17:11:45.706048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m17:11:45.706931 [info ] [Thread-4  ]: 4 of 11 START sql view model staging.host_stg .................................. [RUN]
[0m17:11:45.708178 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.fact_census_G01)
[0m17:11:45.709352 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G02)
[0m17:11:45.710124 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m17:11:45.711338 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m17:11:45.712039 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m17:11:45.712700 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m17:11:45.725961 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m17:11:45.726633 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m17:11:45.730316 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m17:11:45.733944 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m17:11:45.737681 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m17:11:45.738720 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 17:11:45.713227 => 17:11:45.738442
[0m17:11:45.739403 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 17:11:45.734507 => 17:11:45.739128
[0m17:11:45.739877 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m17:11:45.740425 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m17:11:45.741026 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 17:11:45.730759 => 17:11:45.740804
[0m17:11:45.747555 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 17:11:45.727044 => 17:11:45.747155
[0m17:11:45.783287 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m17:11:45.784841 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m17:11:45.785233 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m17:11:45.785551 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m17:11:45.788690 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m17:11:45.791638 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m17:11:45.791984 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:11:45.792310 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:11:45.792781 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m17:11:45.793103 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m17:11:45.793459 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:11:45.793760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:45.794054 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:11:45.794353 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:11:45.794840 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m17:11:45.795159 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m17:11:45.795467 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:11:45.795806 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:11:45.979081 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.980062 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.980971 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:11:45.981702 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:11:45.982426 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.983175 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m17:11:45.984042 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m17:11:45.984822 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:11:45.985600 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m17:11:45.986269 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:45.986874 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:11:45.987472 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m17:11:46.010325 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.011028 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.017333 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.023215 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:11:46.023866 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.029747 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:11:46.076199 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:11:46.076644 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m17:11:46.078967 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:11:46.079320 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m17:11:46.079649 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m17:11:46.080045 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m17:11:46.112337 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.112771 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.113188 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.116198 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:11:46.116597 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.130637 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m17:11:46.131973 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m17:11:46.132361 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m17:11:46.134884 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:11:46.135235 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:11:46.135550 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:11:46.135929 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m17:11:46.136264 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m17:11:46.136568 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m17:11:46.168185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.171924 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m17:11:46.172349 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.172760 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.173135 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:11:46.180913 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:11:46.181273 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.182726 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m17:11:46.183087 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m17:11:46.183430 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m17:11:46.185658 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:11:46.186015 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:11:46.186503 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m17:11:46.186859 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m17:11:46.214849 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.215269 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.216746 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 17:11:45.785930 => 17:11:46.216547
[0m17:11:46.217144 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.217546 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.218894 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 17:11:45.789029 => 17:11:46.218714
[0m17:11:46.219319 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m17:11:46.221819 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:11:46.225395 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:11:46.225792 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m17:11:46.226226 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m17:11:46.226892 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652fa7e80>]}
[0m17:11:46.227283 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m17:11:46.228003 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652fa7dc0>]}
[0m17:11:46.228723 [info ] [Thread-3  ]: 3 of 11 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.52s]
[0m17:11:46.229394 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m17:11:46.229880 [info ] [Thread-2  ]: 2 of 11 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.52s]
[0m17:11:46.230298 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m17:11:46.230840 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m17:11:46.231245 [info ] [Thread-3  ]: 5 of 11 START sql view model staging.listings_stg .............................. [RUN]
[0m17:11:46.231649 [debug] [Thread-2  ]: Began running node model.bde.property_stg
[0m17:11:46.232216 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.listings_stg)
[0m17:11:46.232623 [info ] [Thread-2  ]: 6 of 11 START sql view model staging.property_stg .............................. [RUN]
[0m17:11:46.232982 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m17:11:46.233517 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.property_stg)
[0m17:11:46.236129 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m17:11:46.236496 [debug] [Thread-2  ]: Began compiling node model.bde.property_stg
[0m17:11:46.238858 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.property_stg"
[0m17:11:46.239460 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (compile): 17:11:46.236805 => 17:11:46.239302
[0m17:11:46.239803 [debug] [Thread-2  ]: Began executing node model.bde.property_stg
[0m17:11:46.240185 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 17:11:46.233777 => 17:11:46.240029
[0m17:11:46.243362 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.property_stg"
[0m17:11:46.243709 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m17:11:46.246869 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m17:11:46.247488 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m17:11:46.247861 [debug] [Thread-2  ]: On model.bde.property_stg: BEGIN
[0m17:11:46.248222 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:11:46.248728 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:11:46.249081 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m17:11:46.249379 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:11:46.264541 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.264961 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.266345 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 17:11:45.741399 => 17:11:46.266183
[0m17:11:46.267540 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 17:11:45.773066 => 17:11:46.267387
[0m17:11:46.267911 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m17:11:46.268252 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m17:11:46.269041 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652f9c3d0>]}
[0m17:11:46.269644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652fb8640>]}
[0m17:11:46.270156 [info ] [Thread-4  ]: 4 of 11 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.56s]
[0m17:11:46.270665 [info ] [Thread-1  ]: 1 of 11 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.56s]
[0m17:11:46.271184 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m17:11:46.271660 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m17:11:46.272038 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m17:11:46.272585 [debug] [Thread-1  ]: Began running node model.bde.dim_host
[0m17:11:46.272953 [info ] [Thread-4  ]: 7 of 11 START sql view model staging.suburb_stg ................................ [RUN]
[0m17:11:46.273360 [info ] [Thread-1  ]: 8 of 11 START sql view model warehouse.dim_host ................................ [RUN]
[0m17:11:46.273919 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.suburb_stg)
[0m17:11:46.274402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.dim_host)
[0m17:11:46.274718 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m17:11:46.275018 [debug] [Thread-1  ]: Began compiling node model.bde.dim_host
[0m17:11:46.277724 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m17:11:46.280403 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_host"
[0m17:11:46.281258 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 17:11:46.275243 => 17:11:46.281027
[0m17:11:46.281787 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m17:11:46.285119 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m17:11:46.285543 [debug] [Thread-1  ]: Timing info for model.bde.dim_host (compile): 17:11:46.278056 => 17:11:46.285378
[0m17:11:46.285910 [debug] [Thread-1  ]: Began executing node model.bde.dim_host
[0m17:11:46.289726 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_host"
[0m17:11:46.290088 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:11:46.290470 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m17:11:46.290772 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:11:46.291172 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m17:11:46.291486 [debug] [Thread-1  ]: On model.bde.dim_host: BEGIN
[0m17:11:46.291770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:46.494225 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.494912 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.495539 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:11:46.496076 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.496588 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m17:11:46.497205 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m17:11:46.497805 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m17:11:46.498375 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date, 
        property_type,  
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m17:11:46.499027 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m17:11:46.499813 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.500351 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:11:46.500859 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m17:11:46.516205 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.521306 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:11:46.521859 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.522415 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m17:11:46.522901 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.523375 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.527647 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m17:11:46.531659 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:11:46.535049 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m17:11:46.535556 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m17:11:46.536021 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m17:11:46.536513 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m17:11:46.545893 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.549103 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:11:46.549579 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m17:11:46.550274 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.550740 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.553965 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:11:46.557093 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m17:11:46.557483 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.557890 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m17:11:46.558290 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m17:11:46.559801 [debug] [Thread-1  ]: On model.bde.dim_host: COMMIT
[0m17:11:46.560332 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m17:11:46.560720 [debug] [Thread-1  ]: On model.bde.dim_host: COMMIT
[0m17:11:46.565861 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.567519 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m17:11:46.567923 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:11:46.568298 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m17:11:46.575611 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.575990 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.577648 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m17:11:46.578037 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.579657 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m17:11:46.580078 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:11:46.584188 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m17:11:46.584609 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m17:11:46.584977 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m17:11:46.585334 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m17:11:46.585692 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m17:11:46.586310 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.588651 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m17:11:46.589030 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m17:11:46.601903 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.604453 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:11:46.604868 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m17:11:46.605483 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.606831 [debug] [Thread-1  ]: Timing info for model.bde.dim_host (execute): 17:11:46.286168 => 17:11:46.606661
[0m17:11:46.607185 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.607592 [debug] [Thread-1  ]: On model.bde.dim_host: Close
[0m17:11:46.610044 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m17:11:46.610466 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.611140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640dd5d60>]}
[0m17:11:46.611510 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m17:11:46.612770 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 17:11:46.244018 => 17:11:46.612604
[0m17:11:46.613355 [info ] [Thread-1  ]: 8 of 11 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.34s]
[0m17:11:46.613886 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m17:11:46.614474 [debug] [Thread-1  ]: Finished running node model.bde.dim_host
[0m17:11:46.615224 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640af72b0>]}
[0m17:11:46.615734 [info ] [Thread-3  ]: 5 of 11 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.38s]
[0m17:11:46.616253 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m17:11:46.616755 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m17:11:46.617164 [info ] [Thread-1  ]: 9 of 11 START sql view model warehouse.fact_listing ............................ [RUN]
[0m17:11:46.617725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.fact_listing)
[0m17:11:46.618062 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m17:11:46.620662 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m17:11:46.621085 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.622237 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 17:11:46.282060 => 17:11:46.622089
[0m17:11:46.622574 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m17:11:46.623267 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65303eac0>]}
[0m17:11:46.623702 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 17:11:46.618306 => 17:11:46.623545
[0m17:11:46.624149 [info ] [Thread-4  ]: 7 of 11 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.35s]
[0m17:11:46.624498 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m17:11:46.624966 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m17:11:46.628283 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m17:11:46.628836 [debug] [Thread-3  ]: Began running node model.bde.dim_lge_code_suburb
[0m17:11:46.629331 [info ] [Thread-3  ]: 10 of 11 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m17:11:46.629917 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_lge_code_suburb)
[0m17:11:46.630315 [debug] [Thread-3  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m17:11:46.633257 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m17:11:46.633669 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.634044 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:11:46.635249 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (execute): 17:11:46.240397 => 17:11:46.635100
[0m17:11:46.635605 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m17:11:46.635929 [debug] [Thread-2  ]: On model.bde.property_stg: Close
[0m17:11:46.636258 [debug] [Thread-3  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 17:11:46.630661 => 17:11:46.636129
[0m17:11:46.636559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:46.636924 [debug] [Thread-3  ]: Began executing node model.bde.dim_lge_code_suburb
[0m17:11:46.637442 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652fa78e0>]}
[0m17:11:46.640658 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m17:11:46.641140 [info ] [Thread-2  ]: 6 of 11 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.40s]
[0m17:11:46.641682 [debug] [Thread-2  ]: Finished running node model.bde.property_stg
[0m17:11:46.642163 [debug] [Thread-4  ]: Began running node model.bde.dim_property
[0m17:11:46.642516 [info ] [Thread-4  ]: 11 of 11 START sql view model warehouse.dim_property ........................... [RUN]
[0m17:11:46.642851 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:11:46.643339 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_property)
[0m17:11:46.643643 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m17:11:46.643931 [debug] [Thread-4  ]: Began compiling node model.bde.dim_property
[0m17:11:46.644199 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:11:46.646407 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_property"
[0m17:11:46.647305 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (compile): 17:11:46.644399 => 17:11:46.647136
[0m17:11:46.647645 [debug] [Thread-4  ]: Began executing node model.bde.dim_property
[0m17:11:46.652063 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_property"
[0m17:11:46.652718 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m17:11:46.653022 [debug] [Thread-4  ]: On model.bde.dim_property: BEGIN
[0m17:11:46.653292 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:11:46.806848 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.807529 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:11:46.808032 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.lowercase_suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m17:11:46.808549 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.809098 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:11:46.809569 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m17:11:46.816775 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:11:46.817232 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m17:11:46.817672 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m17:11:46.829473 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.833567 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:11:46.834092 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.834636 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:11:46.835136 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
alter table "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp" rename to "dim_lge_code_suburb"
[0m17:11:46.838670 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:11:46.842041 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m17:11:46.842603 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m17:11:46.843085 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m17:11:46.856853 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.858563 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m17:11:46.859036 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:11:46.859458 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m17:11:46.861790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.862238 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:11:46.863953 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m17:11:46.865645 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m17:11:46.866120 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:11:46.866560 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m17:11:46.866994 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m17:11:46.867419 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m17:11:46.877057 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.880112 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:11:46.880587 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
drop view if exists "postgres"."warehouse"."dim_lge_code_suburb__dbt_backup" cascade
[0m17:11:46.882585 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.885697 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:11:46.886170 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m17:11:46.886818 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:11:46.889724 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m17:11:46.890182 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m17:11:46.896989 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.898562 [debug] [Thread-3  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 17:11:46.637787 => 17:11:46.898345
[0m17:11:46.899047 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: Close
[0m17:11:46.900032 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640dad580>]}
[0m17:11:46.900737 [info ] [Thread-3  ]: 10 of 11 OK created sql view model warehouse.dim_lge_code_suburb ............... [[32mCREATE VIEW[0m in 0.27s]
[0m17:11:46.901461 [debug] [Thread-3  ]: Finished running node model.bde.dim_lge_code_suburb
[0m17:11:46.902008 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.903385 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 17:11:46.625207 => 17:11:46.903193
[0m17:11:46.903794 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m17:11:46.904612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640dd9e20>]}
[0m17:11:46.905186 [info ] [Thread-1  ]: 9 of 11 OK created sql view model warehouse.fact_listing ....................... [[32mCREATE VIEW[0m in 0.29s]
[0m17:11:46.905785 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m17:11:46.906617 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:11:46.907989 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (execute): 17:11:46.647857 => 17:11:46.907800
[0m17:11:46.908403 [debug] [Thread-4  ]: On model.bde.dim_property: Close
[0m17:11:46.909217 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ab8f53-7b7f-477b-8db9-c729225316f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652fa78e0>]}
[0m17:11:46.909794 [info ] [Thread-4  ]: 11 of 11 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m17:11:46.910406 [debug] [Thread-4  ]: Finished running node model.bde.dim_property
[0m17:11:46.911898 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:46.912252 [debug] [MainThread]: On master: BEGIN
[0m17:11:46.912555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:47.076407 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:11:47.077305 [debug] [MainThread]: On master: COMMIT
[0m17:11:47.077931 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:47.078499 [debug] [MainThread]: On master: COMMIT
[0m17:11:47.095205 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:11:47.095930 [debug] [MainThread]: On master: Close
[0m17:11:47.097612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:47.098303 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m17:11:47.098923 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m17:11:47.099534 [debug] [MainThread]: Connection 'model.bde.dim_lge_code_suburb' was properly closed.
[0m17:11:47.100127 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m17:11:47.100991 [info ] [MainThread]: 
[0m17:11:47.101793 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m17:11:47.105687 [debug] [MainThread]: Command end result
[0m17:11:47.121138 [info ] [MainThread]: 
[0m17:11:47.121868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:47.122401 [info ] [MainThread]: 
[0m17:11:47.122952 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:11:47.123897 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:47.123752 after 2.81 seconds
[0m17:11:47.124532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa650b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640c973d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa652f75790>]}
[0m17:11:47.125123 [debug] [MainThread]: Flushing usage events
[0m17:45:12.671219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060c04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062a417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062a418e0>]}


============================== 17:45:12.675495 | de7745b8-52d1-48d1-ae4c-73ad785e6317 ==============================
[0m17:45:12.675495 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:45:12.676161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:45:12.855439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de7745b8-52d1-48d1-ae4c-73ad785e6317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062a41880>]}
[0m17:45:12.866105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de7745b8-52d1-48d1-ae4c-73ad785e6317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8062b68250>]}
[0m17:45:12.866655 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:45:12.884662 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:45:12.918462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m17:45:12.919031 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m17:45:12.919332 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_host_neighbourhood.sql
[0m17:45:12.919613 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_property_type.sql
[0m17:45:12.919924 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/property_stg.sql
[0m17:45:12.955474 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.dm_listing_neighbourhood' (models/datamart/dm_listing_neighbourhood.sql) depends on a node named 'dim_listing' which was not found
[0m17:45:12.956903 [debug] [MainThread]: Command `dbt run` failed at 17:45:12.956098 after 0.33 seconds
[0m17:45:12.957326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8060c04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803042ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f803042acd0>]}
[0m17:45:12.957692 [debug] [MainThread]: Flushing usage events
[0m17:45:33.276151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a80af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82c897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82c898e0>]}


============================== 17:45:33.280222 | e497d927-3f6c-48f7-8132-89b3a2226775 ==============================
[0m17:45:33.280222 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:45:33.280855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:45:33.385575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82c89820>]}
[0m17:45:33.396394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82dc1250>]}
[0m17:45:33.396961 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:45:33.416616 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:45:33.446727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:33.447344 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/property_stg.sql
[0m17:45:33.479461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m17:45:33.483860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5014ef40>]}
[0m17:45:33.498960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a602d6e50>]}
[0m17:45:33.499434 [info ] [MainThread]: Found 4 snapshots, 11 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m17:45:33.499734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a602d6a90>]}
[0m17:45:33.501318 [info ] [MainThread]: 
[0m17:45:33.501939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:33.503061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:45:33.503629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:45:33.511942 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:45:33.513598 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:45:33.513886 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:45:33.514170 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:45:33.514462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:33.514702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:33.992804 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m17:45:33.993247 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m17:45:33.994820 [debug] [ThreadPool]: On list_postgres: Close
[0m17:45:33.996263 [debug] [ThreadPool]: On list_postgres: Close
[0m17:45:33.999269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m17:45:34.000577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m17:45:34.008278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m17:45:34.012952 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:45:34.016379 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m17:45:34.019213 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m17:45:34.019770 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m17:45:34.020313 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m17:45:34.020830 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m17:45:34.021299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:34.021774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:34.022243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:34.199456 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.200443 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m17:45:34.201253 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:45:34.202281 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.202896 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m17:45:34.203527 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:45:34.209402 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.210096 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m17:45:34.210863 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m17:45:34.224055 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:45:34.224839 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:45:34.227939 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m17:45:34.230113 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m17:45:34.230728 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m17:45:34.233185 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m17:45:34.246920 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m17:45:34.247597 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m17:45:34.248311 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m17:45:34.264372 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:34.264988 [debug] [MainThread]: On master: BEGIN
[0m17:45:34.265474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:34.446202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.448575 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:34.449887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:34.475593 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m17:45:34.486350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82e3da60>]}
[0m17:45:34.487519 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:34.502311 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:34.503251 [debug] [MainThread]: On master: BEGIN
[0m17:45:34.532780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.534179 [debug] [MainThread]: On master: COMMIT
[0m17:45:34.535016 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:34.535743 [debug] [MainThread]: On master: COMMIT
[0m17:45:34.550690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:34.552794 [debug] [MainThread]: On master: Close
[0m17:45:34.556460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:34.557663 [info ] [MainThread]: 
[0m17:45:34.564778 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m17:45:34.565749 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m17:45:34.566766 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m17:45:34.567815 [info ] [Thread-1  ]: 1 of 11 START sql view model staging.code_stg .................................. [RUN]
[0m17:45:34.568750 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m17:45:34.569755 [info ] [Thread-2  ]: 2 of 11 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m17:45:34.570661 [info ] [Thread-3  ]: 3 of 11 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m17:45:34.571904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.code_stg)
[0m17:45:34.572750 [info ] [Thread-4  ]: 4 of 11 START sql view model staging.host_stg .................................. [RUN]
[0m17:45:34.573958 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.fact_census_G01)
[0m17:45:34.575079 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G02)
[0m17:45:34.575858 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m17:45:34.577219 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m17:45:34.577978 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m17:45:34.578675 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m17:45:34.591428 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m17:45:34.592172 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m17:45:34.596326 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m17:45:34.600095 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m17:45:34.603651 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m17:45:34.604779 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 17:45:34.579188 => 17:45:34.604469
[0m17:45:34.605409 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 17:45:34.592614 => 17:45:34.605172
[0m17:45:34.606064 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 17:45:34.596860 => 17:45:34.605806
[0m17:45:34.606574 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m17:45:34.607067 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m17:45:34.607643 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m17:45:34.608167 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 17:45:34.600592 => 17:45:34.607951
[0m17:45:34.645577 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m17:45:34.648629 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m17:45:34.651714 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m17:45:34.652096 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m17:45:34.655387 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m17:45:34.655827 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:45:34.656185 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:45:34.656496 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:45:34.656802 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m17:45:34.657124 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m17:45:34.657424 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m17:45:34.657699 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:45:34.657977 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:45:34.658251 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:45:34.658522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:45:34.658790 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m17:45:34.659357 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:45:34.842523 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.843304 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.843917 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.844467 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:34.845114 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:45:34.845696 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:45:34.846248 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:45:34.846782 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:45:34.847371 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m17:45:34.847988 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m17:45:34.848594 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m17:45:34.849213 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m17:45:34.867783 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:34.878392 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:34.879440 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:45:34.879987 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:34.880617 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:34.884991 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:45:34.885563 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m17:45:34.889688 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:45:34.931818 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:45:34.932291 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m17:45:34.932709 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01" rename to "fact_census_G01__dbt_backup"
[0m17:45:34.933076 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02" rename to "fact_census_G02__dbt_backup"
[0m17:45:34.947206 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.949789 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:45:34.950147 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m17:45:34.952467 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.952839 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.955295 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:45:34.955629 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.958118 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:45:34.958472 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m17:45:34.960840 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:45:34.961180 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m17:45:34.961559 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m17:45:34.964560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.978422 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m17:45:34.978761 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.979035 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:45:34.979293 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.979581 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:34.980760 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m17:45:34.981066 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m17:45:34.982257 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m17:45:34.983658 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m17:45:34.983959 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:45:34.984299 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:45:34.984604 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:45:34.984904 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m17:45:34.985181 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m17:45:34.985454 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m17:45:35.001183 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.008566 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m17:45:35.008937 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.009235 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.009521 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.009820 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m17:45:35.012145 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m17:45:35.014356 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m17:45:35.017421 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m17:45:35.017832 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m17:45:35.018168 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m17:45:35.018489 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m17:45:35.032289 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.033626 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 17:45:34.608498 => 17:45:35.033430
[0m17:45:35.034010 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m17:45:35.034844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a602d6220>]}
[0m17:45:35.036521 [info ] [Thread-1  ]: 1 of 11 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.46s]
[0m17:45:35.037097 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m17:45:35.037474 [debug] [Thread-1  ]: Began running node model.bde.listings_stg
[0m17:45:35.037917 [info ] [Thread-1  ]: 5 of 11 START sql view model staging.listings_stg .............................. [RUN]
[0m17:45:35.038495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.listings_stg)
[0m17:45:35.038835 [debug] [Thread-1  ]: Began compiling node model.bde.listings_stg
[0m17:45:35.039170 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.041764 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m17:45:35.042120 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.042465 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.043622 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 17:45:34.652557 => 17:45:35.043462
[0m17:45:35.044949 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 17:45:34.633636 => 17:45:35.044792
[0m17:45:35.046050 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 17:45:34.648859 => 17:45:35.045908
[0m17:45:35.046396 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m17:45:35.046748 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (compile): 17:45:35.039397 => 17:45:35.046606
[0m17:45:35.047056 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m17:45:35.047384 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m17:45:35.047753 [debug] [Thread-1  ]: Began executing node model.bde.listings_stg
[0m17:45:35.048276 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a604774c0>]}
[0m17:45:35.051710 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m17:45:35.052253 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82eb37c0>]}
[0m17:45:35.052744 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a60480970>]}
[0m17:45:35.053227 [info ] [Thread-4  ]: 4 of 11 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.47s]
[0m17:45:35.053750 [info ] [Thread-2  ]: 2 of 11 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.48s]
[0m17:45:35.054264 [info ] [Thread-3  ]: 3 of 11 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.48s]
[0m17:45:35.054611 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m17:45:35.055053 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m17:45:35.055553 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m17:45:35.056026 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m17:45:35.056329 [debug] [Thread-1  ]: On model.bde.listings_stg: BEGIN
[0m17:45:35.056681 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m17:45:35.057101 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m17:45:35.057440 [debug] [Thread-3  ]: Began running node model.bde.dim_host
[0m17:45:35.057768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:45:35.058209 [info ] [Thread-4  ]: 6 of 11 START sql view model staging.property_stg .............................. [RUN]
[0m17:45:35.058637 [info ] [Thread-2  ]: 7 of 11 START sql view model staging.suburb_stg ................................ [RUN]
[0m17:45:35.059089 [info ] [Thread-3  ]: 8 of 11 START sql view model warehouse.dim_host ................................ [RUN]
[0m17:45:35.059876 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m17:45:35.060393 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.suburb_stg)
[0m17:45:35.061147 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.dim_host)
[0m17:45:35.061464 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m17:45:35.061756 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m17:45:35.062033 [debug] [Thread-3  ]: Began compiling node model.bde.dim_host
[0m17:45:35.064376 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m17:45:35.066636 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m17:45:35.068722 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_host"
[0m17:45:35.069404 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 17:45:35.064650 => 17:45:35.069243
[0m17:45:35.069771 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 17:45:35.062245 => 17:45:35.069622
[0m17:45:35.070048 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m17:45:35.070360 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (compile): 17:45:35.066900 => 17:45:35.070230
[0m17:45:35.070642 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m17:45:35.073623 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m17:45:35.074037 [debug] [Thread-3  ]: Began executing node model.bde.dim_host
[0m17:45:35.077310 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m17:45:35.081876 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_host"
[0m17:45:35.082514 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:45:35.082808 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m17:45:35.083083 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:45:35.083507 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:45:35.083808 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m17:45:35.084074 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:45:35.084444 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m17:45:35.084719 [debug] [Thread-3  ]: On model.bde.dim_host: BEGIN
[0m17:45:35.084972 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:45:35.212223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.212763 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m17:45:35.213173 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m17:45:35.231107 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.231601 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:45:35.232035 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m17:45:35.232477 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.236158 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m17:45:35.236594 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m17:45:35.248881 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.249349 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m17:45:35.249739 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m17:45:35.250138 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.253871 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:45:35.254305 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.254718 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.255096 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m17:45:35.257870 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m17:45:35.258247 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:45:35.258666 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m17:45:35.259079 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        listing_neighbourhood,
        property_type,  
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m17:45:35.271002 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.274036 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m17:45:35.274493 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.274863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.275203 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m17:45:35.277942 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:45:35.278305 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.279852 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m17:45:35.280296 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m17:45:35.283252 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:45:35.283600 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m17:45:35.283988 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m17:45:35.284330 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m17:45:35.299047 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.299412 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.300781 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m17:45:35.302456 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m17:45:35.302835 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m17:45:35.303186 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:45:35.303525 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m17:45:35.303872 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.304195 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m17:45:35.304512 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.307127 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:45:35.310472 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m17:45:35.310835 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m17:45:35.311176 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m17:45:35.323568 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.325947 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m17:45:35.326326 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.326669 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m17:45:35.328998 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m17:45:35.329386 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.329726 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.330121 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m17:45:35.331550 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m17:45:35.332706 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (execute): 17:45:35.048619 => 17:45:35.332545
[0m17:45:35.333100 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:45:35.333444 [debug] [Thread-1  ]: On model.bde.listings_stg: Close
[0m17:45:35.333764 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m17:45:35.334497 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a60449760>]}
[0m17:45:35.335007 [info ] [Thread-1  ]: 5 of 11 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m17:45:35.335514 [debug] [Thread-1  ]: Finished running node model.bde.listings_stg
[0m17:45:35.336002 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m17:45:35.336384 [info ] [Thread-1  ]: 9 of 11 START sql view model warehouse.fact_listing ............................ [RUN]
[0m17:45:35.336904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_listing)
[0m17:45:35.337214 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m17:45:35.339656 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m17:45:35.340288 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 17:45:35.337433 => 17:45:35.340128
[0m17:45:35.340609 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m17:45:35.343708 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m17:45:35.344429 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:45:35.344741 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m17:45:35.345030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:45:35.345844 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.347007 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (execute): 17:45:35.077808 => 17:45:35.346855
[0m17:45:35.347308 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.347643 [debug] [Thread-3  ]: On model.bde.dim_host: Close
[0m17:45:35.348668 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 17:45:35.070850 => 17:45:35.348538
[0m17:45:35.349013 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m17:45:35.349534 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82e6e220>]}
[0m17:45:35.350463 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82e652e0>]}
[0m17:45:35.350036 [info ] [Thread-3  ]: 8 of 11 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m17:45:35.351348 [debug] [Thread-3  ]: Finished running node model.bde.dim_host
[0m17:45:35.350982 [info ] [Thread-2  ]: 7 of 11 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m17:45:35.351933 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m17:45:35.352334 [debug] [Thread-3  ]: Began running node model.bde.dim_lge_code_suburb
[0m17:45:35.352675 [info ] [Thread-3  ]: 10 of 11 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m17:45:35.353159 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dim_lge_code_suburb)
[0m17:45:35.353437 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.353722 [debug] [Thread-3  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m17:45:35.355986 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m17:45:35.358608 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m17:45:35.359069 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m17:45:35.359751 [debug] [Thread-3  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 17:45:35.356261 => 17:45:35.359592
[0m17:45:35.360058 [debug] [Thread-3  ]: Began executing node model.bde.dim_lge_code_suburb
[0m17:45:35.363100 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m17:45:35.363576 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:45:35.363854 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m17:45:35.364119 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:45:35.376620 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.378031 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 17:45:35.074286 => 17:45:35.377866
[0m17:45:35.378371 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m17:45:35.379145 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82e48880>]}
[0m17:45:35.379637 [info ] [Thread-4  ]: 6 of 11 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m17:45:35.380116 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m17:45:35.380578 [debug] [Thread-2  ]: Began running node model.bde.dim_property
[0m17:45:35.380945 [info ] [Thread-2  ]: 11 of 11 START sql view model warehouse.dim_property ........................... [RUN]
[0m17:45:35.381474 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_property)
[0m17:45:35.381784 [debug] [Thread-2  ]: Began compiling node model.bde.dim_property
[0m17:45:35.385279 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_property"
[0m17:45:35.385911 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (compile): 17:45:35.382002 => 17:45:35.385762
[0m17:45:35.386221 [debug] [Thread-2  ]: Began executing node model.bde.dim_property
[0m17:45:35.389320 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_property"
[0m17:45:35.390062 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m17:45:35.390367 [debug] [Thread-2  ]: On model.bde.dim_property: BEGIN
[0m17:45:35.390648 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:45:35.505528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.506078 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:45:35.506455 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m17:45:35.515905 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.516287 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:45:35.516671 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.lowercase_suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m17:45:35.523334 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.526529 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:45:35.526928 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m17:45:35.533701 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.536829 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:45:35.537300 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
alter table "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp" rename to "dim_lge_code_suburb"
[0m17:45:35.542055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.542484 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.544090 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m17:45:35.544526 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m17:45:35.544936 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:45:35.545332 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m17:45:35.545718 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m17:45:35.552499 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.553967 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m17:45:35.554364 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:45:35.554734 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m17:45:35.562298 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.564996 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m17:45:35.565409 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m17:45:35.565806 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:35.568659 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m17:45:35.569070 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m17:45:35.573740 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.576343 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m17:45:35.576755 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
drop view if exists "postgres"."warehouse"."dim_lge_code_suburb__dbt_backup" cascade
[0m17:45:35.581013 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.582362 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 17:45:35.340842 => 17:45:35.582173
[0m17:45:35.582767 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m17:45:35.583590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82e65d90>]}
[0m17:45:35.584136 [info ] [Thread-1  ]: 9 of 11 OK created sql view model warehouse.fact_listing ....................... [[32mCREATE VIEW[0m in 0.25s]
[0m17:45:35.584687 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m17:45:35.585115 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:35.586458 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m17:45:35.586817 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m17:45:35.587155 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m17:45:35.591638 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.592881 [debug] [Thread-3  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 17:45:35.360264 => 17:45:35.592713
[0m17:45:35.593263 [debug] [Thread-3  ]: On model.bde.dim_lge_code_suburb: Close
[0m17:45:35.594018 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6043ae50>]}
[0m17:45:35.594540 [info ] [Thread-3  ]: 10 of 11 OK created sql view model warehouse.dim_lge_code_suburb ............... [[32mCREATE VIEW[0m in 0.24s]
[0m17:45:35.595090 [debug] [Thread-3  ]: Finished running node model.bde.dim_lge_code_suburb
[0m17:45:35.603059 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.605672 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m17:45:35.606053 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m17:45:35.621096 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:35.622700 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (execute): 17:45:35.386453 => 17:45:35.622512
[0m17:45:35.623146 [debug] [Thread-2  ]: On model.bde.dim_property: Close
[0m17:45:35.624076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e497d927-3f6c-48f7-8132-89b3a2226775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a70c35a00>]}
[0m17:45:35.624653 [info ] [Thread-2  ]: 11 of 11 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m17:45:35.625219 [debug] [Thread-2  ]: Finished running node model.bde.dim_property
[0m17:45:35.626478 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:35.626816 [debug] [MainThread]: On master: BEGIN
[0m17:45:35.627100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:35.840287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:35.841353 [debug] [MainThread]: On master: COMMIT
[0m17:45:35.842078 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:35.842757 [debug] [MainThread]: On master: COMMIT
[0m17:45:35.858238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:35.859033 [debug] [MainThread]: On master: Close
[0m17:45:35.861154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:35.861928 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m17:45:35.862568 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m17:45:35.863181 [debug] [MainThread]: Connection 'model.bde.dim_lge_code_suburb' was properly closed.
[0m17:45:35.863785 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m17:45:35.864615 [info ] [MainThread]: 
[0m17:45:35.865399 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m17:45:35.869966 [debug] [MainThread]: Command end result
[0m17:45:35.887389 [info ] [MainThread]: 
[0m17:45:35.888112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:35.888633 [info ] [MainThread]: 
[0m17:45:35.889172 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:45:35.890194 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:35.890037 after 2.64 seconds
[0m17:45:35.890810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a80af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a82dc1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a70c3ab80>]}
[0m17:45:35.891405 [debug] [MainThread]: Flushing usage events
[0m18:52:03.503335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a8b996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3aa3117f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3aa3118e0>]}


============================== 18:52:03.507620 | 7da4c3a8-93bf-46a4-8f1c-f5355cbd52f2 ==============================
[0m18:52:03.507620 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:52:03.508281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:03.720630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7da4c3a8-93bf-46a4-8f1c-f5355cbd52f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3aa311880>]}
[0m18:52:03.731393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7da4c3a8-93bf-46a4-8f1c-f5355cbd52f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3aa478250>]}
[0m18:52:03.731978 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:52:03.749677 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:52:03.788057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m18:52:03.788611 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_property_type.sql
[0m18:52:03.788899 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_host_neighbourhood.sql
[0m18:52:03.789157 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m18:52:03.822067 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bde.dm_property_type' (models/datamart/dm_property_type.sql) depends on a node named 'dim_listing' which was not found
[0m18:52:03.822975 [debug] [MainThread]: Command `dbt run` failed at 18:52:03.822672 after 0.36 seconds
[0m18:52:03.823358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3a8b996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388706940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3885e4880>]}
[0m18:52:03.823720 [debug] [MainThread]: Flushing usage events
[0m18:52:50.589869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e0bd96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e33617c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e33618b0>]}


============================== 18:52:50.593731 | e0fb08db-75bb-4c43-a679-1a457a689c57 ==============================
[0m18:52:50.593731 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:52:50.594380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:50.702450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e33617f0>]}
[0m18:52:50.713172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e3417220>]}
[0m18:52:50.713730 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:52:50.730209 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:52:50.762323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m18:52:50.762905 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_property_type.sql
[0m18:52:50.763213 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_host_neighbourhood.sql
[0m18:52:50.763500 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m18:52:50.802945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b01b00d0>]}
[0m18:52:50.817627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b00c1ca0>]}
[0m18:52:50.818079 [info ] [MainThread]: Found 4 snapshots, 14 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:52:50.818383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b00c1eb0>]}
[0m18:52:50.819976 [info ] [MainThread]: 
[0m18:52:50.820584 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:50.821799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:50.829486 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:50.830136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:50.830689 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:50.831210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:50.832816 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:50.833104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:50.834384 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:50.834660 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:50.836110 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:50.836379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:50.836615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:51.349953 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m18:52:51.350403 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m18:52:51.352000 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:51.353005 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:51.353520 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.0 seconds
[0m18:52:51.355289 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:51.356313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_datamart)
[0m18:52:51.357244 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "datamart"
"
[0m18:52:51.362731 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m18:52:51.363104 [debug] [ThreadPool]: On create_postgres_datamart: BEGIN
[0m18:52:51.363413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:51.550638 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:51.552331 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m18:52:51.553272 [debug] [ThreadPool]: On create_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_datamart"} */
create schema if not exists "datamart"
[0m18:52:51.570389 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:52:51.574892 [debug] [ThreadPool]: On create_postgres_datamart: COMMIT
[0m18:52:51.576088 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m18:52:51.577260 [debug] [ThreadPool]: On create_postgres_datamart: COMMIT
[0m18:52:51.591850 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:52:51.592620 [debug] [ThreadPool]: On create_postgres_datamart: Close
[0m18:52:51.598022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m18:52:51.605784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_datamart, now list_postgres_warehouse)
[0m18:52:51.611478 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:51.612666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:52:51.616134 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:51.617309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_at3'
[0m18:52:51.617821 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m18:52:51.620819 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:51.621390 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m18:52:51.624392 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m18:52:51.624940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:51.625436 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:52:51.625881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:51.626342 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m18:52:51.626974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:51.627603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:51.815735 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:51.817421 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:51.818340 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:51.819502 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:51.820196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:51.820997 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:51.822176 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:51.823354 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:52:51.824175 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m18:52:51.824983 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m18:52:51.825854 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:52:51.826908 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m18:52:51.843916 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:52:51.847354 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m18:52:51.848569 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:52:51.850762 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m18:52:51.851530 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m18:52:51.854102 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m18:52:51.854850 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:52:51.857277 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:52:51.862127 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m18:52:51.866221 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m18:52:51.873007 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:52:51.873661 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m18:52:51.887673 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:51.888362 [debug] [MainThread]: On master: BEGIN
[0m18:52:51.888918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:52.068406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.070533 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:52.071857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:52.096973 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m18:52:52.107423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0157970>]}
[0m18:52:52.108543 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:52.126718 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:52.127613 [debug] [MainThread]: On master: BEGIN
[0m18:52:52.157957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.159626 [debug] [MainThread]: On master: COMMIT
[0m18:52:52.160714 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:52.161769 [debug] [MainThread]: On master: COMMIT
[0m18:52:52.177233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:52.179150 [debug] [MainThread]: On master: Close
[0m18:52:52.181669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:52.182744 [info ] [MainThread]: 
[0m18:52:52.190845 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m18:52:52.191885 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m18:52:52.193661 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m18:52:52.192932 [info ] [Thread-1  ]: 1 of 14 START sql view model staging.code_stg .................................. [RUN]
[0m18:52:52.194837 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m18:52:52.195669 [info ] [Thread-2  ]: 2 of 14 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m18:52:52.196580 [info ] [Thread-3  ]: 3 of 14 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m18:52:52.197873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.code_stg)
[0m18:52:52.198825 [info ] [Thread-4  ]: 4 of 14 START sql view model staging.host_stg .................................. [RUN]
[0m18:52:52.200491 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.fact_census_G01)
[0m18:52:52.201798 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G02)
[0m18:52:52.202674 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m18:52:52.203843 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.host_stg)
[0m18:52:52.204573 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m18:52:52.205264 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m18:52:52.218802 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m18:52:52.219513 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m18:52:52.225089 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m18:52:52.228581 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m18:52:52.232595 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m18:52:52.233585 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 18:52:52.205805 => 18:52:52.233263
[0m18:52:52.234232 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m18:52:52.260117 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 18:52:52.219934 => 18:52:52.259870
[0m18:52:52.266373 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 18:52:52.225560 => 18:52:52.266175
[0m18:52:52.268982 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m18:52:52.269412 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 18:52:52.229128 => 18:52:52.269229
[0m18:52:52.269735 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m18:52:52.270077 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m18:52:52.270459 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m18:52:52.273578 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m18:52:52.276454 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m18:52:52.276790 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m18:52:52.279684 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m18:52:52.280127 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m18:52:52.280628 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:52.280931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:52.281230 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:52.281561 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m18:52:52.281867 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:52.282290 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m18:52:52.282586 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:52.282877 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m18:52:52.283171 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:52.283539 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:52.446441 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.447290 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m18:52:52.447927 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m18:52:52.450860 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.451498 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.452103 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:52.452712 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:52.453371 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m18:52:52.454021 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.454624 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m18:52:52.455330 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:52.456020 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m18:52:52.466905 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.517486 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.517910 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.518223 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.521178 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m18:52:52.523917 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:52.526492 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:52.528996 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:52.529332 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m18:52:52.529653 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m18:52:52.530061 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01" rename to "fact_census_G01__dbt_backup"
[0m18:52:52.530378 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02" rename to "fact_census_G02__dbt_backup"
[0m18:52:52.549524 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.552178 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m18:52:52.552565 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m18:52:52.552969 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.553341 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.553669 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.556220 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:52.558670 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:52.561039 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:52.561395 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m18:52:52.561739 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m18:52:52.562075 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m18:52:52.568246 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.582478 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m18:52:52.582834 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.583141 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.583416 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:52.583687 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m18:52:52.585020 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m18:52:52.586275 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m18:52:52.587469 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m18:52:52.587764 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m18:52:52.588046 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:52.588322 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:52.588595 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:52.588918 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m18:52:52.589218 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m18:52:52.589503 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m18:52:52.602402 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:52.611003 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m18:52:52.611356 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:52.611701 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:52.612010 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:52.612304 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m18:52:52.614380 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:52.616476 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:52.618474 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:52.618852 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m18:52:52.619183 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m18:52:52.619500 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m18:52:52.632441 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:52.633755 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 18:52:52.234628 => 18:52:52.633576
[0m18:52:52.634133 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m18:52:52.634922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c0705550>]}
[0m18:52:52.636493 [info ] [Thread-1  ]: 1 of 14 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.44s]
[0m18:52:52.637053 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m18:52:52.637433 [debug] [Thread-1  ]: Began running node model.bde.listings_stg
[0m18:52:52.637862 [info ] [Thread-1  ]: 5 of 14 START sql view model staging.listings_stg .............................. [RUN]
[0m18:52:52.638414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.listings_stg)
[0m18:52:52.638771 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:52.639086 [debug] [Thread-1  ]: Began compiling node model.bde.listings_stg
[0m18:52:52.639385 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:52.639700 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:52.640868 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 18:52:52.273843 => 18:52:52.640708
[0m18:52:52.643609 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m18:52:52.644905 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 18:52:52.270708 => 18:52:52.644737
[0m18:52:52.646168 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 18:52:52.277025 => 18:52:52.646016
[0m18:52:52.646557 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m18:52:52.647019 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m18:52:52.647395 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m18:52:52.647926 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (compile): 18:52:52.641126 => 18:52:52.647751
[0m18:52:52.648549 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e347ad90>]}
[0m18:52:52.649069 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0272550>]}
[0m18:52:52.649442 [debug] [Thread-1  ]: Began executing node model.bde.listings_stg
[0m18:52:52.649957 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e3494970>]}
[0m18:52:52.650471 [info ] [Thread-3  ]: 3 of 14 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.45s]
[0m18:52:52.650935 [info ] [Thread-2  ]: 2 of 14 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.45s]
[0m18:52:52.654440 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m18:52:52.654900 [info ] [Thread-4  ]: 4 of 14 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.45s]
[0m18:52:52.655415 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m18:52:52.655866 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m18:52:52.656360 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m18:52:52.656761 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m18:52:52.657123 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:52.657424 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m18:52:52.657838 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m18:52:52.658177 [info ] [Thread-3  ]: 6 of 14 START sql view model staging.property_stg .............................. [RUN]
[0m18:52:52.658504 [debug] [Thread-1  ]: On model.bde.listings_stg: BEGIN
[0m18:52:52.658823 [info ] [Thread-2  ]: 7 of 14 START sql view model staging.suburb_stg ................................ [RUN]
[0m18:52:52.659164 [info ] [Thread-4  ]: 8 of 14 START sql view model warehouse.dim_host ................................ [RUN]
[0m18:52:52.659673 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.property_stg)
[0m18:52:52.659967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:52.660408 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.suburb_stg)
[0m18:52:52.660926 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.dim_host)
[0m18:52:52.661258 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m18:52:52.661668 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m18:52:52.661969 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m18:52:52.665043 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m18:52:52.667612 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m18:52:52.671101 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m18:52:52.671869 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 18:52:52.665424 => 18:52:52.671707
[0m18:52:52.672171 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m18:52:52.675207 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m18:52:52.675669 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 18:52:52.667899 => 18:52:52.675514
[0m18:52:52.676033 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 18:52:52.662197 => 18:52:52.675887
[0m18:52:52.676332 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m18:52:52.676682 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:52.676961 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m18:52:52.679932 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m18:52:52.680412 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m18:52:52.683792 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m18:52:52.684509 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:52.685121 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:52.685472 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m18:52:52.685793 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:52.686086 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:52.686419 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m18:52:52.686795 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:52.883760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.884539 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:52.885135 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m18:52:52.947899 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.948751 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:52.949629 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        listing_neighbourhood,
        property_type,  
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m18:52:52.950622 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.951561 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:52.952435 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m18:52:52.961876 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:52.962653 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:52.963434 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m18:52:52.964567 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.971949 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:52.972872 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.973732 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m18:52:52.974531 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.980423 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:52.986029 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:52.986769 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:52.987397 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m18:52:52.987983 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m18:52:52.992438 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:52.993246 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m18:52:53.042733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.050385 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:53.051106 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m18:52:53.075015 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.075793 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.076505 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.082453 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:53.088549 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:53.091172 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m18:52:53.091906 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m18:52:53.092607 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m18:52:53.093266 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:53.094201 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m18:52:53.131221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.134754 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m18:52:53.135601 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:53.136391 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m18:52:53.174652 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.176231 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.180656 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m18:52:53.181505 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.185028 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m18:52:53.185927 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:53.192073 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:53.192765 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:53.193427 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m18:52:53.194086 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m18:52:53.194735 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m18:52:53.220022 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.226008 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:53.226915 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m18:52:53.277500 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.279160 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.280501 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.288370 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:53.293886 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:53.297087 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 18:52:52.677194 => 18:52:53.296759
[0m18:52:53.297813 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m18:52:53.298540 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m18:52:53.299255 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m18:52:53.300930 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c069f5b0>]}
[0m18:52:53.301960 [info ] [Thread-4  ]: 8 of 14 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.64s]
[0m18:52:53.303010 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m18:52:53.303703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.306307 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (execute): 18:52:52.651229 => 18:52:53.305978
[0m18:52:53.306933 [debug] [Thread-1  ]: On model.bde.listings_stg: Close
[0m18:52:53.308132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e3453dc0>]}
[0m18:52:53.308971 [info ] [Thread-1  ]: 5 of 14 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.67s]
[0m18:52:53.309853 [debug] [Thread-1  ]: Finished running node model.bde.listings_stg
[0m18:52:53.310722 [debug] [Thread-4  ]: Began running node model.bde.fact_listing
[0m18:52:53.311516 [info ] [Thread-4  ]: 9 of 14 START sql view model warehouse.fact_listing ............................ [RUN]
[0m18:52:53.312584 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.fact_listing)
[0m18:52:53.313194 [debug] [Thread-4  ]: Began compiling node model.bde.fact_listing
[0m18:52:53.317949 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m18:52:53.319141 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (compile): 18:52:53.313613 => 18:52:53.318865
[0m18:52:53.319659 [debug] [Thread-4  ]: Began executing node model.bde.fact_listing
[0m18:52:53.326389 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m18:52:53.327426 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:53.327916 [debug] [Thread-4  ]: On model.bde.fact_listing: BEGIN
[0m18:52:53.328346 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:53.345023 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.347177 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 18:52:52.672379 => 18:52:53.346930
[0m18:52:53.347762 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.348239 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m18:52:53.349926 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 18:52:52.680687 => 18:52:53.349722
[0m18:52:53.350470 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m18:52:53.351336 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e33bcaf0>]}
[0m18:52:53.352144 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e34997c0>]}
[0m18:52:53.352812 [info ] [Thread-2  ]: 7 of 14 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.69s]
[0m18:52:53.353498 [info ] [Thread-3  ]: 6 of 14 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.69s]
[0m18:52:53.354208 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m18:52:53.354789 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m18:52:53.355380 [debug] [Thread-1  ]: Began running node model.bde.dim_lge_code_suburb
[0m18:52:53.355918 [debug] [Thread-2  ]: Began running node model.bde.dim_property
[0m18:52:53.356387 [info ] [Thread-1  ]: 10 of 14 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m18:52:53.356861 [info ] [Thread-2  ]: 11 of 14 START sql view model warehouse.dim_property ........................... [RUN]
[0m18:52:53.357528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_lge_code_suburb)
[0m18:52:53.358159 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_property)
[0m18:52:53.358553 [debug] [Thread-1  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m18:52:53.358927 [debug] [Thread-2  ]: Began compiling node model.bde.dim_property
[0m18:52:53.362464 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m18:52:53.365413 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_property"
[0m18:52:53.366355 [debug] [Thread-1  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 18:52:53.359220 => 18:52:53.366144
[0m18:52:53.366761 [debug] [Thread-1  ]: Began executing node model.bde.dim_lge_code_suburb
[0m18:52:53.370642 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m18:52:53.371111 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (compile): 18:52:53.362815 => 18:52:53.370912
[0m18:52:53.371566 [debug] [Thread-2  ]: Began executing node model.bde.dim_property
[0m18:52:53.375020 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_property"
[0m18:52:53.375469 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m18:52:53.375837 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m18:52:53.376162 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:53.376497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:53.376822 [debug] [Thread-2  ]: On model.bde.dim_property: BEGIN
[0m18:52:53.377262 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:53.507690 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:53.508372 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:53.508843 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m18:52:53.524764 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:53.528863 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:53.529401 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m18:52:53.546018 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.547911 [debug] [Thread-4  ]: On model.bde.fact_listing: COMMIT
[0m18:52:53.548414 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:53.548882 [debug] [Thread-4  ]: On model.bde.fact_listing: COMMIT
[0m18:52:53.549690 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:53.550188 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:53.550668 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m18:52:53.555505 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:53.555983 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m18:52:53.556483 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.lowercase_suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m18:52:53.565517 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.569231 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:53.569757 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m18:52:53.571833 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:53.575419 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:53.575943 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m18:52:53.576488 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:53.580275 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m18:52:53.580797 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
alter table "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp" rename to "dim_lge_code_suburb"
[0m18:52:53.585420 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.588372 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (execute): 18:52:53.320013 => 18:52:53.588159
[0m18:52:53.588879 [debug] [Thread-4  ]: On model.bde.fact_listing: Close
[0m18:52:53.589851 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e35286d0>]}
[0m18:52:53.590531 [info ] [Thread-4  ]: 9 of 14 OK created sql view model warehouse.fact_listing ....................... [[32mCREATE VIEW[0m in 0.28s]
[0m18:52:53.591227 [debug] [Thread-4  ]: Finished running node model.bde.fact_listing
[0m18:52:53.597442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.597927 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.599768 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m18:52:53.601457 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m18:52:53.601944 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m18:52:53.602388 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:53.602826 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m18:52:53.603255 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m18:52:53.619639 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.620202 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.623561 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m18:52:53.626244 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:53.626676 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
drop view if exists "postgres"."warehouse"."dim_lge_code_suburb__dbt_backup" cascade
[0m18:52:53.627094 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m18:52:53.641443 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.641928 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.643650 [debug] [Thread-1  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 18:52:53.367042 => 18:52:53.643433
[0m18:52:53.645153 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (execute): 18:52:53.371866 => 18:52:53.644946
[0m18:52:53.645619 [debug] [Thread-1  ]: On model.bde.dim_lge_code_suburb: Close
[0m18:52:53.646059 [debug] [Thread-2  ]: On model.bde.dim_property: Close
[0m18:52:53.647023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e34e0430>]}
[0m18:52:53.647805 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c05ba8e0>]}
[0m18:52:53.648549 [info ] [Thread-1  ]: 10 of 14 OK created sql view model warehouse.dim_lge_code_suburb ............... [[32mCREATE VIEW[0m in 0.29s]
[0m18:52:53.649328 [info ] [Thread-2  ]: 11 of 14 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:52:53.650006 [debug] [Thread-1  ]: Finished running node model.bde.dim_lge_code_suburb
[0m18:52:53.650574 [debug] [Thread-2  ]: Finished running node model.bde.dim_property
[0m18:52:53.651467 [debug] [Thread-3  ]: Began running node model.bde.dm_host_neighbourhood
[0m18:52:53.651922 [debug] [Thread-4  ]: Began running node model.bde.dm_listing_neighbourhood
[0m18:52:53.652419 [info ] [Thread-3  ]: 12 of 14 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m18:52:53.652880 [debug] [Thread-1  ]: Began running node model.bde.dm_property_type
[0m18:52:53.653317 [info ] [Thread-4  ]: 13 of 14 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m18:52:53.654048 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dm_host_neighbourhood)
[0m18:52:53.654525 [info ] [Thread-1  ]: 14 of 14 START sql view model datamart.dm_property_type ........................ [RUN]
[0m18:52:53.655165 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_listing, now model.bde.dm_listing_neighbourhood)
[0m18:52:53.655537 [debug] [Thread-3  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m18:52:53.656093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.dim_lge_code_suburb, now model.bde.dm_property_type)
[0m18:52:53.656452 [debug] [Thread-4  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m18:52:53.659718 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m18:52:53.660135 [debug] [Thread-1  ]: Began compiling node model.bde.dm_property_type
[0m18:52:53.663571 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m18:52:53.667188 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m18:52:53.668034 [debug] [Thread-1  ]: Timing info for model.bde.dm_property_type (compile): 18:52:53.664254 => 18:52:53.667811
[0m18:52:53.668481 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 18:52:53.660417 => 18:52:53.668304
[0m18:52:53.668897 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 18:52:53.656718 => 18:52:53.668724
[0m18:52:53.669199 [debug] [Thread-1  ]: Began executing node model.bde.dm_property_type
[0m18:52:53.669513 [debug] [Thread-4  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m18:52:53.669818 [debug] [Thread-3  ]: Began executing node model.bde.dm_host_neighbourhood
[0m18:52:53.673079 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m18:52:53.675984 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m18:52:53.680467 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m18:52:53.681403 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:53.681732 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m18:52:53.682023 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:53.682466 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:53.682791 [debug] [Thread-1  ]: On model.bde.dm_property_type: BEGIN
[0m18:52:53.683111 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:53.683377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:53.683667 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m18:52:53.684057 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:53.855818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:53.856662 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:53.857288 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:53.858004 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:53.858607 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:53.859183 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:53.860008 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    select
    p.property_type as property_type,
 	p.room_type as room_type,
 	p.accommodates as accommodates,
 	to_char(l.scraped_date, 'MM/YYYY') as month_year,
    round(sum(case when p.has_availability = 't' then  1 else  0 end )::numeric / nullif(count(p.has_availability),0)*100,2) as active_listings_rate,
  	min(case when p.has_availability = 't' then p.price end) as minimum_price,
  	max(case when p.has_availability = 't' then p.price end) as maximum_price,
  	round(percentile_cont(0.5) within group (order by case when p.has_availability = 't' then p.price end)::numeric,2) as median_price,
  	round(avg(case when p.has_availability = 't' then p.price end),2) as average_price,
    count(distinct host_id) as distinct_host,
  	round(sum(case when  h.host_is_superhost  = 't' then  1 else  0 end )::numeric / nullif(count(h.host_is_superhost),0) *100,2) as superhost_ratio,
  	round(avg(case when p.has_availability = 't' then l.review_scores_rating end),2) as average_review_scores_rating,
 	round((lead(sum(case when p.has_availability = 't' then 1 else 0 end)) over (partition by p.property_type  order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
 	round((lead(sum(case when p.has_availability = 'f' then 1 else 0 end)) over (partition by p.property_type order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
    (sum(case when p.has_availability = 't' then (30 - p.availability_30)  else 0 end)) as number_of_stays,
	round(avg(case when p.has_availability = 't' then (30 - p.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
  from 
    "postgres"."warehouse"."dim_property" p
  join 
  	"postgres"."warehouse"."fact_listing" l
  on p.id = l.id
  join  
    "postgres"."warehouse"."dim_host" h
  on p.id = h.id
  group by 
 	property_type,
 	room_type,
 	accommodates,
 	month_year
  order by 
    p.property_type,
    p.room_type,
    p.accommodates,
  	to_char(l.scraped_date, 'MM/YYYY')
  );
[0m18:52:53.861058 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
    l.listing_neighbourhood,
  	to_char(l.scraped_date, 'MM/YYYY') as month_year,
    --round(sum(case when has_availability = 't' then  1 else  0 end )::numeric / nullif(count(has_availability),0) *100,2) as active_listings_ratio,
    round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  	min(case when p.has_availability = 't' then p.price end) as minimum_price,
  	max(case when p.has_availability = 't' then p.price end) as maximum_price,
  	round(percentile_cont(0.5) within group (order by case when p.has_availability = 't' then p.price end)::numeric,2) as median_price,
  	round(avg(case when p.has_availability = 't' then p.price end),2) as average_price,
    count(distinct host_id) as distinct_host,
  	round((sum(case when  h.host_is_superhost  = 't' then  1 else  0 end )::numeric / nullif(count(h.host_is_superhost),0) )*100,2) as superhost_rate,
    round(avg(case when p.has_availability = 't' then l.review_scores_rating end),2) as average_review_scores_rating,
 	round((lead(sum(case when p.has_availability = 't' then 1 else 0 end)) over (partition by listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
 	round((lead(sum(case when p.has_availability = 'f' then 1 else 0 end)) over (partition by listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
    (sum(case when p.has_availability = 't' then 30 - p.availability_30  else 0 end)) as number_of_stays,
	round(avg(case when p.has_availability = 't' then (30 - p.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
  from
  	"postgres"."warehouse"."dim_property" p
  join 
  	"postgres"."warehouse"."fact_listing" l
  on p.id = l.id
  join  
    "postgres"."warehouse"."dim_host" h
  on p.id = h.id
  group by 
  	l.listing_neighbourhood,
  	to_char(l.scraped_date, 'MM/YYYY')
  order by 
  	l.listing_neighbourhood, 
  	to_char(l.scraped_date, 'MM/YYYY')
  );
[0m18:52:53.861998 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    with joined_table as (
	select 
		p.id, 
		p.scraped_date, 
		h.host_id,
		h.host_name,
		h.host_neighbourhood,
		lga.lowercase_lga_name as host_neighbourhood_lga,
		p.price,
		p.has_availability,
		p.availability_30 
	from 
		"postgres"."warehouse"."dim_property" p
	join 
		"postgres"."warehouse"."dim_host" h
	on p.id = h.id
	join
		"postgres"."warehouse"."dim_lge_code_suburb" lga
	on
		h.lower_host_neighbourhood = lga.lowercase_suburb_name
)

select 
	host_neighbourhood_lga,
	to_char(scraped_date, 'MM/YYYY') as month_year,
	count(distinct host_id) as distinct_host,
	round(sum(case when has_availability = 't' then (30 - availability_30)  else 0 end )* price,2) as estimate_revenue_per_active,
	--round((sum(case when has_availability = 't' then (30 - availability_30)  else 0 )* price) / nullif(count(distinct host_id),0)::numeric, 2) as estimate_revenue_per_host
	round((sum(case when has_availability = 't' then (30 - availability_30)  else 0 end)* price) / count(distinct host_id), 2) as estimate_revenue_per_host
from joined_table
group by 
	host_neighbourhood_lga,
	to_char(scraped_date, 'MM/YYYY')
order by 
    host_neighbourhood_lga,
    to_char(scraped_date, 'MM/YYYY')
  );
[0m18:52:53.879183 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column h.host_neighbourhood does not exist
LINE 13:   h.host_neighbourhood,
           ^

[0m18:52:53.879824 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: ROLLBACK
[0m18:52:53.880823 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column l.listing_neighbourhood does not exist
LINE 8:     l.listing_neighbourhood,
            ^
HINT:  Perhaps you meant to reference the column "p.listing_neighbourhood".

[0m18:52:53.881435 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: ROLLBACK
[0m18:52:53.890365 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:53.895474 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:53.896098 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m18:52:53.897267 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 18:52:53.676258 => 18:52:53.896943
[0m18:52:53.898086 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 18:52:53.673338 => 18:52:53.897794
[0m18:52:53.898630 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: Close
[0m18:52:53.899204 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: Close
[0m18:52:53.907976 [debug] [Thread-3  ]: Database Error in model dm_host_neighbourhood (models/datamart/dm_host_neighbourhood.sql)
  column h.host_neighbourhood does not exist
  LINE 13:   h.host_neighbourhood,
             ^
  compiled Code at target/run/bde/models/datamart/dm_host_neighbourhood.sql
[0m18:52:53.908694 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e3550670>]}
[0m18:52:53.909741 [debug] [Thread-4  ]: Database Error in model dm_listing_neighbourhood (models/datamart/dm_listing_neighbourhood.sql)
  column l.listing_neighbourhood does not exist
  LINE 8:     l.listing_neighbourhood,
              ^
  HINT:  Perhaps you meant to reference the column "p.listing_neighbourhood".
  compiled Code at target/run/bde/models/datamart/dm_listing_neighbourhood.sql
[0m18:52:53.910590 [error] [Thread-3  ]: 12 of 14 ERROR creating sql view model datamart.dm_host_neighbourhood .......... [[31mERROR[0m in 0.25s]
[0m18:52:53.911308 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e3564160>]}
[0m18:52:53.912079 [debug] [Thread-3  ]: Finished running node model.bde.dm_host_neighbourhood
[0m18:52:53.913300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:53.912821 [error] [Thread-4  ]: 13 of 14 ERROR creating sql view model datamart.dm_listing_neighbourhood ....... [[31mERROR[0m in 0.26s]
[0m18:52:53.915582 [debug] [Thread-1  ]: On model.bde.dm_property_type: COMMIT
[0m18:52:53.916293 [debug] [Thread-4  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m18:52:53.916742 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:53.917397 [debug] [Thread-1  ]: On model.bde.dm_property_type: COMMIT
[0m18:52:53.933123 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:53.936610 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:53.937191 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m18:52:53.951718 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:53.953632 [debug] [Thread-1  ]: Timing info for model.bde.dm_property_type (execute): 18:52:53.670041 => 18:52:53.953413
[0m18:52:53.954112 [debug] [Thread-1  ]: On model.bde.dm_property_type: Close
[0m18:52:53.955143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fb08db-75bb-4c43-a679-1a457a689c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e34e3730>]}
[0m18:52:53.955858 [info ] [Thread-1  ]: 14 of 14 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.30s]
[0m18:52:53.956567 [debug] [Thread-1  ]: Finished running node model.bde.dm_property_type
[0m18:52:53.957926 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:53.958275 [debug] [MainThread]: On master: BEGIN
[0m18:52:53.958589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:54.121679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:54.122552 [debug] [MainThread]: On master: COMMIT
[0m18:52:54.123142 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:54.123694 [debug] [MainThread]: On master: COMMIT
[0m18:52:54.140800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:54.141397 [debug] [MainThread]: On master: Close
[0m18:52:54.142866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:54.143418 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m18:52:54.143928 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m18:52:54.144424 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m18:52:54.144924 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m18:52:54.145613 [info ] [MainThread]: 
[0m18:52:54.146235 [info ] [MainThread]: Finished running 14 view models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m18:52:54.150582 [debug] [MainThread]: Command end result
[0m18:52:54.164178 [info ] [MainThread]: 
[0m18:52:54.164881 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:52:54.165348 [info ] [MainThread]: 
[0m18:52:54.165826 [error] [MainThread]:   Database Error in model dm_host_neighbourhood (models/datamart/dm_host_neighbourhood.sql)
  column h.host_neighbourhood does not exist
  LINE 13:   h.host_neighbourhood,
             ^
  compiled Code at target/run/bde/models/datamart/dm_host_neighbourhood.sql
[0m18:52:54.166270 [info ] [MainThread]: 
[0m18:52:54.166710 [error] [MainThread]:   Database Error in model dm_listing_neighbourhood (models/datamart/dm_listing_neighbourhood.sql)
  column l.listing_neighbourhood does not exist
  LINE 8:     l.listing_neighbourhood,
              ^
  HINT:  Perhaps you meant to reference the column "p.listing_neighbourhood".
  compiled Code at target/run/bde/models/datamart/dm_listing_neighbourhood.sql
[0m18:52:54.167163 [info ] [MainThread]: 
[0m18:52:54.167624 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 TOTAL=14
[0m18:52:54.168449 [debug] [MainThread]: Command `dbt run` failed at 18:52:54.168320 after 3.61 seconds
[0m18:52:54.169004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e0bd96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7e3417220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b01b02e0>]}
[0m18:52:54.169532 [debug] [MainThread]: Flushing usage events
[0m19:05:50.493813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a0b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a30c1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a30c1940>]}


============================== 19:05:50.497787 | 9f4491ab-e24a-4753-b4bd-67d48bdc2b9a ==============================
[0m19:05:50.497787 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:05:50.498426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:05:50.638741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a30c18e0>]}
[0m19:05:50.649688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6700a12b0>]}
[0m19:05:50.650247 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m19:05:50.674292 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:05:50.708243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:05:50.708902 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m19:05:50.709289 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_host_neighbourhood.sql
[0m19:05:50.747492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6787b50d0>]}
[0m19:05:50.764829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa690174d90>]}
[0m19:05:50.765297 [info ] [MainThread]: Found 4 snapshots, 14 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m19:05:50.765612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa690174fd0>]}
[0m19:05:50.767296 [info ] [MainThread]: 
[0m19:05:50.767890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:05:50.769111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:50.769682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:50.777304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:50.777825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:05:50.779367 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:50.779662 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:50.780977 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:50.781262 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:50.781523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:50.781786 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:50.782014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:50.783262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:51.194688 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m19:05:51.197166 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:51.197690 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m19:05:51.198208 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m19:05:51.199878 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:51.201963 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:51.205520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m19:05:51.206449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m19:05:51.214526 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m19:05:51.215279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m19:05:51.217278 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m19:05:51.218068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_warehouse'
[0m19:05:51.218412 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m19:05:51.220456 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m19:05:51.220818 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m19:05:51.222617 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m19:05:51.222943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:51.223243 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m19:05:51.223527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:51.223818 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m19:05:51.224247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:51.224738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:51.398181 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:05:51.398899 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m19:05:51.399472 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m19:05:51.403691 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:05:51.404250 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:05:51.404777 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m19:05:51.405306 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m19:05:51.405859 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m19:05:51.406463 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:05:51.407312 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:05:51.407798 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m19:05:51.408323 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m19:05:51.421061 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:05:51.423333 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m19:05:51.427187 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:05:51.427749 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:05:51.429496 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m19:05:51.431270 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m19:05:51.431777 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:05:51.433672 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m19:05:51.437788 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m19:05:51.448364 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m19:05:51.448851 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m19:05:51.449318 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m19:05:51.460734 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:51.461256 [debug] [MainThread]: On master: BEGIN
[0m19:05:51.461669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:51.642336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:51.644115 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:51.645386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:51.671687 [debug] [MainThread]: SQL status: SELECT 15 in 0.0 seconds
[0m19:05:51.683138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa670243fd0>]}
[0m19:05:51.684284 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:51.699127 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:51.699829 [debug] [MainThread]: On master: BEGIN
[0m19:05:51.732913 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:51.734574 [debug] [MainThread]: On master: COMMIT
[0m19:05:51.735706 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:51.736773 [debug] [MainThread]: On master: COMMIT
[0m19:05:51.752532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:51.754949 [debug] [MainThread]: On master: Close
[0m19:05:51.759042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:51.760481 [info ] [MainThread]: 
[0m19:05:51.767157 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m19:05:51.768092 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m19:05:51.769027 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m19:05:51.769969 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m19:05:51.771011 [info ] [Thread-1  ]: 1 of 14 START sql view model staging.code_stg .................................. [RUN]
[0m19:05:51.772085 [info ] [Thread-2  ]: 2 of 14 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m19:05:51.773098 [info ] [Thread-3  ]: 3 of 14 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m19:05:51.774081 [info ] [Thread-4  ]: 4 of 14 START sql view model staging.host_stg .................................. [RUN]
[0m19:05:51.775544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.code_stg)
[0m19:05:51.777025 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G01)
[0m19:05:51.778177 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.fact_census_G02)
[0m19:05:51.779287 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.host_stg)
[0m19:05:51.780087 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m19:05:51.780739 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m19:05:51.781380 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m19:05:51.782007 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m19:05:51.795280 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m19:05:51.799776 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m19:05:51.803587 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m19:05:51.808815 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m19:05:51.810820 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 19:05:51.782500 => 19:05:51.810540
[0m19:05:51.811399 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 19:05:51.804020 => 19:05:51.811137
[0m19:05:51.811933 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 19:05:51.795896 => 19:05:51.811720
[0m19:05:51.812417 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m19:05:51.812871 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m19:05:51.813363 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 19:05:51.800282 => 19:05:51.813160
[0m19:05:51.813834 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m19:05:51.854678 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m19:05:51.856318 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m19:05:51.856635 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m19:05:51.859540 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m19:05:51.862966 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m19:05:51.863598 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:05:51.863912 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:05:51.864270 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:05:51.864579 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m19:05:51.864883 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m19:05:51.865161 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:05:51.865438 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m19:05:51.865711 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:05:51.865973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:51.866259 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m19:05:51.866526 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:05:51.867007 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:05:52.040391 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.041213 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.041831 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.042496 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:05:52.043110 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:05:52.043688 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:05:52.044321 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m19:05:52.044935 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.045564 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m19:05:52.046281 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m19:05:52.046969 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:05:52.047707 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m19:05:52.066859 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.067449 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.077730 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:05:52.078281 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.078761 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.084060 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:05:52.084633 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m19:05:52.126952 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:05:52.129575 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:05:52.129903 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m19:05:52.130289 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02" rename to "fact_census_G02__dbt_backup"
[0m19:05:52.130628 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01" rename to "fact_census_G01__dbt_backup"
[0m19:05:52.146225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.148911 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:05:52.149269 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.149627 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.149938 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m19:05:52.150315 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.152706 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:05:52.155144 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:05:52.157678 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:05:52.158029 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m19:05:52.158363 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m19:05:52.158686 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m19:05:52.169725 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.180625 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.180963 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.185068 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m19:05:52.186355 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m19:05:52.186661 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.188042 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m19:05:52.188397 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:05:52.188707 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:05:52.190000 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m19:05:52.190307 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:05:52.190581 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m19:05:52.190853 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m19:05:52.191128 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:05:52.191395 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m19:05:52.191745 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m19:05:52.206564 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.206917 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.213185 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.214855 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:05:52.215193 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.218434 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:05:52.220647 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:05:52.220995 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m19:05:52.223091 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:05:52.223425 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m19:05:52.223763 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m19:05:52.224128 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m19:05:52.240450 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.241753 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 19:05:51.860088 => 19:05:52.241578
[0m19:05:52.242129 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m19:05:52.242921 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a33c3f40>]}
[0m19:05:52.243753 [info ] [Thread-3  ]: 3 of 14 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.47s]
[0m19:05:52.244345 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m19:05:52.244730 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m19:05:52.245117 [info ] [Thread-3  ]: 5 of 14 START sql view model staging.listings_stg .............................. [RUN]
[0m19:05:52.245682 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.listings_stg)
[0m19:05:52.246014 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m19:05:52.248761 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m19:05:52.249121 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.249472 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.249791 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.251028 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 19:05:51.814195 => 19:05:52.250874
[0m19:05:52.252197 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 19:05:51.839265 => 19:05:52.252057
[0m19:05:52.253314 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 19:05:51.856873 => 19:05:52.253169
[0m19:05:52.253683 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 19:05:52.246310 => 19:05:52.253536
[0m19:05:52.254000 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m19:05:52.254307 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m19:05:52.254614 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m19:05:52.254921 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m19:05:52.258570 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m19:05:52.259520 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa670185670>]}
[0m19:05:52.260100 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a339c130>]}
[0m19:05:52.260619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a3327550>]}
[0m19:05:52.261281 [info ] [Thread-4  ]: 4 of 14 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.48s]
[0m19:05:52.269514 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m19:05:52.269155 [info ] [Thread-2  ]: 2 of 14 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.48s]
[0m19:05:52.269965 [info ] [Thread-1  ]: 1 of 14 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.49s]
[0m19:05:52.270595 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m19:05:52.270935 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m19:05:52.271657 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m19:05:52.272119 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m19:05:52.272482 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m19:05:52.272895 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:05:52.273257 [debug] [Thread-2  ]: Began running node model.bde.suburb_stg
[0m19:05:52.273632 [debug] [Thread-1  ]: Began running node model.bde.dim_host
[0m19:05:52.274034 [info ] [Thread-4  ]: 6 of 14 START sql view model staging.property_stg .............................. [RUN]
[0m19:05:52.274569 [info ] [Thread-2  ]: 7 of 14 START sql view model staging.suburb_stg ................................ [RUN]
[0m19:05:52.275007 [info ] [Thread-1  ]: 8 of 14 START sql view model warehouse.dim_host ................................ [RUN]
[0m19:05:52.275657 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m19:05:52.276206 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.suburb_stg)
[0m19:05:52.276713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.dim_host)
[0m19:05:52.277077 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m19:05:52.277428 [debug] [Thread-2  ]: Began compiling node model.bde.suburb_stg
[0m19:05:52.277771 [debug] [Thread-1  ]: Began compiling node model.bde.dim_host
[0m19:05:52.280619 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m19:05:52.282988 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m19:05:52.285135 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_host"
[0m19:05:52.285815 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 19:05:52.278017 => 19:05:52.285655
[0m19:05:52.286171 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (compile): 19:05:52.280931 => 19:05:52.286025
[0m19:05:52.286508 [debug] [Thread-1  ]: Timing info for model.bde.dim_host (compile): 19:05:52.283262 => 19:05:52.286376
[0m19:05:52.286775 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m19:05:52.287057 [debug] [Thread-2  ]: Began executing node model.bde.suburb_stg
[0m19:05:52.287333 [debug] [Thread-1  ]: Began executing node model.bde.dim_host
[0m19:05:52.291483 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m19:05:52.295265 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m19:05:52.298200 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_host"
[0m19:05:52.298894 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m19:05:52.299191 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m19:05:52.299473 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:05:52.299795 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m19:05:52.300108 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:05:52.300505 [debug] [Thread-1  ]: On model.bde.dim_host: BEGIN
[0m19:05:52.300804 [debug] [Thread-2  ]: On model.bde.suburb_stg: BEGIN
[0m19:05:52.301087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:52.301349 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:05:52.441768 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.442391 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m19:05:52.442866 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m19:05:52.452952 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.453442 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m19:05:52.453917 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        listing_neighbourhood,
        property_type,  
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m19:05:52.461538 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.465600 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m19:05:52.466085 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.466590 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.467017 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m19:05:52.467460 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m19:05:52.467882 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:05:52.468406 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m19:05:52.468879 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m19:05:52.469513 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.472779 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m19:05:52.473197 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m19:05:52.486366 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.489580 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m19:05:52.490023 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.490432 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.490814 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m19:05:52.491188 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.494532 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:05:52.497500 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m19:05:52.501068 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m19:05:52.501469 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m19:05:52.501841 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m19:05:52.502209 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m19:05:52.512512 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.514004 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m19:05:52.514370 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m19:05:52.514715 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m19:05:52.518853 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.519228 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.519590 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.521243 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m19:05:52.522569 [debug] [Thread-1  ]: On model.bde.dim_host: COMMIT
[0m19:05:52.525487 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:05:52.525881 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m19:05:52.526245 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m19:05:52.526599 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m19:05:52.526947 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m19:05:52.527285 [debug] [Thread-1  ]: On model.bde.dim_host: COMMIT
[0m19:05:52.532323 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.534753 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m19:05:52.535126 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m19:05:52.540647 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.542122 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m19:05:52.542669 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.543008 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.543327 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:05:52.545644 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m19:05:52.547995 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m19:05:52.548341 [debug] [Thread-2  ]: On model.bde.suburb_stg: COMMIT
[0m19:05:52.548678 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m19:05:52.549015 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m19:05:52.553526 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.554766 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 19:05:52.255296 => 19:05:52.554603
[0m19:05:52.555121 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m19:05:52.555900 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a334a910>]}
[0m19:05:52.556419 [info ] [Thread-3  ]: 5 of 14 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m19:05:52.556965 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m19:05:52.557462 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m19:05:52.557861 [info ] [Thread-3  ]: 9 of 14 START sql view model warehouse.fact_listing ............................ [RUN]
[0m19:05:52.558418 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_listing)
[0m19:05:52.558750 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m19:05:52.561273 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m19:05:52.562228 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 19:05:52.558988 => 19:05:52.562058
[0m19:05:52.562548 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m19:05:52.562856 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.566151 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m19:05:52.566519 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.566838 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.568037 [debug] [Thread-1  ]: Timing info for model.bde.dim_host (execute): 19:05:52.295587 => 19:05:52.567883
[0m19:05:52.570326 [debug] [Thread-2  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:05:52.571466 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 19:05:52.287536 => 19:05:52.571315
[0m19:05:52.571874 [debug] [Thread-1  ]: On model.bde.dim_host: Close
[0m19:05:52.572200 [debug] [Thread-2  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m19:05:52.572488 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:05:52.572777 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m19:05:52.573179 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m19:05:52.573758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a15ee1f0>]}
[0m19:05:52.574113 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:05:52.574679 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6788310a0>]}
[0m19:05:52.575116 [info ] [Thread-1  ]: 8 of 14 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m19:05:52.575694 [info ] [Thread-4  ]: 6 of 14 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m19:05:52.576165 [debug] [Thread-1  ]: Finished running node model.bde.dim_host
[0m19:05:52.576581 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m19:05:52.577091 [debug] [Thread-1  ]: Began running node model.bde.dim_property
[0m19:05:52.577437 [info ] [Thread-1  ]: 10 of 14 START sql view model warehouse.dim_property ........................... [RUN]
[0m19:05:52.577937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dim_property)
[0m19:05:52.578229 [debug] [Thread-1  ]: Began compiling node model.bde.dim_property
[0m19:05:52.581572 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_property"
[0m19:05:52.582426 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (compile): 19:05:52.578437 => 19:05:52.582238
[0m19:05:52.582752 [debug] [Thread-1  ]: Began executing node model.bde.dim_property
[0m19:05:52.586089 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_property"
[0m19:05:52.587069 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m19:05:52.587365 [debug] [Thread-1  ]: On model.bde.dim_property: BEGIN
[0m19:05:52.587630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:05:52.594566 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.595929 [debug] [Thread-2  ]: Timing info for model.bde.suburb_stg (execute): 19:05:52.291943 => 19:05:52.595782
[0m19:05:52.596253 [debug] [Thread-2  ]: On model.bde.suburb_stg: Close
[0m19:05:52.596956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67023b4c0>]}
[0m19:05:52.597424 [info ] [Thread-2  ]: 7 of 14 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.32s]
[0m19:05:52.597879 [debug] [Thread-2  ]: Finished running node model.bde.suburb_stg
[0m19:05:52.598337 [debug] [Thread-4  ]: Began running node model.bde.dim_lge_code_suburb
[0m19:05:52.598710 [info ] [Thread-4  ]: 11 of 14 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m19:05:52.599227 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_lge_code_suburb)
[0m19:05:52.599526 [debug] [Thread-4  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m19:05:52.602134 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m19:05:52.602749 [debug] [Thread-4  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 19:05:52.599732 => 19:05:52.602596
[0m19:05:52.603049 [debug] [Thread-4  ]: Began executing node model.bde.dim_lge_code_suburb
[0m19:05:52.606048 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m19:05:52.606561 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:05:52.606853 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m19:05:52.607117 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:05:52.730060 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.730584 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:05:52.730970 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m19:05:52.748700 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.752077 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:05:52.752549 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m19:05:52.763106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.763493 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m19:05:52.763884 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m19:05:52.765684 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:52.766067 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:05:52.766464 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.lowercase_suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m19:05:52.769529 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.771242 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m19:05:52.771656 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:05:52.772025 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m19:05:52.785670 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.789226 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:05:52.789708 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:52.790155 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.790616 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
alter table "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp" rename to "dim_lge_code_suburb"
[0m19:05:52.793847 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m19:05:52.796503 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:05:52.796988 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m19:05:52.797413 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m19:05:52.811076 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.812756 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m19:05:52.813160 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:05:52.813529 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m19:05:52.815394 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.815781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:52.817150 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 19:05:52.563076 => 19:05:52.816962
[0m19:05:52.818639 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m19:05:52.819072 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m19:05:52.819465 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m19:05:52.819916 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m19:05:52.820638 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67023fac0>]}
[0m19:05:52.821294 [info ] [Thread-3  ]: 9 of 14 OK created sql view model warehouse.fact_listing ....................... [[32mCREATE VIEW[0m in 0.26s]
[0m19:05:52.821936 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m19:05:52.831743 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.835750 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:05:52.836183 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:52.836561 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
drop view if exists "postgres"."warehouse"."dim_lge_code_suburb__dbt_backup" cascade
[0m19:05:52.839124 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m19:05:52.839617 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m19:05:52.856966 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.857447 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:52.859253 [debug] [Thread-4  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 19:05:52.603258 => 19:05:52.859044
[0m19:05:52.860838 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (execute): 19:05:52.582972 => 19:05:52.860652
[0m19:05:52.861292 [debug] [Thread-4  ]: On model.bde.dim_lge_code_suburb: Close
[0m19:05:52.861695 [debug] [Thread-1  ]: On model.bde.dim_property: Close
[0m19:05:52.862752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa678812ee0>]}
[0m19:05:52.863425 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa690267430>]}
[0m19:05:52.863971 [info ] [Thread-1  ]: 10 of 14 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m19:05:52.864515 [info ] [Thread-4  ]: 11 of 14 OK created sql view model warehouse.dim_lge_code_suburb ............... [[32mCREATE VIEW[0m in 0.26s]
[0m19:05:52.865071 [debug] [Thread-1  ]: Finished running node model.bde.dim_property
[0m19:05:52.865580 [debug] [Thread-4  ]: Finished running node model.bde.dim_lge_code_suburb
[0m19:05:52.866198 [debug] [Thread-4  ]: Began running node model.bde.dm_listing_neighbourhood
[0m19:05:52.866665 [info ] [Thread-4  ]: 12 of 14 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m19:05:52.867280 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_lge_code_suburb, now model.bde.dm_listing_neighbourhood)
[0m19:05:52.867650 [debug] [Thread-4  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m19:05:52.871063 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m19:05:52.871566 [debug] [Thread-2  ]: Began running node model.bde.dm_property_type
[0m19:05:52.871978 [debug] [Thread-3  ]: Began running node model.bde.dm_host_neighbourhood
[0m19:05:52.872400 [info ] [Thread-2  ]: 13 of 14 START sql view model datamart.dm_property_type ........................ [RUN]
[0m19:05:52.872821 [info ] [Thread-3  ]: 14 of 14 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m19:05:52.873436 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dm_property_type)
[0m19:05:52.873997 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_listing, now model.bde.dm_host_neighbourhood)
[0m19:05:52.874386 [debug] [Thread-2  ]: Began compiling node model.bde.dm_property_type
[0m19:05:52.874804 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 19:05:52.867911 => 19:05:52.874620
[0m19:05:52.875213 [debug] [Thread-3  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m19:05:52.878723 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m19:05:52.879131 [debug] [Thread-4  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m19:05:52.881746 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m19:05:52.885017 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m19:05:52.885619 [debug] [Thread-2  ]: Timing info for model.bde.dm_property_type (compile): 19:05:52.875487 => 19:05:52.885452
[0m19:05:52.886036 [debug] [Thread-2  ]: Began executing node model.bde.dm_property_type
[0m19:05:52.886416 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 19:05:52.879376 => 19:05:52.886264
[0m19:05:52.889343 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m19:05:52.889727 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:05:52.890063 [debug] [Thread-3  ]: Began executing node model.bde.dm_host_neighbourhood
[0m19:05:52.890431 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m19:05:52.893803 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m19:05:52.894229 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:05:52.894544 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:05:52.895063 [debug] [Thread-2  ]: On model.bde.dm_property_type: BEGIN
[0m19:05:52.895392 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:05:52.895689 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:05:52.896084 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m19:05:52.896386 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:05:53.065361 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:53.066135 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:53.066848 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:05:53.067448 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:05:53.068252 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    select
    p.property_type as property_type,
 	p.room_type as room_type,
 	p.accommodates as accommodates,
 	to_char(l.scraped_date, 'MM/YYYY') as month_year,
    round(sum(case when p.has_availability = 't' then  1 else  0 end )::numeric / nullif(count(p.has_availability),0)*100,2) as active_listings_rate,
  	min(case when p.has_availability = 't' then p.price end) as minimum_price,
  	max(case when p.has_availability = 't' then p.price end) as maximum_price,
  	round(percentile_cont(0.5) within group (order by case when p.has_availability = 't' then p.price end)::numeric,2) as median_price,
  	round(avg(case when p.has_availability = 't' then p.price end),2) as average_price,
    count(distinct host_id) as distinct_host,
  	round(sum(case when  h.host_is_superhost  = 't' then  1 else  0 end )::numeric / nullif(count(h.host_is_superhost),0) *100,2) as superhost_ratio,
  	round(avg(case when p.has_availability = 't' then l.review_scores_rating end),2) as average_review_scores_rating,
 	round((lead(sum(case when p.has_availability = 't' then 1 else 0 end)) over (partition by p.property_type  order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
 	round((lead(sum(case when p.has_availability = 'f' then 1 else 0 end)) over (partition by p.property_type order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
    (sum(case when p.has_availability = 't' then (30 - p.availability_30)  else 0 end)) as number_of_stays,
	round(avg(case when p.has_availability = 't' then (30 - p.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
  from 
    "postgres"."warehouse"."dim_property" p
  join 
  	"postgres"."warehouse"."fact_listing" l
  on p.id = l.id
  join  
    "postgres"."warehouse"."dim_host" h
  on p.id = h.id
  group by 
 	property_type,
 	room_type,
 	accommodates,
 	month_year
  order by 
    p.property_type,
    p.room_type,
    p.accommodates,
  	to_char(l.scraped_date, 'MM/YYYY')
  );
[0m19:05:53.069257 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
    l.listing_neighbourhood,
  	to_char(l.scraped_date, 'MM/YYYY') as month_year,
    --round(sum(case when has_availability = 't' then  1 else  0 end )::numeric / nullif(count(has_availability),0) *100,2) as active_listings_ratio,
    round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  	min(case when p.has_availability = 't' then p.price end) as minimum_price,
  	max(case when p.has_availability = 't' then p.price end) as maximum_price,
  	round(percentile_cont(0.5) within group (order by case when p.has_availability = 't' then p.price end)::numeric,2) as median_price,
  	round(avg(case when p.has_availability = 't' then p.price end),2) as average_price,
    count(distinct host_id) as distinct_host,
  	round((sum(case when  h.host_is_superhost  = 't' then  1 else  0 end )::numeric / nullif(count(h.host_is_superhost),0) )*100,2) as superhost_rate,
    round(avg(case when p.has_availability = 't' then l.review_scores_rating end),2) as average_review_scores_rating,
 	round((lead(sum(case when p.has_availability = 't' then 1 else 0 end)) over (partition by listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
 	round((lead(sum(case when p.has_availability = 'f' then 1 else 0 end)) over (partition by listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
    (sum(case when p.has_availability = 't' then 30 - p.availability_30  else 0 end)) as number_of_stays,
	round(avg(case when p.has_availability = 't' then (30 - p.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
  from
  	"postgres"."warehouse"."dim_property" p
  join 
  	"postgres"."warehouse"."fact_listing" l
  on p.id = l.id
  join  
    "postgres"."warehouse"."dim_host" h
  on p.id = h.id
  group by 
  	p.listing_neighbourhood,
  	to_char(l.scraped_date, 'MM/YYYY')
  order by 
  	p.listing_neighbourhood, 
  	to_char(l.scraped_date, 'MM/YYYY')
  );
[0m19:05:53.070206 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:05:53.070777 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:05:53.071470 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    with joined_table as (
	select 
		p.id, 
		p.scraped_date, 
		h.host_id,
		h.host_name,
		h.lower_host_neighbourhood,
		lga.lowercase_lga_name as host_neighbourhood_lga,
		p.price,
		p.has_availability,
		p.availability_30 
	from 
		"postgres"."warehouse"."dim_property" p
	join 
		"postgres"."warehouse"."dim_host" h
	on p.id = h.id
	join
		"postgres"."warehouse"."dim_lge_code_suburb" lga
	on
		h.lower_host_neighbourhood = lga.lowercase_suburb_name
)

select 
	host_neighbourhood_lga,
	to_char(scraped_date, 'MM/YYYY') as month_year,
	count(distinct host_id) as distinct_host,
	round(sum(case when has_availability = 't' then (30 - availability_30)  else 0 end )* price,2) as estimate_revenue_per_active,
	--round((sum(case when has_availability = 't' then (30 - availability_30)  else 0 )* price) / nullif(count(distinct host_id),0)::numeric, 2) as estimate_revenue_per_host
	round((sum(case when has_availability = 't' then (30 - availability_30)  else 0 end)* price) / count(distinct host_id), 2) as estimate_revenue_per_host
from joined_table
group by 
	host_neighbourhood_lga,
	to_char(scraped_date, 'MM/YYYY')
order by 
    host_neighbourhood_lga,
    to_char(scraped_date, 'MM/YYYY')
  );
[0m19:05:53.092122 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column l.listing_neighbourhood does not exist
LINE 8:     l.listing_neighbourhood,
            ^
HINT:  Perhaps you meant to reference the column "p.listing_neighbourhood".

[0m19:05:53.092831 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: ROLLBACK
[0m19:05:53.093637 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "joined_table.price" must appear in the GROUP BY clause or be used in an aggregate function
LINE 33: ... = 't' then (30 - availability_30)  else 0 end )* price,2) a...
                                                              ^

[0m19:05:53.094161 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: ROLLBACK
[0m19:05:53.103007 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:53.107741 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:05:53.108495 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 19:05:52.890673 => 19:05:53.108141
[0m19:05:53.109052 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 19:05:52.882105 => 19:05:53.108856
[0m19:05:53.109505 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m19:05:53.109940 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: Close
[0m19:05:53.110352 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: Close
[0m19:05:53.116679 [debug] [Thread-3  ]: Database Error in model dm_host_neighbourhood (models/datamart/dm_host_neighbourhood.sql)
  column "joined_table.price" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 33: ... = 't' then (30 - availability_30)  else 0 end )* price,2) a...
                                                                ^
  compiled Code at target/run/bde/models/datamart/dm_host_neighbourhood.sql
[0m19:05:53.117516 [debug] [Thread-4  ]: Database Error in model dm_listing_neighbourhood (models/datamart/dm_listing_neighbourhood.sql)
  column l.listing_neighbourhood does not exist
  LINE 8:     l.listing_neighbourhood,
              ^
  HINT:  Perhaps you meant to reference the column "p.listing_neighbourhood".
  compiled Code at target/run/bde/models/datamart/dm_listing_neighbourhood.sql
[0m19:05:53.118015 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6788d0730>]}
[0m19:05:53.118429 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa678812ee0>]}
[0m19:05:53.119031 [error] [Thread-3  ]: 14 of 14 ERROR creating sql view model datamart.dm_host_neighbourhood .......... [[31mERROR[0m in 0.24s]
[0m19:05:53.119662 [error] [Thread-4  ]: 12 of 14 ERROR creating sql view model datamart.dm_listing_neighbourhood ....... [[31mERROR[0m in 0.25s]
[0m19:05:53.120291 [debug] [Thread-3  ]: Finished running node model.bde.dm_host_neighbourhood
[0m19:05:53.120822 [debug] [Thread-4  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m19:05:53.130380 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:53.131908 [debug] [Thread-2  ]: On model.bde.dm_property_type: COMMIT
[0m19:05:53.132291 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:05:53.132640 [debug] [Thread-2  ]: On model.bde.dm_property_type: COMMIT
[0m19:05:53.168348 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:53.171456 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:05:53.171904 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m19:05:53.200459 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:53.202258 [debug] [Thread-2  ]: Timing info for model.bde.dm_property_type (execute): 19:05:52.886679 => 19:05:53.202039
[0m19:05:53.202737 [debug] [Thread-2  ]: On model.bde.dm_property_type: Close
[0m19:05:53.203748 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f4491ab-e24a-4753-b4bd-67d48bdc2b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6788b46a0>]}
[0m19:05:53.204446 [info ] [Thread-2  ]: 13 of 14 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.33s]
[0m19:05:53.205154 [debug] [Thread-2  ]: Finished running node model.bde.dm_property_type
[0m19:05:53.206760 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:53.207194 [debug] [MainThread]: On master: BEGIN
[0m19:05:53.207554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:53.483515 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:53.486017 [debug] [MainThread]: On master: COMMIT
[0m19:05:53.487372 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:53.488289 [debug] [MainThread]: On master: COMMIT
[0m19:05:53.514394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:53.516428 [debug] [MainThread]: On master: Close
[0m19:05:53.519284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:53.520284 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m19:05:53.521456 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m19:05:53.522246 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m19:05:53.522877 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m19:05:53.523794 [info ] [MainThread]: 
[0m19:05:53.524630 [info ] [MainThread]: Finished running 14 view models in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m19:05:53.529990 [debug] [MainThread]: Command end result
[0m19:05:53.545634 [info ] [MainThread]: 
[0m19:05:53.546575 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:05:53.547136 [info ] [MainThread]: 
[0m19:05:53.547675 [error] [MainThread]:   Database Error in model dm_host_neighbourhood (models/datamart/dm_host_neighbourhood.sql)
  column "joined_table.price" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 33: ... = 't' then (30 - availability_30)  else 0 end )* price,2) a...
                                                                ^
  compiled Code at target/run/bde/models/datamart/dm_host_neighbourhood.sql
[0m19:05:53.548197 [info ] [MainThread]: 
[0m19:05:53.548697 [error] [MainThread]:   Database Error in model dm_listing_neighbourhood (models/datamart/dm_listing_neighbourhood.sql)
  column l.listing_neighbourhood does not exist
  LINE 8:     l.listing_neighbourhood,
              ^
  HINT:  Perhaps you meant to reference the column "p.listing_neighbourhood".
  compiled Code at target/run/bde/models/datamart/dm_listing_neighbourhood.sql
[0m19:05:53.549215 [info ] [MainThread]: 
[0m19:05:53.549729 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 TOTAL=14
[0m19:05:53.550696 [debug] [MainThread]: Command `dbt run` failed at 19:05:53.550539 after 3.09 seconds
[0m19:05:53.551324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a0b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6a33069a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa678888d60>]}
[0m19:05:53.551939 [debug] [MainThread]: Flushing usage events
[0m19:30:53.570182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c0c316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c2f00850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c2f00940>]}


============================== 19:30:53.574204 | 76f8e0b5-52ad-42db-b4c4-a9e40ee17497 ==============================
[0m19:30:53.574204 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:30:53.574831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/94693 Big Data Engineering/dbt-dev/bde/logs', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:30:53.725865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c2f008e0>]}
[0m19:30:53.736751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c30382b0>]}
[0m19:30:53.737310 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m19:30:53.755216 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:30:53.798258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:30:53.798890 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m19:30:53.799219 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_host_neighbourhood.sql
[0m19:30:53.836418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0a7f0d0>]}
[0m19:30:53.850384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c31d4cd0>]}
[0m19:30:53.850825 [info ] [MainThread]: Found 4 snapshots, 14 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m19:30:53.851125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c31d4f10>]}
[0m19:30:53.852746 [info ] [MainThread]: 
[0m19:30:53.853341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:53.854562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:30:53.861446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:30:53.862062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:30:53.863434 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:30:53.864843 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:30:53.866343 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:30:53.866658 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:30:53.866938 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:30:53.867237 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:30:53.867542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:53.867796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:53.868036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:54.403834 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.0 seconds
[0m19:30:54.404278 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.0 seconds
[0m19:30:54.404704 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.0 seconds
[0m19:30:54.406241 [debug] [ThreadPool]: On list_postgres: Close
[0m19:30:54.407264 [debug] [ThreadPool]: On list_postgres: Close
[0m19:30:54.408202 [debug] [ThreadPool]: On list_postgres: Close
[0m19:30:54.412844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m19:30:54.413485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m19:30:54.414143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_at3)
[0m19:30:54.419749 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m19:30:54.420409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_datamart'
[0m19:30:54.422081 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m19:30:54.423561 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m19:30:54.423850 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m19:30:54.425433 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m19:30:54.425742 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m19:30:54.426011 [debug] [ThreadPool]: On list_postgres_at3: BEGIN
[0m19:30:54.426269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:54.426522 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m19:30:54.426765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:54.427010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:54.427363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:54.650810 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:54.653368 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m19:30:54.654498 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:54.655653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:54.656796 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:54.657812 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m19:30:54.658609 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m19:30:54.659281 [debug] [ThreadPool]: Using postgres connection "list_postgres_at3"
[0m19:30:54.659952 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m19:30:54.660913 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:30:54.661927 [debug] [ThreadPool]: On list_postgres_at3: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_at3"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'at3'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'at3'
  
[0m19:30:54.662817 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m19:30:54.678694 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:30:54.682206 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m19:30:54.685259 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:30:54.687950 [debug] [ThreadPool]: On list_postgres_at3: ROLLBACK
[0m19:30:54.688709 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:30:54.691122 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m19:30:54.691859 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:30:54.694159 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m19:30:54.696743 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m19:30:54.706270 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m19:30:54.706833 [debug] [ThreadPool]: On list_postgres_at3: Close
[0m19:30:54.712332 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m19:30:54.721631 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:54.722231 [debug] [MainThread]: On master: BEGIN
[0m19:30:54.722720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:54.905705 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:54.907718 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:54.908885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:54.935358 [debug] [MainThread]: SQL status: SELECT 15 in 0.0 seconds
[0m19:30:54.947202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0bdac40>]}
[0m19:30:54.948316 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:54.963952 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:54.964822 [debug] [MainThread]: On master: BEGIN
[0m19:30:54.998400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.000010 [debug] [MainThread]: On master: COMMIT
[0m19:30:55.001378 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:55.002302 [debug] [MainThread]: On master: COMMIT
[0m19:30:55.038193 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.039667 [debug] [MainThread]: On master: Close
[0m19:30:55.041964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:55.043004 [info ] [MainThread]: 
[0m19:30:55.049263 [debug] [Thread-1  ]: Began running node model.bde.code_stg
[0m19:30:55.050318 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m19:30:55.051551 [info ] [Thread-1  ]: 1 of 14 START sql view model staging.code_stg .................................. [RUN]
[0m19:30:55.052555 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m19:30:55.053474 [debug] [Thread-4  ]: Began running node model.bde.host_stg
[0m19:30:55.054389 [info ] [Thread-2  ]: 2 of 14 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m19:30:55.055717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.code_stg)
[0m19:30:55.056588 [info ] [Thread-3  ]: 3 of 14 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m19:30:55.057462 [info ] [Thread-4  ]: 4 of 14 START sql view model staging.host_stg .................................. [RUN]
[0m19:30:55.058774 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.fact_census_G01)
[0m19:30:55.059534 [debug] [Thread-1  ]: Began compiling node model.bde.code_stg
[0m19:30:55.060626 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_at3, now model.bde.fact_census_G02)
[0m19:30:55.061675 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.host_stg)
[0m19:30:55.062363 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m19:30:55.075736 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.code_stg"
[0m19:30:55.076381 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m19:30:55.076882 [debug] [Thread-4  ]: Began compiling node model.bde.host_stg
[0m19:30:55.080753 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m19:30:55.085251 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m19:30:55.090511 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.host_stg"
[0m19:30:55.091183 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (compile): 19:30:55.062855 => 19:30:55.090910
[0m19:30:55.091919 [debug] [Thread-1  ]: Began executing node model.bde.code_stg
[0m19:30:55.117062 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (compile): 19:30:55.085815 => 19:30:55.116756
[0m19:30:55.125963 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.code_stg"
[0m19:30:55.126450 [debug] [Thread-4  ]: Began executing node model.bde.host_stg
[0m19:30:55.126867 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 19:30:55.081386 => 19:30:55.126701
[0m19:30:55.127221 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 19:30:55.077255 => 19:30:55.127076
[0m19:30:55.130418 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.host_stg"
[0m19:30:55.130791 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m19:30:55.131094 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m19:30:55.131393 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:30:55.134285 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m19:30:55.137265 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m19:30:55.137577 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:30:55.137872 [debug] [Thread-1  ]: On model.bde.code_stg: BEGIN
[0m19:30:55.138305 [debug] [Thread-4  ]: On model.bde.host_stg: BEGIN
[0m19:30:55.138611 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:30:55.138942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:55.139230 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:30:55.139507 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:30:55.139786 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m19:30:55.140155 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m19:30:55.140532 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:30:55.140818 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:30:55.315947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.316726 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:30:55.317359 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */

  create view "postgres"."staging"."code_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lowercase_lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m19:30:55.319751 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.320413 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:30:55.321123 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.321784 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.322337 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g01_nsw_lga"
  );
[0m19:30:55.322941 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:30:55.323490 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:30:55.324206 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."host_snapshot"

),

to_date_format as (
    select
        id,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as lower_host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'DD/MM/YYYY') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'DD/MM/YYYY') as dbt_valid_from,
        dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m19:30:55.324901 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."at3"."census_g02_nsw_lga"
  );
[0m19:30:55.337155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.347257 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:30:55.347865 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.348375 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.348870 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.349455 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg" rename to "code_stg__dbt_backup"
[0m19:30:55.354655 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:30:55.396589 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:30:55.399256 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:30:55.399679 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01" rename to "fact_census_G01__dbt_backup"
[0m19:30:55.400033 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m19:30:55.400354 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02" rename to "fact_census_G02__dbt_backup"
[0m19:30:55.414015 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.416707 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:30:55.417080 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
alter table "postgres"."staging"."code_stg__dbt_tmp" rename to "code_stg"
[0m19:30:55.419405 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.421958 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:30:55.422344 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.422669 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m19:30:55.422990 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.425526 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:30:55.428089 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:30:55.428449 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m19:30:55.428791 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m19:30:55.454242 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.454623 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.454978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.455349 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.470987 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m19:30:55.472359 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m19:30:55.473698 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m19:30:55.475006 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m19:30:55.475328 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:30:55.475632 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:30:55.475925 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:30:55.476225 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:30:55.476510 [debug] [Thread-4  ]: On model.bde.host_stg: COMMIT
[0m19:30:55.476798 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m19:30:55.477080 [debug] [Thread-1  ]: On model.bde.code_stg: COMMIT
[0m19:30:55.477368 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m19:30:55.493128 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.500559 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m19:30:55.500924 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.501249 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.501605 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m19:30:55.501919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.505012 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m19:30:55.507133 [debug] [Thread-4  ]: Using postgres connection "model.bde.host_stg"
[0m19:30:55.509251 [debug] [Thread-1  ]: Using postgres connection "model.bde.code_stg"
[0m19:30:55.509588 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m19:30:55.509908 [debug] [Thread-4  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m19:30:55.510221 [debug] [Thread-1  ]: On model.bde.code_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.code_stg"} */
drop view if exists "postgres"."staging"."code_stg__dbt_backup" cascade
[0m19:30:55.524007 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.525324 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 19:30:55.134568 => 19:30:55.525145
[0m19:30:55.525702 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m19:30:55.526133 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.526782 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819007ef70>]}
[0m19:30:55.528003 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 19:30:55.131667 => 19:30:55.527841
[0m19:30:55.528352 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.528698 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.530237 [info ] [Thread-2  ]: 2 of 14 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.47s]
[0m19:30:55.530651 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m19:30:55.531779 [debug] [Thread-1  ]: Timing info for model.bde.code_stg (execute): 19:30:55.092272 => 19:30:55.531629
[0m19:30:55.532901 [debug] [Thread-4  ]: Timing info for model.bde.host_stg (execute): 19:30:55.127536 => 19:30:55.532754
[0m19:30:55.533386 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m19:30:55.533767 [debug] [Thread-1  ]: On model.bde.code_stg: Close
[0m19:30:55.534345 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8190055e50>]}
[0m19:30:55.534695 [debug] [Thread-4  ]: On model.bde.host_stg: Close
[0m19:30:55.535059 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m19:30:55.535668 [info ] [Thread-3  ]: 3 of 14 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.47s]
[0m19:30:55.536388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0a7f070>]}
[0m19:30:55.536854 [info ] [Thread-2  ]: 5 of 14 START sql view model staging.listings_stg .............................. [RUN]
[0m19:30:55.537447 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0c26a30>]}
[0m19:30:55.537924 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m19:30:55.538364 [info ] [Thread-1  ]: 1 of 14 OK created sql view model staging.code_stg ............................. [[32mCREATE VIEW[0m in 0.48s]
[0m19:30:55.538897 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.listings_stg)
[0m19:30:55.539329 [info ] [Thread-4  ]: 4 of 14 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.48s]
[0m19:30:55.539697 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m19:30:55.540126 [debug] [Thread-1  ]: Finished running node model.bde.code_stg
[0m19:30:55.540451 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m19:30:55.540872 [debug] [Thread-4  ]: Finished running node model.bde.host_stg
[0m19:30:55.541217 [info ] [Thread-3  ]: 6 of 14 START sql view model staging.property_stg .............................. [RUN]
[0m19:30:55.541578 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m19:30:55.544339 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m19:30:55.544894 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m19:30:55.545422 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.property_stg)
[0m19:30:55.545802 [info ] [Thread-1  ]: 7 of 14 START sql view model staging.suburb_stg ................................ [RUN]
[0m19:30:55.546281 [info ] [Thread-4  ]: 8 of 14 START sql view model warehouse.dim_host ................................ [RUN]
[0m19:30:55.546699 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m19:30:55.547216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.code_stg, now model.bde.suburb_stg)
[0m19:30:55.547599 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 19:30:55.541836 => 19:30:55.547457
[0m19:30:55.548028 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.dim_host)
[0m19:30:55.550449 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m19:30:55.550887 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m19:30:55.551231 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m19:30:55.551550 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m19:30:55.554565 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m19:30:55.557660 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m19:30:55.560002 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m19:30:55.560407 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 19:30:55.548263 => 19:30:55.560254
[0m19:30:55.560928 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m19:30:55.564926 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m19:30:55.565315 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m19:30:55.565712 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 19:30:55.551970 => 19:30:55.565562
[0m19:30:55.566043 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 19:30:55.557943 => 19:30:55.565901
[0m19:30:55.566351 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m19:30:55.566671 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m19:30:55.567000 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m19:30:55.567284 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m19:30:55.567563 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:30:55.570575 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m19:30:55.574117 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m19:30:55.574667 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m19:30:55.575279 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:30:55.575780 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m19:30:55.576086 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:30:55.576376 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m19:30:55.576656 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m19:30:55.576921 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:30:55.577188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:55.737458 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.738284 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m19:30:55.738881 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."listing_snapshot"


),

to_date_format as (
    select
        id,
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m19:30:55.741328 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.741854 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m19:30:55.742386 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."at3"."property_snapshot"

),

to_date_format as (
    select
        id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        listing_neighbourhood,
        property_type,  
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m19:30:55.747482 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.748025 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:55.748547 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:30:55.749062 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m19:30:55.749582 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."at3"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lowercase_lga_name,
        lower(suburb_name) as lowercase_suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m19:30:55.750120 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m19:30:55.762113 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.767088 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m19:30:55.767634 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.768155 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m19:30:55.772440 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m19:30:55.772950 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.773438 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:55.774024 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m19:30:55.777687 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:30:55.780979 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m19:30:55.781517 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m19:30:55.781980 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m19:30:55.788332 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.791473 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m19:30:55.791926 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m19:30:55.793856 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.796898 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m19:30:55.798329 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m19:30:55.799057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.799456 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.802330 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:30:55.803812 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m19:30:55.804230 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m19:30:55.804618 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m19:30:55.805041 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m19:30:55.807362 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.808986 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m19:30:55.809376 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m19:30:55.809739 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m19:30:55.813379 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.814985 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m19:30:55.815369 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m19:30:55.815729 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m19:30:55.817760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:55.819382 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m19:30:55.819772 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:30:55.820137 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m19:30:55.823901 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.826800 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m19:30:55.827213 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m19:30:55.827631 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.830043 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m19:30:55.830417 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m19:30:55.841599 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.844232 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m19:30:55.844632 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m19:30:55.869036 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.869469 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:55.869868 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.870247 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.871849 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 19:30:55.554903 => 19:30:55.871633
[0m19:30:55.874838 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m19:30:55.876237 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 19:30:55.561213 => 19:30:55.876056
[0m19:30:55.877531 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 19:30:55.570943 => 19:30:55.877356
[0m19:30:55.877938 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m19:30:55.878326 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m19:30:55.878718 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m19:30:55.879088 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m19:30:55.880031 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0abc460>]}
[0m19:30:55.880760 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8190080dc0>]}
[0m19:30:55.881443 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c3275850>]}
[0m19:30:55.882029 [info ] [Thread-2  ]: 5 of 14 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m19:30:55.882740 [info ] [Thread-3  ]: 6 of 14 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m19:30:55.883330 [info ] [Thread-4  ]: 8 of 14 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m19:30:55.883870 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m19:30:55.884373 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m19:30:55.884860 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m19:30:55.885436 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m19:30:55.885938 [debug] [Thread-4  ]: Began running node model.bde.dim_property
[0m19:30:55.886416 [info ] [Thread-3  ]: 9 of 14 START sql view model warehouse.fact_listing ............................ [RUN]
[0m19:30:55.886878 [info ] [Thread-4  ]: 10 of 14 START sql view model warehouse.dim_property ........................... [RUN]
[0m19:30:55.887509 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_listing)
[0m19:30:55.888098 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dim_property)
[0m19:30:55.888464 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m19:30:55.888807 [debug] [Thread-4  ]: Began compiling node model.bde.dim_property
[0m19:30:55.891646 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m19:30:55.893991 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_property"
[0m19:30:55.894578 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:55.895824 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 19:30:55.567777 => 19:30:55.895663
[0m19:30:55.896178 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m19:30:55.896727 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 19:30:55.889059 => 19:30:55.896545
[0m19:30:55.897092 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m19:30:55.897507 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (compile): 19:30:55.891928 => 19:30:55.897342
[0m19:30:55.898093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0bbeac0>]}
[0m19:30:55.907093 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m19:30:55.907565 [debug] [Thread-4  ]: Began executing node model.bde.dim_property
[0m19:30:55.908054 [info ] [Thread-1  ]: 7 of 14 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.35s]
[0m19:30:55.912787 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_property"
[0m19:30:55.913373 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m19:30:55.913792 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:30:55.914253 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m19:30:55.914605 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m19:30:55.914976 [debug] [Thread-4  ]: On model.bde.dim_property: BEGIN
[0m19:30:55.915279 [debug] [Thread-2  ]: Began running node model.bde.dim_lge_code_suburb
[0m19:30:55.915568 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:30:55.915850 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:30:55.916242 [info ] [Thread-2  ]: 11 of 14 START sql view model warehouse.dim_lge_code_suburb .................... [RUN]
[0m19:30:55.917226 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_lge_code_suburb)
[0m19:30:55.917570 [debug] [Thread-2  ]: Began compiling node model.bde.dim_lge_code_suburb
[0m19:30:55.920201 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_lge_code_suburb"
[0m19:30:55.920816 [debug] [Thread-2  ]: Timing info for model.bde.dim_lge_code_suburb (compile): 19:30:55.917778 => 19:30:55.920659
[0m19:30:55.921109 [debug] [Thread-2  ]: Began executing node model.bde.dim_lge_code_suburb
[0m19:30:55.924203 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_lge_code_suburb"
[0m19:30:55.926695 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:30:55.926997 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: BEGIN
[0m19:30:55.927269 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:30:56.082484 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.083170 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m19:30:56.083700 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m19:30:56.086645 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.087166 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:30:56.087704 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.088273 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */

  create view "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lowercase_lga_name, b.lowercase_suburb_name 
FROM "postgres"."staging"."code_stg" a 
JOIN "postgres"."staging"."suburb_stg" b 
ON a.lowercase_lga_name = b.lowercase_lga_name
  );
[0m19:30:56.088836 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:30:56.089424 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."listings_stg"
  );
[0m19:30:56.102796 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:56.107468 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m19:30:56.108039 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m19:30:56.108539 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:56.108992 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:56.112809 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:30:56.116319 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:30:56.116875 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
alter table "postgres"."warehouse"."dim_lge_code_suburb__dbt_tmp" rename to "dim_lge_code_suburb"
[0m19:30:56.117395 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m19:30:56.127185 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:56.129052 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m19:30:56.129554 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m19:30:56.130021 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m19:30:56.130749 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:56.132606 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m19:30:56.133109 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:56.133587 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:30:56.135314 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m19:30:56.135781 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: COMMIT
[0m19:30:56.136216 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:30:56.136699 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m19:30:56.148008 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.151346 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m19:30:56.151812 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m19:30:56.152527 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.155303 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_lge_code_suburb"
[0m19:30:56.155752 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.156170 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_lge_code_suburb"} */
drop view if exists "postgres"."warehouse"."dim_lge_code_suburb__dbt_backup" cascade
[0m19:30:56.160402 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m19:30:56.160935 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m19:30:56.166322 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:56.167868 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (execute): 19:30:55.908422 => 19:30:56.167652
[0m19:30:56.168318 [debug] [Thread-4  ]: On model.bde.dim_property: Close
[0m19:30:56.169253 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819007ef70>]}
[0m19:30:56.169935 [info ] [Thread-4  ]: 10 of 14 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m19:30:56.170559 [debug] [Thread-4  ]: Finished running node model.bde.dim_property
[0m19:30:56.177342 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:56.178888 [debug] [Thread-2  ]: Timing info for model.bde.dim_lge_code_suburb (execute): 19:30:55.921315 => 19:30:56.178674
[0m19:30:56.179336 [debug] [Thread-2  ]: On model.bde.dim_lge_code_suburb: Close
[0m19:30:56.179800 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:56.181374 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 19:30:55.903144 => 19:30:56.181167
[0m19:30:56.182181 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0b1a340>]}
[0m19:30:56.182664 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m19:30:56.183264 [info ] [Thread-2  ]: 11 of 14 OK created sql view model warehouse.dim_lge_code_suburb ............... [[32mCREATE VIEW[0m in 0.27s]
[0m19:30:56.184051 [debug] [Thread-2  ]: Finished running node model.bde.dim_lge_code_suburb
[0m19:30:56.185131 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8190065a00>]}
[0m19:30:56.185950 [info ] [Thread-3  ]: 9 of 14 OK created sql view model warehouse.fact_listing ....................... [[32mCREATE VIEW[0m in 0.30s]
[0m19:30:56.186455 [debug] [Thread-1  ]: Began running node model.bde.dm_host_neighbourhood
[0m19:30:56.187077 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m19:30:56.187573 [info ] [Thread-1  ]: 12 of 14 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m19:30:56.188465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dm_host_neighbourhood)
[0m19:30:56.188901 [debug] [Thread-2  ]: Began running node model.bde.dm_listing_neighbourhood
[0m19:30:56.189262 [debug] [Thread-1  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m19:30:56.189638 [debug] [Thread-4  ]: Began running node model.bde.dm_property_type
[0m19:30:56.190099 [info ] [Thread-2  ]: 13 of 14 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m19:30:56.193423 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m19:30:56.193904 [info ] [Thread-4  ]: 14 of 14 START sql view model datamart.dm_property_type ........................ [RUN]
[0m19:30:56.194535 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.dim_lge_code_suburb, now model.bde.dm_listing_neighbourhood)
[0m19:30:56.195205 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_property, now model.bde.dm_property_type)
[0m19:30:56.195585 [debug] [Thread-2  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m19:30:56.195934 [debug] [Thread-4  ]: Began compiling node model.bde.dm_property_type
[0m19:30:56.199050 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m19:30:56.202243 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m19:30:56.202789 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 19:30:56.190402 => 19:30:56.202588
[0m19:30:56.203367 [debug] [Thread-1  ]: Began executing node model.bde.dm_host_neighbourhood
[0m19:30:56.206915 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m19:30:56.207441 [debug] [Thread-4  ]: Timing info for model.bde.dm_property_type (compile): 19:30:56.199373 => 19:30:56.207273
[0m19:30:56.207856 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 19:30:56.196199 => 19:30:56.207674
[0m19:30:56.208196 [debug] [Thread-4  ]: Began executing node model.bde.dm_property_type
[0m19:30:56.208532 [debug] [Thread-2  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m19:30:56.208861 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:30:56.211924 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m19:30:56.214975 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m19:30:56.215359 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m19:30:56.215880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:30:56.216435 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:30:56.216813 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:30:56.217121 [debug] [Thread-4  ]: On model.bde.dm_property_type: BEGIN
[0m19:30:56.217431 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m19:30:56.217751 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:30:56.218037 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:30:56.389258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.389979 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:30:56.390610 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    with joined_table as (
	select 
		p.id, 
		p.scraped_date, 
		h.host_id,
		h.host_name,
		h.lower_host_neighbourhood,
		lga.lowercase_lga_name as host_neighbourhood_lga,
		p.price,
		p.has_availability,
		p.availability_30 
	from 
		"postgres"."warehouse"."dim_property" p
	join 
		"postgres"."warehouse"."dim_host" h
	on p.id = h.id
	join
		"postgres"."warehouse"."dim_lge_code_suburb" lga
	on
		h.lower_host_neighbourhood = lga.lowercase_suburb_name
)

select 
	host_neighbourhood_lga,
	to_char(scraped_date, 'MM/YYYY') as month_year,
	count(distinct host_id) as distinct_host,
	round(sum(case when has_availability = 't' then (30 - availability_30)  else 0 end * price),2) as estimate_revenue_per_active,
	--round((sum(case when has_availability = 't' then (30 - availability_30)  else 0 )* price) / nullif(count(distinct host_id),0)::numeric, 2) as estimate_revenue_per_host
	round((sum(case when has_availability = 't' then (30 - availability_30)  else 0 end * price)) / count(distinct host_id), 2) as estimate_revenue_per_host
from joined_table
group by 
	host_neighbourhood_lga,
	to_char(scraped_date, 'MM/YYYY')
order by 
    host_neighbourhood_lga,
    to_char(scraped_date, 'MM/YYYY')
  );
[0m19:30:56.411796 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:56.418016 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:30:56.418636 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.419146 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m19:30:56.419644 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.420172 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:30:56.420805 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:30:56.421532 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
    p.listing_neighbourhood,
  	to_char(l.scraped_date, 'MM/YYYY') as month_year,
    --round(sum(case when has_availability = 't' then  1 else  0 end )::numeric / nullif(count(has_availability),0) *100,2) as active_listings_ratio,
    round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  	min(case when p.has_availability = 't' then p.price end) as minimum_price,
  	max(case when p.has_availability = 't' then p.price end) as maximum_price,
  	round(percentile_cont(0.5) within group (order by case when p.has_availability = 't' then p.price end)::numeric,2) as median_price,
  	round(avg(case when p.has_availability = 't' then p.price end),2) as average_price,
    count(distinct host_id) as distinct_host,
  	round((sum(case when  h.host_is_superhost  = 't' then  1 else  0 end )::numeric / nullif(count(h.host_is_superhost),0) )*100,2) as superhost_rate,
    round(avg(case when p.has_availability = 't' then l.review_scores_rating end),2) as average_review_scores_rating,
 	round((lead(sum(case when p.has_availability = 't' then 1 else 0 end)) over (partition by listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
 	round((lead(sum(case when p.has_availability = 'f' then 1 else 0 end)) over (partition by listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
    (sum(case when p.has_availability = 't' then 30 - p.availability_30  else 0 end)) as number_of_stays,
	round(avg(case when p.has_availability = 't' then (30 - p.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
  from
  	"postgres"."warehouse"."dim_property" p
  join 
  	"postgres"."warehouse"."fact_listing" l
  on p.id = l.id
  join  
    "postgres"."warehouse"."dim_host" h
  on p.id = h.id
  group by 
  	p.listing_neighbourhood,
  	to_char(l.scraped_date, 'MM/YYYY')
  order by 
  	p.listing_neighbourhood, 
  	to_char(l.scraped_date, 'MM/YYYY')
  );
[0m19:30:56.422426 [debug] [Thread-4  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    select
    p.property_type as property_type,
 	p.room_type as room_type,
 	p.accommodates as accommodates,
 	to_char(l.scraped_date, 'MM/YYYY') as month_year,
    round(sum(case when p.has_availability = 't' then  1 else  0 end )::numeric / nullif(count(p.has_availability),0)*100,2) as active_listings_rate,
  	min(case when p.has_availability = 't' then p.price end) as minimum_price,
  	max(case when p.has_availability = 't' then p.price end) as maximum_price,
  	round(percentile_cont(0.5) within group (order by case when p.has_availability = 't' then p.price end)::numeric,2) as median_price,
  	round(avg(case when p.has_availability = 't' then p.price end),2) as average_price,
    count(distinct host_id) as distinct_host,
  	round(sum(case when  h.host_is_superhost  = 't' then  1 else  0 end )::numeric / nullif(count(h.host_is_superhost),0) *100,2) as superhost_ratio,
  	round(avg(case when p.has_availability = 't' then l.review_scores_rating end),2) as average_review_scores_rating,
 	round((lead(sum(case when p.has_availability = 't' then 1 else 0 end)) over (partition by p.property_type  order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
 	round((lead(sum(case when p.has_availability = 'f' then 1 else 0 end)) over (partition by p.property_type order by to_char(l.scraped_date, 'MM/YYYY')) 
        - sum(case when p.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when p.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
    (sum(case when p.has_availability = 't' then (30 - p.availability_30)  else 0 end)) as number_of_stays,
	round(avg(case when p.has_availability = 't' then (30 - p.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
  from 
    "postgres"."warehouse"."dim_property" p
  join 
  	"postgres"."warehouse"."fact_listing" l
  on p.id = l.id
  join  
    "postgres"."warehouse"."dim_host" h
  on p.id = h.id
  group by 
 	property_type,
 	room_type,
 	accommodates,
 	month_year
  order by 
    p.property_type,
    p.room_type,
    p.accommodates,
  	to_char(l.scraped_date, 'MM/YYYY')
  );
[0m19:30:56.442517 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:56.444832 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m19:30:56.445423 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:30:56.445957 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m19:30:56.446554 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:56.450766 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:30:56.451310 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:56.451833 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m19:30:56.455611 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:30:56.456238 [debug] [Thread-4  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m19:30:56.462245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.465591 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m19:30:56.466102 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m19:30:56.470851 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:56.471352 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:56.473254 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m19:30:56.475103 [debug] [Thread-4  ]: On model.bde.dm_property_type: COMMIT
[0m19:30:56.475631 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:30:56.476119 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:30:56.476602 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m19:30:56.477066 [debug] [Thread-4  ]: On model.bde.dm_property_type: COMMIT
[0m19:30:56.479504 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:56.481234 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 19:30:56.203694 => 19:30:56.480991
[0m19:30:56.481747 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: Close
[0m19:30:56.482780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0c93c40>]}
[0m19:30:56.483484 [info ] [Thread-1  ]: 12 of 14 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.29s]
[0m19:30:56.484173 [debug] [Thread-1  ]: Finished running node model.bde.dm_host_neighbourhood
[0m19:30:56.492200 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.495585 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m19:30:56.496080 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m19:30:56.496802 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.499799 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m19:30:56.500292 [debug] [Thread-4  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m19:30:56.510127 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:56.511927 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 19:30:56.212183 => 19:30:56.511711
[0m19:30:56.512401 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: Close
[0m19:30:56.513412 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c32aab80>]}
[0m19:30:56.514086 [info ] [Thread-2  ]: 13 of 14 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.32s]
[0m19:30:56.514757 [debug] [Thread-2  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m19:30:56.515217 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:56.516909 [debug] [Thread-4  ]: Timing info for model.bde.dm_property_type (execute): 19:30:56.209098 => 19:30:56.516714
[0m19:30:56.517386 [debug] [Thread-4  ]: On model.bde.dm_property_type: Close
[0m19:30:56.518471 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f8e0b5-52ad-42db-b4c4-a9e40ee17497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0aea490>]}
[0m19:30:56.519083 [info ] [Thread-4  ]: 14 of 14 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.32s]
[0m19:30:56.519778 [debug] [Thread-4  ]: Finished running node model.bde.dm_property_type
[0m19:30:56.521282 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:56.521687 [debug] [MainThread]: On master: BEGIN
[0m19:30:56.522016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:56.717554 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:56.718806 [debug] [MainThread]: On master: COMMIT
[0m19:30:56.719699 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:56.720555 [debug] [MainThread]: On master: COMMIT
[0m19:30:56.734923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:56.735798 [debug] [MainThread]: On master: Close
[0m19:30:56.737766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:56.738625 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m19:30:56.739351 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m19:30:56.739941 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m19:30:56.740544 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m19:30:56.741365 [info ] [MainThread]: 
[0m19:30:56.742145 [info ] [MainThread]: Finished running 14 view models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m19:30:56.747457 [debug] [MainThread]: Command end result
[0m19:30:56.762258 [info ] [MainThread]: 
[0m19:30:56.762924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:56.763441 [info ] [MainThread]: 
[0m19:30:56.763964 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m19:30:56.764911 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:56.764758 after 3.23 seconds
[0m19:30:56.765520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c0c316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b0b1a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81c32aab80>]}
[0m19:30:56.766106 [debug] [MainThread]: Flushing usage events
[0m13:54:54.357686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1907f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1930507f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1930508e0>]}


============================== 13:54:54.362052 | b7732987-4871-42d0-98a7-1a873d9cad8c ==============================
[0m13:54:54.362052 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:54:54.362716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:54:54.791816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7732987-4871-42d0-98a7-1a873d9cad8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193050880>]}
[0m13:54:54.802542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7732987-4871-42d0-98a7-1a873d9cad8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193138220>]}
[0m13:54:54.803137 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:54:54.833974 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:54:54.862476 [debug] [MainThread]: Partial parsing enabled: 17 files deleted, 1 files added, 2 files changed.
[0m13:54:54.863013 [debug] [MainThread]: Partial parsing: added file: bde://snapshots/room_snapshot.sql
[0m13:54:54.863447 [debug] [MainThread]: Partial parsing: deleted file: bde://models/datamart/dm_host_neighbourhood.sql
[0m13:54:54.863702 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/listings_stg.sql
[0m13:54:54.863931 [debug] [MainThread]: Partial parsing: deleted file: bde://snapshots/fact_snapshot.sql
[0m13:54:54.864157 [debug] [MainThread]: Partial parsing: deleted file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m13:54:54.864386 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_property.sql
[0m13:54:54.864608 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_census_G01.sql
[0m13:54:54.864838 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/code_stg.sql
[0m13:54:54.865078 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/host_stg.sql
[0m13:54:54.865293 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_census_G02.sql
[0m13:54:54.865509 [debug] [MainThread]: Partial parsing: deleted file: bde://models/datamart/dm_property_type.sql
[0m13:54:54.865728 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_listing.sql
[0m13:54:54.865953 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/property_stg.sql
[0m13:54:54.866174 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_lge_code_suburb.sql
[0m13:54:54.866394 [debug] [MainThread]: Partial parsing: deleted file: bde://snapshots/listings_snapshot.sql
[0m13:54:54.866619 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_host.sql
[0m13:54:54.866830 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/suburb_stg.sql
[0m13:54:54.867089 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m13:54:54.867354 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m13:54:54.903062 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.listing_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'RAW.listings' which was not found
[0m13:54:54.904361 [debug] [MainThread]: Command `dbt snapshot` failed at 13:54:54.903637 after 0.59 seconds
[0m13:54:54.904777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1907f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1700f9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1700f9d90>]}
[0m13:54:54.905244 [debug] [MainThread]: Flushing usage events
[0m14:03:41.605342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc038a516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc03b3b7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc03b3b7d90>]}


============================== 14:03:41.609395 | 649668be-3fad-4673-8d7c-083e3e182f36 ==============================
[0m14:03:41.609395 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:03:41.609880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:03:41.610330 [info ] [MainThread]: dbt version: 1.6.6
[0m14:03:41.610582 [info ] [MainThread]: python version: 3.9.16
[0m14:03:41.610820 [info ] [MainThread]: python path: /Users/charlotteli/opt/anaconda3/bin/python
[0m14:03:41.611052 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m14:03:41.666085 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m14:03:41.666471 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m14:03:41.666736 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/dbt_project.yml
[0m14:03:41.667128 [info ] [MainThread]: adapter type: postgres
[0m14:03:41.667391 [info ] [MainThread]: adapter version: 1.6.6
[0m14:03:41.684214 [info ] [MainThread]: Configuration:
[0m14:03:41.684658 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:03:41.684924 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:03:41.685167 [info ] [MainThread]: Required dependencies:
[0m14:03:41.685495 [debug] [MainThread]: Executing "git --help"
[0m14:03:41.704946 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:03:41.706055 [debug] [MainThread]: STDERR: "b''"
[0m14:03:41.706453 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:03:41.706787 [info ] [MainThread]: Connection:
[0m14:03:41.707164 [info ] [MainThread]:   host: 34.116.121.126
[0m14:03:41.707420 [info ] [MainThread]:   port: 5432
[0m14:03:41.707663 [info ] [MainThread]:   user: postgres
[0m14:03:41.707899 [info ] [MainThread]:   database: postgres
[0m14:03:41.708133 [info ] [MainThread]:   schema: public
[0m14:03:41.708365 [info ] [MainThread]:   connect_timeout: 10
[0m14:03:41.708596 [info ] [MainThread]:   role: None
[0m14:03:41.708823 [info ] [MainThread]:   search_path: None
[0m14:03:41.709048 [info ] [MainThread]:   keepalives_idle: 0
[0m14:03:41.709274 [info ] [MainThread]:   sslmode: None
[0m14:03:41.709502 [info ] [MainThread]:   sslcert: None
[0m14:03:41.709723 [info ] [MainThread]:   sslkey: None
[0m14:03:41.709951 [info ] [MainThread]:   sslrootcert: None
[0m14:03:41.710177 [info ] [MainThread]:   application_name: dbt
[0m14:03:41.710402 [info ] [MainThread]:   retries: 1
[0m14:03:41.710998 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:03:41.722922 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:03:41.723840 [debug] [MainThread]: Using postgres connection "debug"
[0m14:03:41.724107 [debug] [MainThread]: On debug: select 1 as id
[0m14:03:41.724353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:51.734236 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "34.116.121.126", port 5432 failed: timeout expired

[0m14:04:01.740580 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:04:01.743404 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:04:01.744693 [debug] [MainThread]: On debug: No close available on handle
[0m14:04:01.746012 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:04:01.747053 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:04:01.748771 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "34.116.121.126", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:04:01.752931 [debug] [MainThread]: Command `dbt debug` failed at 14:04:01.751767 after 20.18 seconds
[0m14:04:01.754183 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:04:01.755169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc038a516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0283dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0283c9970>]}
[0m14:04:01.756571 [debug] [MainThread]: Flushing usage events
[0m14:16:17.829689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b8b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb2187f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb2188e0>]}


============================== 14:16:17.834345 | c84cda73-7f71-4126-9e20-faa9eac20c99 ==============================
[0m14:16:17.834345 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:16:17.835002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:16:17.984044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84cda73-7f71-4126-9e20-faa9eac20c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb218820>]}
[0m14:16:17.995341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c84cda73-7f71-4126-9e20-faa9eac20c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb34e220>]}
[0m14:16:18.008720 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:16:18.028731 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:16:18.038753 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:16:18.039247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c84cda73-7f71-4126-9e20-faa9eac20c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0bb2e6af0>]}
[0m14:16:18.588600 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.listing_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'RAW.listings' which was not found
[0m14:16:18.590575 [debug] [MainThread]: Command `dbt snapshot` failed at 14:16:18.589129 after 0.80 seconds
[0m14:16:18.590924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b8b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a87a7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a87bb3d0>]}
[0m14:16:18.591224 [debug] [MainThread]: Flushing usage events
[0m14:17:47.816612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe620a916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe622b47880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe622b47970>]}


============================== 14:17:47.821403 | de097f60-0ca1-4c48-b0c6-c7ee66bc2d05 ==============================
[0m14:17:47.821403 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:17:47.822064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:17:47.973581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de097f60-0ca1-4c48-b0c6-c7ee66bc2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe622b47910>]}
[0m14:17:47.984234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de097f60-0ca1-4c48-b0c6-c7ee66bc2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe622cd72b0>]}
[0m14:17:47.984774 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:17:48.000888 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:17:48.010327 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:17:48.010793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de097f60-0ca1-4c48-b0c6-c7ee66bc2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe622b475e0>]}
[0m14:17:48.554247 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.listing_snapshot' (snapshots/room_snapshot.sql) depends on a source named '"RAW".listings' which was not found
[0m14:17:48.556260 [debug] [MainThread]: Command `dbt snapshot` failed at 14:17:48.554822 after 0.78 seconds
[0m14:17:48.556607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe620a916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6202c87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6201b0730>]}
[0m14:17:48.556901 [debug] [MainThread]: Flushing usage events
[0m14:19:43.799166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc588f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5b078c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5b078dc0>]}


============================== 14:19:43.803218 | d266c30d-6d8b-40ce-bee9-e47eb3cd4694 ==============================
[0m14:19:43.803218 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:19:43.803700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:19:43.804166 [info ] [MainThread]: dbt version: 1.6.6
[0m14:19:43.804420 [info ] [MainThread]: python version: 3.9.16
[0m14:19:43.804658 [info ] [MainThread]: python path: /Users/charlotteli/opt/anaconda3/bin/python
[0m14:19:43.804889 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m14:19:43.859578 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m14:19:43.859972 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m14:19:43.860239 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/dbt_project.yml
[0m14:19:43.860634 [info ] [MainThread]: adapter type: postgres
[0m14:19:43.860889 [info ] [MainThread]: adapter version: 1.6.6
[0m14:19:43.877696 [info ] [MainThread]: Configuration:
[0m14:19:43.878101 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:19:43.878355 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:19:43.878596 [info ] [MainThread]: Required dependencies:
[0m14:19:43.878904 [debug] [MainThread]: Executing "git --help"
[0m14:19:43.894468 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:19:43.895558 [debug] [MainThread]: STDERR: "b''"
[0m14:19:43.895918 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:19:43.896216 [info ] [MainThread]: Connection:
[0m14:19:43.896544 [info ] [MainThread]:   host: 35.244.127.104
[0m14:19:43.896789 [info ] [MainThread]:   port: 5432
[0m14:19:43.897029 [info ] [MainThread]:   user: postgres
[0m14:19:43.897261 [info ] [MainThread]:   database: postgres
[0m14:19:43.897493 [info ] [MainThread]:   schema: public
[0m14:19:43.897720 [info ] [MainThread]:   connect_timeout: 10
[0m14:19:43.897954 [info ] [MainThread]:   role: None
[0m14:19:43.898179 [info ] [MainThread]:   search_path: None
[0m14:19:43.898409 [info ] [MainThread]:   keepalives_idle: 0
[0m14:19:43.898635 [info ] [MainThread]:   sslmode: None
[0m14:19:43.898869 [info ] [MainThread]:   sslcert: None
[0m14:19:43.899111 [info ] [MainThread]:   sslkey: None
[0m14:19:43.899342 [info ] [MainThread]:   sslrootcert: None
[0m14:19:43.899580 [info ] [MainThread]:   application_name: dbt
[0m14:19:43.899808 [info ] [MainThread]:   retries: 1
[0m14:19:43.900372 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:19:43.908056 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:19:43.909065 [debug] [MainThread]: Using postgres connection "debug"
[0m14:19:43.909329 [debug] [MainThread]: On debug: select 1 as id
[0m14:19:43.909572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:44.358094 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:19:44.360348 [debug] [MainThread]: On debug: Close
[0m14:19:44.361205 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:19:44.361735 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:19:44.363022 [debug] [MainThread]: Command `dbt debug` succeeded at 14:19:44.362593 after 0.59 seconds
[0m14:19:44.363499 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:19:44.363958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc588f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5b121d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5b1741f0>]}
[0m14:19:44.364521 [debug] [MainThread]: Flushing usage events
[0m14:31:47.575511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a40a716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42ae8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42ae8910>]}


============================== 14:31:47.579695 | 47d5a328-1d0a-467d-beb4-4309033d1498 ==============================
[0m14:31:47.579695 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:31:47.580376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:31:47.721065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47d5a328-1d0a-467d-beb4-4309033d1498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42ae88b0>]}
[0m14:31:47.731816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47d5a328-1d0a-467d-beb4-4309033d1498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42bcf250>]}
[0m14:31:47.732350 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:31:47.749315 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:31:47.758994 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:31:47.759461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47d5a328-1d0a-467d-beb4-4309033d1498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a42ae8310>]}
[0m14:31:48.305972 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.listing_snapshot' (snapshots/room_snapshot.sql) depends on a source named '"RAW".listings' which was not found
[0m14:31:48.306781 [debug] [MainThread]: Command `dbt snapshot` failed at 14:31:48.306497 after 0.76 seconds
[0m14:31:48.307108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a40a716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a307e3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3094b400>]}
[0m14:31:48.307408 [debug] [MainThread]: Flushing usage events
[0m14:35:00.708800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc89e1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcad707c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcad708b0>]}


============================== 14:35:00.712705 | 884d7b3f-5bcb-4268-a707-9ac4cf91c112 ==============================
[0m14:35:00.712705 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:35:00.713341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m14:35:00.850688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '884d7b3f-5bcb-4268-a707-9ac4cf91c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcad8a2e0>]}
[0m14:35:00.861527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '884d7b3f-5bcb-4268-a707-9ac4cf91c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcaea71f0>]}
[0m14:35:00.862058 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:35:00.879308 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:35:00.888501 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:35:00.888939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '884d7b3f-5bcb-4268-a707-9ac4cf91c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcad8a3d0>]}
[0m14:35:01.410869 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named '"RAW".listings' which was not found
[0m14:35:01.411714 [debug] [MainThread]: Command `dbt snapshot` failed at 14:35:01.411417 after 0.74 seconds
[0m14:35:01.412073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc89e1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb98b2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb98b2bf10>]}
[0m14:35:01.412386 [debug] [MainThread]: Flushing usage events
[0m14:41:06.977538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a8b296a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ab018850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ab018940>]}


============================== 14:41:06.981427 | 07a7ae10-18c0-4c62-a303-d95144f0ef26 ==============================
[0m14:41:06.981427 [info ] [MainThread]: Running with dbt=1.6.6
[0m14:41:06.982050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:07.118923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07a7ae10-18c0-4c62-a303-d95144f0ef26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ab018880>]}
[0m14:41:07.129749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07a7ae10-18c0-4c62-a303-d95144f0ef26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2b88df280>]}
[0m14:41:07.130292 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m14:41:07.147074 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m14:41:07.157919 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:41:07.158498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07a7ae10-18c0-4c62-a303-d95144f0ef26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ab09a940>]}
[0m14:41:07.724236 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'RAW.listings' which was not found
[0m14:41:07.725122 [debug] [MainThread]: Command `dbt snapshot` failed at 14:41:07.724830 after 0.78 seconds
[0m14:41:07.725461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a8b296a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2b89c72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2b8a5c8b0>]}
[0m14:41:07.725762 [debug] [MainThread]: Flushing usage events
[0m17:14:05.213062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f8bf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80fad30880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80fad30970>]}


============================== 17:14:05.217012 | 07dabfb7-1cbe-420a-bff1-6199e0432055 ==============================
[0m17:14:05.217012 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:14:05.217639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:05.473459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07dabfb7-1cbe-420a-bff1-6199e0432055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80fad308b0>]}
[0m17:14:05.484200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07dabfb7-1cbe-420a-bff1-6199e0432055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80fae572b0>]}
[0m17:14:05.484731 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:14:05.502219 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:14:05.512065 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:14:05.512580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07dabfb7-1cbe-420a-bff1-6199e0432055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80fad30640>]}
[0m17:14:06.070511 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'RAW.listings' which was not found
[0m17:14:06.072323 [debug] [MainThread]: Command `dbt snapshot` failed at 17:14:06.071038 after 0.90 seconds
[0m17:14:06.072659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f8bf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d82e1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d82e14c0>]}
[0m17:14:06.072961 [debug] [MainThread]: Flushing usage events
[0m17:48:10.164143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec8c016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecb0ffc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecb0ffdf0>]}


============================== 17:48:10.168793 | bf4ea5c4-dd96-4fbb-8dfc-502925dfc115 ==============================
[0m17:48:10.168793 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:48:10.169297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:10.169752 [info ] [MainThread]: dbt version: 1.6.6
[0m17:48:10.170002 [info ] [MainThread]: python version: 3.9.16
[0m17:48:10.170239 [info ] [MainThread]: python path: /Users/charlotteli/opt/anaconda3/bin/python
[0m17:48:10.170471 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m17:48:10.229747 [info ] [MainThread]: Using profiles dir at /Users/charlotteli/.dbt
[0m17:48:10.230147 [info ] [MainThread]: Using profiles.yml file at /Users/charlotteli/.dbt/profiles.yml
[0m17:48:10.230408 [info ] [MainThread]: Using dbt_project.yml file at /Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/dbt_project.yml
[0m17:48:10.230954 [info ] [MainThread]: adapter type: postgres
[0m17:48:10.231211 [info ] [MainThread]: adapter version: 1.6.6
[0m17:48:10.248506 [info ] [MainThread]: Configuration:
[0m17:48:10.248936 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:48:10.249188 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:48:10.249428 [info ] [MainThread]: Required dependencies:
[0m17:48:10.249733 [debug] [MainThread]: Executing "git --help"
[0m17:48:10.279078 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:48:10.280189 [debug] [MainThread]: STDERR: "b''"
[0m17:48:10.280536 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:48:10.280846 [info ] [MainThread]: Connection:
[0m17:48:10.281176 [info ] [MainThread]:   host: 35.244.127.104
[0m17:48:10.281418 [info ] [MainThread]:   port: 5432
[0m17:48:10.281656 [info ] [MainThread]:   user: postgres
[0m17:48:10.281881 [info ] [MainThread]:   database: postgres
[0m17:48:10.282110 [info ] [MainThread]:   schema: public
[0m17:48:10.282333 [info ] [MainThread]:   connect_timeout: 10
[0m17:48:10.282563 [info ] [MainThread]:   role: None
[0m17:48:10.282806 [info ] [MainThread]:   search_path: None
[0m17:48:10.283035 [info ] [MainThread]:   keepalives_idle: 0
[0m17:48:10.283258 [info ] [MainThread]:   sslmode: None
[0m17:48:10.283498 [info ] [MainThread]:   sslcert: None
[0m17:48:10.283719 [info ] [MainThread]:   sslkey: None
[0m17:48:10.283943 [info ] [MainThread]:   sslrootcert: None
[0m17:48:10.284165 [info ] [MainThread]:   application_name: dbt
[0m17:48:10.284387 [info ] [MainThread]:   retries: 1
[0m17:48:10.284837 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:48:10.293132 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:48:10.294191 [debug] [MainThread]: Using postgres connection "debug"
[0m17:48:10.294463 [debug] [MainThread]: On debug: select 1 as id
[0m17:48:10.294708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:10.677227 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:48:10.680208 [debug] [MainThread]: On debug: Close
[0m17:48:10.684231 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:48:10.684731 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:48:10.688117 [debug] [MainThread]: Command `dbt debug` succeeded at 17:48:10.685904 after 0.55 seconds
[0m17:48:10.688676 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:48:10.689162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec8c016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecb164a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ecb169af0>]}
[0m17:48:10.689769 [debug] [MainThread]: Flushing usage events
[0m17:50:31.161737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff618a916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61afe8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61afe8910>]}


============================== 17:50:31.165813 | 6a220021-cbb2-43a0-9a60-6f3f71fce03f ==============================
[0m17:50:31.165813 [info ] [MainThread]: Running with dbt=1.6.6
[0m17:50:31.166450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:31.332559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a220021-cbb2-43a0-9a60-6f3f71fce03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61afe8850>]}
[0m17:50:31.343825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a220021-cbb2-43a0-9a60-6f3f71fce03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff628148250>]}
[0m17:50:31.344459 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m17:50:31.363104 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m17:50:31.372768 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:50:31.373270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a220021-cbb2-43a0-9a60-6f3f71fce03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61afe85e0>]}
[0m17:50:31.906078 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'RAW.listings' which was not found
[0m17:50:31.906936 [debug] [MainThread]: Command `dbt snapshot` failed at 17:50:31.906647 after 0.77 seconds
[0m17:50:31.907276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff618a916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6281933a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61b19b9a0>]}
[0m17:50:31.907605 [debug] [MainThread]: Flushing usage events
[0m18:00:10.914779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd548b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54b0b7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54b0b7970>]}


============================== 18:00:10.918884 | f7c2af1a-fe81-47c9-ba79-83d7e1e8a5e5 ==============================
[0m18:00:10.918884 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:00:10.919566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:11.057862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7c2af1a-fe81-47c9-ba79-83d7e1e8a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54b0b7910>]}
[0m18:00:11.068646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7c2af1a-fe81-47c9-ba79-83d7e1e8a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54b1af2b0>]}
[0m18:00:11.069188 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:00:11.086555 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:00:11.096019 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:00:11.096486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7c2af1a-fe81-47c9-ba79-83d7e1e8a5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54b0b75b0>]}
[0m18:00:11.626351 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'RAW.listings' which was not found
[0m18:00:11.628413 [debug] [MainThread]: Command `dbt snapshot` failed at 18:00:11.628105 after 0.74 seconds
[0m18:00:11.628771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd548b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54a1439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd549eb0e80>]}
[0m18:00:11.629088 [debug] [MainThread]: Flushing usage events
[0m18:00:44.924545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa750985ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa752ef78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa752ef79a0>]}


============================== 18:00:44.928706 | 66ce69b0-5aeb-4187-8502-65032981d059 ==============================
[0m18:00:44.928706 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:00:44.929373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:45.032836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ce69b0-5aeb-4187-8502-65032981d059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa752ef78e0>]}
[0m18:00:45.043488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ce69b0-5aeb-4187-8502-65032981d059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75302f2e0>]}
[0m18:00:45.044166 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:00:45.062330 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:00:45.072515 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:00:45.073011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66ce69b0-5aeb-4187-8502-65032981d059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa752ef7670>]}
[0m18:00:45.597342 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:00:45.598165 [debug] [MainThread]: Command `dbt snapshot` failed at 18:00:45.597874 after 0.70 seconds
[0m18:00:45.598501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa750985ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75308afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa753077bb0>]}
[0m18:00:45.598809 [debug] [MainThread]: Flushing usage events
[0m18:02:46.687385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f87096a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa480880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa480970>]}


============================== 18:02:46.694668 | 29abd274-7f51-4a10-a7ae-f3e917b47697 ==============================
[0m18:02:46.694668 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:02:46.695414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:46.834320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29abd274-7f51-4a10-a7ae-f3e917b47697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa480910>]}
[0m18:02:46.845402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29abd274-7f51-4a10-a7ae-f3e917b47697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa5bb2b0>]}
[0m18:02:46.846012 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:02:46.863520 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:02:46.873841 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:02:46.874363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29abd274-7f51-4a10-a7ae-f3e917b47697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fa4805b0>]}
[0m18:02:47.408189 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:02:47.409083 [debug] [MainThread]: Command `dbt snapshot` failed at 18:02:47.408790 after 0.76 seconds
[0m18:02:47.409465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f87096a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9082707c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9081d8730>]}
[0m18:02:47.409799 [debug] [MainThread]: Flushing usage events
[0m18:04:34.925957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e0a816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0bb7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0bb7940>]}


============================== 18:04:34.930307 | 1f4943bd-f0a7-4ccb-919b-81a71935ae31 ==============================
[0m18:04:34.930307 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:04:34.930996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:35.068741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f4943bd-f0a7-4ccb-919b-81a71935ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0bb78e0>]}
[0m18:04:35.079651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f4943bd-f0a7-4ccb-919b-81a71935ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e29df280>]}
[0m18:04:35.080207 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:04:35.100896 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:04:35.111044 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:04:35.111527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f4943bd-f0a7-4ccb-919b-81a71935ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0d0bb7340>]}
[0m18:04:35.632680 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:04:35.634696 [debug] [MainThread]: Command `dbt snapshot` failed at 18:04:35.634388 after 0.74 seconds
[0m18:04:35.635056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e0a816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0c029bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0c015ca30>]}
[0m18:04:35.635371 [debug] [MainThread]: Flushing usage events
[0m18:11:43.777868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f08896a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f31d0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f31d0910>]}


============================== 18:11:43.782182 | 25bff7de-4eb6-4488-b8c3-6f0850f50e3c ==============================
[0m18:11:43.782182 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:11:43.782873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:11:43.918003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25bff7de-4eb6-4488-b8c3-6f0850f50e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f31d0850>]}
[0m18:11:43.928815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25bff7de-4eb6-4488-b8c3-6f0850f50e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f32f7250>]}
[0m18:11:43.929359 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:11:43.945724 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:11:43.954963 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:11:43.955434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25bff7de-4eb6-4488-b8c3-6f0850f50e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f31d05e0>]}
[0m18:11:44.480732 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:11:44.481578 [debug] [MainThread]: Command `dbt snapshot` failed at 18:11:44.481268 after 0.74 seconds
[0m18:11:44.481939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f08896a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c0265700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f3354400>]}
[0m18:11:44.482280 [debug] [MainThread]: Flushing usage events
[0m18:13:21.400635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd708a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80ed8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80ed8970>]}


============================== 18:13:21.404665 | 3704fec5-b5d1-499e-b617-da754129aff2 ==============================
[0m18:13:21.404665 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:13:21.405398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:13:21.510659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3704fec5-b5d1-499e-b617-da754129aff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80ed8910>]}
[0m18:13:21.521458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3704fec5-b5d1-499e-b617-da754129aff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd729772b0>]}
[0m18:13:21.522069 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:13:21.539393 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:13:21.549327 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:13:21.549800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3704fec5-b5d1-499e-b617-da754129aff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80ed85b0>]}
[0m18:13:22.097908 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:13:22.098804 [debug] [MainThread]: Command `dbt snapshot` failed at 18:13:22.098481 after 0.73 seconds
[0m18:13:22.099173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd708a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8100aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd8100ab80>]}
[0m18:13:22.099497 [debug] [MainThread]: Flushing usage events
[0m18:15:39.381792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da89716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daa9ff880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daa9ff970>]}


============================== 18:15:39.386119 | 083f1cc3-3bbe-4bc1-bbee-c318f169b4f6 ==============================
[0m18:15:39.386119 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:15:39.386764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:39.497036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '083f1cc3-3bbe-4bc1-bbee-c318f169b4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daa9ff910>]}
[0m18:15:39.507982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '083f1cc3-3bbe-4bc1-bbee-c318f169b4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d88e402b0>]}
[0m18:15:39.508690 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:15:39.526031 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:15:39.536077 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:15:39.536565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '083f1cc3-3bbe-4bc1-bbee-c318f169b4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9daa9ff5e0>]}
[0m18:15:40.079017 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:15:40.079860 [debug] [MainThread]: Command `dbt snapshot` failed at 18:15:40.079565 after 0.74 seconds
[0m18:15:40.080207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9da89716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d98183910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d98183ac0>]}
[0m18:15:40.080517 [debug] [MainThread]: Flushing usage events
[0m18:18:20.181799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae989916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9ae17850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9ae17940>]}


============================== 18:18:20.185713 | a4830a10-af31-45c3-9640-b7e1821e1033 ==============================
[0m18:18:20.185713 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:18:20.186354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:18:20.291281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4830a10-af31-45c3-9640-b7e1821e1033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9ae178e0>]}
[0m18:18:20.301994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4830a10-af31-45c3-9640-b7e1821e1033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9af92280>]}
[0m18:18:20.302565 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:18:20.318839 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:18:20.328489 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:18:20.328983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4830a10-af31-45c3-9640-b7e1821e1033', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae9ae17580>]}
[0m18:18:20.871415 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.bde.room_snapshot' (snapshots/room_snapshot.sql) depends on a source named 'raw.listings' which was not found
[0m18:18:20.872231 [debug] [MainThread]: Command `dbt snapshot` failed at 18:18:20.871944 after 0.72 seconds
[0m18:18:20.872566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae989916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faea895aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faea895aa90>]}
[0m18:18:20.872872 [debug] [MainThread]: Flushing usage events
[0m18:19:50.905977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf408516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42928850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42928940>]}


============================== 18:19:50.909850 | 6cf5e222-a7d6-49fe-8a62-d36667917f90 ==============================
[0m18:19:50.909850 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:19:50.910504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:19:51.013153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf429288e0>]}
[0m18:19:51.023794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42a60280>]}
[0m18:19:51.024360 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:19:51.040935 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:19:51.050598 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:19:51.051093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42928340>]}
[0m18:19:51.607223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
- models.bde.staging
[0m18:19:51.610942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42abcf70>]}
[0m18:19:51.622910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42a64c40>]}
[0m18:19:51.623333 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:19:51.623627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42bad970>]}
[0m18:19:51.624755 [info ] [MainThread]: 
[0m18:19:51.625330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:51.626254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:19:51.634383 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:19:51.634807 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:19:51.635059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:52.092685 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:19:52.095986 [debug] [ThreadPool]: On list_postgres: Close
[0m18:19:52.099627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m18:19:52.109792 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:19:52.110428 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:19:52.110899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:52.282469 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:19:52.283351 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:19:52.283948 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:19:52.306286 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:19:52.308579 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:19:52.324949 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:19:52.333842 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.334464 [debug] [MainThread]: On master: BEGIN
[0m18:19:52.334899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:52.503013 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:52.504029 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.504957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:52.527313 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:19:52.529832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42a64b20>]}
[0m18:19:52.530750 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:52.546107 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.546829 [debug] [MainThread]: On master: BEGIN
[0m18:19:52.578431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:52.579270 [debug] [MainThread]: On master: COMMIT
[0m18:19:52.580006 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.580688 [debug] [MainThread]: On master: COMMIT
[0m18:19:52.595904 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:52.596741 [debug] [MainThread]: On master: Close
[0m18:19:52.598498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:52.599154 [info ] [MainThread]: 
[0m18:19:52.604895 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m18:19:52.605755 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m18:19:52.606617 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m18:19:52.609422 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:19:52.610410 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:19:52.611273 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m18:19:52.612560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres, now snapshot.bde.host_snapshot)
[0m18:19:52.613646 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.property_snapshot)
[0m18:19:52.614928 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m18:19:52.615665 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:19:52.616285 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:19:52.616853 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m18:19:52.629427 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:19:52.617295 => 18:19:52.628988
[0m18:19:52.634069 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:19:52.629975 => 18:19:52.633706
[0m18:19:52.638244 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 18:19:52.634568 => 18:19:52.637979
[0m18:19:52.638793 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m18:19:52.639276 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m18:19:52.639730 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m18:19:52.697063 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:19:52.698451 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:19:52.700886 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m18:19:52.701629 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:19:52.701998 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m18:19:52.702306 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:19:52.702755 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:19:52.703050 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:19:52.703347 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:19:52.703736 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:19:52.704035 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:19:52.704299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:52.871731 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:19:52.872662 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:19:52.876486 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:19:52.885286 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:19:52.885996 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:19:52.886693 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:19:52.887512 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      
  
    

  create  table "postgres"."raw"."property_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(select distinct LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        


select
  LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:19:52.888407 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      
  
    

  create  table "postgres"."raw"."room_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(select distinct LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select listing_id,scrape_id,scraped_date,hdbtas_availability,availability_30,number_of_reviews,REVIEW_SCORES_RATING,REVIEW_SCORES_ACCURACY,REVIEW_SCORES_CLEANLINESS,REVIEW_SCORES_CHECKIN,REVIEW_SCORES_COMMUNICATION,REVIEW_SCORES_VALUE from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:19:52.889274 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(select distinct host_id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id,
        host_since as dbt_updated_at,
        host_since as dbt_valid_from,
        nullif(host_since, host_since) as dbt_valid_to
    from (
        



select LISTING_ID,SCRAPE_ID,SCRAPED_DATE,host_id,host_name,host_since,host_is_superhost,host_neighbourhood from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:19:52.904192 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16:         md5(coalesce(cast(select distinct LISTING_ID as varc...
                                   ^

[0m18:19:52.904953 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16:         md5(coalesce(cast(select distinct LISTING_ID as varc...
                                   ^

[0m18:19:52.905629 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16:         md5(coalesce(cast(select distinct host_id as varchar...
                                   ^

[0m18:19:52.906343 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: ROLLBACK
[0m18:19:52.907020 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: ROLLBACK
[0m18:19:52.907697 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: ROLLBACK
[0m18:19:52.925851 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:19:52.665290 => 18:19:52.925401
[0m18:19:52.927074 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:19:52.640055 => 18:19:52.926648
[0m18:19:52.927904 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m18:19:52.928985 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 18:19:52.698685 => 18:19:52.928589
[0m18:19:52.929826 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m18:19:52.930778 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m18:19:52.944255 [debug] [Thread-3  ]: Database Error in snapshot room_snapshot (snapshots/room_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct LISTING_ID as varc...
                                     ^
  compiled Code at target/run/bde/snapshots/room_snapshot.sql
[0m18:19:52.945326 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5023bf70>]}
[0m18:19:52.946695 [debug] [Thread-1  ]: Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct host_id as varchar...
                                     ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:19:52.947924 [debug] [Thread-2  ]: Database Error in snapshot property_snapshot (snapshots/property_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct LISTING_ID as varc...
                                     ^
  compiled Code at target/run/bde/snapshots/property_snapshot.sql
[0m18:19:52.949567 [error] [Thread-3  ]: 3 of 3 ERROR snapshotting raw.room_snapshot .................................... [[31mERROR[0m in 0.33s]
[0m18:19:52.950378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf60d2ff70>]}
[0m18:19:52.951024 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf5e222-a7d6-49fe-8a62-d36667917f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf5023ba90>]}
[0m18:19:52.951959 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m18:19:52.953032 [error] [Thread-1  ]: 1 of 3 ERROR snapshotting raw.host_snapshot .................................... [[31mERROR[0m in 0.34s]
[0m18:19:52.954180 [error] [Thread-2  ]: 2 of 3 ERROR snapshotting raw.property_snapshot ................................ [[31mERROR[0m in 0.34s]
[0m18:19:52.955378 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m18:19:52.956265 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m18:19:52.958289 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.958751 [debug] [MainThread]: On master: BEGIN
[0m18:19:52.959152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:53.127846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:53.128981 [debug] [MainThread]: On master: COMMIT
[0m18:19:53.129734 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:53.130433 [debug] [MainThread]: On master: COMMIT
[0m18:19:53.145280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:53.146184 [debug] [MainThread]: On master: Close
[0m18:19:53.148020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:53.148697 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:19:53.149335 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:19:53.149960 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m18:19:53.150727 [info ] [MainThread]: 
[0m18:19:53.151558 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m18:19:53.153652 [debug] [MainThread]: Command end result
[0m18:19:53.173767 [info ] [MainThread]: 
[0m18:19:53.174312 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:19:53.174662 [info ] [MainThread]: 
[0m18:19:53.175010 [error] [MainThread]:   Database Error in snapshot room_snapshot (snapshots/room_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct LISTING_ID as varc...
                                     ^
  compiled Code at target/run/bde/snapshots/room_snapshot.sql
[0m18:19:53.175357 [info ] [MainThread]: 
[0m18:19:53.175688 [error] [MainThread]:   Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct host_id as varchar...
                                     ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:19:53.176021 [info ] [MainThread]: 
[0m18:19:53.176352 [error] [MainThread]:   Database Error in snapshot property_snapshot (snapshots/property_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct LISTING_ID as varc...
                                     ^
  compiled Code at target/run/bde/snapshots/property_snapshot.sql
[0m18:19:53.176688 [info ] [MainThread]: 
[0m18:19:53.177038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m18:19:53.177787 [debug] [MainThread]: Command `dbt snapshot` failed at 18:19:53.177653 after 2.30 seconds
[0m18:19:53.178360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf408516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42a60280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42a62820>]}
[0m18:19:53.178913 [debug] [MainThread]: Flushing usage events
[0m18:25:36.028240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc89416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca737850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca737940>]}


============================== 18:25:36.032417 | ff63d264-4321-422f-8f4b-47b4f6b68b7a ==============================
[0m18:25:36.032417 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:25:36.033090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:25:36.138707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca7378e0>]}
[0m18:25:36.149474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca8ad280>]}
[0m18:25:36.150002 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:25:36.167239 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:25:36.192299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:25:36.192870 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:25:36.193206 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/property_snapshot.sql
[0m18:25:36.193525 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/room_snapshot.sql
[0m18:25:36.233481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.warehouse
- models.bde.datamart
[0m18:25:36.237675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca982580>]}
[0m18:25:36.250670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb9142b20>]}
[0m18:25:36.251120 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:25:36.251422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb9142e80>]}
[0m18:25:36.252694 [info ] [MainThread]: 
[0m18:25:36.253310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:36.254279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:25:36.261842 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:25:36.262156 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:25:36.262427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:36.497728 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:25:36.500163 [debug] [ThreadPool]: On list_postgres: Close
[0m18:25:36.503610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m18:25:36.511502 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:25:36.511945 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:25:36.512312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:36.691064 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:36.692398 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:25:36.693438 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:25:36.715464 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:25:36.720386 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:25:36.734983 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:25:36.750087 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:36.750977 [debug] [MainThread]: On master: BEGIN
[0m18:25:36.751662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:36.939404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:36.941149 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:36.942147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:36.963912 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:25:36.968096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb9142340>]}
[0m18:25:36.969639 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:36.983472 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:36.984237 [debug] [MainThread]: On master: BEGIN
[0m18:25:37.016568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:37.017966 [debug] [MainThread]: On master: COMMIT
[0m18:25:37.018869 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:37.020019 [debug] [MainThread]: On master: COMMIT
[0m18:25:37.036507 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:37.037740 [debug] [MainThread]: On master: Close
[0m18:25:37.040654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:25:37.041557 [info ] [MainThread]: 
[0m18:25:37.048465 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m18:25:37.049463 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m18:25:37.050463 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m18:25:37.053619 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:25:37.054616 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:25:37.055461 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m18:25:37.056717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m18:25:37.057937 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m18:25:37.059138 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m18:25:37.059891 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:25:37.060564 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:25:37.061228 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m18:25:37.074750 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:25:37.061727 => 18:25:37.074340
[0m18:25:37.079185 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:25:37.075246 => 18:25:37.078902
[0m18:25:37.083502 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 18:25:37.079630 => 18:25:37.083219
[0m18:25:37.084109 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m18:25:37.084626 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m18:25:37.085212 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m18:25:37.142755 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:25:37.143424 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:25:37.146056 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m18:25:37.146827 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:25:37.147128 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:25:37.147443 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:25:37.147879 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:25:37.148187 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:25:37.148495 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m18:25:37.148784 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:25:37.149071 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:25:37.149350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:25:37.313698 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:25:37.314647 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:25:37.315357 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      
  
    

  create  table "postgres"."raw"."property_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:25:37.317944 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:25:37.318592 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:25:37.319207 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:25:37.319835 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:25:37.320499 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(select distinct host_id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id,
        host_since as dbt_updated_at,
        host_since as dbt_valid_from,
        nullif(host_since, host_since) as dbt_valid_to
    from (
        



select 
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  distinct host_id,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:25:37.321224 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      
  
    

  create  table "postgres"."raw"."room_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:25:37.338108 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 16:         md5(coalesce(cast(select distinct host_id as varchar...
                                   ^

[0m18:25:37.338839 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: ROLLBACK
[0m18:25:37.353391 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:25:37.085592 => 18:25:37.353036
[0m18:25:37.354081 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m18:25:37.361233 [debug] [Thread-1  ]: Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct host_id as varchar...
                                     ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:25:37.362179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab5d670>]}
[0m18:25:37.363843 [error] [Thread-1  ]: 1 of 3 ERROR snapshotting raw.host_snapshot .................................... [[31mERROR[0m in 0.31s]
[0m18:25:37.364857 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m18:25:37.681361 [debug] [Thread-2  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m18:25:37.684015 [debug] [Thread-3  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m18:25:37.732682 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:25:37.733497 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:25:37.734073 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:25:37.734539 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:25:37.734993 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:25:37.735431 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:25:37.770398 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:25:37.771005 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:25:37.772326 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 18:25:37.143650 => 18:25:37.772031
[0m18:25:37.773610 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:25:37.111926 => 18:25:37.773324
[0m18:25:37.774226 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m18:25:37.774757 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m18:25:37.775910 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca9c8790>]}
[0m18:25:37.776832 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff63d264-4321-422f-8f4b-47b4f6b68b7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fca8abc10>]}
[0m18:25:37.777801 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mSELECT 37562[0m in 0.72s]
[0m18:25:37.778563 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mSELECT 37562[0m in 0.72s]
[0m18:25:37.779555 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m18:25:37.780281 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m18:25:37.781966 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:37.782442 [debug] [MainThread]: On master: BEGIN
[0m18:25:37.782859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:37.943493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:37.944524 [debug] [MainThread]: On master: COMMIT
[0m18:25:37.945278 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:37.945972 [debug] [MainThread]: On master: COMMIT
[0m18:25:37.961026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:37.961757 [debug] [MainThread]: On master: Close
[0m18:25:37.963415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:37.964097 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:25:37.964730 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:25:37.965356 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m18:25:37.966120 [info ] [MainThread]: 
[0m18:25:37.967000 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m18:25:37.969022 [debug] [MainThread]: Command end result
[0m18:25:37.981930 [info ] [MainThread]: 
[0m18:25:37.982710 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:37.983233 [info ] [MainThread]: 
[0m18:25:37.983744 [error] [MainThread]:   Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  syntax error at or near "select"
  LINE 16:         md5(coalesce(cast(select distinct host_id as varchar...
                                     ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:25:37.984264 [info ] [MainThread]: 
[0m18:25:37.984801 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:25:37.985857 [debug] [MainThread]: Command `dbt snapshot` failed at 18:25:37.985700 after 1.99 seconds
[0m18:25:37.986537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc89416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab43370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab43790>]}
[0m18:25:37.987169 [debug] [MainThread]: Flushing usage events
[0m18:26:09.211302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8390a116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8393098850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8393098940>]}


============================== 18:26:09.215318 | 3d555701-8079-467c-88dd-9d5798bfd997 ==============================
[0m18:26:09.215318 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:26:09.216005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:26:09.318352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8393098880>]}
[0m18:26:09.329057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83800fd280>]}
[0m18:26:09.329624 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:26:09.347304 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:26:09.372247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:09.372806 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:26:09.404518 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
- models.bde.staging
[0m18:26:09.408386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83934230d0>]}
[0m18:26:09.422474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839337e460>]}
[0m18:26:09.422908 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:26:09.423202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839337e550>]}
[0m18:26:09.424498 [info ] [MainThread]: 
[0m18:26:09.425221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:26:09.426241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:26:09.434198 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:26:09.434599 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:26:09.434859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.665683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:26:09.668057 [debug] [ThreadPool]: On list_postgres: Close
[0m18:26:09.670415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m18:26:09.677917 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:26:09.678381 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:26:09.678762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:09.845170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:09.846147 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:26:09.846954 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:26:09.867000 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:26:09.870705 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:26:09.884974 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:26:09.899877 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:09.900742 [debug] [MainThread]: On master: BEGIN
[0m18:26:09.901448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:10.091389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:10.093522 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:10.094938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:10.117137 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:26:10.122615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839337e400>]}
[0m18:26:10.124006 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:10.138944 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:10.140204 [debug] [MainThread]: On master: BEGIN
[0m18:26:10.173126 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:10.174883 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.176383 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:10.177779 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.192182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:10.193105 [debug] [MainThread]: On master: Close
[0m18:26:10.195546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:10.196738 [info ] [MainThread]: 
[0m18:26:10.202527 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m18:26:10.203544 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m18:26:10.204911 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m18:26:10.206130 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:26:10.207254 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:26:10.208297 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m18:26:10.209805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m18:26:10.211011 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m18:26:10.212563 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m18:26:10.213370 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:26:10.214075 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:26:10.214730 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m18:26:10.228774 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:26:10.215242 => 18:26:10.228361
[0m18:26:10.234853 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:26:10.229292 => 18:26:10.234485
[0m18:26:10.239211 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 18:26:10.235357 => 18:26:10.238930
[0m18:26:10.239733 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m18:26:10.240186 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m18:26:10.240619 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m18:26:10.307210 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:26:10.310223 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:10.313676 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:10.314122 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:26:10.314430 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m18:26:10.314761 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:26:10.315096 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:26:10.315407 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:26:10.315933 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:26:10.316205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:26:10.482811 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:26:10.483560 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:26:10.484233 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:26:10.484794 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:10.485368 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:26:10.485928 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:10.486535 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:26:10.487182 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(host_id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id,
        host_since as dbt_updated_at,
        host_since as dbt_valid_from,
        nullif(host_since, host_since) as dbt_valid_to
    from (
        



select 
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  distinct host_id,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:26:10.487826 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:26:10.511792 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "distinct"
LINE 31:   distinct host_id,
           ^

[0m18:26:10.512496 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: ROLLBACK
[0m18:26:10.520262 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:26:10.520967 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:26:10.540350 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:26:10.240935 => 18:26:10.539998
[0m18:26:10.553797 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:10.556853 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:10.557373 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m18:26:10.557998 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp182610544761"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:26:10.558746 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp182610555898"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:26:10.563689 [debug] [Thread-1  ]: Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  syntax error at or near "distinct"
  LINE 31:   distinct host_id,
             ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:26:10.564203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83933e2880>]}
[0m18:26:10.565238 [error] [Thread-1  ]: 1 of 3 ERROR snapshotting raw.host_snapshot .................................... [[31mERROR[0m in 0.36s]
[0m18:26:10.565905 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m18:26:11.372198 [debug] [Thread-2  ]: SQL status: SELECT 0 in 1.0 seconds
[0m18:26:11.373941 [debug] [Thread-3  ]: SQL status: SELECT 0 in 1.0 seconds
[0m18:26:11.382402 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.388462 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.389308 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp182610555898'
        
      order by ordinal_position

  
[0m18:26:11.390082 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp182610544761'
        
      order by ordinal_position

  
[0m18:26:11.409684 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:26:11.410578 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:26:11.418124 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.424005 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.424776 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:26:11.425541 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:26:11.443893 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:26:11.450234 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.451015 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:26:11.451660 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp182610544761'
        
      order by ordinal_position

  
[0m18:26:11.457347 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.458230 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp182610555898'
        
      order by ordinal_position

  
[0m18:26:11.474277 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:26:11.480310 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.481049 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:26:11.481713 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:26:11.486835 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.487599 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:26:11.502978 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:26:11.514109 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:26:11.516499 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.565754 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.566237 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp182610544761'
        
      order by ordinal_position

  
[0m18:26:11.566601 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp182610555898'
        
      order by ordinal_position

  
[0m18:26:11.591522 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:26:11.591923 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:26:11.597743 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:26:11.600254 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m18:26:11.601013 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.601386 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.601782 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp182610555898" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp182610555898" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:26:11.602266 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp182610544761" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp182610544761" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:26:11.618971 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m18:26:11.619331 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m18:26:11.632517 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:26:11.633722 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:26:11.634057 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:26:11.634365 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:26:11.634672 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:26:11.634965 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:26:11.649121 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:26:11.649481 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:26:11.651983 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:26:10.266288 => 18:26:11.651806
[0m18:26:11.652878 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 18:26:10.310550 => 18:26:11.652729
[0m18:26:11.653232 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m18:26:11.653561 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m18:26:11.654287 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839336f910>]}
[0m18:26:11.654908 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d555701-8079-467c-88dd-9d5798bfd997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839352c0d0>]}
[0m18:26:11.655561 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 0[0m in 1.44s]
[0m18:26:11.656167 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 0[0m in 1.44s]
[0m18:26:11.656738 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m18:26:11.657215 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m18:26:11.658404 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:11.658701 [debug] [MainThread]: On master: BEGIN
[0m18:26:11.658965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:11.831043 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:11.831971 [debug] [MainThread]: On master: COMMIT
[0m18:26:11.832584 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:11.833150 [debug] [MainThread]: On master: COMMIT
[0m18:26:11.848483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:11.849192 [debug] [MainThread]: On master: Close
[0m18:26:11.850880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:11.851455 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:26:11.851970 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:26:11.852481 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m18:26:11.853111 [info ] [MainThread]: 
[0m18:26:11.853748 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m18:26:11.855388 [debug] [MainThread]: Command end result
[0m18:26:11.867073 [info ] [MainThread]: 
[0m18:26:11.867866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:11.868404 [info ] [MainThread]: 
[0m18:26:11.868923 [error] [MainThread]:   Database Error in snapshot host_snapshot (snapshots/host_snapshot.sql)
  syntax error at or near "distinct"
  LINE 31:   distinct host_id,
             ^
  compiled Code at target/run/bde/snapshots/host_snapshot.sql
[0m18:26:11.869437 [info ] [MainThread]: 
[0m18:26:11.869962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:26:11.870876 [debug] [MainThread]: Command `dbt snapshot` failed at 18:26:11.870742 after 2.69 seconds
[0m18:26:11.871427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8390a116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8393573190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8390290460>]}
[0m18:26:11.871952 [debug] [MainThread]: Flushing usage events
[0m18:27:35.213533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9158a516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b1a7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b1a7910>]}


============================== 18:27:35.217648 | 9d4e0a85-bc4e-479e-9112-e7289dc4b8fe ==============================
[0m18:27:35.217648 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:27:35.218318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:35.347060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b1a7850>]}
[0m18:27:35.357852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b29d250>]}
[0m18:27:35.358396 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:27:35.375311 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:27:35.402415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:35.403015 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:27:35.434870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
- models.bde.staging
[0m18:27:35.438672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b5340d0>]}
[0m18:27:35.452175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b48c430>]}
[0m18:27:35.452626 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:27:35.452921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b48c520>]}
[0m18:27:35.454197 [info ] [MainThread]: 
[0m18:27:35.454794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:35.455813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:27:35.463325 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:27:35.463672 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:27:35.463944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:35.684094 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m18:27:35.686749 [debug] [ThreadPool]: On list_postgres: Close
[0m18:27:35.689265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m18:27:35.697439 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:27:35.697954 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:27:35.698380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:35.873320 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:35.875362 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:27:35.876280 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:27:35.895106 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:27:35.900007 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:27:35.914939 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:27:35.931451 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:35.932366 [debug] [MainThread]: On master: BEGIN
[0m18:27:35.933053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:36.113465 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:36.115089 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:36.116313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:36.137094 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:27:36.141079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b48c3d0>]}
[0m18:27:36.142604 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:36.156271 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:36.157472 [debug] [MainThread]: On master: BEGIN
[0m18:27:36.186830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:36.188257 [debug] [MainThread]: On master: COMMIT
[0m18:27:36.189339 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:36.190061 [debug] [MainThread]: On master: COMMIT
[0m18:27:36.204583 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:36.205773 [debug] [MainThread]: On master: Close
[0m18:27:36.208595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:36.209712 [info ] [MainThread]: 
[0m18:27:36.218302 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m18:27:36.219331 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m18:27:36.220686 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m18:27:36.221787 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:27:36.222897 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:27:36.223950 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m18:27:36.225515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m18:27:36.226876 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m18:27:36.228074 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m18:27:36.228787 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:27:36.229452 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:27:36.230102 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m18:27:36.244305 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:27:36.230611 => 18:27:36.243862
[0m18:27:36.250399 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:27:36.244838 => 18:27:36.250074
[0m18:27:36.255023 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 18:27:36.250910 => 18:27:36.254724
[0m18:27:36.255623 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m18:27:36.256153 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m18:27:36.256660 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m18:27:36.313509 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:27:36.318573 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:36.321664 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:36.322076 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:27:36.322392 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m18:27:36.322731 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:27:36.323055 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:27:36.323310 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:27:36.323699 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:27:36.324078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:36.494072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:36.495057 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:27:36.495804 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:36.496645 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(host_id as varchar ), '')
         || '|' || coalesce(cast(host_since as varchar ), '')
        ) as dbt_scd_id,
        host_since as dbt_updated_at,
        host_since as dbt_valid_from,
        nullif(host_since, host_since) as dbt_valid_to
    from (
        



select 
  distinct host_id,
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:27:36.497443 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:36.498085 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:36.498938 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:27:36.499670 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:36.500485 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:27:36.533883 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:27:36.547929 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:27:36.583631 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:36.578951 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:36.584524 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp182736570717"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:27:36.585213 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp182736565438"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:27:36.878869 [debug] [Thread-1  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m18:27:36.917784 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m18:27:36.918619 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:27:36.919215 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m18:27:36.932303 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:36.933792 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:27:36.257021 => 18:27:36.933500
[0m18:27:36.934421 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m18:27:36.935803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9128759fd0>]}
[0m18:27:36.937518 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mSELECT 37562[0m in 0.71s]
[0m18:27:36.938519 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m18:27:37.285415 [debug] [Thread-3  ]: SQL status: SELECT 0 in 1.0 seconds
[0m18:27:37.295113 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.296378 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp182736565438'
        
      order by ordinal_position

  
[0m18:27:37.325656 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:27:37.335302 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.336344 [debug] [Thread-2  ]: SQL status: SELECT 0 in 1.0 seconds
[0m18:27:37.337276 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:27:37.342892 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.343791 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp182736570717'
        
      order by ordinal_position

  
[0m18:27:37.366786 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:27:37.374664 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:27:37.374100 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.381444 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.382253 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:27:37.383043 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp182736565438'
        
      order by ordinal_position

  
[0m18:27:37.401687 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:27:37.407896 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.408642 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:27:37.409324 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp182736570717'
        
      order by ordinal_position

  
[0m18:27:37.415215 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.415996 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:27:37.434153 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:27:37.442580 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.443294 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:27:37.443926 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:27:37.496596 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.497148 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp182736565438'
        
      order by ordinal_position

  
[0m18:27:37.515265 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:27:37.518829 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.519302 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp182736570717'
        
      order by ordinal_position

  
[0m18:27:37.519917 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:27:37.525438 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m18:27:37.526100 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.526544 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp182736565438" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp182736565438" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:27:37.536485 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:27:37.538965 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:27:37.539597 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.540042 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp182736570717" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp182736570717" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:27:37.540710 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m18:27:37.541943 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:27:37.542293 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:27:37.542608 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:27:37.554535 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m18:27:37.555918 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:27:37.556304 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:27:37.556651 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:27:37.562164 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:37.564834 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 18:27:36.318797 => 18:27:37.564658
[0m18:27:37.565212 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m18:27:37.566020 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b47ec40>]}
[0m18:27:37.566710 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 0[0m in 1.34s]
[0m18:27:37.567293 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m18:27:37.576251 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:37.577235 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:27:36.283166 => 18:27:37.577071
[0m18:27:37.577610 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m18:27:37.578362 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4e0a85-bc4e-479e-9112-e7289dc4b8fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b46aa60>]}
[0m18:27:37.578991 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 0[0m in 1.35s]
[0m18:27:37.579562 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m18:27:37.580830 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:37.581142 [debug] [MainThread]: On master: BEGIN
[0m18:27:37.581417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:37.749445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:37.750237 [debug] [MainThread]: On master: COMMIT
[0m18:27:37.750770 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:37.751262 [debug] [MainThread]: On master: COMMIT
[0m18:27:37.766482 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:37.767090 [debug] [MainThread]: On master: Close
[0m18:27:37.768552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:37.769128 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:27:37.769656 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:27:37.770164 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m18:27:37.770796 [info ] [MainThread]: 
[0m18:27:37.771446 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m18:27:37.773145 [debug] [MainThread]: Command end result
[0m18:27:37.784304 [info ] [MainThread]: 
[0m18:27:37.784947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:37.785389 [info ] [MainThread]: 
[0m18:27:37.785848 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:27:37.786743 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:27:37.786599 after 2.60 seconds
[0m18:27:37.787315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9158a516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b267040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915b51beb0>]}
[0m18:27:37.787902 [debug] [MainThread]: Flushing usage events
[0m18:51:50.493549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae8c716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb2f0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb2f0910>]}


============================== 18:51:50.497835 | 49660680-434f-40d3-a66a-83d49c24a2a0 ==============================
[0m18:51:50.497835 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:51:50.498533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:50.644223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49660680-434f-40d3-a66a-83d49c24a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb2f08b0>]}
[0m18:51:50.655081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49660680-434f-40d3-a66a-83d49c24a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb3e7250>]}
[0m18:51:50.655647 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:51:50.672631 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:51:50.701502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:50.702125 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:51:50.706513 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "listings') }}
  
  {% endsnapshot %}"
[0m18:51:50.707444 [debug] [MainThread]: Command `dbt snapshot` failed at 18:51:50.707101 after 0.26 seconds
[0m18:51:50.707970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae8c716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac8207fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac8062100>]}
[0m18:51:50.708500 [debug] [MainThread]: Flushing usage events
[0m18:52:58.933624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9070aa16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90729087f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90729088e0>]}


============================== 18:52:58.937786 | 6a7177b6-86aa-4e5f-a386-cc3c4d94afdc ==============================
[0m18:52:58.937786 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:52:58.938436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:59.039404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9072908880>]}
[0m18:52:59.050071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907296f220>]}
[0m18:52:59.050663 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:52:59.067061 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:52:59.092050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:59.092633 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m18:52:59.125947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.staging
- models.bde.warehouse
[0m18:52:59.129891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908109c0d0>]}
[0m18:52:59.144617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90729d6400>]}
[0m18:52:59.145093 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:52:59.145408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90729d64f0>]}
[0m18:52:59.146739 [info ] [MainThread]: 
[0m18:52:59.147346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:59.148340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:59.155926 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:59.156242 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:59.156492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:59.612512 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:52:59.614174 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:59.616097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m18:52:59.627566 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:59.628257 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:52:59.628818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:59.807779 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:59.809933 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:59.811234 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:52:59.831763 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:52:59.836991 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:52:59.851317 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:52:59.866350 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:59.867237 [debug] [MainThread]: On master: BEGIN
[0m18:52:59.867926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:00.049224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:00.050864 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:00.052399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:00.075286 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:53:00.079222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90729d63a0>]}
[0m18:53:00.080631 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:00.096645 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:00.097546 [debug] [MainThread]: On master: BEGIN
[0m18:53:00.133322 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:00.135240 [debug] [MainThread]: On master: COMMIT
[0m18:53:00.136241 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:00.137244 [debug] [MainThread]: On master: COMMIT
[0m18:53:00.152913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:00.154424 [debug] [MainThread]: On master: Close
[0m18:53:00.156701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:00.157595 [info ] [MainThread]: 
[0m18:53:00.163540 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m18:53:00.164886 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m18:53:00.166377 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m18:53:00.167389 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:53:00.168095 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:53:00.168490 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m18:53:00.169141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres, now snapshot.bde.host_snapshot)
[0m18:53:00.169655 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.property_snapshot)
[0m18:53:00.170214 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m18:53:00.170560 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:53:00.170868 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:53:00.171165 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m18:53:00.178722 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:53:00.171379 => 18:53:00.178473
[0m18:53:00.182798 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:53:00.179082 => 18:53:00.182571
[0m18:53:00.185270 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 18:53:00.183108 => 18:53:00.185104
[0m18:53:00.185618 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m18:53:00.185904 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m18:53:00.186179 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m18:53:00.240899 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:00.246315 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:53:00.247266 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:00.247729 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m18:53:00.248220 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:53:00.248567 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:53:00.248923 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:53:00.249276 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:53:00.249859 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:53:00.250176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:00.414920 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:53:00.415894 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:00.416655 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:53:00.419430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:53:00.420226 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:53:00.420884 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:53:00.421678 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(host_id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select 
  distinct host_id,
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:53:00.422456 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:00.423211 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:53:00.448066 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:53:00.462242 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:53:00.481207 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:00.484358 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:00.485075 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp185300473043"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:53:00.485934 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp185300483396"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:53:00.767611 [debug] [Thread-1  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m18:53:00.817359 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m18:53:00.818039 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:53:00.818500 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m18:53:00.831502 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:53:00.832848 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:53:00.186379 => 18:53:00.832589
[0m18:53:00.833384 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m18:53:00.834557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9072a1dfd0>]}
[0m18:53:00.835854 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mSELECT 37562[0m in 0.67s]
[0m18:53:00.836699 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m18:53:01.037419 [debug] [Thread-2  ]: SQL status: SELECT 0 in 1.0 seconds
[0m18:53:01.050343 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.052527 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp185300483396'
        
      order by ordinal_position

  
[0m18:53:01.077922 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:53:01.098074 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.099687 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:53:01.119488 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:53:01.132849 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.134184 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp185300483396'
        
      order by ordinal_position

  
[0m18:53:01.156365 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:53:01.171050 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.172236 [debug] [Thread-3  ]: SQL status: SELECT 0 in 1.0 seconds
[0m18:53:01.173376 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:53:01.180227 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.181745 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp185300473043'
        
      order by ordinal_position

  
[0m18:53:01.199213 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m18:53:01.209534 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:53:01.224414 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.222769 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.225562 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp185300483396'
        
      order by ordinal_position

  
[0m18:53:01.226395 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:53:01.244769 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m18:53:01.245507 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:53:01.256604 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:53:01.261827 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.262702 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp185300473043'
        
      order by ordinal_position

  
[0m18:53:01.263699 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.264416 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp185300483396" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp185300483396" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:53:01.281027 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:53:01.333467 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m18:53:01.334592 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.335819 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:53:01.336153 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m18:53:01.336463 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:53:01.336809 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:53:01.367507 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m18:53:01.367900 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:53:01.371441 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.374273 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:53:00.212660 => 18:53:01.374086
[0m18:53:01.374701 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp185300473043'
        
      order by ordinal_position

  
[0m18:53:01.375112 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m18:53:01.375973 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90811da2e0>]}
[0m18:53:01.376636 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 0[0m in 1.21s]
[0m18:53:01.377181 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m18:53:01.402110 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m18:53:01.404939 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m18:53:01.405850 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.406380 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp185300473043" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp185300473043" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:53:01.426195 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m18:53:01.427893 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:53:01.428356 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:53:01.428778 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:53:01.444041 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:53:01.445369 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 18:53:00.236652 => 18:53:01.445113
[0m18:53:01.445914 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m18:53:01.446961 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7177b6-86aa-4e5f-a386-cc3c4d94afdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9080e8a1f0>]}
[0m18:53:01.447883 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 0[0m in 1.28s]
[0m18:53:01.448667 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m18:53:01.450536 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:01.450991 [debug] [MainThread]: On master: BEGIN
[0m18:53:01.451386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:01.630182 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:01.633171 [debug] [MainThread]: On master: COMMIT
[0m18:53:01.634690 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:01.636179 [debug] [MainThread]: On master: COMMIT
[0m18:53:01.651033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:01.652786 [debug] [MainThread]: On master: Close
[0m18:53:01.656835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:01.658303 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:53:01.659632 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:53:01.660923 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m18:53:01.662219 [info ] [MainThread]: 
[0m18:53:01.663520 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m18:53:01.666709 [debug] [MainThread]: Command end result
[0m18:53:01.686026 [info ] [MainThread]: 
[0m18:53:01.687120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:01.687852 [info ] [MainThread]: 
[0m18:53:01.688618 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:53:01.689771 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:53:01.689583 after 2.80 seconds
[0m18:53:01.690545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9070aa16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9080eb1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9060149130>]}
[0m18:53:01.691261 [debug] [MainThread]: Flushing usage events
[0m19:04:53.018860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9608c716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960b070880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960b070970>]}


============================== 19:04:53.022883 | 63291bb1-ecf4-43f4-8cce-4f8ef272db7b ==============================
[0m19:04:53.022883 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:04:53.023540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m19:04:53.171342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960b0708b0>]}
[0m19:04:53.182201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960b1982b0>]}
[0m19:04:53.182743 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m19:04:53.200316 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:04:53.227118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:53.227523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:53.228147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.datamart
- models.bde.warehouse
[0m19:04:53.233604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e85600d0>]}
[0m19:04:53.247878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e84a8b50>]}
[0m19:04:53.248470 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m19:04:53.248821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e84a8eb0>]}
[0m19:04:53.250424 [info ] [MainThread]: 
[0m19:04:53.251417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:04:53.252622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:04:53.260723 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:04:53.261117 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:04:53.261382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:53.624405 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:04:53.626851 [debug] [ThreadPool]: On list_postgres: Close
[0m19:04:53.629270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m19:04:53.636434 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m19:04:53.636982 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m19:04:53.637350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:53.803908 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:04:53.804486 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m19:04:53.804871 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:04:53.825976 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:04:53.827636 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m19:04:53.843903 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m19:04:53.851106 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:53.851583 [debug] [MainThread]: On master: BEGIN
[0m19:04:53.851956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:54.017513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:04:54.018483 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:54.019318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:04:54.042225 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:04:54.044408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e84a8310>]}
[0m19:04:54.045256 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:54.061670 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:54.062406 [debug] [MainThread]: On master: BEGIN
[0m19:04:54.096188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:04:54.097158 [debug] [MainThread]: On master: COMMIT
[0m19:04:54.097873 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:54.098534 [debug] [MainThread]: On master: COMMIT
[0m19:04:54.113725 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:04:54.114706 [debug] [MainThread]: On master: Close
[0m19:04:54.116598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:54.117422 [info ] [MainThread]: 
[0m19:04:54.122945 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m19:04:54.123832 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m19:04:54.124998 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m19:04:54.125905 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m19:04:54.126875 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m19:04:54.127726 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m19:04:54.128959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres, now snapshot.bde.host_snapshot)
[0m19:04:54.130084 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.property_snapshot)
[0m19:04:54.131124 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m19:04:54.131746 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m19:04:54.132524 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m19:04:54.133201 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m19:04:54.145855 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 19:04:54.133669 => 19:04:54.145453
[0m19:04:54.152176 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 19:04:54.146372 => 19:04:54.151823
[0m19:04:54.156195 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 19:04:54.152728 => 19:04:54.155958
[0m19:04:54.156718 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m19:04:54.157169 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m19:04:54.157609 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m19:04:54.205816 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:54.206975 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:54.210217 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:54.210538 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m19:04:54.210813 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m19:04:54.211100 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m19:04:54.211371 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:04:54.211629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:54.211879 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:04:54.393472 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:04:54.394510 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:04:54.395481 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:04:54.396304 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:54.397043 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:54.397720 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:54.398437 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:54.399214 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:54.400043 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:54.431254 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:04:54.443755 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:04:54.444491 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:04:54.497416 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:54.497762 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:54.501353 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:54.501802 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp190454496661"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct host_id,
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            host_id as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            host_id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(host_id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            host_id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:04:54.502369 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp190454476542"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:04:54.502916 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp190454472185"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:04:56.044397 [debug] [Thread-2  ]: SQL status: SELECT 73015 in 2.0 seconds
[0m19:04:56.055915 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.057117 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp190454476542'
        
      order by ordinal_position

  
[0m19:04:56.092275 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:04:56.101762 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.102814 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:56.123487 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:04:56.131909 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.132865 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp190454476542'
        
      order by ordinal_position

  
[0m19:04:56.153164 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:04:56.160440 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.161362 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:56.180640 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:04:56.194761 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.195714 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp190454476542'
        
      order by ordinal_position

  
[0m19:04:56.215028 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:04:56.227551 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m19:04:56.228783 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.229522 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp190454476542" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp190454476542" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:04:56.734038 [debug] [Thread-3  ]: SQL status: SELECT 73015 in 2.0 seconds
[0m19:04:56.745352 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:56.746590 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp190454472185'
        
      order by ordinal_position

  
[0m19:04:56.781155 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:04:56.791425 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:56.792453 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:56.812575 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:04:56.824267 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:56.825203 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp190454472185'
        
      order by ordinal_position

  
[0m19:04:56.845716 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:04:56.853100 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:56.854013 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:56.874222 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:04:56.882559 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:56.883452 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp190454472185'
        
      order by ordinal_position

  
[0m19:04:56.904899 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:04:56.911947 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m19:04:56.914814 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:56.915827 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp190454472185" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp190454472185" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:04:56.927641 [debug] [Thread-2  ]: SQL status: INSERT 0 36901 in 1.0 seconds
[0m19:04:56.955799 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:04:56.956506 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:04:56.957075 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:04:57.008125 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:04:57.014864 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 19:04:54.188863 => 19:04:57.014442
[0m19:04:57.015717 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m19:04:57.017346 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960b21ad90>]}
[0m19:04:57.020305 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 36901[0m in 2.89s]
[0m19:04:57.021517 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m19:04:57.669620 [debug] [Thread-3  ]: SQL status: INSERT 0 36901 in 1.0 seconds
[0m19:04:57.672793 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m19:04:57.673511 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:04:57.674083 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m19:04:57.771352 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:04:57.773138 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 19:04:54.207261 => 19:04:57.772886
[0m19:04:57.773685 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m19:04:57.774838 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e84a8eb0>]}
[0m19:04:57.775804 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 36901[0m in 3.64s]
[0m19:04:57.776623 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m19:04:58.409959 [debug] [Thread-1  ]: SQL status: SELECT 653194 in 4.0 seconds
[0m19:04:58.418289 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:58.419502 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp190454496661'
        
      order by ordinal_position

  
[0m19:04:58.440327 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:04:58.448648 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:58.449752 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:58.468933 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:04:58.476836 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:58.477786 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp190454496661'
        
      order by ordinal_position

  
[0m19:04:58.496033 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:04:58.503048 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:58.503882 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:04:58.521213 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:04:58.528301 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:58.529053 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp190454496661'
        
      order by ordinal_position

  
[0m19:04:58.546993 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:04:58.551555 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m19:04:58.552844 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:04:58.553652 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp190454496661" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("host_id", "listing_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp190454496661" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:05:15.591749 [debug] [Thread-1  ]: SQL status: INSERT 0 326831 in 17.0 seconds
[0m19:05:15.606427 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m19:05:15.607689 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:05:15.608542 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m19:05:15.681141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m19:05:15.687219 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 19:04:54.157935 => 19:05:15.686371
[0m19:05:15.688443 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m19:05:15.690891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63291bb1-ecf4-43f4-8cce-4f8ef272db7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d818eeb0>]}
[0m19:05:15.692532 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 326831[0m in 21.56s]
[0m19:05:15.693865 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m19:05:15.697922 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:15.698783 [debug] [MainThread]: On master: BEGIN
[0m19:05:15.699488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:15.887602 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:15.889814 [debug] [MainThread]: On master: COMMIT
[0m19:05:15.890701 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:15.891590 [debug] [MainThread]: On master: COMMIT
[0m19:05:15.906933 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:15.907983 [debug] [MainThread]: On master: Close
[0m19:05:15.910147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:15.911044 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m19:05:15.911857 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m19:05:15.912636 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m19:05:15.913582 [info ] [MainThread]: 
[0m19:05:15.914526 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 22.66 seconds (22.66s).
[0m19:05:15.916656 [debug] [MainThread]: Command end result
[0m19:05:15.979116 [info ] [MainThread]: 
[0m19:05:15.979565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:15.979864 [info ] [MainThread]: 
[0m19:05:15.980176 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:05:15.980719 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:05:15.980630 after 23.00 seconds
[0m19:05:15.981121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9608c716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e8310430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960b0894f0>]}
[0m19:05:15.981474 [debug] [MainThread]: Flushing usage events
[0m19:35:48.732680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd58c116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5acf8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5acf8970>]}


============================== 19:35:48.736802 | 04788adf-713b-4f73-a64c-668283ed0912 ==============================
[0m19:35:48.736802 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:35:48.737433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:48.879274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5acf8910>]}
[0m19:35:48.889945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5ade42b0>]}
[0m19:35:48.890477 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m19:35:48.908297 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:35:48.935789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:48.936211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:48.936802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.staging
- models.bde.warehouse
[0m19:35:48.941791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd281770d0>]}
[0m19:35:48.957694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd38c40b50>]}
[0m19:35:48.958183 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m19:35:48.958503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd38c40eb0>]}
[0m19:35:48.959903 [info ] [MainThread]: 
[0m19:35:48.960528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:48.961576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:35:48.971056 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:35:48.971596 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:35:48.971900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:49.446085 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:35:49.450509 [debug] [ThreadPool]: On list_postgres: Close
[0m19:35:49.454166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m19:35:49.465154 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m19:35:49.465865 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m19:35:49.466432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:49.659001 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:49.661154 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m19:35:49.662174 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:35:49.682509 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:35:49.686610 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m19:35:49.702878 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m19:35:49.717505 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:49.718350 [debug] [MainThread]: On master: BEGIN
[0m19:35:49.718965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:49.918475 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:49.920835 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:49.921924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:49.945035 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:35:49.950076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd38c40310>]}
[0m19:35:49.951558 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:49.965626 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:49.966592 [debug] [MainThread]: On master: BEGIN
[0m19:35:49.994391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:49.996303 [debug] [MainThread]: On master: COMMIT
[0m19:35:49.997187 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:49.998003 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.011814 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:50.012967 [debug] [MainThread]: On master: Close
[0m19:35:50.015818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:35:50.016685 [info ] [MainThread]: 
[0m19:35:50.023715 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m19:35:50.024836 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m19:35:50.026218 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m19:35:50.027344 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m19:35:50.028515 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m19:35:50.029563 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m19:35:50.031140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres, now snapshot.bde.host_snapshot)
[0m19:35:50.032383 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.property_snapshot)
[0m19:35:50.033737 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m19:35:50.034632 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m19:35:50.035401 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m19:35:50.036238 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m19:35:50.050795 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 19:35:50.036794 => 19:35:50.050347
[0m19:35:50.057528 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 19:35:50.051366 => 19:35:50.057144
[0m19:35:50.062029 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 19:35:50.058071 => 19:35:50.061724
[0m19:35:50.062593 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m19:35:50.063062 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m19:35:50.063496 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m19:35:50.116696 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:35:50.119869 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:50.125538 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:50.125878 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m19:35:50.126156 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m19:35:50.126423 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m19:35:50.126689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:35:50.126948 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:35:50.127204 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:35:50.298888 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:35:50.299691 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:35:50.300486 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:50.301217 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:50.301990 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:50.302770 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:50.307235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:35:50.307902 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:35:50.308595 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:50.331446 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:35:50.342634 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:35:50.343270 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:35:50.384213 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:35:50.386517 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:50.388834 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:50.389340 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp193550364432"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct host_id,
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            host_id as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            host_id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(host_id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            host_id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:35:50.389910 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp193550361833"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:35:50.390478 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp193550388148"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:35:52.732313 [debug] [Thread-2  ]: SQL status: SELECT 71008 in 2.0 seconds
[0m19:35:52.735137 [debug] [Thread-3  ]: SQL status: SELECT 71008 in 2.0 seconds
[0m19:35:52.746169 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:52.752101 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:52.753085 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp193550388148'
        
      order by ordinal_position

  
[0m19:35:52.754013 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp193550361833'
        
      order by ordinal_position

  
[0m19:35:52.771908 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:35:52.772849 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:35:52.780452 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:52.786151 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:52.786948 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:52.787725 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:52.805848 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:35:52.811913 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:52.812661 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:35:52.813371 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp193550388148'
        
      order by ordinal_position

  
[0m19:35:52.819202 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:52.820012 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp193550361833'
        
      order by ordinal_position

  
[0m19:35:52.843864 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:35:52.844568 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:35:52.852494 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:52.858048 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:52.858735 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:52.859403 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:35:52.878501 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:35:52.889152 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:35:52.890852 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:52.896163 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:52.896846 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp193550388148'
        
      order by ordinal_position

  
[0m19:35:52.897524 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp193550361833'
        
      order by ordinal_position

  
[0m19:35:52.914785 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:35:52.924709 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m19:35:52.925376 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:35:52.928906 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m19:35:52.929703 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:52.930350 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp193550388148" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp193550388148" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:35:52.931094 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:52.931743 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp193550361833" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp193550361833" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:35:53.830400 [debug] [Thread-3  ]: SQL status: INSERT 0 36057 in 1.0 seconds
[0m19:35:53.865907 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m19:35:53.866624 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:35:53.867205 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m19:35:53.896489 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:35:53.901258 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 19:35:50.116975 => 19:35:53.900924
[0m19:35:53.901973 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m19:35:53.903521 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5ae22e20>]}
[0m19:35:53.905313 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 36057[0m in 3.87s]
[0m19:35:53.906444 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m19:35:53.910941 [debug] [Thread-2  ]: SQL status: INSERT 0 36057 in 1.0 seconds
[0m19:35:53.913580 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:35:53.914288 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:35:53.914869 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:35:53.949916 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:35:53.951836 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 19:35:50.083639 => 19:35:53.951551
[0m19:35:53.952467 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m19:35:53.953797 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04788adf-713b-4f73-a64c-668283ed0912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd38cd8d90>]}
[0m19:35:53.954869 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 36057[0m in 3.92s]
[0m19:35:53.955781 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m19:40:06.997542 [debug] [Thread-1  ]: SQL status: SELECT 89770905 in 257.0 seconds
[0m19:40:07.026597 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:40:07.027900 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp193550364432'
        
      order by ordinal_position

  
[0m19:40:07.049464 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:40:07.055877 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:40:07.056852 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:40:07.077776 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:40:07.085660 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:40:07.086270 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp193550364432'
        
      order by ordinal_position

  
[0m19:40:07.117661 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:40:07.128630 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:40:07.130319 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:40:07.151799 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:40:07.169966 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:40:07.251556 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp193550364432'
        
      order by ordinal_position

  
[0m19:40:07.271720 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:40:07.273846 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m19:40:07.275827 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:40:07.276206 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp193550364432" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("host_id", "listing_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp193550364432" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:48:27.030833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea82c96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa747880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa747970>]}


============================== 19:48:27.034983 | c04bc919-f641-4042-aba2-227c9a6d1838 ==============================
[0m19:48:27.034983 [info ] [MainThread]: Running with dbt=1.6.6
[0m19:48:27.035635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:48:27.175912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa747910>]}
[0m19:48:27.186658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeaa8812b0>]}
[0m19:48:27.187224 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m19:48:27.203654 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m19:48:27.232885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:48:27.233280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:48:27.233898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.warehouse
- models.bde.datamart
[0m19:48:27.239097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe780a80d0>]}
[0m19:48:27.253015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe992a7b50>]}
[0m19:48:27.253465 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m19:48:27.253768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe992a7eb0>]}
[0m19:48:27.255204 [info ] [MainThread]: 
[0m19:48:27.255845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:27.256921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:48:27.264949 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:48:27.265285 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:48:27.265537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:27.651859 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:48:27.655106 [debug] [ThreadPool]: On list_postgres: Close
[0m19:48:27.658184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m19:48:27.668153 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m19:48:27.668762 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m19:48:27.669273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:27.867341 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:48:27.869240 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m19:48:27.870536 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:48:27.892961 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:48:27.897593 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m19:48:27.911195 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m19:48:27.926001 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:27.926899 [debug] [MainThread]: On master: BEGIN
[0m19:48:27.927603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:28.120418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.122145 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:28.123629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:48:28.148099 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:48:28.152089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe992a7310>]}
[0m19:48:28.153339 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:28.170832 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:28.172151 [debug] [MainThread]: On master: BEGIN
[0m19:48:28.202366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.204101 [debug] [MainThread]: On master: COMMIT
[0m19:48:28.205565 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:28.206964 [debug] [MainThread]: On master: COMMIT
[0m19:48:28.220929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:28.222633 [debug] [MainThread]: On master: Close
[0m19:48:28.225861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:28.226779 [info ] [MainThread]: 
[0m19:48:28.233692 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m19:48:28.234774 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m19:48:28.236122 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m19:48:28.237255 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m19:48:28.238405 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m19:48:28.239592 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m19:48:28.241152 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres, now snapshot.bde.host_snapshot)
[0m19:48:28.242350 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.property_snapshot)
[0m19:48:28.243706 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m19:48:28.244539 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m19:48:28.245280 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m19:48:28.245979 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m19:48:28.260976 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 19:48:28.246503 => 19:48:28.260493
[0m19:48:28.267350 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 19:48:28.261573 => 19:48:28.266942
[0m19:48:28.271766 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 19:48:28.267861 => 19:48:28.271471
[0m19:48:28.272357 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m19:48:28.272822 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m19:48:28.273274 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m19:48:28.319925 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:48:28.322347 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:28.325627 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:28.325974 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m19:48:28.326269 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m19:48:28.326553 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m19:48:28.326823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:48:28.327086 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:48:28.327342 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:48:28.499266 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.500170 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:48:28.500839 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:28.505194 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.505825 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.506408 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:28.507026 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:28.507658 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:28.508356 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:28.545583 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:48:28.565410 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:48:28.572535 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:48:28.597529 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:28.599934 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m19:48:28.602481 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:28.603015 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp194828581161"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:48:28.603656 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp194828573142"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct host_id,
  LISTING_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            host_id as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            host_id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(host_id as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            host_id as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:48:28.604298 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp194828601756"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m19:48:31.411791 [debug] [Thread-2  ]: SQL status: SELECT 0 in 3.0 seconds
[0m19:48:31.422414 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.423637 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp194828581161'
        
      order by ordinal_position

  
[0m19:48:31.445896 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:48:31.454108 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.455100 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:31.475614 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:48:31.483834 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.484782 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp194828581161'
        
      order by ordinal_position

  
[0m19:48:31.506113 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:48:31.514241 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.515209 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:31.527709 [debug] [Thread-3  ]: SQL status: SELECT 0 in 3.0 seconds
[0m19:48:31.533391 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.534332 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp194828601756'
        
      order by ordinal_position

  
[0m19:48:31.539341 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m19:48:31.552544 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.553419 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp194828581161'
        
      order by ordinal_position

  
[0m19:48:31.575995 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m19:48:31.588332 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m19:48:31.589089 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:48:31.594714 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.595404 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:31.596324 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.597054 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp194828581161" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp194828581161" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:48:31.615919 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m19:48:31.628410 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:48:31.640461 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:48:31.644707 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.645224 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m19:48:31.645706 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp194828601756'
        
      order by ordinal_position

  
[0m19:48:31.646192 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m19:48:31.667477 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m19:48:31.673572 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 19:48:28.299468 => 19:48:31.673314
[0m19:48:31.674146 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m19:48:31.674661 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:48:31.678696 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.679577 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe99340d90>]}
[0m19:48:31.680053 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m19:48:31.681599 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 0[0m in 3.44s]
[0m19:48:31.682497 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m19:48:31.706912 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m19:48:31.712003 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.712665 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp194828601756'
        
      order by ordinal_position

  
[0m19:48:31.736085 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m19:48:31.739786 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m19:48:31.741729 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.742438 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp194828601756" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp194828601756" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m19:48:31.756366 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m19:48:31.758387 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m19:48:31.758913 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m19:48:31.759391 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m19:48:31.777548 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m19:48:31.779902 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 19:48:28.322574 => 19:48:31.779625
[0m19:48:31.796952 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m19:48:31.798554 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04bc919-f641-4042-aba2-227c9a6d1838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe9920ad00>]}
[0m19:48:31.816627 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 0[0m in 3.56s]
[0m19:48:31.818164 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:20:45.171139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f0bb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e07b0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e07b0970>]}


============================== 20:20:45.175231 | 9faa8c86-300b-4e27-97a9-c0f642cd2b5e ==============================
[0m20:20:45.175231 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:20:45.175881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:20:45.320835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e07b08b0>]}
[0m20:20:45.331618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2ad62b0>]}
[0m20:20:45.332168 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:20:45.348815 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:20:45.376092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:45.376682 [debug] [MainThread]: Partial parsing: updated file: bde://snapshots/host_snapshot.sql
[0m20:20:45.409585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m20:20:45.413349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e10ed0d0>]}
[0m20:20:45.427697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2c17490>]}
[0m20:20:45.428140 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:20:45.428439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2c17580>]}
[0m20:20:45.429716 [info ] [MainThread]: 
[0m20:20:45.430313 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:45.431289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:20:45.439177 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:20:45.439684 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:20:45.439990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:45.866153 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:20:45.870519 [debug] [ThreadPool]: On list_postgres: Close
[0m20:20:45.872577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m20:20:45.883691 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:20:45.884389 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:20:45.884974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:46.079049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:20:46.081358 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:20:46.082802 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:20:46.109918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:20:46.115628 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:20:46.130682 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:20:46.146123 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:46.146968 [debug] [MainThread]: On master: BEGIN
[0m20:20:46.147642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:46.326271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:46.328002 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:46.329364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:46.354121 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:20:46.357960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2c17430>]}
[0m20:20:46.359450 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:46.373869 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:46.374946 [debug] [MainThread]: On master: BEGIN
[0m20:20:46.406778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:46.408489 [debug] [MainThread]: On master: COMMIT
[0m20:20:46.409979 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:46.411166 [debug] [MainThread]: On master: COMMIT
[0m20:20:46.424470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:46.425799 [debug] [MainThread]: On master: Close
[0m20:20:46.428576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:46.429708 [info ] [MainThread]: 
[0m20:20:46.436574 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:20:46.437614 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:20:46.438667 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:20:46.440321 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:20:46.441525 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:20:46.442415 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:20:46.443679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres, now snapshot.bde.host_snapshot)
[0m20:20:46.444786 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.property_snapshot)
[0m20:20:46.445992 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:20:46.446765 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:20:46.447444 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:20:46.448159 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:20:46.462381 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:20:46.448725 => 20:20:46.461883
[0m20:20:46.468751 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:20:46.462909 => 20:20:46.468359
[0m20:20:46.473269 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:20:46.469288 => 20:20:46.472977
[0m20:20:46.473835 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:20:46.474300 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:20:46.474740 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:20:46.529034 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:20:46.530697 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:20:46.533099 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:20:46.533992 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:20:46.534312 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:20:46.534651 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:20:46.534990 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:20:46.535305 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:20:46.535633 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:20:46.535926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:46.536208 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:20:46.536696 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:20:46.711055 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:20:46.711596 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:20:46.711906 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m20:20:46.717435 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:20:46.717774 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:20:46.718066 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:20:46.718385 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:20:46.718724 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      
  
    

  create  table "postgres"."raw"."room_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m20:20:46.719105 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      
  
    

  create  table "postgres"."raw"."property_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m20:20:47.109212 [debug] [Thread-2  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m20:20:47.111833 [debug] [Thread-1  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m20:20:47.119774 [debug] [Thread-3  ]: SQL status: SELECT 37562 in 0.0 seconds
[0m20:20:47.149969 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:20:47.152167 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:20:47.154199 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:20:47.154738 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:20:47.155238 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:20:47.155725 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:20:47.156205 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:20:47.156672 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:20:47.157150 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:20:47.200989 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:20:47.201720 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:20:47.202439 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:20:47.204095 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:20:46.500527 => 20:20:47.203744
[0m20:20:47.205396 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:20:46.530920 => 20:20:47.205137
[0m20:20:47.206597 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:20:46.475081 => 20:20:47.206339
[0m20:20:47.207213 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:20:47.207774 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:20:47.208339 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:20:47.209802 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2c08190>]}
[0m20:20:47.210853 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e118bdf0>]}
[0m20:20:47.211888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9faa8c86-300b-4e27-97a9-c0f642cd2b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2c17310>]}
[0m20:20:47.213550 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mSELECT 37562[0m in 0.77s]
[0m20:20:47.214492 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mSELECT 37562[0m in 0.77s]
[0m20:20:47.215613 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mSELECT 37562[0m in 0.77s]
[0m20:20:47.216500 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:20:47.217247 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:20:47.218001 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:20:47.221130 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:47.221657 [debug] [MainThread]: On master: BEGIN
[0m20:20:47.222086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:47.399419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:47.400810 [debug] [MainThread]: On master: COMMIT
[0m20:20:47.401758 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:47.402615 [debug] [MainThread]: On master: COMMIT
[0m20:20:47.417577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:47.418983 [debug] [MainThread]: On master: Close
[0m20:20:47.421221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:47.422155 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:20:47.422814 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:20:47.423429 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:20:47.424197 [info ] [MainThread]: 
[0m20:20:47.425026 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m20:20:47.427149 [debug] [MainThread]: Command end result
[0m20:20:47.443382 [info ] [MainThread]: 
[0m20:20:47.444131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:47.444640 [info ] [MainThread]: 
[0m20:20:47.445182 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:20:47.446305 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:20:47.446147 after 2.32 seconds
[0m20:20:47.446997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f0bb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f2ad62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e1130730>]}
[0m20:20:47.447625 [debug] [MainThread]: Flushing usage events
[0m20:27:31.227018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc168af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc158438850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc158438940>]}


============================== 20:27:31.230876 | 3d0faced-f118-48ad-b254-479a58e9b99c ==============================
[0m20:27:31.230876 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:27:31.231524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:27:31.369046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1584388e0>]}
[0m20:27:31.379822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16ae1f280>]}
[0m20:27:31.380356 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:27:31.397588 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:27:31.423948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:31.424331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:31.424893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.datamart
- models.bde.warehouse
[0m20:27:31.429920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1584a70d0>]}
[0m20:27:31.443676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16aeebb20>]}
[0m20:27:31.444192 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:27:31.444511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16aeebe80>]}
[0m20:27:31.445998 [info ] [MainThread]: 
[0m20:27:31.446738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:27:31.448019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:27:31.455849 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:27:31.456155 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:27:31.456405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:31.679370 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m20:27:31.687448 [debug] [ThreadPool]: On list_postgres: Close
[0m20:27:31.689191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:27:31.694980 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:27:31.695351 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:27:31.695642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:31.854851 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:27:31.856250 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:27:31.857359 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:27:31.875947 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:27:31.880576 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:27:31.893846 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:27:31.909157 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:31.910084 [debug] [MainThread]: On master: BEGIN
[0m20:27:31.910777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:32.089828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:27:32.091535 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:32.092581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:27:32.113180 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:27:32.117046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16aeeb310>]}
[0m20:27:32.118435 [debug] [MainThread]: On master: ROLLBACK
[0m20:27:32.132324 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:32.133465 [debug] [MainThread]: On master: BEGIN
[0m20:27:32.164787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:27:32.166862 [debug] [MainThread]: On master: COMMIT
[0m20:27:32.168365 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:32.169797 [debug] [MainThread]: On master: COMMIT
[0m20:27:32.185244 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:27:32.186385 [debug] [MainThread]: On master: Close
[0m20:27:32.188389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:32.189178 [info ] [MainThread]: 
[0m20:27:32.195445 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:27:32.196473 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:27:32.197820 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:27:32.198943 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:27:32.199933 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:27:32.200781 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:27:32.202051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:27:32.203307 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:27:32.204496 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:27:32.205201 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:27:32.205861 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:27:32.206505 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:27:32.220809 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:27:32.207010 => 20:27:32.220336
[0m20:27:32.226427 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:27:32.221321 => 20:27:32.226132
[0m20:27:32.231003 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:27:32.226889 => 20:27:32.230689
[0m20:27:32.231596 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:27:32.232052 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:27:32.232491 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:27:32.287517 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:32.289871 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:32.293525 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:32.293845 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:27:32.294132 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:27:32.294400 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:27:32.294664 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:27:32.294921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:27:32.295174 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:27:32.463944 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:27:32.464574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:27:32.465120 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:27:32.465583 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:32.466040 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:32.466470 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:32.466951 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:32.467452 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:32.467953 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:32.518902 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:27:32.519507 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:27:32.525369 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:27:32.560446 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:32.560996 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:32.563460 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:32.563931 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp202732539987"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:27:32.564492 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp202732551860"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:27:32.565050 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp202732562798"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:27:34.176322 [debug] [Thread-1  ]: SQL status: SELECT 73015 in 2.0 seconds
[0m20:27:34.187831 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:34.188991 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp202732539987'
        
      order by ordinal_position

  
[0m20:27:34.217344 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:27:34.226234 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:34.227338 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:34.246313 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:27:34.254130 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:34.255071 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp202732539987'
        
      order by ordinal_position

  
[0m20:27:34.273796 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:27:34.281487 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:34.282447 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:34.301884 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:27:34.317172 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:34.317949 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp202732539987'
        
      order by ordinal_position

  
[0m20:27:34.323008 [debug] [Thread-3  ]: SQL status: SELECT 73015 in 2.0 seconds
[0m20:27:34.327507 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:34.328257 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp202732562798'
        
      order by ordinal_position

  
[0m20:27:34.329188 [debug] [Thread-2  ]: SQL status: SELECT 73015 in 2.0 seconds
[0m20:27:34.335202 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:34.335883 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp202732551860'
        
      order by ordinal_position

  
[0m20:27:34.336720 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:27:34.345634 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:27:34.347653 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:34.348240 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:27:34.348891 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp202732539987" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp202732539987" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:27:34.353566 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:34.354178 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:27:34.354792 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:34.358735 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:34.359333 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:34.380639 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:27:34.384966 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:34.385525 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp202732551860'
        
      order by ordinal_position

  
[0m20:27:34.392983 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:27:34.397250 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:34.397802 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp202732562798'
        
      order by ordinal_position

  
[0m20:27:34.408594 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:27:34.412951 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:34.413508 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:34.423447 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:27:34.427733 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:34.428288 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:27:34.434710 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:27:34.439261 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:34.439811 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp202732551860'
        
      order by ordinal_position

  
[0m20:27:34.454741 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:27:34.459700 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:34.460281 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp202732562798'
        
      order by ordinal_position

  
[0m20:27:34.465389 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:27:34.468597 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:27:34.470532 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:34.471139 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp202732551860" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp202732551860" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:27:34.479296 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:27:34.482675 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:27:34.484771 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:34.485322 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp202732562798" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp202732562798" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:27:35.504594 [debug] [Thread-1  ]: SQL status: INSERT 0 36901 in 1.0 seconds
[0m20:27:35.541044 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:27:35.541875 [debug] [Thread-2  ]: SQL status: INSERT 0 36901 in 1.0 seconds
[0m20:27:35.542552 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:27:35.544950 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:27:35.545551 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:27:35.546111 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:27:35.546771 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:27:35.570460 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:27:35.574846 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:27:32.232816 => 20:27:35.574531
[0m20:27:35.575455 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:27:35.576017 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:27:35.577520 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:27:32.258554 => 20:27:35.577252
[0m20:27:35.578182 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:27:35.579310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16b02fe80>]}
[0m20:27:35.581649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1488b8d30>]}
[0m20:27:35.580856 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 36901[0m in 3.38s]
[0m20:27:35.582659 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 36901[0m in 3.38s]
[0m20:27:35.583527 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:27:35.584268 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:27:35.688030 [debug] [Thread-3  ]: SQL status: INSERT 0 36901 in 1.0 seconds
[0m20:27:35.691838 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:27:35.692764 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:27:35.693570 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:27:35.719464 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:27:35.722233 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:27:32.290126 => 20:27:35.721814
[0m20:27:35.723143 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:27:35.725031 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d0faced-f118-48ad-b254-479a58e9b99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc14899a100>]}
[0m20:27:35.726596 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 36901[0m in 3.52s]
[0m20:27:35.727912 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:27:35.730595 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:35.731258 [debug] [MainThread]: On master: BEGIN
[0m20:27:35.731813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:35.907798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:27:35.909948 [debug] [MainThread]: On master: COMMIT
[0m20:27:35.911027 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:35.911748 [debug] [MainThread]: On master: COMMIT
[0m20:27:35.927050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:27:35.928225 [debug] [MainThread]: On master: Close
[0m20:27:35.930783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:35.931896 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:27:35.932707 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:27:35.933369 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:27:35.934139 [info ] [MainThread]: 
[0m20:27:35.934982 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m20:27:35.937168 [debug] [MainThread]: Command end result
[0m20:27:35.997914 [info ] [MainThread]: 
[0m20:27:35.998389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:35.998712 [info ] [MainThread]: 
[0m20:27:35.999041 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:27:35.999637 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:27:35.999545 after 4.80 seconds
[0m20:27:36.000031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc168af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc169d49d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16ada2a30>]}
[0m20:27:36.000386 [debug] [MainThread]: Flushing usage events
[0m20:30:28.679780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca489e16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b2f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b2f8940>]}


============================== 20:30:28.683873 | 5003004d-7f83-4100-8d03-80361d7b09e8 ==============================
[0m20:30:28.683873 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:30:28.684554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:30:28.822960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b2f8880>]}
[0m20:30:28.833567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b3a0280>]}
[0m20:30:28.834115 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:30:28.858178 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:30:28.885593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:28.885977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:28.886583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m20:30:28.891412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b43f0d0>]}
[0m20:30:28.905680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58243b20>]}
[0m20:30:28.906106 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:30:28.906391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58243e80>]}
[0m20:30:28.907850 [info ] [MainThread]: 
[0m20:30:28.908547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:28.909750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:30:28.918304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:30:28.918704 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:30:28.918967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:29.158516 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m20:30:29.161594 [debug] [ThreadPool]: On list_postgres: Close
[0m20:30:29.164200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:30:29.172435 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:30:29.172893 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:30:29.173269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:29.349697 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:30:29.351619 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:30:29.352817 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:30:29.373178 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:30:29.377867 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:30:29.392042 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:30:29.407103 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.407803 [debug] [MainThread]: On master: BEGIN
[0m20:30:29.408364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:29.580038 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:29.581901 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.583411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:29.604674 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:30:29.608626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58243310>]}
[0m20:30:29.610212 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:29.624553 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.625742 [debug] [MainThread]: On master: BEGIN
[0m20:30:29.655793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:29.657565 [debug] [MainThread]: On master: COMMIT
[0m20:30:29.658671 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.659741 [debug] [MainThread]: On master: COMMIT
[0m20:30:29.674200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:29.675225 [debug] [MainThread]: On master: Close
[0m20:30:29.677430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:29.678408 [info ] [MainThread]: 
[0m20:30:29.684870 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:30:29.685899 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:30:29.687238 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:30:29.688337 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:30:29.689470 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:30:29.690492 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:30:29.692041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:30:29.693578 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:30:29.695222 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:30:29.696133 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:30:29.696840 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:30:29.697502 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:30:29.711878 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:30:29.698011 => 20:30:29.711413
[0m20:30:29.717903 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:30:29.712471 => 20:30:29.717611
[0m20:30:29.721978 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:30:29.718347 => 20:30:29.721741
[0m20:30:29.722522 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:30:29.723031 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:30:29.723492 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:30:29.780504 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:29.782183 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:29.784530 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:29.784815 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:30:29.785104 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:30:29.785379 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:30:29.785644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:29.785900 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:30:29.786149 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:30:29.964800 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:30:29.965736 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:30:29.966445 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:29.967066 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:30:29.967750 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:29.968484 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:29.969192 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:29.969889 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:29.970773 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:30.002850 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:30:30.016665 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:30:30.030185 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:30:30.046516 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:30.049215 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:30.051985 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:30.052547 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp203030030689"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:30:30.053209 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp203030048413"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:30:30.053876 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp203030051170"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:30:32.218419 [debug] [Thread-1  ]: SQL status: SELECT 71008 in 2.0 seconds
[0m20:30:32.221102 [debug] [Thread-2  ]: SQL status: SELECT 71008 in 2.0 seconds
[0m20:30:32.232327 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:32.238238 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:32.239145 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203030048413'
        
      order by ordinal_position

  
[0m20:30:32.239902 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203030030689'
        
      order by ordinal_position

  
[0m20:30:32.258923 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:30:32.259892 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:30:32.267177 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:32.273059 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:32.273871 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:32.274638 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:32.294153 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:30:32.294881 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:30:32.300983 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:32.306706 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:32.307360 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203030048413'
        
      order by ordinal_position

  
[0m20:30:32.308043 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203030030689'
        
      order by ordinal_position

  
[0m20:30:32.326905 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:30:32.332611 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:32.333333 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:30:32.334036 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:32.341187 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:32.341919 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:32.365976 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:30:32.366694 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:30:32.378058 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:32.383265 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:32.383865 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203030048413'
        
      order by ordinal_position

  
[0m20:30:32.384423 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203030030689'
        
      order by ordinal_position

  
[0m20:30:32.414633 [debug] [Thread-3  ]: SQL status: SELECT 71008 in 2.0 seconds
[0m20:30:32.419320 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:32.419951 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203030051170'
        
      order by ordinal_position

  
[0m20:30:32.422047 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:30:32.422645 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:30:32.432125 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:30:32.435484 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:30:32.437881 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:32.438523 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp203030030689" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp203030030689" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:30:32.439189 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:32.439782 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:30:32.440450 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp203030048413" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp203030048413" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:30:32.445063 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:32.445655 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:32.484825 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:30:32.490264 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:32.490919 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203030051170'
        
      order by ordinal_position

  
[0m20:30:32.517436 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:30:32.523254 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:32.524032 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:30:32.544583 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:30:32.552457 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:32.553280 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203030051170'
        
      order by ordinal_position

  
[0m20:30:32.573127 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:30:32.579099 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:30:32.581686 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:32.582534 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp203030051170" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp203030051170" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:30:33.547972 [debug] [Thread-2  ]: SQL status: INSERT 0 36057 in 1.0 seconds
[0m20:30:33.550060 [debug] [Thread-1  ]: SQL status: INSERT 0 36057 in 1.0 seconds
[0m20:30:33.592173 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:30:33.588441 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:30:33.593186 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:30:33.593697 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:30:33.594193 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:30:33.594667 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:30:33.700782 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:30:33.708773 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:30:33.711343 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:30:29.723828 => 20:30:33.710922
[0m20:30:33.713593 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:30:29.749689 => 20:30:33.713192
[0m20:30:33.714440 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:30:33.715257 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:30:33.717208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca38055280>]}
[0m20:30:33.718697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b4e9d60>]}
[0m20:30:33.720736 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 36057[0m in 4.03s]
[0m20:30:33.722029 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 36057[0m in 4.03s]
[0m20:30:33.723171 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:30:33.724174 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:30:33.742044 [debug] [Thread-3  ]: SQL status: INSERT 0 36057 in 1.0 seconds
[0m20:30:33.745079 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:30:33.745964 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:30:33.746659 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:30:33.766621 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:30:33.768745 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:30:29.762282 => 20:30:33.768427
[0m20:30:33.769456 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:30:33.771059 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5003004d-7f83-4100-8d03-80361d7b09e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4b4ffc70>]}
[0m20:30:33.772343 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 36057[0m in 4.08s]
[0m20:30:33.773388 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:30:33.776043 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:33.776716 [debug] [MainThread]: On master: BEGIN
[0m20:30:33.777195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:33.936351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:33.936998 [debug] [MainThread]: On master: COMMIT
[0m20:30:33.937443 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:33.937857 [debug] [MainThread]: On master: COMMIT
[0m20:30:33.953977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:33.954461 [debug] [MainThread]: On master: Close
[0m20:30:33.955596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:33.956063 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:30:33.956442 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:30:33.956814 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:30:33.957259 [info ] [MainThread]: 
[0m20:30:33.957733 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m20:30:33.958943 [debug] [MainThread]: Command end result
[0m20:30:34.006213 [info ] [MainThread]: 
[0m20:30:34.006642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:34.006927 [info ] [MainThread]: 
[0m20:30:34.007242 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:30:34.007849 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:30:34.007752 after 5.36 seconds
[0m20:30:34.008209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca489e16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4a48aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca285b8ee0>]}
[0m20:30:34.008549 [debug] [MainThread]: Flushing usage events
[0m20:34:42.786627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f0b116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f31f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f31f8940>]}


============================== 20:34:42.791085 | 15952496-f3e8-4587-81b7-3122c5c546c9 ==============================
[0m20:34:42.791085 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:34:42.791792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:42.929638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f31f8880>]}
[0m20:34:42.940492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3001a7280>]}
[0m20:34:42.941028 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:34:42.958148 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:34:42.986793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:34:42.987185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:34:42.987780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
- models.bde.staging
[0m20:34:42.992618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3001ef0d0>]}
[0m20:34:43.006542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e05ebb20>]}
[0m20:34:43.007003 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:34:43.007304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e05ebe80>]}
[0m20:34:43.008605 [info ] [MainThread]: 
[0m20:34:43.009254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:43.010325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:34:43.018577 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:34:43.018981 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:34:43.019238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:43.234414 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:34:43.236843 [debug] [ThreadPool]: On list_postgres: Close
[0m20:34:43.240049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:34:43.247142 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:34:43.247612 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:34:43.247993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:43.422087 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:34:43.423140 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:34:43.423974 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:34:43.446225 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:34:43.450422 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:34:43.466018 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:34:43.479805 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:43.480622 [debug] [MainThread]: On master: BEGIN
[0m20:34:43.481251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:43.715823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:43.717342 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:43.718530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:43.743494 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:34:43.747470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e05eb310>]}
[0m20:34:43.748754 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:43.763055 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:43.764120 [debug] [MainThread]: On master: BEGIN
[0m20:34:43.794593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:43.796613 [debug] [MainThread]: On master: COMMIT
[0m20:34:43.797859 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:43.798537 [debug] [MainThread]: On master: COMMIT
[0m20:34:43.813036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:34:43.814368 [debug] [MainThread]: On master: Close
[0m20:34:43.817055 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:34:43.818297 [info ] [MainThread]: 
[0m20:34:43.824627 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:34:43.825658 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:34:43.827024 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:34:43.828154 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:34:43.829324 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:34:43.830213 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:34:43.831474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:34:43.832836 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:34:43.834116 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:34:43.834899 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:34:43.835630 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:34:43.836296 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:34:43.850621 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:34:43.836817 => 20:34:43.850101
[0m20:34:43.856840 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:34:43.851150 => 20:34:43.856507
[0m20:34:43.861017 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:34:43.857340 => 20:34:43.860768
[0m20:34:43.861524 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:34:43.861981 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:34:43.862475 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:34:43.911061 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:43.913513 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:43.916796 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:43.917129 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:34:43.917419 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:34:43.917698 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:34:43.917961 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:34:43.918231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:34:43.918484 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:34:44.089670 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:34:44.090597 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:44.091356 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:44.093834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:34:44.094509 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:44.095208 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:44.095981 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:34:44.096769 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:44.097468 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:44.140736 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:34:44.150986 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:34:44.151996 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:34:44.214796 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:44.217208 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:44.217706 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:44.218141 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp203444182390"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:34:44.218696 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp203444187755"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:34:44.219253 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp203444205463"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:34:46.938748 [debug] [Thread-1  ]: SQL status: SELECT 59101 in 3.0 seconds
[0m20:34:46.949590 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:46.950798 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203444182390'
        
      order by ordinal_position

  
[0m20:34:46.975558 [debug] [Thread-2  ]: SQL status: SELECT 59101 in 3.0 seconds
[0m20:34:46.976625 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:34:46.983022 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:46.990487 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:46.991247 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203444187755'
        
      order by ordinal_position

  
[0m20:34:46.992029 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:47.011793 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:34:47.018873 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:47.019682 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203444182390'
        
      order by ordinal_position

  
[0m20:34:47.020426 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:34:47.026178 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:47.026957 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:47.039790 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:34:47.045710 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:47.046483 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:47.056589 [debug] [Thread-3  ]: SQL status: SELECT 59101 in 3.0 seconds
[0m20:34:47.061151 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:47.061857 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:34:47.062547 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203444205463'
        
      order by ordinal_position

  
[0m20:34:47.069563 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:34:47.070447 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:47.080173 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:47.080790 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203444187755'
        
      order by ordinal_position

  
[0m20:34:47.081378 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203444182390'
        
      order by ordinal_position

  
[0m20:34:47.092024 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:34:47.096338 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:47.096898 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:47.102687 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:34:47.103205 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:34:47.107649 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:47.114805 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:34:47.115380 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:47.116313 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:34:47.120043 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:47.120494 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203444205463'
        
      order by ordinal_position

  
[0m20:34:47.121078 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:47.121551 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp203444182390" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp203444182390" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:34:47.133869 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:34:47.137731 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:47.138188 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203444187755'
        
      order by ordinal_position

  
[0m20:34:47.142545 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:34:47.145918 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:47.146350 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:34:47.158106 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:34:47.160864 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:34:47.162089 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:47.162571 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp203444187755" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp203444187755" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:34:47.169717 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:34:47.173382 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:47.173825 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203444205463'
        
      order by ordinal_position

  
[0m20:34:47.193173 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:34:47.196295 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:34:47.197902 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:47.198448 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp203444205463" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp203444205463" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:34:48.034977 [debug] [Thread-1  ]: SQL status: INSERT 0 29940 in 1.0 seconds
[0m20:34:48.037740 [debug] [Thread-2  ]: SQL status: INSERT 0 29940 in 1.0 seconds
[0m20:34:48.065138 [debug] [Thread-3  ]: SQL status: INSERT 0 29940 in 1.0 seconds
[0m20:34:48.070637 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:34:48.073034 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:34:48.077505 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:34:48.078077 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:34:48.078603 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:34:48.079096 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:34:48.079629 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:34:48.080154 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:34:48.080640 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:34:48.138071 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:34:48.138888 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:34:48.139597 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:34:48.144904 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:34:43.895189 => 20:34:48.144541
[0m20:34:48.146733 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:34:43.862849 => 20:34:48.146424
[0m20:34:48.148556 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:34:43.913783 => 20:34:48.148257
[0m20:34:48.149304 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:34:48.149933 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:34:48.150520 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:34:48.152066 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f32a5d00>]}
[0m20:34:48.153130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e05eb190>]}
[0m20:34:48.154109 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15952496-f3e8-4587-81b7-3122c5c546c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f32e3d60>]}
[0m20:34:48.155721 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 29940[0m in 4.32s]
[0m20:34:48.156910 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 29940[0m in 4.32s]
[0m20:34:48.158066 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 29940[0m in 4.32s]
[0m20:34:48.159011 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:34:48.159767 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:34:48.160480 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:34:48.162448 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:48.162921 [debug] [MainThread]: On master: BEGIN
[0m20:34:48.163318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:48.348977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:48.350957 [debug] [MainThread]: On master: COMMIT
[0m20:34:48.352269 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:48.353024 [debug] [MainThread]: On master: COMMIT
[0m20:34:48.367540 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:34:48.368468 [debug] [MainThread]: On master: Close
[0m20:34:48.370553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:48.371365 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:34:48.372018 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:34:48.372636 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:34:48.373408 [info ] [MainThread]: 
[0m20:34:48.374241 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m20:34:48.376359 [debug] [MainThread]: Command end result
[0m20:34:48.437380 [info ] [MainThread]: 
[0m20:34:48.437850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:48.438176 [info ] [MainThread]: 
[0m20:34:48.438509 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:34:48.439074 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:34:48.438986 after 5.68 seconds
[0m20:34:48.439436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2f0b116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2d01e2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e0488ee0>]}
[0m20:34:48.439778 [debug] [MainThread]: Flushing usage events
[0m20:38:12.539141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf68b696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b037850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b037940>]}


============================== 20:38:12.543092 | 68b84efe-f739-43b4-b665-d1721b6212ef ==============================
[0m20:38:12.543092 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:38:12.543718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:38:12.680475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b0378e0>]}
[0m20:38:12.691232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b130280>]}
[0m20:38:12.691790 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:38:12.710988 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:38:12.737267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:38:12.737710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:38:12.738349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m20:38:12.743105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b3000d0>]}
[0m20:38:12.756374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b243b20>]}
[0m20:38:12.756899 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:38:12.757214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b243e80>]}
[0m20:38:12.758883 [info ] [MainThread]: 
[0m20:38:12.759578 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:12.760714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:38:12.768538 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:38:12.768854 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:38:12.769103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:13.122526 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:38:13.124519 [debug] [ThreadPool]: On list_postgres: Close
[0m20:38:13.126511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:38:13.137688 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:38:13.138364 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:38:13.138927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:13.374182 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:38:13.376553 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:38:13.377615 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:38:13.396419 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:38:13.401479 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:38:13.416081 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:38:13.431472 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:13.432438 [debug] [MainThread]: On master: BEGIN
[0m20:38:13.433018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:13.679582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:38:13.681062 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:13.682261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:13.706712 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:38:13.711633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b243310>]}
[0m20:38:13.713352 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:13.728511 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:13.729557 [debug] [MainThread]: On master: BEGIN
[0m20:38:13.762570 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:38:13.764001 [debug] [MainThread]: On master: COMMIT
[0m20:38:13.765087 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:13.766021 [debug] [MainThread]: On master: COMMIT
[0m20:38:13.779649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:38:13.780571 [debug] [MainThread]: On master: Close
[0m20:38:13.782727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:13.783714 [info ] [MainThread]: 
[0m20:38:13.790344 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:38:13.791445 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:38:13.792662 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:38:13.794164 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:38:13.795111 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:38:13.796319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:38:13.797119 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:38:13.798357 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:38:13.799058 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:38:13.800273 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:38:13.800928 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:38:13.815312 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:38:13.801425 => 20:38:13.814856
[0m20:38:13.816042 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:38:13.821783 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:38:13.816474 => 20:38:13.821391
[0m20:38:13.822505 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:38:13.826933 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:38:13.822926 => 20:38:13.826693
[0m20:38:13.827424 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:38:13.860237 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:38:13.870101 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:13.873424 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:13.876722 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:13.877054 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:38:13.877341 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:38:13.877617 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:38:13.877899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:38:13.878170 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:38:13.878427 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:38:14.065355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:38:14.066502 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:38:14.067308 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:14.067944 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:38:14.068635 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:14.069387 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:14.070102 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:14.070798 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:14.071670 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:14.109236 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:38:14.120627 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:38:14.129659 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:38:14.163117 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:14.165120 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:14.167894 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:14.168457 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp203814140065"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:38:14.169105 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp203814154821"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:38:14.169746 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp203814167095"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:38:17.350534 [debug] [Thread-1  ]: SQL status: SELECT 69110 in 3.0 seconds
[0m20:38:17.360612 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:17.361744 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203814140065'
        
      order by ordinal_position

  
[0m20:38:17.390431 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:38:17.399160 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:17.400196 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:17.424557 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:38:17.432222 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:17.433226 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203814140065'
        
      order by ordinal_position

  
[0m20:38:17.457648 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:38:17.466162 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:17.467050 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:17.492511 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:38:17.508455 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:17.509302 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp203814140065'
        
      order by ordinal_position

  
[0m20:38:17.517755 [debug] [Thread-2  ]: SQL status: SELECT 69110 in 3.0 seconds
[0m20:38:17.522353 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:17.523137 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203814154821'
        
      order by ordinal_position

  
[0m20:38:17.527397 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:38:17.537725 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:38:17.540129 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:17.540868 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp203814140065" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp203814140065" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:38:17.552382 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:38:17.557593 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:17.558277 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:17.602012 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:38:17.611647 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:17.612420 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203814154821'
        
      order by ordinal_position

  
[0m20:38:17.636587 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:38:17.644122 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:17.644915 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:17.669547 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:38:17.676805 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:17.677744 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp203814154821'
        
      order by ordinal_position

  
[0m20:38:17.700907 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:38:17.707334 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:38:17.708842 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:17.709815 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp203814154821" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp203814154821" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:38:18.272490 [debug] [Thread-3  ]: SQL status: SELECT 69110 in 4.0 seconds
[0m20:38:18.283258 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.284362 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203814167095'
        
      order by ordinal_position

  
[0m20:38:18.305044 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:38:18.314155 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.315226 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:18.335820 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:38:18.342992 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.343905 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203814167095'
        
      order by ordinal_position

  
[0m20:38:18.355694 [debug] [Thread-1  ]: SQL status: INSERT 0 34829 in 1.0 seconds
[0m20:38:18.370320 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:38:18.383967 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:38:18.388744 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.389328 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:38:18.389916 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:38:18.390452 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:38:18.411554 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:38:18.417083 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.417661 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp203814167095'
        
      order by ordinal_position

  
[0m20:38:18.438645 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:38:18.442815 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:38:18.445008 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.445716 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp203814167095" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp203814167095" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:38:18.465044 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:38:18.470351 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:38:13.827753 => 20:38:18.470002
[0m20:38:18.471085 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:38:18.472730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48544f40>]}
[0m20:38:18.474469 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 34829[0m in 4.68s]
[0m20:38:18.475480 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:38:18.479555 [debug] [Thread-2  ]: SQL status: INSERT 0 34829 in 1.0 seconds
[0m20:38:18.481896 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:38:18.482511 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:38:18.483048 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:38:18.504862 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:38:18.506711 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:38:13.870386 => 20:38:18.506464
[0m20:38:18.507273 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:38:18.508475 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48560fd0>]}
[0m20:38:18.509446 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 34829[0m in 4.71s]
[0m20:38:18.510239 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:38:18.987178 [debug] [Thread-3  ]: SQL status: INSERT 0 34829 in 1.0 seconds
[0m20:38:18.995834 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:38:18.997360 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:38:18.998237 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:38:19.080597 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:38:19.085340 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:38:13.873700 => 20:38:19.084853
[0m20:38:19.086342 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:38:19.088953 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b84efe-f739-43b4-b665-d1721b6212ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6b3b7fa0>]}
[0m20:38:19.090698 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 34829[0m in 5.29s]
[0m20:38:19.092034 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:38:19.094958 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:19.095685 [debug] [MainThread]: On master: BEGIN
[0m20:38:19.096337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:19.278974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:38:19.281271 [debug] [MainThread]: On master: COMMIT
[0m20:38:19.282191 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:19.283076 [debug] [MainThread]: On master: COMMIT
[0m20:38:19.298194 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:38:19.299574 [debug] [MainThread]: On master: Close
[0m20:38:19.302207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:19.303291 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:38:19.303966 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:38:19.304576 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:38:19.305336 [info ] [MainThread]: 
[0m20:38:19.306099 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m20:38:19.308140 [debug] [MainThread]: Command end result
[0m20:38:19.370097 [info ] [MainThread]: 
[0m20:38:19.370577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:38:19.370875 [info ] [MainThread]: 
[0m20:38:19.371189 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:38:19.371762 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:38:19.371671 after 6.86 seconds
[0m20:38:19.372125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf68b696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf69f0ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf58422a30>]}
[0m20:38:19.372462 [debug] [MainThread]: Flushing usage events
[0m20:41:48.811703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86309716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632c78790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632c78880>]}


============================== 20:41:48.815888 | 507cdad6-1f7b-4aea-b2da-f68c31821a9d ==============================
[0m20:41:48.815888 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:41:48.816574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:41:48.954003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632c923d0>]}
[0m20:41:48.964878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632dad1c0>]}
[0m20:41:48.965428 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:41:48.983359 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:41:49.012553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:49.012945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:49.013530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.staging
- models.bde.warehouse
- models.bde.datamart
[0m20:41:49.018169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86401c00d0>]}
[0m20:41:49.033009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8610d1ba60>]}
[0m20:41:49.033478 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:41:49.033795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8610d1bdc0>]}
[0m20:41:49.035290 [info ] [MainThread]: 
[0m20:41:49.036019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:41:49.037148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:41:49.045005 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:41:49.045355 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:41:49.045605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:49.277222 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:41:49.279612 [debug] [ThreadPool]: On list_postgres: Close
[0m20:41:49.281971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:41:49.289209 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:41:49.289654 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:41:49.290025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:49.453969 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:41:49.455027 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:41:49.456021 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:41:49.475028 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:41:49.479851 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:41:49.493541 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:41:49.508841 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:49.509747 [debug] [MainThread]: On master: BEGIN
[0m20:41:49.510435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:49.709194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:49.711369 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:49.712915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:41:49.734582 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:41:49.738715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8610d1bbe0>]}
[0m20:41:49.740115 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:49.755976 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:49.756924 [debug] [MainThread]: On master: BEGIN
[0m20:41:49.789796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:49.791866 [debug] [MainThread]: On master: COMMIT
[0m20:41:49.792965 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:49.793951 [debug] [MainThread]: On master: COMMIT
[0m20:41:49.809428 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:41:49.810700 [debug] [MainThread]: On master: Close
[0m20:41:49.814080 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:49.815197 [info ] [MainThread]: 
[0m20:41:49.821156 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:41:49.822205 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:41:49.823618 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:41:49.824801 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:41:49.826063 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:41:49.827248 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:41:49.828826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:41:49.830358 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:41:49.831644 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:41:49.832562 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:41:49.833349 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:41:49.834043 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:41:49.848594 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:41:49.834603 => 20:41:49.848074
[0m20:41:49.854854 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:41:49.849193 => 20:41:49.854514
[0m20:41:49.859055 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:41:49.855335 => 20:41:49.858775
[0m20:41:49.859626 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:41:49.860134 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:41:49.860620 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:41:49.910859 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:49.911503 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:49.914863 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:49.915215 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:41:49.915507 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:41:49.915791 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:41:49.916068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:41:49.916342 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:41:49.916609 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:41:50.082900 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:41:50.083732 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:50.084279 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:50.086763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:41:50.087251 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:50.087781 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:50.092105 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:41:50.092588 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:50.093104 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:50.117317 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:41:50.128783 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:41:50.129469 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:41:50.165531 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:50.167515 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:50.169856 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:50.170344 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp204150142185"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:41:50.170926 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp204150150515"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:41:50.171497 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp204150169189"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:41:54.040016 [debug] [Thread-1  ]: SQL status: SELECT 67946 in 4.0 seconds
[0m20:41:54.050479 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:54.051579 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204150169189'
        
      order by ordinal_position

  
[0m20:41:54.070712 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:41:54.078437 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:54.079390 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:54.099884 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:41:54.108940 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:54.109917 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204150169189'
        
      order by ordinal_position

  
[0m20:41:54.129148 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:41:54.137856 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:54.138809 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:54.152900 [debug] [Thread-3  ]: SQL status: SELECT 67946 in 4.0 seconds
[0m20:41:54.158790 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:54.159705 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:41:54.160716 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204150150515'
        
      order by ordinal_position

  
[0m20:41:54.172919 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:54.173745 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204150169189'
        
      order by ordinal_position

  
[0m20:41:54.182909 [debug] [Thread-2  ]: SQL status: SELECT 67946 in 4.0 seconds
[0m20:41:54.186897 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:54.187546 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204150142185'
        
      order by ordinal_position

  
[0m20:41:54.206340 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:41:54.214461 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:41:54.219529 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:41:54.220190 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:41:54.225065 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:54.229654 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:54.230464 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:54.231100 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:54.231700 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:54.232451 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp204150169189" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp204150169189" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:41:54.253675 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:41:54.258371 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:54.258951 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204150142185'
        
      order by ordinal_position

  
[0m20:41:54.270501 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:41:54.275192 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:54.275751 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204150150515'
        
      order by ordinal_position

  
[0m20:41:54.278061 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:41:54.282403 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:54.282981 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:54.296592 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:41:54.301491 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:54.302041 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:41:54.304081 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:41:54.308731 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:54.309323 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204150142185'
        
      order by ordinal_position

  
[0m20:41:54.321909 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:41:54.326809 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:54.327384 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204150150515'
        
      order by ordinal_position

  
[0m20:41:54.329786 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:41:54.333020 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:41:54.333979 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:54.334600 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp204150142185" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp204150142185" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:41:54.347319 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:41:54.350684 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:41:54.352358 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:54.352993 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp204150150515" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp204150150515" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:41:55.472676 [debug] [Thread-1  ]: SQL status: INSERT 0 34276 in 1.0 seconds
[0m20:41:55.475264 [debug] [Thread-2  ]: SQL status: INSERT 0 34276 in 1.0 seconds
[0m20:41:55.476656 [debug] [Thread-3  ]: SQL status: INSERT 0 34276 in 1.0 seconds
[0m20:41:55.516420 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:41:55.515948 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:41:55.518858 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:41:55.519430 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:41:55.519969 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:41:55.520452 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:41:55.520954 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:41:55.521429 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:41:55.521903 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:41:55.543392 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:41:55.543949 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:41:55.589327 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:41:55.590692 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:41:49.893487 => 20:41:55.590532
[0m20:41:55.591555 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:41:49.860979 => 20:41:55.591414
[0m20:41:55.592351 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:41:49.911748 => 20:41:55.592213
[0m20:41:55.592685 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:41:55.593001 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:41:55.593305 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:41:55.594103 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8631f1ab20>]}
[0m20:41:55.594700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632e413a0>]}
[0m20:41:55.595284 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '507cdad6-1f7b-4aea-b2da-f68c31821a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86302b6d60>]}
[0m20:41:55.596121 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 34276[0m in 5.76s]
[0m20:41:55.596733 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 34276[0m in 5.77s]
[0m20:41:55.597349 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 34276[0m in 5.77s]
[0m20:41:55.597826 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:41:55.598260 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:41:55.598672 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:41:55.599802 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:55.600084 [debug] [MainThread]: On master: BEGIN
[0m20:41:55.600325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:55.780790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:41:55.781805 [debug] [MainThread]: On master: COMMIT
[0m20:41:55.782419 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:55.782994 [debug] [MainThread]: On master: COMMIT
[0m20:41:55.799411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:41:55.800115 [debug] [MainThread]: On master: Close
[0m20:41:55.801712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:55.802376 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:41:55.803015 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:41:55.803639 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:41:55.804384 [info ] [MainThread]: 
[0m20:41:55.805162 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m20:41:55.807222 [debug] [MainThread]: Command end result
[0m20:41:55.819335 [info ] [MainThread]: 
[0m20:41:55.820029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:55.820540 [info ] [MainThread]: 
[0m20:41:55.821075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:41:55.822048 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:41:55.821895 after 7.04 seconds
[0m20:41:55.822682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86309716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632e966d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8610c63a60>]}
[0m20:41:55.823270 [debug] [MainThread]: Flushing usage events
[0m20:46:01.713922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb409d16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb42e2f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb42e2f910>]}


============================== 20:46:01.719353 | a9eafa54-d53c-4e7b-ace6-a0bb5b80b371 ==============================
[0m20:46:01.719353 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:46:01.720260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:46:01.874883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb42e2f8b0>]}
[0m20:46:01.900296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb42ea4250>]}
[0m20:46:01.906842 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:46:01.926673 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:46:01.954003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:01.954475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:01.955093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.staging
- models.bde.datamart
[0m20:46:01.959795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb42f370d0>]}
[0m20:46:01.973135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30602af0>]}
[0m20:46:01.973698 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:46:01.974033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb30602e50>]}
[0m20:46:01.975634 [info ] [MainThread]: 
[0m20:46:01.976303 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:01.977357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:46:01.985231 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:46:01.985590 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:46:01.985843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:02.208333 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:46:02.210844 [debug] [ThreadPool]: On list_postgres: Close
[0m20:46:02.213526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:46:02.221029 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:46:02.221483 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:46:02.221869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:02.398940 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:02.400599 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:46:02.401419 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:46:02.421900 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:46:02.426008 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:46:02.445202 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:46:02.459778 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:02.460643 [debug] [MainThread]: On master: BEGIN
[0m20:46:02.461337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:02.639064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:02.639764 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:02.640485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:02.662802 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:46:02.664758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb306021f0>]}
[0m20:46:02.665562 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:02.679671 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:02.680359 [debug] [MainThread]: On master: BEGIN
[0m20:46:02.715613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:02.716840 [debug] [MainThread]: On master: COMMIT
[0m20:46:02.717553 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:02.718271 [debug] [MainThread]: On master: COMMIT
[0m20:46:02.736078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:02.737362 [debug] [MainThread]: On master: Close
[0m20:46:02.740674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:02.741819 [info ] [MainThread]: 
[0m20:46:02.747930 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:46:02.748984 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:46:02.750342 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:46:02.751478 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:46:02.752710 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:46:02.753762 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:46:02.755290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:46:02.756799 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:46:02.758114 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:46:02.758906 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:46:02.759620 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:46:02.760269 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:46:02.774820 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:46:02.760773 => 20:46:02.774334
[0m20:46:02.781155 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:46:02.775480 => 20:46:02.780838
[0m20:46:02.785295 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:46:02.781613 => 20:46:02.785027
[0m20:46:02.785860 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:46:02.786376 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:46:02.786848 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:46:02.836644 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:02.837849 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:02.841084 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:02.841428 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:46:02.841723 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:46:02.842001 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:46:02.842270 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:46:02.842537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:02.842794 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:46:03.020842 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:46:03.021839 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:46:03.022774 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:46:03.023568 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:03.024358 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:03.025029 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:03.025735 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:03.026480 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:03.027224 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:03.057697 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:46:03.069209 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:46:03.078071 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:46:03.107895 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:03.109917 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:03.112629 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:03.113213 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp204603098701"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:46:03.113919 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp204603087353"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:46:03.114617 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp204603111848"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:46:07.680648 [debug] [Thread-1  ]: SQL status: SELECT 66971 in 5.0 seconds
[0m20:46:07.686828 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:07.687642 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204603098701'
        
      order by ordinal_position

  
[0m20:46:07.707297 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:07.714397 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:07.715321 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:07.737507 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:46:07.744791 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:07.745715 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204603098701'
        
      order by ordinal_position

  
[0m20:46:07.768117 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:07.769177 [debug] [Thread-2  ]: SQL status: SELECT 66971 in 5.0 seconds
[0m20:46:07.777591 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:07.783038 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:07.783842 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:07.784628 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204603087353'
        
      order by ordinal_position

  
[0m20:46:07.805800 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:07.812936 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:07.813805 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:46:07.814573 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:07.826379 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:07.827259 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204603098701'
        
      order by ordinal_position

  
[0m20:46:07.850354 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:07.851006 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:46:07.861429 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:46:07.868365 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:07.869217 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204603087353'
        
      order by ordinal_position

  
[0m20:46:07.870179 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:07.870798 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp204603098701" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp204603098701" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:46:07.888175 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:07.893173 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:07.893841 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:07.912028 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:46:07.917362 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:07.918018 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204603087353'
        
      order by ordinal_position

  
[0m20:46:07.943296 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:46:07.947580 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:46:07.949137 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:07.949968 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp204603087353" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp204603087353" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:46:08.004160 [debug] [Thread-3  ]: SQL status: SELECT 66971 in 5.0 seconds
[0m20:46:08.010574 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:08.011510 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204603111848'
        
      order by ordinal_position

  
[0m20:46:08.044151 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:46:08.054194 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:08.055220 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:08.083226 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:46:08.092092 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:08.093143 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204603111848'
        
      order by ordinal_position

  
[0m20:46:08.119881 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:46:08.128781 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:08.129801 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:46:08.167104 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:46:08.177900 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:08.178928 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204603111848'
        
      order by ordinal_position

  
[0m20:46:08.209753 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:46:08.217506 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:46:08.219826 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:08.220889 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp204603111848" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp204603111848" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:46:08.819865 [debug] [Thread-1  ]: SQL status: INSERT 0 33795 in 1.0 seconds
[0m20:46:08.852645 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:46:08.853407 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:46:08.853988 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:46:08.924001 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:46:08.931524 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:46:02.787228 => 20:46:08.931081
[0m20:46:08.932508 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:46:08.934428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb42fef340>]}
[0m20:46:08.936566 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 33795[0m in 6.18s]
[0m20:46:08.937728 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:46:09.020415 [debug] [Thread-2  ]: SQL status: INSERT 0 33795 in 1.0 seconds
[0m20:46:09.025667 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:46:09.026841 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:46:09.027691 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:46:09.070849 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:46:09.075162 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:46:02.819785 => 20:46:09.074610
[0m20:46:09.076231 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:46:09.078844 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb43006190>]}
[0m20:46:09.080777 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 33795[0m in 6.32s]
[0m20:46:09.082138 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:46:09.169461 [debug] [Thread-3  ]: SQL status: INSERT 0 33795 in 1.0 seconds
[0m20:46:09.175331 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:46:09.176478 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:46:09.177326 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:46:09.202097 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:46:09.205262 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:46:02.838070 => 20:46:09.204787
[0m20:46:09.206242 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:46:09.208405 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eafa54-d53c-4e7b-ace6-a0bb5b80b371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb508058b0>]}
[0m20:46:09.210107 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 33795[0m in 6.45s]
[0m20:46:09.211455 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:46:09.214240 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:09.214970 [debug] [MainThread]: On master: BEGIN
[0m20:46:09.215636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:09.395808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:09.398430 [debug] [MainThread]: On master: COMMIT
[0m20:46:09.399640 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:09.400657 [debug] [MainThread]: On master: COMMIT
[0m20:46:09.414004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:09.415237 [debug] [MainThread]: On master: Close
[0m20:46:09.418149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:09.418893 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:46:09.419526 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:46:09.420660 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:46:09.421933 [info ] [MainThread]: 
[0m20:46:09.422815 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m20:46:09.424971 [debug] [MainThread]: Command end result
[0m20:46:09.487598 [info ] [MainThread]: 
[0m20:46:09.488119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:09.488461 [info ] [MainThread]: 
[0m20:46:09.488806 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:46:09.489366 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:46:09.489279 after 7.82 seconds
[0m20:46:09.489738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb409d16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb302342b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb50518610>]}
[0m20:46:09.490091 [debug] [MainThread]: Flushing usage events
[0m20:48:44.345273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc09f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc2c90850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc2c90940>]}


============================== 20:48:44.349318 | d8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d ==============================
[0m20:48:44.349318 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:48:44.350009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:44.494281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc2c90880>]}
[0m20:48:44.505083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc2db7280>]}
[0m20:48:44.505625 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:48:44.522876 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:48:44.551940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:44.552380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:44.552992 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m20:48:44.557642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc2dff0d0>]}
[0m20:48:44.571384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb01f3b20>]}
[0m20:48:44.571826 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:48:44.572128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb01f3e80>]}
[0m20:48:44.573453 [info ] [MainThread]: 
[0m20:48:44.574053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:44.575150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:48:44.583809 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:48:44.584235 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:48:44.584496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:44.819338 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:48:44.822125 [debug] [ThreadPool]: On list_postgres: Close
[0m20:48:44.824808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:48:44.833076 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:48:44.833609 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:48:44.834032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:45.008289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:48:45.010193 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:48:45.011628 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:48:45.030675 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:48:45.035652 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:48:45.050342 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:48:45.064947 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:45.065700 [debug] [MainThread]: On master: BEGIN
[0m20:48:45.066276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:45.240929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:45.242723 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:45.243936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:45.270609 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:48:45.275516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb01f3310>]}
[0m20:48:45.276982 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:45.291874 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:45.292832 [debug] [MainThread]: On master: BEGIN
[0m20:48:45.327288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:45.329197 [debug] [MainThread]: On master: COMMIT
[0m20:48:45.330732 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:45.332163 [debug] [MainThread]: On master: COMMIT
[0m20:48:45.345867 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:45.346827 [debug] [MainThread]: On master: Close
[0m20:48:45.349362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:45.350567 [info ] [MainThread]: 
[0m20:48:45.357248 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:48:45.358279 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:48:45.359383 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:48:45.360763 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:48:45.361821 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:48:45.363144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:48:45.363960 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:48:45.365230 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:48:45.365984 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:48:45.367308 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:48:45.367988 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:48:45.382779 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:48:45.368492 => 20:48:45.382306
[0m20:48:45.383467 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:48:45.389119 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:48:45.383871 => 20:48:45.388841
[0m20:48:45.389684 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:48:45.393892 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:48:45.390060 => 20:48:45.393562
[0m20:48:45.394485 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:48:45.412287 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:48:45.437396 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:45.440690 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:45.443909 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:45.444241 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:48:45.444532 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:48:45.444817 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:48:45.445094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:45.445363 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:48:45.445630 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:48:45.608301 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:48:45.609109 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:45.609739 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:45.619491 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:48:45.620108 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:48:45.620699 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:45.621294 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:45.621897 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:45.622540 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:45.636574 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:48:45.659522 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:48:45.672787 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:48:45.684536 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:45.685871 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:45.688194 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:45.688683 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp204845660220"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:48:45.689254 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp204845667967"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:48:45.689823 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp204845687523"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:48:50.579747 [debug] [Thread-2  ]: SQL status: SELECT 66249 in 5.0 seconds
[0m20:48:50.590984 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:50.592265 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204845660220'
        
      order by ordinal_position

  
[0m20:48:50.636957 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:50.647668 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:50.648614 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:50.694310 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:48:50.703795 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:50.704814 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204845660220'
        
      order by ordinal_position

  
[0m20:48:50.729150 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:50.737451 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:50.738408 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:50.789710 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:48:50.809380 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:50.810277 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp204845660220'
        
      order by ordinal_position

  
[0m20:48:50.857389 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:50.872559 [debug] [Thread-1  ]: SQL status: SELECT 66249 in 5.0 seconds
[0m20:48:50.874304 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:48:50.879307 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:50.880320 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204845667967'
        
      order by ordinal_position

  
[0m20:48:50.882349 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:50.883185 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp204845660220" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp204845660220" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:48:50.927437 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:50.938449 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:50.939399 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:50.959304 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:48:50.966152 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:50.967083 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204845667967'
        
      order by ordinal_position

  
[0m20:48:50.985179 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:50.992255 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:50.993167 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:51.018007 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:48:51.024469 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:51.025171 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp204845667967'
        
      order by ordinal_position

  
[0m20:48:51.055709 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:48:51.060055 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:48:51.061034 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:51.061557 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp204845667967" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp204845667967" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:48:51.653965 [debug] [Thread-1  ]: SQL status: INSERT 0 33871 in 1.0 seconds
[0m20:48:51.683356 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:48:51.684233 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:48:51.684918 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:48:51.746894 [debug] [Thread-3  ]: SQL status: SELECT 66249 in 6.0 seconds
[0m20:48:51.755859 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:51.756963 [debug] [Thread-2  ]: SQL status: INSERT 0 33871 in 1.0 seconds
[0m20:48:51.757973 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204845687523'
        
      order by ordinal_position

  
[0m20:48:51.761486 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:48:51.762575 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:48:51.763407 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:48:51.792538 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:48:51.800914 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:51.801893 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:51.804371 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:48:51.805196 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:48:51.811210 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:48:45.394846 => 20:48:51.810862
[0m20:48:51.813000 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:48:45.437649 => 20:48:51.812693
[0m20:48:51.813761 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:48:51.814437 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:48:51.816241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd0e2f160>]}
[0m20:48:51.817459 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd0d59fd0>]}
[0m20:48:51.819312 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 33871[0m in 6.45s]
[0m20:48:51.821218 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:48:51.820234 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 33871[0m in 6.45s]
[0m20:48:51.822003 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:48:51.823018 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:48:51.828485 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:51.829446 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204845687523'
        
      order by ordinal_position

  
[0m20:48:51.855041 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:48:51.859183 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:51.859851 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:48:51.890413 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:48:51.896053 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:51.896585 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp204845687523'
        
      order by ordinal_position

  
[0m20:48:51.922550 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:48:51.925621 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:48:51.927965 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:51.928530 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp204845687523" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp204845687523" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:48:52.258735 [debug] [Thread-3  ]: SQL status: INSERT 0 33871 in 0.0 seconds
[0m20:48:52.266398 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:48:52.267516 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:48:52.268354 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:48:52.356414 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:48:52.361015 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:48:45.440961 => 20:48:52.360494
[0m20:48:52.362053 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:48:52.364557 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d6f905-e0f0-43be-ba6a-7e9d07fd8b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd0f11e80>]}
[0m20:48:52.366256 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 33871[0m in 7.00s]
[0m20:48:52.367660 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:48:52.370671 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:52.371481 [debug] [MainThread]: On master: BEGIN
[0m20:48:52.372191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:52.552091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:52.553910 [debug] [MainThread]: On master: COMMIT
[0m20:48:52.554920 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:52.555778 [debug] [MainThread]: On master: COMMIT
[0m20:48:52.569743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:52.570770 [debug] [MainThread]: On master: Close
[0m20:48:52.572890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:52.573781 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:48:52.574578 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:48:52.575303 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:48:52.576046 [info ] [MainThread]: 
[0m20:48:52.576871 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m20:48:52.578987 [debug] [MainThread]: Command end result
[0m20:48:52.640054 [info ] [MainThread]: 
[0m20:48:52.640529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:52.640851 [info ] [MainThread]: 
[0m20:48:52.641183 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:48:52.641753 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:48:52.641661 after 8.33 seconds
[0m20:48:52.642126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc09f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc1eb2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd0d49ee0>]}
[0m20:48:52.642466 [debug] [MainThread]: Flushing usage events
[0m20:52:06.175330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb09e16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb30887f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb30888e0>]}


============================== 20:52:06.179513 | 888fe12e-1c2b-4f13-99ba-12b7a9b76c2d ==============================
[0m20:52:06.179513 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:52:06.180193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:52:06.317109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb3088700>]}
[0m20:52:06.327804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb31ae220>]}
[0m20:52:06.328339 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:52:06.345437 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:52:06.374612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:06.375018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:06.375594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
- models.bde.staging
[0m20:52:06.380250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ec01770d0>]}
[0m20:52:06.394378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea0954ac0>]}
[0m20:52:06.394837 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:52:06.395137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea0954e20>]}
[0m20:52:06.396434 [info ] [MainThread]: 
[0m20:52:06.397085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:06.398167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:52:06.406446 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:52:06.406850 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:52:06.407105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:06.637980 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:52:06.640953 [debug] [ThreadPool]: On list_postgres: Close
[0m20:52:06.643343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:52:06.651339 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:52:06.651873 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:52:06.652302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:06.829315 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:52:06.831176 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:52:06.831972 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:52:06.851570 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:52:06.856825 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:52:06.870225 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:52:06.886232 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:06.887315 [debug] [MainThread]: On master: BEGIN
[0m20:52:06.888030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:07.069027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:52:07.070384 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:07.072141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:07.094735 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:52:07.098865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea0954be0>]}
[0m20:52:07.100286 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:07.114452 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:07.115448 [debug] [MainThread]: On master: BEGIN
[0m20:52:07.150363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:52:07.152290 [debug] [MainThread]: On master: COMMIT
[0m20:52:07.153791 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:07.155254 [debug] [MainThread]: On master: COMMIT
[0m20:52:07.169996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:52:07.171254 [debug] [MainThread]: On master: Close
[0m20:52:07.173599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:52:07.174610 [info ] [MainThread]: 
[0m20:52:07.179719 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:52:07.180741 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:52:07.182101 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:52:07.183239 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:52:07.184311 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:52:07.185323 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:52:07.186733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:52:07.187922 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:52:07.189170 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:52:07.189900 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:52:07.190559 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:52:07.191190 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:52:07.205691 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:52:07.191682 => 20:52:07.205211
[0m20:52:07.211761 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:52:07.206156 => 20:52:07.211450
[0m20:52:07.216017 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:52:07.212281 => 20:52:07.215713
[0m20:52:07.216665 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:52:07.217188 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:52:07.217712 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:52:07.270651 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:07.274015 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:07.279519 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:07.279861 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:52:07.280140 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:52:07.280411 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:52:07.280675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:07.280936 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:52:07.281192 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:52:07.460204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:52:07.461041 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:52:07.461837 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:52:07.462524 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:07.463241 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:07.463918 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:07.464681 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:07.465440 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:07.466256 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:07.498732 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:52:07.511630 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:52:07.512368 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:52:07.559030 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:07.559634 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:07.556809 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:07.560393 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp205207558276"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:52:07.561028 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp205207534997"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:52:07.561653 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp205207538091"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:52:13.074241 [debug] [Thread-1  ]: SQL status: SELECT 67009 in 6.0 seconds
[0m20:52:13.084959 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:13.086251 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp205207534997'
        
      order by ordinal_position

  
[0m20:52:13.105391 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:13.113618 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:13.114555 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:13.132723 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:52:13.140540 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:13.141488 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp205207534997'
        
      order by ordinal_position

  
[0m20:52:13.160822 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:13.168818 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:13.169748 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:13.189332 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:52:13.204068 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:13.204929 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp205207534997'
        
      order by ordinal_position

  
[0m20:52:13.223349 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:13.235507 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:52:13.236931 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:13.237779 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp205207534997" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp205207534997" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:52:13.995646 [debug] [Thread-2  ]: SQL status: SELECT 67009 in 6.0 seconds
[0m20:52:14.008003 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:14.009040 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp205207558276'
        
      order by ordinal_position

  
[0m20:52:14.029162 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:14.040533 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:14.041541 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:14.059683 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:52:14.066744 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:14.067712 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp205207558276'
        
      order by ordinal_position

  
[0m20:52:14.093184 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:14.102282 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:14.103345 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:14.131470 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:52:14.139738 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:14.140664 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp205207558276'
        
      order by ordinal_position

  
[0m20:52:14.170813 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:52:14.177400 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:52:14.179030 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:14.180029 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp205207558276" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp205207558276" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:52:14.507326 [debug] [Thread-1  ]: SQL status: INSERT 0 33902 in 1.0 seconds
[0m20:52:14.540616 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:52:14.541414 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:52:14.541990 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:52:14.555711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:52:14.559894 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:52:07.218052 => 20:52:14.559598
[0m20:52:14.560567 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:52:14.562022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea0954df0>]}
[0m20:52:14.563664 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 33902[0m in 7.38s]
[0m20:52:14.564655 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:52:14.638202 [debug] [Thread-3  ]: SQL status: SELECT 67009 in 7.0 seconds
[0m20:52:14.643602 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:14.644462 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp205207538091'
        
      order by ordinal_position

  
[0m20:52:14.673515 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:52:14.680280 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:14.681057 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:14.709107 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:52:14.716158 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:14.717079 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp205207538091'
        
      order by ordinal_position

  
[0m20:52:14.746517 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:52:14.755781 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:14.756779 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:52:14.791316 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:52:14.857411 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:14.857973 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp205207538091'
        
      order by ordinal_position

  
[0m20:52:14.885171 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:52:14.888449 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:52:14.891124 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:14.891699 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp205207538091" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp205207538091" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:52:15.224154 [debug] [Thread-2  ]: SQL status: INSERT 0 33902 in 1.0 seconds
[0m20:52:15.231935 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:52:15.233016 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:52:15.234214 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:52:15.259373 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:52:15.263849 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:52:07.237772 => 20:52:15.263285
[0m20:52:15.265013 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:52:15.267614 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb3181400>]}
[0m20:52:15.269637 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 33902[0m in 8.08s]
[0m20:52:15.271034 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:52:15.513682 [debug] [Thread-3  ]: SQL status: INSERT 0 33902 in 1.0 seconds
[0m20:52:15.521877 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:52:15.523320 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:52:15.524316 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:52:15.578975 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:52:15.581296 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:52:07.270938 => 20:52:15.580903
[0m20:52:15.582153 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:52:15.584028 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888fe12e-1c2b-4f13-99ba-12b7a9b76c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb3232be0>]}
[0m20:52:15.585595 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 33902[0m in 8.40s]
[0m20:52:15.586915 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:52:15.589509 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:15.590178 [debug] [MainThread]: On master: BEGIN
[0m20:52:15.590728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:15.761376 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:52:15.762488 [debug] [MainThread]: On master: COMMIT
[0m20:52:15.763223 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:15.763934 [debug] [MainThread]: On master: COMMIT
[0m20:52:15.781336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:52:15.782283 [debug] [MainThread]: On master: Close
[0m20:52:15.784171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:15.784854 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:52:15.785492 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:52:15.786094 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:52:15.786829 [info ] [MainThread]: 
[0m20:52:15.787590 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m20:52:15.789658 [debug] [MainThread]: Command end result
[0m20:52:15.803171 [info ] [MainThread]: 
[0m20:52:15.803934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:15.804459 [info ] [MainThread]: 
[0m20:52:15.804995 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:52:15.805945 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:52:15.805796 after 9.66 seconds
[0m20:52:15.806580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb09e16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb09d5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eb31339d0>]}
[0m20:52:15.807183 [debug] [MainThread]: Flushing usage events
[0m20:57:31.942246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa250af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa240508880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa240508970>]}


============================== 20:57:31.947898 | 80a97971-eab9-4408-9d80-14683a0b702b ==============================
[0m20:57:31.947898 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:57:31.948649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:57:32.087728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa240508910>]}
[0m20:57:32.098804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2528302b0>]}
[0m20:57:32.099367 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m20:57:32.116442 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:57:32.142955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:32.143333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:32.143924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.staging
- models.bde.warehouse
[0m20:57:32.148826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2407680d0>]}
[0m20:57:32.161733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2406aab50>]}
[0m20:57:32.162243 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m20:57:32.162559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2406aaeb0>]}
[0m20:57:32.164050 [info ] [MainThread]: 
[0m20:57:32.164764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:57:32.166052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:57:32.174092 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:57:32.174419 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:57:32.174680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:32.401221 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m20:57:32.404002 [debug] [ThreadPool]: On list_postgres: Close
[0m20:57:32.407415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m20:57:32.415016 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:57:32.415454 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m20:57:32.415824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:32.582683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:57:32.583970 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m20:57:32.585042 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:57:32.603708 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m20:57:32.608189 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m20:57:32.623165 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m20:57:32.636999 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:32.637747 [debug] [MainThread]: On master: BEGIN
[0m20:57:32.638331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:32.820922 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:57:32.822566 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:32.823808 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:57:32.844882 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:57:32.849682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2406aa310>]}
[0m20:57:32.851392 [debug] [MainThread]: On master: ROLLBACK
[0m20:57:32.865445 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:32.866482 [debug] [MainThread]: On master: BEGIN
[0m20:57:32.902345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:57:32.904460 [debug] [MainThread]: On master: COMMIT
[0m20:57:32.905988 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:32.907020 [debug] [MainThread]: On master: COMMIT
[0m20:57:32.921277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:57:32.923236 [debug] [MainThread]: On master: Close
[0m20:57:32.927304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:32.928343 [info ] [MainThread]: 
[0m20:57:32.935822 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m20:57:32.936936 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m20:57:32.938079 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m20:57:32.939394 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m20:57:32.940461 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m20:57:32.942015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m20:57:32.943029 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m20:57:32.944556 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m20:57:32.945286 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m20:57:32.946447 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m20:57:32.947112 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m20:57:32.961961 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 20:57:32.947617 => 20:57:32.961461
[0m20:57:32.962741 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m20:57:32.969449 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 20:57:32.963226 => 20:57:32.969070
[0m20:57:32.970085 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m20:57:32.974495 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 20:57:32.970488 => 20:57:32.974190
[0m20:57:32.975076 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m20:57:33.008271 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m20:57:33.018941 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:33.022296 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:33.025556 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:33.025884 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m20:57:33.026176 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m20:57:33.026450 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m20:57:33.026723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:57:33.026989 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:57:33.027253 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:57:33.197096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:57:33.198041 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:33.198727 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m20:57:33.199536 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:33.200276 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:33.201091 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:33.201845 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:57:33.202580 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:33.203295 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:33.226373 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:57:33.240582 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:57:33.247617 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:57:33.292225 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:33.293540 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:33.293903 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:33.294332 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp205733259521"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:57:33.294892 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp205733263075"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:57:33.295426 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp205733286603"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m20:57:39.231786 [debug] [Thread-1  ]: SQL status: SELECT 66838 in 6.0 seconds
[0m20:57:39.242983 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:39.244238 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp205733259521'
        
      order by ordinal_position

  
[0m20:57:39.275803 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:57:39.285591 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:39.286640 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:39.318997 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:57:39.328827 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:39.329830 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp205733259521'
        
      order by ordinal_position

  
[0m20:57:39.354069 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:57:39.363172 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:39.364163 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:39.383978 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:57:39.398742 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:39.399599 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp205733259521'
        
      order by ordinal_position

  
[0m20:57:39.418076 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:57:39.430451 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m20:57:39.433248 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:39.434006 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp205733259521" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp205733259521" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:57:39.949685 [debug] [Thread-2  ]: SQL status: SELECT 66838 in 7.0 seconds
[0m20:57:39.960848 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:39.961938 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp205733263075'
        
      order by ordinal_position

  
[0m20:57:39.981928 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:57:39.993692 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:39.994727 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:40.019514 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:57:40.027907 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:40.028846 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp205733263075'
        
      order by ordinal_position

  
[0m20:57:40.052367 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:57:40.061153 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:40.062187 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:40.083232 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m20:57:40.091659 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:40.092612 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp205733263075'
        
      order by ordinal_position

  
[0m20:57:40.117936 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m20:57:40.124383 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m20:57:40.127199 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:40.128226 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp205733263075" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp205733263075" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:57:40.333167 [debug] [Thread-1  ]: SQL status: INSERT 0 33630 in 1.0 seconds
[0m20:57:40.363366 [debug] [Thread-3  ]: SQL status: SELECT 66838 in 7.0 seconds
[0m20:57:40.368138 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:57:40.372662 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:40.373316 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m20:57:40.373944 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp205733286603'
        
      order by ordinal_position

  
[0m20:57:40.374540 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m20:57:40.395856 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:57:40.400368 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 20:57:32.975496 => 20:57:40.400074
[0m20:57:40.400964 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:57:40.401594 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m20:57:40.406867 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:40.407558 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:40.408627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa230e593d0>]}
[0m20:57:40.410073 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 33630[0m in 7.47s]
[0m20:57:40.410960 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m20:57:40.430329 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:57:40.435765 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:40.436659 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp205733286603'
        
      order by ordinal_position

  
[0m20:57:40.459852 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:57:40.465510 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:40.466174 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m20:57:40.484588 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m20:57:40.491702 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:40.492289 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp205733286603'
        
      order by ordinal_position

  
[0m20:57:40.510605 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m20:57:40.514468 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m20:57:40.516796 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:40.517546 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp205733286603" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp205733286603" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m20:57:40.817266 [debug] [Thread-2  ]: SQL status: INSERT 0 33630 in 1.0 seconds
[0m20:57:40.824055 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:57:40.825197 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m20:57:40.826194 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m20:57:40.899228 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:57:40.904254 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 20:57:33.019271 => 20:57:40.903502
[0m20:57:40.905724 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m20:57:40.907723 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa230ec81f0>]}
[0m20:57:40.909359 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 33630[0m in 7.96s]
[0m20:57:40.910706 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m20:57:41.041247 [debug] [Thread-3  ]: SQL status: INSERT 0 33630 in 1.0 seconds
[0m20:57:41.047723 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:57:41.048769 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m20:57:41.049816 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m20:57:41.096737 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m20:57:41.104139 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 20:57:33.022550 => 20:57:41.103697
[0m20:57:41.105545 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m20:57:41.107774 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a97971-eab9-4408-9d80-14683a0b702b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa230e593d0>]}
[0m20:57:41.109419 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 33630[0m in 8.16s]
[0m20:57:41.110579 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m20:57:41.111895 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:41.112479 [debug] [MainThread]: On master: BEGIN
[0m20:57:41.113135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:41.287101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:57:41.289363 [debug] [MainThread]: On master: COMMIT
[0m20:57:41.290679 [debug] [MainThread]: Using postgres connection "master"
[0m20:57:41.291594 [debug] [MainThread]: On master: COMMIT
[0m20:57:41.305307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:57:41.306233 [debug] [MainThread]: On master: Close
[0m20:57:41.308367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:41.309236 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m20:57:41.310025 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m20:57:41.310628 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m20:57:41.311371 [info ] [MainThread]: 
[0m20:57:41.312178 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m20:57:41.314260 [debug] [MainThread]: Command end result
[0m20:57:41.375370 [info ] [MainThread]: 
[0m20:57:41.375809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:41.376110 [info ] [MainThread]: 
[0m20:57:41.376418 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:57:41.376961 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:57:41.376871 after 9.48 seconds
[0m20:57:41.377313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa250af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa251a87b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2405892b0>]}
[0m20:57:41.377652 [debug] [MainThread]: Flushing usage events
[0m21:03:20.060046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81589716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815b1ef820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815b1ef910>]}


============================== 21:03:20.064114 | 668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58 ==============================
[0m21:03:20.064114 [info ] [MainThread]: Running with dbt=1.6.6
[0m21:03:20.064805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:20.202594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815b1ef8b0>]}
[0m21:03:20.213332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815b2d8250>]}
[0m21:03:20.213876 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m21:03:20.230539 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m21:03:20.259684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:20.260085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:20.260678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
- models.bde.staging
[0m21:03:20.265341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81682ff0d0>]}
[0m21:03:20.279668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8168244af0>]}
[0m21:03:20.280129 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m21:03:20.280432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8168244e50>]}
[0m21:03:20.281774 [info ] [MainThread]: 
[0m21:03:20.282438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:03:20.283499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:03:20.291695 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:03:20.292127 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:03:20.292390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:20.529044 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m21:03:20.531808 [debug] [ThreadPool]: On list_postgres: Close
[0m21:03:20.534349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m21:03:20.542821 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m21:03:20.543348 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m21:03:20.543784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:20.723293 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:03:20.724364 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m21:03:20.725199 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:03:20.747876 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m21:03:20.752594 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m21:03:20.767763 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m21:03:20.783672 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:20.784535 [debug] [MainThread]: On master: BEGIN
[0m21:03:20.785155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:20.971419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:03:20.972532 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:20.973816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:03:20.996456 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:03:20.999515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81682441f0>]}
[0m21:03:21.000717 [debug] [MainThread]: On master: ROLLBACK
[0m21:03:21.015385 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:21.016355 [debug] [MainThread]: On master: BEGIN
[0m21:03:21.048606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:03:21.051731 [debug] [MainThread]: On master: COMMIT
[0m21:03:21.053445 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:21.054449 [debug] [MainThread]: On master: COMMIT
[0m21:03:21.068981 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:03:21.070197 [debug] [MainThread]: On master: Close
[0m21:03:21.072414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:03:21.073455 [info ] [MainThread]: 
[0m21:03:21.077598 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m21:03:21.078510 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m21:03:21.079559 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m21:03:21.082857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m21:03:21.083776 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m21:03:21.084402 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m21:03:21.084938 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m21:03:21.085415 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m21:03:21.086136 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m21:03:21.093621 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 21:03:21.086421 => 21:03:21.093294
[0m21:03:21.094585 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m21:03:21.094930 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m21:03:21.095228 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m21:03:21.095507 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m21:03:21.099209 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 21:03:21.095738 => 21:03:21.099029
[0m21:03:21.114157 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 21:03:21.111084 => 21:03:21.113890
[0m21:03:21.142026 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m21:03:21.145979 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:21.146458 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m21:03:21.150327 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:21.150708 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m21:03:21.154997 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:21.155339 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m21:03:21.155644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:03:21.155951 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m21:03:21.156238 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:03:21.156680 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:03:21.334309 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:03:21.335204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:03:21.336012 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m21:03:21.336699 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:21.337424 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:21.338106 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:21.338854 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:21.339651 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:21.340425 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:21.370848 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:03:21.384274 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:03:21.391322 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:03:21.432103 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:21.435687 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:21.436158 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:21.436654 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp210321431073"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:03:21.437288 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp210321405948"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:03:21.437916 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp210321413627"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:03:28.436323 [debug] [Thread-1  ]: SQL status: SELECT 66130 in 7.0 seconds
[0m21:03:28.447152 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:28.448368 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp210321431073'
        
      order by ordinal_position

  
[0m21:03:28.466333 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:03:28.474298 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:28.475229 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:28.495875 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:03:28.503724 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:28.504660 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp210321431073'
        
      order by ordinal_position

  
[0m21:03:28.524193 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:03:28.531132 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:28.532063 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:28.535550 [debug] [Thread-2  ]: SQL status: SELECT 66130 in 7.0 seconds
[0m21:03:28.540963 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:28.541708 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp210321405948'
        
      order by ordinal_position

  
[0m21:03:28.551911 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:03:28.564748 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:28.565534 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:03:28.566384 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp210321431073'
        
      order by ordinal_position

  
[0m21:03:28.573371 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:28.574154 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:28.594128 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:03:28.604201 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m21:03:28.604827 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:03:28.609489 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:28.610087 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp210321405948'
        
      order by ordinal_position

  
[0m21:03:28.610865 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:28.611498 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp210321431073" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp210321431073" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:03:28.649125 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:03:28.655295 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:28.656015 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:28.675877 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:03:28.682109 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:28.682860 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp210321405948'
        
      order by ordinal_position

  
[0m21:03:28.702103 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:03:28.706363 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m21:03:28.708609 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:28.709428 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp210321405948" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp210321405948" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:03:29.046556 [debug] [Thread-3  ]: SQL status: SELECT 66130 in 8.0 seconds
[0m21:03:29.056836 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:29.057877 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp210321413627'
        
      order by ordinal_position

  
[0m21:03:29.086963 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m21:03:29.096216 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:29.097228 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:29.139365 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:03:29.150255 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:29.151295 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp210321413627'
        
      order by ordinal_position

  
[0m21:03:29.180858 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m21:03:29.190924 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:29.191935 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:03:29.224334 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:03:29.238478 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:29.239485 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp210321413627'
        
      order by ordinal_position

  
[0m21:03:29.276438 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m21:03:29.285682 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m21:03:29.289388 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:29.290422 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp210321413627" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp210321413627" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:03:29.764030 [debug] [Thread-2  ]: SQL status: INSERT 0 33229 in 1.0 seconds
[0m21:03:29.766535 [debug] [Thread-1  ]: SQL status: INSERT 0 33229 in 1.0 seconds
[0m21:03:29.847050 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m21:03:29.849367 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m21:03:29.849775 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:03:29.850105 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:03:29.850419 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m21:03:29.850719 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m21:03:29.897012 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m21:03:29.900357 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 21:03:21.146741 => 21:03:29.900132
[0m21:03:29.900862 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m21:03:29.901855 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8148758df0>]}
[0m21:03:29.902986 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 33229[0m in 8.82s]
[0m21:03:29.903506 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:03:29.904073 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m21:03:29.905144 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 21:03:21.099480 => 21:03:29.904955
[0m21:03:29.905675 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m21:03:29.906473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815b329c10>]}
[0m21:03:29.907171 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 33229[0m in 8.82s]
[0m21:03:29.907791 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m21:03:30.025547 [debug] [Thread-3  ]: SQL status: INSERT 0 33229 in 1.0 seconds
[0m21:03:30.028603 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m21:03:30.029368 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:03:30.030038 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m21:03:30.053305 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m21:03:30.055523 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 21:03:21.150960 => 21:03:30.055128
[0m21:03:30.056377 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m21:03:30.058137 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '668ea68d-ba1d-42c0-a0e3-7fb1bd20ae58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8148758d00>]}
[0m21:03:30.059694 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 33229[0m in 8.96s]
[0m21:03:30.060986 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m21:03:30.063791 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:30.064466 [debug] [MainThread]: On master: BEGIN
[0m21:03:30.065001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:30.253542 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:03:30.255756 [debug] [MainThread]: On master: COMMIT
[0m21:03:30.256669 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:30.257565 [debug] [MainThread]: On master: COMMIT
[0m21:03:30.275383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:03:30.276626 [debug] [MainThread]: On master: Close
[0m21:03:30.279604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:30.280538 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m21:03:30.281785 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m21:03:30.282616 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m21:03:30.283445 [info ] [MainThread]: 
[0m21:03:30.284277 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 10.00 seconds (10.00s).
[0m21:03:30.286444 [debug] [MainThread]: Command end result
[0m21:03:30.300406 [info ] [MainThread]: 
[0m21:03:30.301268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:30.301866 [info ] [MainThread]: 
[0m21:03:30.302523 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:03:30.303645 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:03:30.303471 after 10.27 seconds
[0m21:03:30.304390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81589716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8148740e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8148740df0>]}
[0m21:03:30.305012 [debug] [MainThread]: Flushing usage events
[0m21:05:43.416052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e0b316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e2e27820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e2e27910>]}


============================== 21:05:43.419940 | 5124e1f5-aefa-45d9-b364-e43a712230a0 ==============================
[0m21:05:43.419940 [info ] [MainThread]: Running with dbt=1.6.6
[0m21:05:43.420586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:05:43.562929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e2e27850>]}
[0m21:05:43.573697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e2f1e250>]}
[0m21:05:43.574234 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m21:05:43.591297 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m21:05:43.619211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:43.619642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:43.620349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
- models.bde.staging
[0m21:05:43.625189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d07e70d0>]}
[0m21:05:43.639845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c068aaf0>]}
[0m21:05:43.640523 [info ] [MainThread]: Found 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m21:05:43.640842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c068ae50>]}
[0m21:05:43.642228 [info ] [MainThread]: 
[0m21:05:43.642850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:05:43.643882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:05:43.651775 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:05:43.652201 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:05:43.652461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:43.948811 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m21:05:43.951746 [debug] [ThreadPool]: On list_postgres: Close
[0m21:05:43.955478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m21:05:43.964292 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m21:05:43.964813 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m21:05:43.965236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:44.130946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:05:44.132698 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m21:05:44.133885 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m21:05:44.153680 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m21:05:44.156815 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m21:05:44.171759 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m21:05:44.183770 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:44.184451 [debug] [MainThread]: On master: BEGIN
[0m21:05:44.185027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:44.350549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:05:44.351875 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:44.353201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:05:44.373638 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:05:44.377778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c068a1f0>]}
[0m21:05:44.379029 [debug] [MainThread]: On master: ROLLBACK
[0m21:05:44.393660 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:44.394773 [debug] [MainThread]: On master: BEGIN
[0m21:05:44.428750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:05:44.430638 [debug] [MainThread]: On master: COMMIT
[0m21:05:44.431949 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:44.432989 [debug] [MainThread]: On master: COMMIT
[0m21:05:44.447498 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:05:44.449120 [debug] [MainThread]: On master: Close
[0m21:05:44.452777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:05:44.453857 [info ] [MainThread]: 
[0m21:05:44.460870 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m21:05:44.461957 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m21:05:44.463138 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m21:05:44.464655 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m21:05:44.465616 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m21:05:44.467276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now snapshot.bde.host_snapshot)
[0m21:05:44.468304 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m21:05:44.469911 [debug] [Thread-2  ]: Acquiring new postgres connection 'snapshot.bde.property_snapshot'
[0m21:05:44.470662 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m21:05:44.471917 [debug] [Thread-3  ]: Acquiring new postgres connection 'snapshot.bde.room_snapshot'
[0m21:05:44.472605 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m21:05:44.487857 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 21:05:44.473117 => 21:05:44.487367
[0m21:05:44.488640 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m21:05:44.495057 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 21:05:44.489153 => 21:05:44.494713
[0m21:05:44.495756 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m21:05:44.500039 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 21:05:44.496196 => 21:05:44.499742
[0m21:05:44.500607 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m21:05:44.527043 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m21:05:44.543186 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:44.546606 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:44.549842 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:44.550171 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m21:05:44.550459 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m21:05:44.550742 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m21:05:44.551014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:44.551288 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:05:44.551561 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:05:44.713791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:05:44.714702 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:44.715351 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:44.719364 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:05:44.719994 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m21:05:44.720577 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:44.721218 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:44.721838 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:44.722513 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:44.748238 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:05:44.760753 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:05:44.767780 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:05:44.794999 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:44.795580 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:44.798268 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:44.798792 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

        
  
    

  create temporary table "host_snapshot__dbt_tmp210544773612"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."host_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:05:44.799413 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

        
  
    

  create temporary table "property_snapshot__dbt_tmp210544788372"
  
  
    as
  
  (
    with snapshot_query as (

        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."property_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:05:44.800029 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

        
  
    

  create temporary table "room_snapshot__dbt_tmp210544797509"
  
  
    as
  
  (
    with snapshot_query as (

        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"


    ),

    snapshotted_data as (

        select *,
            LISTING_ID as dbt_unique_key

        from "postgres"."raw"."room_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            nullif(scraped_date, scraped_date) as dbt_valid_to,
            md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LISTING_ID as dbt_unique_key,
            scraped_date as dbt_updated_at,
            scraped_date as dbt_valid_from,
            scraped_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.scraped_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.scraped_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:05:52.577495 [debug] [Thread-1  ]: SQL status: SELECT 64790 in 8.0 seconds
[0m21:05:52.588348 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:52.589591 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp210544773612'
        
      order by ordinal_position

  
[0m21:05:52.609955 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:05:52.618989 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:52.619981 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:52.639061 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:05:52.645842 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:52.646801 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp210544773612'
        
      order by ordinal_position

  
[0m21:05:52.669370 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:05:52.677123 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:52.678041 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:52.707238 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:05:52.722722 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:52.723588 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'host_snapshot__dbt_tmp210544773612'
        
      order by ordinal_position

  
[0m21:05:52.748507 [debug] [Thread-1  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:05:52.756590 [debug] [Thread-2  ]: SQL status: SELECT 64790 in 8.0 seconds
[0m21:05:52.762111 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m21:05:52.766781 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:52.767831 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp210544788372'
        
      order by ordinal_position

  
[0m21:05:52.769139 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:52.769968 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      update "postgres"."raw"."host_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "host_snapshot__dbt_tmp210544773612" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."host_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."host_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."host_snapshot" ("listing_id", "host_id", "scrape_id", "scraped_date", "host_name", "host_since", "host_is_superhost", "host_neighbourhood", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."host_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."host_name",DBT_INTERNAL_SOURCE."host_since",DBT_INTERNAL_SOURCE."host_is_superhost",DBT_INTERNAL_SOURCE."host_neighbourhood",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "host_snapshot__dbt_tmp210544773612" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:05:52.801686 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:05:52.808775 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:52.809536 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:52.828497 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:05:52.837660 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:52.838426 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp210544788372'
        
      order by ordinal_position

  
[0m21:05:52.856761 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:05:52.863714 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:52.864570 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:52.883923 [debug] [Thread-2  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:05:52.890703 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:52.891388 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'property_snapshot__dbt_tmp210544788372'
        
      order by ordinal_position

  
[0m21:05:52.914623 [debug] [Thread-2  ]: SQL status: SELECT 14 in 0.0 seconds
[0m21:05:52.919006 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m21:05:52.920290 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:52.921115 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      update "postgres"."raw"."property_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "property_snapshot__dbt_tmp210544788372" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."property_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."property_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."property_snapshot" ("listing_id", "scrape_id", "scraped_date", "listing_neighbourhood", "property_type", "room_type", "accommodates", "price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."listing_neighbourhood",DBT_INTERNAL_SOURCE."property_type",DBT_INTERNAL_SOURCE."room_type",DBT_INTERNAL_SOURCE."accommodates",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "property_snapshot__dbt_tmp210544788372" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:05:52.991065 [debug] [Thread-3  ]: SQL status: SELECT 64790 in 8.0 seconds
[0m21:05:53.000732 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:53.001954 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp210544797509'
        
      order by ordinal_position

  
[0m21:05:53.028922 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m21:05:53.038437 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:53.039426 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:53.059840 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:05:53.067779 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:53.068708 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp210544797509'
        
      order by ordinal_position

  
[0m21:05:53.089016 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m21:05:53.096832 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:53.097746 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot'
        
        and table_schema = 'raw'
        
      order by ordinal_position

  
[0m21:05:53.118092 [debug] [Thread-3  ]: SQL status: SELECT 16 in 0.0 seconds
[0m21:05:53.126279 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:53.127177 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'room_snapshot__dbt_tmp210544797509'
        
      order by ordinal_position

  
[0m21:05:53.147082 [debug] [Thread-3  ]: SQL status: SELECT 18 in 0.0 seconds
[0m21:05:53.152983 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m21:05:53.155653 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:53.156674 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      update "postgres"."raw"."room_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "room_snapshot__dbt_tmp210544797509" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."raw"."room_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."raw"."room_snapshot".dbt_valid_to is null;

    insert into "postgres"."raw"."room_snapshot" ("listing_id", "scrape_id", "scraped_date", "has_availability", "availability_30", "number_of_reviews", "review_scores_rating", "review_scores_accuracy", "review_scores_cleanliness", "review_scores_checkin", "review_scores_communication", "review_scores_value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."listing_id",DBT_INTERNAL_SOURCE."scrape_id",DBT_INTERNAL_SOURCE."scraped_date",DBT_INTERNAL_SOURCE."has_availability",DBT_INTERNAL_SOURCE."availability_30",DBT_INTERNAL_SOURCE."number_of_reviews",DBT_INTERNAL_SOURCE."review_scores_rating",DBT_INTERNAL_SOURCE."review_scores_accuracy",DBT_INTERNAL_SOURCE."review_scores_cleanliness",DBT_INTERNAL_SOURCE."review_scores_checkin",DBT_INTERNAL_SOURCE."review_scores_communication",DBT_INTERNAL_SOURCE."review_scores_value",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "room_snapshot__dbt_tmp210544797509" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:05:54.007748 [debug] [Thread-1  ]: SQL status: INSERT 0 32679 in 1.0 seconds
[0m21:05:54.040805 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m21:05:54.041606 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m21:05:54.042185 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m21:05:54.083569 [debug] [Thread-2  ]: SQL status: INSERT 0 32679 in 1.0 seconds
[0m21:05:54.086879 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m21:05:54.087754 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m21:05:54.088542 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m21:05:54.128706 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:05:54.137271 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 21:05:44.500988 => 21:05:54.136841
[0m21:05:54.138151 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m21:05:54.139130 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m21:05:54.141373 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 21:05:44.543493 => 21:05:54.140994
[0m21:05:54.142378 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m21:05:54.143956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c0809f10>]}
[0m21:05:54.147248 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c0736f70>]}
[0m21:05:54.146198 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mINSERT 0 32679[0m in 9.68s]
[0m21:05:54.148703 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mINSERT 0 32679[0m in 9.68s]
[0m21:05:54.149841 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m21:05:54.150859 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m21:05:54.225363 [debug] [Thread-3  ]: SQL status: INSERT 0 32679 in 1.0 seconds
[0m21:05:54.228927 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m21:05:54.229801 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m21:05:54.230588 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m21:05:54.272872 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m21:05:54.276863 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 21:05:44.546871 => 21:05:54.276279
[0m21:05:54.278182 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m21:05:54.280267 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5124e1f5-aefa-45d9-b364-e43a712230a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c0790a90>]}
[0m21:05:54.281845 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mINSERT 0 32679[0m in 9.81s]
[0m21:05:54.283188 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m21:05:54.286050 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:54.286773 [debug] [MainThread]: On master: BEGIN
[0m21:05:54.287428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:05:54.512657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:05:54.515662 [debug] [MainThread]: On master: COMMIT
[0m21:05:54.516723 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:54.517617 [debug] [MainThread]: On master: COMMIT
[0m21:05:54.534500 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:05:54.536238 [debug] [MainThread]: On master: Close
[0m21:05:54.538978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:54.540179 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m21:05:54.541267 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m21:05:54.541973 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m21:05:54.542763 [info ] [MainThread]: 
[0m21:05:54.543597 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 10.90 seconds (10.90s).
[0m21:05:54.545780 [debug] [MainThread]: Command end result
[0m21:05:54.609899 [info ] [MainThread]: 
[0m21:05:54.610347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:54.610644 [info ] [MainThread]: 
[0m21:05:54.610957 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:05:54.611481 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:05:54.611396 after 11.22 seconds
[0m21:05:54.611836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e0b316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e181c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d07a2dc0>]}
[0m21:05:54.612180 [debug] [MainThread]: Flushing usage events
[0m00:08:16.422600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db0bf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db2f0f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db2f0f910>]}


============================== 00:08:16.426637 | 7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7 ==============================
[0m00:08:16.426637 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:08:16.427275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:16.579330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db2f0f850>]}
[0m00:08:16.590459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db3038280>]}
[0m00:08:16.591108 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m00:08:16.607969 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:08:16.642580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m00:08:16.643113 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/host_stg.sql
[0m00:08:16.643413 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/listings_stg.sql
[0m00:08:16.643681 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m00:08:16.643950 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/room_stg.sql
[0m00:08:16.644210 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/G02_stg.sql
[0m00:08:16.644474 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/lga_stg.sql
[0m00:08:16.644724 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m00:08:16.644984 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/G01_stg.sql
[0m00:08:16.694486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
[0m00:08:16.698680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d902f1fd0>]}
[0m00:08:16.713653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db3149550>]}
[0m00:08:16.714127 [info ] [MainThread]: Found 3 snapshots, 8 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m00:08:16.714444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da0957340>]}
[0m00:08:16.717522 [info ] [MainThread]: 
[0m00:08:16.718271 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:08:16.720150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:08:16.728607 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:08:16.729088 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:08:16.729367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:17.197424 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m00:08:17.199000 [debug] [ThreadPool]: On list_postgres: Close
[0m00:08:17.200136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_staging)
[0m00:08:17.200757 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "staging"
"
[0m00:08:17.205964 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m00:08:17.206358 [debug] [ThreadPool]: On create_postgres_staging: BEGIN
[0m00:08:17.207046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:17.406577 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:08:17.408649 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m00:08:17.409622 [debug] [ThreadPool]: On create_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_staging"} */
create schema if not exists "staging"
[0m00:08:17.424924 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:08:17.428302 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m00:08:17.429229 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m00:08:17.430249 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m00:08:17.448922 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:08:17.450124 [debug] [ThreadPool]: On create_postgres_staging: Close
[0m00:08:17.456708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m00:08:17.458574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_staging, now list_postgres_staging)
[0m00:08:17.471343 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:08:17.474782 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:08:17.475484 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m00:08:17.476079 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m00:08:17.476579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:17.477040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:17.666091 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:08:17.667451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:08:17.668560 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:08:17.669461 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:08:17.670371 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m00:08:17.671484 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:08:17.695168 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:08:17.696494 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:08:17.701199 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m00:08:17.704677 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m00:08:17.719783 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m00:08:17.720662 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m00:08:17.737648 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:17.738364 [debug] [MainThread]: On master: BEGIN
[0m00:08:17.738939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:08:17.917822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:08:17.918726 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:17.919600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:08:17.954591 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:08:17.956887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d8005a310>]}
[0m00:08:17.957911 [debug] [MainThread]: On master: ROLLBACK
[0m00:08:17.973597 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:17.974406 [debug] [MainThread]: On master: BEGIN
[0m00:08:18.006514 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.007283 [debug] [MainThread]: On master: COMMIT
[0m00:08:18.007896 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:18.008458 [debug] [MainThread]: On master: COMMIT
[0m00:08:18.024187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.024862 [debug] [MainThread]: On master: Close
[0m00:08:18.026427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:08:18.027091 [info ] [MainThread]: 
[0m00:08:18.032485 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m00:08:18.033381 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m00:08:18.034094 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m00:08:18.035120 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m00:08:18.035955 [info ] [Thread-1  ]: 1 of 8 START sql view model staging.G01_stg .................................... [RUN]
[0m00:08:18.036810 [info ] [Thread-2  ]: 2 of 8 START sql view model staging.G02_stg .................................... [RUN]
[0m00:08:18.037575 [info ] [Thread-3  ]: 3 of 8 START sql view model staging.host_stg ................................... [RUN]
[0m00:08:18.038315 [info ] [Thread-4  ]: 4 of 8 START sql view model staging.lga_stg .................................... [RUN]
[0m00:08:18.039386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.G01_stg)
[0m00:08:18.040346 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.G02_stg)
[0m00:08:18.041380 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.bde.host_stg'
[0m00:08:18.042401 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.lga_stg'
[0m00:08:18.043014 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m00:08:18.043552 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m00:08:18.044035 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m00:08:18.044524 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m00:08:18.055958 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m00:08:18.059606 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m00:08:18.062988 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m00:08:18.066331 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m00:08:18.067881 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 00:08:18.044936 => 00:08:18.067567
[0m00:08:18.068402 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 00:08:18.056477 => 00:08:18.068194
[0m00:08:18.068870 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m00:08:18.069521 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 00:08:18.063490 => 00:08:18.069331
[0m00:08:18.069893 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m00:08:18.070336 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 00:08:18.060006 => 00:08:18.070152
[0m00:08:18.102107 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m00:08:18.102502 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m00:08:18.106329 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m00:08:18.106671 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m00:08:18.109549 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m00:08:18.112706 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m00:08:18.113039 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m00:08:18.113470 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m00:08:18.113854 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m00:08:18.114168 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m00:08:18.114478 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m00:08:18.114770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:08:18.115067 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m00:08:18.115337 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m00:08:18.115612 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:08:18.116021 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m00:08:18.116323 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:08:18.116751 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:08:18.292833 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.293501 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m00:08:18.294014 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m00:08:18.294577 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.295109 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m00:08:18.295611 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        TO_DATE(host_since, 'YYYY-MM-DD') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m00:08:18.298784 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.299310 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m00:08:18.299789 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m00:08:18.303701 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.304162 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m00:08:18.304616 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m00:08:18.321375 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.329021 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m00:08:18.329565 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.329944 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.330303 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.330675 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m00:08:18.333718 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m00:08:18.336768 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m00:08:18.339414 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m00:08:18.339888 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m00:08:18.340297 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m00:08:18.340673 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m00:08:18.354210 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.365879 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.366345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.366672 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.369245 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m00:08:18.370515 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m00:08:18.371753 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m00:08:18.372988 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m00:08:18.373344 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m00:08:18.373666 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m00:08:18.373976 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m00:08:18.374280 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m00:08:18.374579 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m00:08:18.374875 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m00:08:18.375177 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m00:08:18.375468 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m00:08:18.391808 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.392192 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.392512 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.392817 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.401355 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m00:08:18.436306 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m00:08:18.438331 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m00:08:18.440151 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m00:08:18.440459 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m00:08:18.440750 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m00:08:18.441029 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m00:08:18.441303 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m00:08:18.456196 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.456597 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.456924 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.458286 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 00:08:18.110001 => 00:08:18.458116
[0m00:08:18.459446 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 00:08:18.106985 => 00:08:18.459293
[0m00:08:18.459758 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.460863 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 00:08:18.102757 => 00:08:18.460722
[0m00:08:18.461200 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m00:08:18.461512 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m00:08:18.462629 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 00:08:18.070652 => 00:08:18.462486
[0m00:08:18.462970 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m00:08:18.463388 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m00:08:18.463984 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da098b1f0>]}
[0m00:08:18.464546 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db31496a0>]}
[0m00:08:18.465343 [info ] [Thread-3  ]: 3 of 8 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.42s]
[0m00:08:18.465931 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9035faf0>]}
[0m00:08:18.466451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9033fc40>]}
[0m00:08:18.466932 [info ] [Thread-4  ]: 4 of 8 OK created sql view model staging.lga_stg ............................... [[32mCREATE VIEW[0m in 0.42s]
[0m00:08:18.467453 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m00:08:18.467924 [info ] [Thread-2  ]: 2 of 8 OK created sql view model staging.G02_stg ............................... [[32mCREATE VIEW[0m in 0.43s]
[0m00:08:18.468363 [info ] [Thread-1  ]: 1 of 8 OK created sql view model staging.G01_stg ............................... [[32mCREATE VIEW[0m in 0.43s]
[0m00:08:18.468840 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m00:08:18.469206 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m00:08:18.469725 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m00:08:18.470187 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m00:08:18.470533 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m00:08:18.470895 [info ] [Thread-3  ]: 5 of 8 START sql view model staging.listings_stg ............................... [RUN]
[0m00:08:18.471311 [debug] [Thread-2  ]: Began running node model.bde.room_stg
[0m00:08:18.471676 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m00:08:18.472058 [info ] [Thread-4  ]: 6 of 8 START sql view model staging.property_stg ............................... [RUN]
[0m00:08:18.472578 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.listings_stg)
[0m00:08:18.472931 [info ] [Thread-2  ]: 7 of 8 START sql view model staging.room_stg ................................... [RUN]
[0m00:08:18.473296 [info ] [Thread-1  ]: 8 of 8 START sql view model staging.suburb_stg ................................. [RUN]
[0m00:08:18.473775 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.property_stg)
[0m00:08:18.474093 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m00:08:18.474568 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.room_stg)
[0m00:08:18.475027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.suburb_stg)
[0m00:08:18.475327 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m00:08:18.478108 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m00:08:18.478569 [debug] [Thread-2  ]: Began compiling node model.bde.room_stg
[0m00:08:18.478879 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m00:08:18.481561 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m00:08:18.484492 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.room_stg"
[0m00:08:18.486923 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m00:08:18.487750 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (compile): 00:08:18.482133 => 00:08:18.487580
[0m00:08:18.488056 [debug] [Thread-2  ]: Began executing node model.bde.room_stg
[0m00:08:18.491010 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.room_stg"
[0m00:08:18.491431 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 00:08:18.479107 => 00:08:18.491257
[0m00:08:18.491775 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 00:08:18.475543 => 00:08:18.491639
[0m00:08:18.492136 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m00:08:18.492474 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 00:08:18.484822 => 00:08:18.492342
[0m00:08:18.492791 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m00:08:18.493138 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m00:08:18.497219 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m00:08:18.497680 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m00:08:18.501131 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m00:08:18.501640 [debug] [Thread-2  ]: On model.bde.room_stg: BEGIN
[0m00:08:18.505415 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m00:08:18.505972 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:08:18.506316 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m00:08:18.506718 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m00:08:18.507139 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m00:08:18.507447 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m00:08:18.507733 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m00:08:18.508031 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:08:18.508350 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:08:18.508651 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m00:08:18.509162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:08:18.676656 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.677306 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m00:08:18.677809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.678359 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        TO_DATE(host_since, 'YYYY-MM-DD') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m00:08:18.679033 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m00:08:18.679673 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m00:08:18.680185 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.680671 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m00:08:18.681179 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m00:08:18.688331 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.688773 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m00:08:18.689251 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m00:08:18.700174 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.703822 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m00:08:18.704313 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.704732 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m00:08:18.705145 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.705562 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:18.708952 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m00:08:18.712263 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m00:08:18.715202 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m00:08:18.715634 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m00:08:18.716076 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m00:08:18.716501 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m00:08:18.723235 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.724787 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m00:08:18.725188 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m00:08:18.725566 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m00:08:18.731565 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.731994 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.733533 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m00:08:18.733923 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:18.735374 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m00:08:18.735795 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m00:08:18.737217 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m00:08:18.737628 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m00:08:18.738013 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m00:08:18.738391 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m00:08:18.738766 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m00:08:18.739198 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m00:08:18.744451 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.747189 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m00:08:18.747611 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m00:08:18.752640 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.756339 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m00:08:18.756761 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m00:08:18.759072 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.759429 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.761678 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m00:08:18.764035 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m00:08:18.764379 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.764748 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m00:08:18.765118 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m00:08:18.766374 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 00:08:18.502172 => 00:08:18.766201
[0m00:08:18.766856 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m00:08:18.767628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d90250790>]}
[0m00:08:18.768188 [info ] [Thread-1  ]: 8 of 8 OK created sql view model staging.suburb_stg ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m00:08:18.768742 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m00:08:18.769640 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.770817 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 00:08:18.497936 => 00:08:18.770662
[0m00:08:18.771174 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m00:08:18.771888 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d90376520>]}
[0m00:08:18.772377 [info ] [Thread-3  ]: 5 of 8 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m00:08:18.772884 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m00:08:18.781399 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.781830 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:18.783236 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (execute): 00:08:18.488279 => 00:08:18.783071
[0m00:08:18.784403 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 00:08:18.493348 => 00:08:18.784247
[0m00:08:18.784770 [debug] [Thread-2  ]: On model.bde.room_stg: Close
[0m00:08:18.785111 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m00:08:18.785970 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da098b1f0>]}
[0m00:08:18.786601 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1bf7a2-4fb9-45f5-8dcd-2588a705ebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db3008ee0>]}
[0m00:08:18.787124 [info ] [Thread-2  ]: 7 of 8 OK created sql view model staging.room_stg .............................. [[32mCREATE VIEW[0m in 0.31s]
[0m00:08:18.787692 [info ] [Thread-4  ]: 6 of 8 OK created sql view model staging.property_stg .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m00:08:18.788261 [debug] [Thread-2  ]: Finished running node model.bde.room_stg
[0m00:08:18.788736 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m00:08:18.791444 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:18.791731 [debug] [MainThread]: On master: BEGIN
[0m00:08:18.791983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:18.947836 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:08:18.948739 [debug] [MainThread]: On master: COMMIT
[0m00:08:18.949276 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:18.949759 [debug] [MainThread]: On master: COMMIT
[0m00:08:18.970554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:08:18.971165 [debug] [MainThread]: On master: Close
[0m00:08:18.972644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:18.973213 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m00:08:18.973759 [debug] [MainThread]: Connection 'model.bde.room_stg' was properly closed.
[0m00:08:18.974264 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m00:08:18.974764 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m00:08:18.975475 [info ] [MainThread]: 
[0m00:08:18.976127 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m00:08:18.979085 [debug] [MainThread]: Command end result
[0m00:08:18.992814 [info ] [MainThread]: 
[0m00:08:18.993472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:18.993934 [info ] [MainThread]: 
[0m00:08:18.994431 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m00:08:18.995328 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:18.995192 after 2.62 seconds
[0m00:08:18.995890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db0bf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da09897c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db26d6160>]}
[0m00:08:18.996453 [debug] [MainThread]: Flushing usage events
[0m00:17:59.269828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff600bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f05177f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f05178e0>]}


============================== 00:17:59.274133 | 598ce494-492c-4ebc-9a59-6adc8f012061 ==============================
[0m00:17:59.274133 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:17:59.274833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:17:59.426082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f0517880>]}
[0m00:17:59.437568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff603215250>]}
[0m00:17:59.438310 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m00:17:59.456747 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:17:59.486284 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 0 files added, 2 files changed.
[0m00:17:59.486760 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/property_stg.sql
[0m00:17:59.487019 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/suburb_stg.sql
[0m00:17:59.487258 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/G01_stg.sql
[0m00:17:59.487484 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/G02_stg.sql
[0m00:17:59.487704 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/room_stg.sql
[0m00:17:59.487918 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/lga_stg.sql
[0m00:17:59.488262 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m00:17:59.488574 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/listings_stg.sql
[0m00:17:59.524346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m00:17:59.528509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f05d30d0>]}
[0m00:17:59.543126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e04d2160>]}
[0m00:17:59.543594 [info ] [MainThread]: Found 3 snapshots, 2 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m00:17:59.543890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e04d21f0>]}
[0m00:17:59.545279 [info ] [MainThread]: 
[0m00:17:59.545947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:59.547214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:17:59.555502 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:17:59.555833 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:17:59.556085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:00.010740 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m00:18:00.013130 [debug] [ThreadPool]: On list_postgres: Close
[0m00:18:00.015892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m00:18:00.016998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m00:18:00.024556 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:18:00.026940 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:18:00.027384 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m00:18:00.027769 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m00:18:00.028122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:00.028440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:00.211431 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:18:00.212204 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:18:00.212793 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m00:18:00.215348 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:18:00.215888 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:18:00.216435 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:18:00.234312 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:18:00.236546 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m00:18:00.237381 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m00:18:00.239153 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m00:18:00.251621 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m00:18:00.252155 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m00:18:00.263154 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:00.263793 [debug] [MainThread]: On master: BEGIN
[0m00:18:00.264292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:00.432281 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:18:00.433289 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:00.434540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:18:00.457345 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m00:18:00.464586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e04d2190>]}
[0m00:18:00.465710 [debug] [MainThread]: On master: ROLLBACK
[0m00:18:00.479991 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:00.480890 [debug] [MainThread]: On master: BEGIN
[0m00:18:00.511658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:18:00.513711 [debug] [MainThread]: On master: COMMIT
[0m00:18:00.515251 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:00.516679 [debug] [MainThread]: On master: COMMIT
[0m00:18:00.530245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:18:00.530973 [debug] [MainThread]: On master: Close
[0m00:18:00.532728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:18:00.533515 [info ] [MainThread]: 
[0m00:18:00.540227 [debug] [Thread-1  ]: Began running node model.bde.host_stg
[0m00:18:00.541046 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m00:18:00.542021 [info ] [Thread-1  ]: 1 of 2 START sql view model staging.host_stg ................................... [RUN]
[0m00:18:00.542993 [info ] [Thread-2  ]: 2 of 2 START sql view model staging.listings_stg ............................... [RUN]
[0m00:18:00.544342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.host_stg)
[0m00:18:00.545518 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.listings_stg)
[0m00:18:00.546298 [debug] [Thread-1  ]: Began compiling node model.bde.host_stg
[0m00:18:00.546959 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m00:18:00.560217 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.host_stg"
[0m00:18:00.565718 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m00:18:00.567799 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 00:18:00.560735 => 00:18:00.567388
[0m00:18:00.568532 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (compile): 00:18:00.547467 => 00:18:00.568287
[0m00:18:00.569049 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m00:18:00.569517 [debug] [Thread-1  ]: Began executing node model.bde.host_stg
[0m00:18:00.612430 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.host_stg"
[0m00:18:00.613608 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m00:18:00.614647 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:18:00.614982 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:18:00.615298 [debug] [Thread-1  ]: On model.bde.host_stg: BEGIN
[0m00:18:00.615610 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m00:18:00.615901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:00.616186 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:18:00.786622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:18:00.787534 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:18:00.788378 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:18:00.789142 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:18:00.789948 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m00:18:00.790863 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m00:18:00.809614 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:18:00.817020 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:18:00.823261 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:18:00.827714 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:18:00.828390 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m00:18:00.829005 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m00:18:00.843909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:18:00.844574 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:18:00.868585 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m00:18:00.872554 [debug] [Thread-1  ]: On model.bde.host_stg: COMMIT
[0m00:18:00.873063 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:18:00.873534 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:18:00.873973 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m00:18:00.874399 [debug] [Thread-1  ]: On model.bde.host_stg: COMMIT
[0m00:18:00.890161 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:18:00.899493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:18:00.900677 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:18:00.904350 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:18:00.904792 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m00:18:00.905219 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m00:18:00.918387 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:18:00.920282 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (execute): 00:18:00.595078 => 00:18:00.920055
[0m00:18:00.920738 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:18:00.921184 [debug] [Thread-1  ]: On model.bde.host_stg: Close
[0m00:18:00.922596 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 00:18:00.569835 => 00:18:00.922412
[0m00:18:00.923083 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m00:18:00.923856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f0633e80>]}
[0m00:18:00.925073 [info ] [Thread-1  ]: 1 of 2 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.38s]
[0m00:18:00.925858 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598ce494-492c-4ebc-9a59-6adc8f012061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f064afd0>]}
[0m00:18:00.926469 [debug] [Thread-1  ]: Finished running node model.bde.host_stg
[0m00:18:00.927080 [info ] [Thread-2  ]: 2 of 2 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.38s]
[0m00:18:00.927782 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m00:18:00.929197 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:00.929518 [debug] [MainThread]: On master: BEGIN
[0m00:18:00.929803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:01.101527 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:18:01.102189 [debug] [MainThread]: On master: COMMIT
[0m00:18:01.102645 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:01.103059 [debug] [MainThread]: On master: COMMIT
[0m00:18:01.119853 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:18:01.120373 [debug] [MainThread]: On master: Close
[0m00:18:01.121574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:01.122046 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m00:18:01.122494 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m00:18:01.123038 [info ] [MainThread]: 
[0m00:18:01.123577 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m00:18:01.124657 [debug] [MainThread]: Command end result
[0m00:18:01.134793 [info ] [MainThread]: 
[0m00:18:01.135323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:01.135725 [info ] [MainThread]: 
[0m00:18:01.136159 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:18:01.136984 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:01.136862 after 1.91 seconds
[0m00:18:01.137483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff600bd16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff603215250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e04d2310>]}
[0m00:18:01.137940 [debug] [MainThread]: Flushing usage events
[0m01:00:43.814913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd378b696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37aef8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37aef8940>]}


============================== 01:00:43.818910 | cc710a19-dd28-4171-8424-2e5fdedecefe ==============================
[0m01:00:43.818910 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:00:43.819592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:43.974952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37aef8880>]}
[0m01:00:43.986653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37afa02b0>]}
[0m01:00:43.987485 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m01:00:44.005523 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:00:44.041077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 13 files added, 0 files changed.
[0m01:00:44.041642 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m01:00:44.041949 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m01:00:44.042215 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m01:00:44.042476 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m01:00:44.042744 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m01:00:44.043007 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_lge.sql
[0m01:00:44.043260 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/G01_stg.sql
[0m01:00:44.043523 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m01:00:44.043787 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/lga_stg.sql
[0m01:00:44.044028 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/G02_stg.sql
[0m01:00:44.044265 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/room_stg.sql
[0m01:00:44.044505 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_room.sql
[0m01:00:44.044745 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m01:00:44.105878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m01:00:44.110453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3583070d0>]}
[0m01:00:44.127455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35821e790>]}
[0m01:00:44.127924 [info ] [MainThread]: Found 3 snapshots, 15 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m01:00:44.128224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388949220>]}
[0m01:00:44.129897 [info ] [MainThread]: 
[0m01:00:44.130501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:44.131758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:00:44.132353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:00:44.140816 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:00:44.142855 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:00:44.143156 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:00:44.143413 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:00:44.143661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:44.143885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:44.618871 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m01:00:44.619658 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m01:00:44.622304 [debug] [ThreadPool]: On list_postgres: Close
[0m01:00:44.623851 [debug] [ThreadPool]: On list_postgres: Close
[0m01:00:44.626303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_warehouse)
[0m01:00:44.627809 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "warehouse"
"
[0m01:00:44.634481 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m01:00:44.634964 [debug] [ThreadPool]: On create_postgres_warehouse: BEGIN
[0m01:00:44.635334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:44.817009 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:44.817908 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m01:00:44.818513 [debug] [ThreadPool]: On create_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_warehouse"} */
create schema if not exists "warehouse"
[0m01:00:44.838036 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m01:00:44.840171 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m01:00:44.840941 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m01:00:44.841631 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m01:00:44.859438 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m01:00:44.860293 [debug] [ThreadPool]: On create_postgres_warehouse: Close
[0m01:00:44.865570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_warehouse, now list_postgres_staging)
[0m01:00:44.866904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m01:00:44.874573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_warehouse'
[0m01:00:44.879021 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:00:44.882189 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:00:44.884925 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:00:44.885398 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:00:44.885819 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m01:00:44.886238 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m01:00:44.886655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:44.887072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:44.887464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:45.069125 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.070042 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:00:45.070738 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:00:45.076026 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.076770 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:00:45.077476 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:00:45.079660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.080265 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:00:45.080878 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m01:00:45.091506 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:00:45.094050 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:00:45.101727 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:00:45.103954 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m01:00:45.104672 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m01:00:45.107009 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m01:00:45.107644 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:00:45.121321 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m01:00:45.125069 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m01:00:45.133686 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.134284 [debug] [MainThread]: On master: BEGIN
[0m01:00:45.134765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:45.307762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.308864 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.309964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:45.337560 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m01:00:45.345096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35829fa90>]}
[0m01:00:45.346116 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:45.359576 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.360304 [debug] [MainThread]: On master: BEGIN
[0m01:00:45.391328 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.392943 [debug] [MainThread]: On master: COMMIT
[0m01:00:45.393826 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.394646 [debug] [MainThread]: On master: COMMIT
[0m01:00:45.409421 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.410694 [debug] [MainThread]: On master: Close
[0m01:00:45.413548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:45.414521 [info ] [MainThread]: 
[0m01:00:45.422212 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m01:00:45.423236 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m01:00:45.424206 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m01:00:45.425267 [info ] [Thread-1  ]: 1 of 15 START sql view model staging.G01_stg ................................... [RUN]
[0m01:00:45.426195 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m01:00:45.427088 [info ] [Thread-2  ]: 2 of 15 START sql view model staging.G02_stg ................................... [RUN]
[0m01:00:45.427949 [info ] [Thread-3  ]: 3 of 15 START sql view model staging.host_stg .................................. [RUN]
[0m01:00:45.429219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.G01_stg)
[0m01:00:45.430042 [info ] [Thread-4  ]: 4 of 15 START sql view model staging.lga_stg ................................... [RUN]
[0m01:00:45.431201 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.G02_stg)
[0m01:00:45.432270 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.host_stg)
[0m01:00:45.432988 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m01:00:45.434172 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.lga_stg'
[0m01:00:45.434842 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m01:00:45.435490 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m01:00:45.448936 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m01:00:45.449603 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m01:00:45.453626 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m01:00:45.459158 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m01:00:45.462630 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m01:00:45.463468 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 01:00:45.436014 => 01:00:45.463209
[0m01:00:45.464151 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 01:00:45.449985 => 01:00:45.463911
[0m01:00:45.464642 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m01:00:45.465228 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 01:00:45.459716 => 01:00:45.465021
[0m01:00:45.465729 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m01:00:45.466194 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 01:00:45.454196 => 01:00:45.466004
[0m01:00:45.491903 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m01:00:45.503220 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m01:00:45.506647 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m01:00:45.507015 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m01:00:45.510031 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m01:00:45.513287 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m01:00:45.513799 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.514192 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.514480 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.514789 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m01:00:45.515089 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m01:00:45.515423 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.515683 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m01:00:45.515955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:45.516221 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:00:45.516489 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m01:00:45.516748 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:00:45.517251 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:45.673089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.673765 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.674255 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m01:00:45.697218 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.706621 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.707107 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.707831 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.708264 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.708723 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.709164 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.709617 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m01:00:45.710060 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.710528 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m01:00:45.711022 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m01:00:45.711646 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m01:00:45.725884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.765503 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.767005 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.767320 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.767640 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.770189 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.770513 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m01:00:45.772926 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.775257 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.775602 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m01:00:45.775977 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m01:00:45.776286 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m01:00:45.789473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.800762 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.801082 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.804425 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:00:45.804739 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.807056 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.809427 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.809740 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.811781 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.812091 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m01:00:45.812389 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m01:00:45.812667 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:00:45.812945 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m01:00:45.828271 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.828683 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.829082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.830641 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:00:45.832109 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:00:45.838744 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.840608 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.840923 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.841241 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.842538 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:00:45.842878 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m01:00:45.843193 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:00:45.843482 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:00:45.843776 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.844212 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:00:45.858669 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.861152 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.861556 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.861891 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m01:00:45.862215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.864453 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.865704 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 01:00:45.466532 => 01:00:45.865540
[0m01:00:45.866053 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.866369 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m01:00:45.866727 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m01:00:45.868907 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.869357 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m01:00:45.869996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388a8f430>]}
[0m01:00:45.871923 [info ] [Thread-1  ]: 1 of 15 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.44s]
[0m01:00:45.872430 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m01:00:45.872774 [debug] [Thread-1  ]: Began running node model.bde.listings_stg
[0m01:00:45.873137 [info ] [Thread-1  ]: 5 of 15 START sql view model staging.listings_stg .............................. [RUN]
[0m01:00:45.873713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.listings_stg)
[0m01:00:45.874075 [debug] [Thread-1  ]: Began compiling node model.bde.listings_stg
[0m01:00:45.876660 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m01:00:45.877657 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (compile): 01:00:45.874311 => 01:00:45.877498
[0m01:00:45.877975 [debug] [Thread-1  ]: Began executing node model.bde.listings_stg
[0m01:00:45.881266 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m01:00:45.881787 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:45.882070 [debug] [Thread-1  ]: On model.bde.listings_stg: BEGIN
[0m01:00:45.882341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:45.883072 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.884166 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 01:00:45.507257 => 01:00:45.884025
[0m01:00:45.884476 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m01:00:45.885183 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3889d3be0>]}
[0m01:00:45.885636 [info ] [Thread-4  ]: 4 of 15 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m01:00:45.886094 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m01:00:45.886447 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m01:00:45.886856 [info ] [Thread-4  ]: 6 of 15 START sql view model staging.property_stg .............................. [RUN]
[0m01:00:45.887452 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.property_stg)
[0m01:00:45.887770 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m01:00:45.890197 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m01:00:45.890530 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.890830 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.892024 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 01:00:45.503521 => 01:00:45.891880
[0m01:00:45.893170 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 01:00:45.510445 => 01:00:45.893031
[0m01:00:45.893531 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m01:00:45.893893 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 01:00:45.887986 => 01:00:45.893751
[0m01:00:45.894196 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m01:00:45.894533 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m01:00:45.895094 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3889d3eb0>]}
[0m01:00:45.898297 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m01:00:45.898851 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388aef760>]}
[0m01:00:45.899303 [info ] [Thread-2  ]: 2 of 15 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m01:00:45.900201 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m01:00:45.899796 [info ] [Thread-3  ]: 3 of 15 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.47s]
[0m01:00:45.900634 [debug] [Thread-2  ]: Began running node model.bde.room_stg
[0m01:00:45.901017 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:45.901429 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m01:00:45.901755 [info ] [Thread-2  ]: 7 of 15 START sql view model staging.room_stg .................................. [RUN]
[0m01:00:45.902080 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m01:00:45.902419 [debug] [Thread-3  ]: Began running node model.bde.suburb_stg
[0m01:00:45.902996 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.room_stg)
[0m01:00:45.903298 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:00:45.903649 [info ] [Thread-3  ]: 8 of 15 START sql view model staging.suburb_stg ................................ [RUN]
[0m01:00:45.904036 [debug] [Thread-2  ]: Began compiling node model.bde.room_stg
[0m01:00:45.905088 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.suburb_stg)
[0m01:00:45.909001 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.room_stg"
[0m01:00:45.909423 [debug] [Thread-3  ]: Began compiling node model.bde.suburb_stg
[0m01:00:45.911858 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m01:00:45.912403 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (compile): 01:00:45.905435 => 01:00:45.912226
[0m01:00:45.912736 [debug] [Thread-2  ]: Began executing node model.bde.room_stg
[0m01:00:45.915710 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.room_stg"
[0m01:00:45.916125 [debug] [Thread-3  ]: Timing info for model.bde.suburb_stg (compile): 01:00:45.909730 => 01:00:45.915961
[0m01:00:45.916490 [debug] [Thread-3  ]: Began executing node model.bde.suburb_stg
[0m01:00:45.919939 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m01:00:45.920463 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:45.920911 [debug] [Thread-2  ]: On model.bde.room_stg: BEGIN
[0m01:00:45.921207 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:00:45.921732 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:45.922074 [debug] [Thread-3  ]: On model.bde.suburb_stg: BEGIN
[0m01:00:45.922352 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:46.035840 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.036468 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.036871 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        TO_DATE(host_since, 'DD/MM/YYYY') as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m01:00:46.054824 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.058165 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.058566 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.058997 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m01:00:46.059385 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:46.059852 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m01:00:46.073511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.076573 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.076984 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m01:00:46.077656 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.078027 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.078396 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m01:00:46.079877 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.082996 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:46.083382 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m01:00:46.086923 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.087271 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.087661 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m01:00:46.092178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.093704 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m01:00:46.094069 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.094405 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m01:00:46.098438 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.101370 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.101761 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m01:00:46.102128 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.104743 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:46.106246 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.106590 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m01:00:46.109308 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.109721 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m01:00:46.114855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.117197 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.117567 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m01:00:46.117901 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.120397 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.120769 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m01:00:46.122405 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.123822 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m01:00:46.124173 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:46.124488 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m01:00:46.128349 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.130767 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.131114 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m01:00:46.134604 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.135740 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (execute): 01:00:45.878196 => 01:00:46.135578
[0m01:00:46.136073 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.136393 [debug] [Thread-1  ]: On model.bde.listings_stg: Close
[0m01:00:46.137802 [debug] [Thread-3  ]: On model.bde.suburb_stg: COMMIT
[0m01:00:46.138203 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.138797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388b12a00>]}
[0m01:00:46.139137 [debug] [Thread-3  ]: On model.bde.suburb_stg: COMMIT
[0m01:00:46.139677 [info ] [Thread-1  ]: 5 of 15 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m01:00:46.140276 [debug] [Thread-1  ]: Finished running node model.bde.listings_stg
[0m01:00:46.140672 [debug] [Thread-1  ]: Began running node model.bde.fact_census_G01
[0m01:00:46.141082 [info ] [Thread-1  ]: 9 of 15 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m01:00:46.141617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_census_G01)
[0m01:00:46.141924 [debug] [Thread-1  ]: Began compiling node model.bde.fact_census_G01
[0m01:00:46.144408 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m01:00:46.144782 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.147078 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:46.147480 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m01:00:46.147809 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.149317 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m01:00:46.149675 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.150080 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G01 (compile): 01:00:46.142148 => 01:00:46.149915
[0m01:00:46.150363 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m01:00:46.150676 [debug] [Thread-1  ]: Began executing node model.bde.fact_census_G01
[0m01:00:46.153817 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m01:00:46.154550 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:00:46.154842 [debug] [Thread-1  ]: On model.bde.fact_census_G01: BEGIN
[0m01:00:46.155111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:46.157022 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.159022 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.159352 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m01:00:46.163988 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.165290 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 01:00:45.895376 => 01:00:46.165136
[0m01:00:46.165659 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m01:00:46.166416 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3889cfd90>]}
[0m01:00:46.166891 [info ] [Thread-4  ]: 6 of 15 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m01:00:46.167518 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m01:00:46.167977 [debug] [Thread-4  ]: Began running node model.bde.fact_census_G02
[0m01:00:46.168470 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.168833 [info ] [Thread-4  ]: 10 of 15 START sql view model warehouse.fact_census_G02 ........................ [RUN]
[0m01:00:46.171946 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.172417 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_census_G02)
[0m01:00:46.172708 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m01:00:46.173036 [debug] [Thread-4  ]: Began compiling node model.bde.fact_census_G02
[0m01:00:46.175438 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m01:00:46.176254 [debug] [Thread-4  ]: Timing info for model.bde.fact_census_G02 (compile): 01:00:46.173363 => 01:00:46.176103
[0m01:00:46.176537 [debug] [Thread-4  ]: Began executing node model.bde.fact_census_G02
[0m01:00:46.179325 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m01:00:46.179635 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.180702 [debug] [Thread-3  ]: Timing info for model.bde.suburb_stg (execute): 01:00:45.916765 => 01:00:46.180574
[0m01:00:46.181004 [debug] [Thread-3  ]: On model.bde.suburb_stg: Close
[0m01:00:46.181408 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:00:46.181922 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3582b4040>]}
[0m01:00:46.182217 [debug] [Thread-4  ]: On model.bde.fact_census_G02: BEGIN
[0m01:00:46.182659 [info ] [Thread-3  ]: 8 of 15 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m01:00:46.182963 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:00:46.183395 [debug] [Thread-3  ]: Finished running node model.bde.suburb_stg
[0m01:00:46.183816 [debug] [Thread-3  ]: Began running node model.bde.dim_host
[0m01:00:46.184198 [info ] [Thread-3  ]: 11 of 15 START sql view model warehouse.dim_host ............................... [RUN]
[0m01:00:46.184759 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_host)
[0m01:00:46.185103 [debug] [Thread-3  ]: Began compiling node model.bde.dim_host
[0m01:00:46.187689 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_host"
[0m01:00:46.190036 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (compile): 01:00:46.185335 => 01:00:46.189856
[0m01:00:46.190349 [debug] [Thread-3  ]: Began executing node model.bde.dim_host
[0m01:00:46.193273 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_host"
[0m01:00:46.193751 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.194881 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (execute): 01:00:45.912955 => 01:00:46.194742
[0m01:00:46.195197 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.195485 [debug] [Thread-2  ]: On model.bde.room_stg: Close
[0m01:00:46.195808 [debug] [Thread-3  ]: On model.bde.dim_host: BEGIN
[0m01:00:46.196153 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:46.196645 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388b3baf0>]}
[0m01:00:46.197200 [info ] [Thread-2  ]: 7 of 15 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.29s]
[0m01:00:46.197662 [debug] [Thread-2  ]: Finished running node model.bde.room_stg
[0m01:00:46.197988 [debug] [Thread-2  ]: Began running node model.bde.dim_property
[0m01:00:46.198396 [info ] [Thread-2  ]: 12 of 15 START sql view model warehouse.dim_property ........................... [RUN]
[0m01:00:46.198881 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.dim_property)
[0m01:00:46.199170 [debug] [Thread-2  ]: Began compiling node model.bde.dim_property
[0m01:00:46.201407 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_property"
[0m01:00:46.201976 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (compile): 01:00:46.199373 => 01:00:46.201833
[0m01:00:46.202252 [debug] [Thread-2  ]: Began executing node model.bde.dim_property
[0m01:00:46.205560 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_property"
[0m01:00:46.206559 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m01:00:46.206923 [debug] [Thread-2  ]: On model.bde.dim_property: BEGIN
[0m01:00:46.207199 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:00:46.331090 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.331636 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:00:46.332008 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m01:00:46.339906 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.340464 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:00:46.340859 [debug] [Thread-4  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m01:00:46.349572 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.350116 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.350516 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m01:00:46.355664 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.356166 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.359378 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:00:46.363293 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:00:46.363761 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m01:00:46.364204 [debug] [Thread-4  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m01:00:46.367233 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.367747 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m01:00:46.369833 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.370277 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m01:00:46.374888 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.378912 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.379249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.392597 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m01:00:46.394350 [debug] [Thread-4  ]: On model.bde.fact_census_G02: COMMIT
[0m01:00:46.395802 [debug] [Thread-1  ]: On model.bde.fact_census_G01: COMMIT
[0m01:00:46.396269 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:00:46.396637 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:00:46.396994 [debug] [Thread-4  ]: On model.bde.fact_census_G02: COMMIT
[0m01:00:46.397341 [debug] [Thread-1  ]: On model.bde.fact_census_G01: COMMIT
[0m01:00:46.407127 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.410020 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m01:00:46.410435 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.410811 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m01:00:46.412207 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m01:00:46.412648 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.412999 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m01:00:46.415727 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.418201 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:00:46.418566 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.418898 [debug] [Thread-4  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m01:00:46.421096 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:00:46.430396 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.431775 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.438266 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m01:00:46.439791 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m01:00:46.451840 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.458013 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.458750 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m01:00:46.473515 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.477448 [debug] [Thread-4  ]: Timing info for model.bde.fact_census_G02 (execute): 01:00:46.176753 => 01:00:46.477248
[0m01:00:46.494420 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m01:00:46.494928 [debug] [Thread-2  ]: On model.bde.dim_property: COMMIT
[0m01:00:46.496539 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G01 (execute): 01:00:46.150936 => 01:00:46.496315
[0m01:00:46.497026 [debug] [Thread-4  ]: On model.bde.fact_census_G02: Close
[0m01:00:46.497634 [debug] [Thread-1  ]: On model.bde.fact_census_G01: Close
[0m01:00:46.498679 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388a7dd60>]}
[0m01:00:46.499505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388af4a00>]}
[0m01:00:46.500179 [info ] [Thread-4  ]: 10 of 15 OK created sql view model warehouse.fact_census_G02 ................... [[32mCREATE VIEW[0m in 0.33s]
[0m01:00:46.500812 [info ] [Thread-1  ]: 9 of 15 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.36s]
[0m01:00:46.501489 [debug] [Thread-4  ]: Finished running node model.bde.fact_census_G02
[0m01:00:46.502077 [debug] [Thread-1  ]: Finished running node model.bde.fact_census_G01
[0m01:00:46.502543 [debug] [Thread-4  ]: Began running node model.bde.fact_lge
[0m01:00:46.503033 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m01:00:46.503542 [info ] [Thread-4  ]: 13 of 15 START sql view model warehouse.fact_lge ............................... [RUN]
[0m01:00:46.504043 [info ] [Thread-1  ]: 14 of 15 START sql view model warehouse.fact_listing ........................... [RUN]
[0m01:00:46.504705 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.fact_lge)
[0m01:00:46.505318 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.fact_listing)
[0m01:00:46.505745 [debug] [Thread-4  ]: Began compiling node model.bde.fact_lge
[0m01:00:46.506235 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m01:00:46.509600 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m01:00:46.512813 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m01:00:46.513213 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.513554 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.517454 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_property"
[0m01:00:46.518786 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (execute): 01:00:46.190546 => 01:00:46.518615
[0m01:00:46.519204 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (compile): 01:00:46.506540 => 01:00:46.519051
[0m01:00:46.519606 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 01:00:46.509937 => 01:00:46.519435
[0m01:00:46.519964 [debug] [Thread-2  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m01:00:46.520319 [debug] [Thread-3  ]: On model.bde.dim_host: Close
[0m01:00:46.520656 [debug] [Thread-4  ]: Began executing node model.bde.fact_lge
[0m01:00:46.520980 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m01:00:46.524795 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m01:00:46.525444 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3889b18e0>]}
[0m01:00:46.528652 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m01:00:46.529290 [info ] [Thread-3  ]: 11 of 15 OK created sql view model warehouse.dim_host .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m01:00:46.529932 [debug] [Thread-3  ]: Finished running node model.bde.dim_host
[0m01:00:46.530332 [debug] [Thread-3  ]: Began running node model.bde.dim_room
[0m01:00:46.530782 [info ] [Thread-3  ]: 15 of 15 START sql view model warehouse.dim_room ............................... [RUN]
[0m01:00:46.531347 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dim_room)
[0m01:00:46.531690 [debug] [Thread-3  ]: Began compiling node model.bde.dim_room
[0m01:00:46.534097 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_room"
[0m01:00:46.534439 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m01:00:46.534770 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.535094 [debug] [Thread-4  ]: On model.bde.fact_lge: BEGIN
[0m01:00:46.535415 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m01:00:46.535829 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (compile): 01:00:46.531932 => 01:00:46.535668
[0m01:00:46.536119 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:00:46.536465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:46.536822 [debug] [Thread-3  ]: Began executing node model.bde.dim_room
[0m01:00:46.540291 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_room"
[0m01:00:46.540634 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.541804 [debug] [Thread-2  ]: Timing info for model.bde.dim_property (execute): 01:00:46.202441 => 01:00:46.541662
[0m01:00:46.542154 [debug] [Thread-2  ]: On model.bde.dim_property: Close
[0m01:00:46.542505 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:00:46.543022 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37af8d970>]}
[0m01:00:46.543319 [debug] [Thread-3  ]: On model.bde.dim_room: BEGIN
[0m01:00:46.543781 [info ] [Thread-2  ]: 12 of 15 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.34s]
[0m01:00:46.544083 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:46.544511 [debug] [Thread-2  ]: Finished running node model.bde.dim_property
[0m01:00:46.709519 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.710201 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.710838 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.711360 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m01:00:46.711998 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

select
        listing_id ,
        scraped_date,
        host_id,
        host_name,
        host_since,
        host_is_superhost,
        host_neighbourhood,
        b.lga_name as host_neighbourhood_lga_name,
        b.lga_code as host_neighbourhood_lga_code,        
        listing_neighbourhood,
        c.lga_name as listing_neighbourhood_lga_name,
        c.lga_code as listing_neighbourhood_lga_code,   
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from  "postgres"."staging"."listings_stg" a
left join lga b
on a.host_neighbourhood = b.suburb_name
left join lga c
on a.listing_neighbourhood = c.suburb_name
  );
[0m01:00:46.712636 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m01:00:46.713316 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.713785 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:00:46.714287 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m01:00:46.730284 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.735598 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m01:00:46.736294 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.736880 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.737385 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m01:00:46.741451 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.745343 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:00:46.746003 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m01:00:46.746529 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m01:00:46.760790 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.762791 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m01:00:46.763354 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m01:00:46.763843 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m01:00:46.764570 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.765083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.767039 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m01:00:46.769160 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m01:00:46.769631 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:00:46.770091 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.770524 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m01:00:46.770939 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m01:00:46.780854 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.785256 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m01:00:46.785763 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m01:00:46.786466 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.789356 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:00:46.789823 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m01:00:46.790446 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.793008 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.793417 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m01:00:46.799621 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.801089 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (execute): 01:00:46.521427 => 01:00:46.800888
[0m01:00:46.801505 [debug] [Thread-4  ]: On model.bde.fact_lge: Close
[0m01:00:46.802399 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3889cfee0>]}
[0m01:00:46.803012 [info ] [Thread-4  ]: 13 of 15 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m01:00:46.803655 [debug] [Thread-4  ]: Finished running node model.bde.fact_lge
[0m01:00:46.805316 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.806682 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (execute): 01:00:46.537280 => 01:00:46.806502
[0m01:00:46.807086 [debug] [Thread-3  ]: On model.bde.dim_room: Close
[0m01:00:46.807979 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388b902b0>]}
[0m01:00:46.808548 [info ] [Thread-3  ]: 15 of 15 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m01:00:46.809166 [debug] [Thread-3  ]: Finished running node model.bde.dim_room
[0m01:00:46.809639 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.811004 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 01:00:46.525716 => 01:00:46.810821
[0m01:00:46.811439 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m01:00:46.812238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc710a19-dd28-4171-8424-2e5fdedecefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388a40280>]}
[0m01:00:46.812755 [info ] [Thread-1  ]: 14 of 15 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.31s]
[0m01:00:46.813284 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m01:00:46.815414 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.815759 [debug] [MainThread]: On master: BEGIN
[0m01:00:46.816063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:46.984118 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.985014 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.985638 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.986194 [debug] [MainThread]: On master: COMMIT
[0m01:00:47.001696 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:47.002642 [debug] [MainThread]: On master: Close
[0m01:00:47.004500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:47.005204 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m01:00:47.005808 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m01:00:47.006330 [debug] [MainThread]: Connection 'model.bde.dim_room' was properly closed.
[0m01:00:47.006831 [debug] [MainThread]: Connection 'model.bde.fact_lge' was properly closed.
[0m01:00:47.007577 [info ] [MainThread]: 
[0m01:00:47.008251 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m01:00:47.012885 [debug] [MainThread]: Command end result
[0m01:00:47.026920 [info ] [MainThread]: 
[0m01:00:47.027562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:47.028041 [info ] [MainThread]: 
[0m01:00:47.028552 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m01:00:47.029380 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:47.029248 after 3.25 seconds
[0m01:00:47.029926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd378b696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3581fbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3583070a0>]}
[0m01:00:47.030452 [debug] [MainThread]: Flushing usage events
[0m00:48:25.140316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3982d96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b10ef7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b10ef8e0>]}


============================== 00:48:25.145153 | e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2 ==============================
[0m00:48:25.145153 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:48:25.145946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:48:25.389170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b10ef820>]}
[0m00:48:25.400930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a0ecd250>]}
[0m00:48:25.403071 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m00:48:25.430156 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:48:25.471775 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 0 files added, 2 files changed.
[0m00:48:25.472366 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_host.sql
[0m00:48:25.472723 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/G01_stg.sql
[0m00:48:25.473013 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/G02_stg.sql
[0m00:48:25.473352 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/property_stg.sql
[0m00:48:25.473584 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/suburb_stg.sql
[0m00:48:25.473850 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/room_stg.sql
[0m00:48:25.474094 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_property.sql
[0m00:48:25.474319 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_lge.sql
[0m00:48:25.474539 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/dim_room.sql
[0m00:48:25.474761 [debug] [MainThread]: Partial parsing: deleted file: bde://models/staging/lga_stg.sql
[0m00:48:25.474980 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_listing.sql
[0m00:48:25.475201 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_census_G01.sql
[0m00:48:25.475418 [debug] [MainThread]: Partial parsing: deleted file: bde://models/warehouse/fact_census_G02.sql
[0m00:48:25.475781 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/listings_stg.sql
[0m00:48:25.476096 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m00:48:25.514354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.warehouse
- models.bde.datamart
[0m00:48:25.518750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a0f3f0d0>]}
[0m00:48:25.537083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3905f70a0>]}
[0m00:48:25.537570 [info ] [MainThread]: Found 3 snapshots, 2 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m00:48:25.537982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39118f490>]}
[0m00:48:25.539788 [info ] [MainThread]: 
[0m00:48:25.541002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:48:25.542262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:48:25.551375 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:48:25.551810 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:48:25.552093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:26.019432 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m00:48:26.020890 [debug] [ThreadPool]: On list_postgres: Close
[0m00:48:26.022788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m00:48:26.023492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m00:48:26.028138 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:48:26.029755 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:48:26.030052 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m00:48:26.030324 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m00:48:26.030578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:26.030827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:26.201511 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.202913 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:48:26.204084 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:48:26.205480 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.206413 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:48:26.207079 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m00:48:26.224861 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:48:26.228623 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m00:48:26.230133 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:48:26.231107 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m00:48:26.241521 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m00:48:26.246597 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m00:48:26.251283 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:26.251587 [debug] [MainThread]: On master: BEGIN
[0m00:48:26.251831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:26.420808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.422662 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:26.424383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:48:26.450313 [debug] [MainThread]: SQL status: SELECT 18 in 0.0 seconds
[0m00:48:26.463720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39118f490>]}
[0m00:48:26.464183 [debug] [MainThread]: On master: ROLLBACK
[0m00:48:26.479990 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:26.480314 [debug] [MainThread]: On master: BEGIN
[0m00:48:26.515672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.517411 [debug] [MainThread]: On master: COMMIT
[0m00:48:26.518805 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:26.519846 [debug] [MainThread]: On master: COMMIT
[0m00:48:26.538307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:48:26.539864 [debug] [MainThread]: On master: Close
[0m00:48:26.542085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:48:26.542864 [info ] [MainThread]: 
[0m00:48:26.547665 [debug] [Thread-1  ]: Began running node model.bde.host_stg
[0m00:48:26.548096 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m00:48:26.548755 [info ] [Thread-1  ]: 1 of 2 START sql view model staging.host_stg ................................... [RUN]
[0m00:48:26.549187 [info ] [Thread-2  ]: 2 of 2 START sql view model staging.listings_stg ............................... [RUN]
[0m00:48:26.550042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.host_stg)
[0m00:48:26.550552 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.listings_stg)
[0m00:48:26.550884 [debug] [Thread-1  ]: Began compiling node model.bde.host_stg
[0m00:48:26.551200 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m00:48:26.560634 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.host_stg"
[0m00:48:26.563600 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m00:48:26.565117 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (compile): 00:48:26.551464 => 00:48:26.564913
[0m00:48:26.565478 [debug] [Thread-1  ]: Began executing node model.bde.host_stg
[0m00:48:26.565861 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 00:48:26.561182 => 00:48:26.565715
[0m00:48:26.598287 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m00:48:26.612374 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.host_stg"
[0m00:48:26.612813 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m00:48:26.613775 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:48:26.614135 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:48:26.614431 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m00:48:26.614742 [debug] [Thread-1  ]: On model.bde.host_stg: BEGIN
[0m00:48:26.615166 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:48:26.615478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:48:26.785302 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.785729 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.786110 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:48:26.786439 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:48:26.786806 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHERE host_since = 'NaN' THEN NULL
            WHERE host_since = '' THEN NULL
            ELSE
            TO_DATE(host_since, 'DD/MM/YYYY') END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m00:48:26.787220 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHERE host_since = 'NaN' THEN NULL
            WHERE host_since = '' THEN NULL
            ELSE
            TO_DATE(host_since, 'DD/MM/YYYY') END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m00:48:26.802611 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 25:             WHERE host_since = 'NaN' THEN NULL
                     ^

[0m00:48:26.802969 [debug] [Thread-1  ]: On model.bde.host_stg: ROLLBACK
[0m00:48:26.803423 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 26:             WHERE host_since = 'NaN' THEN NULL
                     ^

[0m00:48:26.803715 [debug] [Thread-2  ]: On model.bde.listings_stg: ROLLBACK
[0m00:48:26.817278 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (execute): 00:48:26.566076 => 00:48:26.816631
[0m00:48:26.818423 [debug] [Thread-1  ]: On model.bde.host_stg: Close
[0m00:48:26.821201 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 00:48:26.605051 => 00:48:26.821018
[0m00:48:26.821641 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m00:48:26.824860 [debug] [Thread-2  ]: Database Error in model listings_stg (models/staging/listings_stg.sql)
  syntax error at or near "WHERE"
  LINE 26:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/listings_stg.sql
[0m00:48:26.825495 [debug] [Thread-1  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near "WHERE"
  LINE 25:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m00:48:26.825873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff391233a00>]}
[0m00:48:26.826207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e94b8b44-0bd3-4ad7-be28-82d66b1a6cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a0f00ca0>]}
[0m00:48:26.827246 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model staging.listings_stg ...................... [[31mERROR[0m in 0.28s]
[0m00:48:26.828219 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m00:48:26.827784 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model staging.host_stg .......................... [[31mERROR[0m in 0.28s]
[0m00:48:26.828885 [debug] [Thread-1  ]: Finished running node model.bde.host_stg
[0m00:48:26.830156 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:26.830421 [debug] [MainThread]: On master: BEGIN
[0m00:48:26.830657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:48:26.981809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:48:26.982228 [debug] [MainThread]: On master: COMMIT
[0m00:48:26.982486 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:26.982728 [debug] [MainThread]: On master: COMMIT
[0m00:48:27.000634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:48:27.001510 [debug] [MainThread]: On master: Close
[0m00:48:27.003182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:27.003864 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m00:48:27.004222 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m00:48:27.004548 [info ] [MainThread]: 
[0m00:48:27.004876 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m00:48:27.005657 [debug] [MainThread]: Command end result
[0m00:48:27.012927 [info ] [MainThread]: 
[0m00:48:27.013469 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:48:27.013830 [info ] [MainThread]: 
[0m00:48:27.014238 [error] [MainThread]:   Database Error in model listings_stg (models/staging/listings_stg.sql)
  syntax error at or near "WHERE"
  LINE 26:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/listings_stg.sql
[0m00:48:27.014622 [info ] [MainThread]: 
[0m00:48:27.014988 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near "WHERE"
  LINE 25:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m00:48:27.015294 [info ] [MainThread]: 
[0m00:48:27.015720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m00:48:27.016477 [debug] [MainThread]: Command `dbt run` failed at 00:48:27.016376 after 1.93 seconds
[0m00:48:27.016988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3982d96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3905f70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff39121bf40>]}
[0m00:48:27.017425 [debug] [MainThread]: Flushing usage events
[0m00:52:50.816471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7582696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7492087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7492088b0>]}


============================== 00:52:50.821029 | b8b04f70-db2b-4067-b11a-91ac01616c71 ==============================
[0m00:52:50.821029 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:52:50.821820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:52:50.979841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd749208850>]}
[0m00:52:50.991501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd73890f220>]}
[0m00:52:50.992124 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m00:52:51.017337 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:52:51.055957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:52:51.056817 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m00:52:51.094494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
[0m00:52:51.098990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7493aef10>]}
[0m00:52:51.118754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd749312970>]}
[0m00:52:51.119521 [info ] [MainThread]: Found 3 snapshots, 2 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m00:52:51.119962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd749312cd0>]}
[0m00:52:51.121888 [info ] [MainThread]: 
[0m00:52:51.122707 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:52:51.124149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:52:51.136304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:52:51.136959 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:52:51.137450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:51.585777 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m00:52:51.587819 [debug] [ThreadPool]: On list_postgres: Close
[0m00:52:51.590637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m00:52:51.591856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m00:52:51.596971 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:52:51.598553 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:52:51.598900 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m00:52:51.599172 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m00:52:51.599423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:51.599682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:52:51.771145 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:52:51.772406 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:52:51.773629 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:52:51.774463 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:52:51.775356 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m00:52:51.776162 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:52:51.800555 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:52:51.802198 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:52:51.806357 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m00:52:51.808158 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m00:52:51.821046 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m00:52:51.821751 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m00:52:51.830631 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:51.830982 [debug] [MainThread]: On master: BEGIN
[0m00:52:51.831230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:51.988284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:52:51.989661 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:51.990796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:52:52.017143 [debug] [MainThread]: SQL status: SELECT 18 in 0.0 seconds
[0m00:52:52.027113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd738913ee0>]}
[0m00:52:52.027623 [debug] [MainThread]: On master: ROLLBACK
[0m00:52:52.040737 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:52.041580 [debug] [MainThread]: On master: BEGIN
[0m00:52:52.070599 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:52:52.072026 [debug] [MainThread]: On master: COMMIT
[0m00:52:52.073097 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:52.076465 [debug] [MainThread]: On master: COMMIT
[0m00:52:52.090588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:52:52.092047 [debug] [MainThread]: On master: Close
[0m00:52:52.094799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:52:52.095902 [info ] [MainThread]: 
[0m00:52:52.099180 [debug] [Thread-1  ]: Began running node model.bde.host_stg
[0m00:52:52.099533 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m00:52:52.100026 [info ] [Thread-1  ]: 1 of 2 START sql view model staging.host_stg ................................... [RUN]
[0m00:52:52.100384 [info ] [Thread-2  ]: 2 of 2 START sql view model staging.listings_stg ............................... [RUN]
[0m00:52:52.101320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.host_stg)
[0m00:52:52.101836 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.listings_stg)
[0m00:52:52.102181 [debug] [Thread-1  ]: Began compiling node model.bde.host_stg
[0m00:52:52.102509 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m00:52:52.109430 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.host_stg"
[0m00:52:52.112591 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m00:52:52.113661 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 00:52:52.109719 => 00:52:52.113458
[0m00:52:52.114003 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (compile): 00:52:52.102761 => 00:52:52.113871
[0m00:52:52.114326 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m00:52:52.114630 [debug] [Thread-1  ]: Began executing node model.bde.host_stg
[0m00:52:52.156210 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.host_stg"
[0m00:52:52.157159 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m00:52:52.158015 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:52:52.158328 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:52:52.158664 [debug] [Thread-1  ]: On model.bde.host_stg: BEGIN
[0m00:52:52.159004 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m00:52:52.159309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:52:52.159594 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:52:52.306486 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:52:52.306960 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:52:52.307315 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHERE host_since = 'NaN' THEN NULL
            WHERE host_since = '' THEN NULL
            ELSE
            TO_DATE(host_since, 'DD/MM/YYYY') END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m00:52:52.311820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:52:52.312153 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:52:52.312493 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHERE host_since = 'NaN' THEN NULL
            WHERE host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> ''
)

select * from to_date_format
  );
[0m00:52:52.323138 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 26:             WHERE host_since = 'NaN' THEN NULL
                     ^

[0m00:52:52.323461 [debug] [Thread-2  ]: On model.bde.listings_stg: ROLLBACK
[0m00:52:52.328507 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 25:             WHERE host_since = 'NaN' THEN NULL
                     ^

[0m00:52:52.328810 [debug] [Thread-1  ]: On model.bde.host_stg: ROLLBACK
[0m00:52:52.340038 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 00:52:52.114865 => 00:52:52.339826
[0m00:52:52.340398 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m00:52:52.344695 [debug] [Thread-2  ]: Database Error in model listings_stg (models/staging/listings_stg.sql)
  syntax error at or near "WHERE"
  LINE 26:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/listings_stg.sql
[0m00:52:52.345173 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (execute): 00:52:52.140208 => 00:52:52.345022
[0m00:52:52.345581 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768e55550>]}
[0m00:52:52.345935 [debug] [Thread-1  ]: On model.bde.host_stg: Close
[0m00:52:52.346629 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model staging.listings_stg ...................... [[31mERROR[0m in 0.24s]
[0m00:52:52.347302 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m00:52:52.348330 [debug] [Thread-1  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near "WHERE"
  LINE 25:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m00:52:52.348669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8b04f70-db2b-4067-b11a-91ac01616c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768e7e130>]}
[0m00:52:52.349083 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model staging.host_stg .......................... [[31mERROR[0m in 0.25s]
[0m00:52:52.349539 [debug] [Thread-1  ]: Finished running node model.bde.host_stg
[0m00:52:52.350882 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:52.351163 [debug] [MainThread]: On master: BEGIN
[0m00:52:52.351400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:52:52.515711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:52:52.517178 [debug] [MainThread]: On master: COMMIT
[0m00:52:52.518219 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:52.519069 [debug] [MainThread]: On master: COMMIT
[0m00:52:52.534519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:52:52.536154 [debug] [MainThread]: On master: Close
[0m00:52:52.538215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:52.538939 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m00:52:52.539556 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m00:52:52.540376 [info ] [MainThread]: 
[0m00:52:52.540904 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m00:52:52.541667 [debug] [MainThread]: Command end result
[0m00:52:52.549994 [info ] [MainThread]: 
[0m00:52:52.550871 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:52:52.551331 [info ] [MainThread]: 
[0m00:52:52.551928 [error] [MainThread]:   Database Error in model listings_stg (models/staging/listings_stg.sql)
  syntax error at or near "WHERE"
  LINE 26:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/listings_stg.sql
[0m00:52:52.552390 [info ] [MainThread]: 
[0m00:52:52.552850 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  syntax error at or near "WHERE"
  LINE 25:             WHERE host_since = 'NaN' THEN NULL
                       ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m00:52:52.553289 [info ] [MainThread]: 
[0m00:52:52.553655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m00:52:52.554253 [debug] [MainThread]: Command `dbt run` failed at 00:52:52.554169 after 1.78 seconds
[0m00:52:52.554619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7582696a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768e33d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768e5b820>]}
[0m00:52:52.554950 [debug] [MainThread]: Flushing usage events
[0m00:55:24.709287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab03396a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90858850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90858940>]}


============================== 00:55:24.713728 | bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc ==============================
[0m00:55:24.713728 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:55:24.714513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:55:24.830949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90858880>]}
[0m00:55:24.842612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa12f02b0>]}
[0m00:55:24.843271 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m00:55:24.865214 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:55:24.904191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:55:24.905188 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/host_stg.sql
[0m00:55:24.905681 [debug] [MainThread]: Partial parsing: updated file: bde://models/staging/listings_stg.sql
[0m00:55:24.944469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.bde.datamart
- models.bde.warehouse
[0m00:55:24.948786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa137e0d0>]}
[0m00:55:24.963358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac10313d0>]}
[0m00:55:24.963864 [info ] [MainThread]: Found 3 snapshots, 2 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m00:55:24.964258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0fafdf0>]}
[0m00:55:24.966073 [info ] [MainThread]: 
[0m00:55:24.966902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:24.968507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:55:24.978167 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:55:24.978575 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:55:24.978850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:25.196340 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m00:55:25.198094 [debug] [ThreadPool]: On list_postgres: Close
[0m00:55:25.199810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m00:55:25.200419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m00:55:25.205204 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:55:25.207185 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:55:25.207495 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m00:55:25.207767 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m00:55:25.208025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:25.208277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:25.357676 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:55:25.358250 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m00:55:25.358582 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m00:55:25.369233 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:55:25.370139 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m00:55:25.370897 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m00:55:25.377906 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:55:25.379142 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m00:55:25.391034 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:55:25.394152 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m00:55:25.395059 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m00:55:25.408644 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m00:55:25.415687 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.416043 [debug] [MainThread]: On master: BEGIN
[0m00:55:25.416287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:25.579769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:55:25.581558 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.582723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:55:25.613066 [debug] [MainThread]: SQL status: SELECT 18 in 0.0 seconds
[0m00:55:25.623097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa1304ca0>]}
[0m00:55:25.623576 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:25.636483 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.636786 [debug] [MainThread]: On master: BEGIN
[0m00:55:25.667091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:55:25.668840 [debug] [MainThread]: On master: COMMIT
[0m00:55:25.670287 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:25.671356 [debug] [MainThread]: On master: COMMIT
[0m00:55:25.685590 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:55:25.686800 [debug] [MainThread]: On master: Close
[0m00:55:25.689766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:55:25.690783 [info ] [MainThread]: 
[0m00:55:25.695124 [debug] [Thread-1  ]: Began running node model.bde.host_stg
[0m00:55:25.695549 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m00:55:25.696022 [info ] [Thread-1  ]: 1 of 2 START sql view model staging.host_stg ................................... [RUN]
[0m00:55:25.696498 [info ] [Thread-2  ]: 2 of 2 START sql view model staging.listings_stg ............................... [RUN]
[0m00:55:25.697247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.host_stg)
[0m00:55:25.697785 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.listings_stg)
[0m00:55:25.698133 [debug] [Thread-1  ]: Began compiling node model.bde.host_stg
[0m00:55:25.698462 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m00:55:25.705291 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.host_stg"
[0m00:55:25.708353 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m00:55:25.709157 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (compile): 00:55:25.698713 => 00:55:25.708938
[0m00:55:25.709547 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 00:55:25.705579 => 00:55:25.709379
[0m00:55:25.709870 [debug] [Thread-1  ]: Began executing node model.bde.host_stg
[0m00:55:25.710191 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m00:55:25.745243 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.host_stg"
[0m00:55:25.746207 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m00:55:25.746853 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:55:25.747256 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:55:25.747582 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m00:55:25.747895 [debug] [Thread-1  ]: On model.bde.host_stg: BEGIN
[0m00:55:25.748183 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:55:25.748498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:55:25.920249 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:55:25.920822 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:55:25.921176 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m00:55:25.921561 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:55:25.921986 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:55:25.922362 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m00:55:25.945649 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:55:25.946781 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:55:25.955236 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:55:25.957953 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:55:25.958324 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m00:55:25.958738 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m00:55:25.974506 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:25.976976 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:55:25.977286 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:25.977612 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m00:55:25.979777 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:55:25.980188 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m00:55:25.993209 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:26.004720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:55:26.007448 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m00:55:26.008747 [debug] [Thread-1  ]: On model.bde.host_stg: COMMIT
[0m00:55:26.009088 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:55:26.009407 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:55:26.009733 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m00:55:26.010047 [debug] [Thread-1  ]: On model.bde.host_stg: COMMIT
[0m00:55:26.024707 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:55:26.024990 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:55:26.033417 [debug] [Thread-1  ]: Using postgres connection "model.bde.host_stg"
[0m00:55:26.034061 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m00:55:26.034399 [debug] [Thread-1  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m00:55:26.034736 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m00:55:26.052721 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:55:26.053029 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:55:26.054191 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 00:55:25.735497 => 00:55:26.054040
[0m00:55:26.055202 [debug] [Thread-1  ]: Timing info for model.bde.host_stg (execute): 00:55:25.710419 => 00:55:26.055067
[0m00:55:26.055538 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m00:55:26.055845 [debug] [Thread-1  ]: On model.bde.host_stg: Close
[0m00:55:26.056592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa13d3880>]}
[0m00:55:26.057186 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd63a52d-6b5c-4cf6-90b5-9bf6dd907fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ac0fc6fd0>]}
[0m00:55:26.057930 [info ] [Thread-1  ]: 1 of 2 OK created sql view model staging.host_stg .............................. [[32mCREATE VIEW[0m in 0.36s]
[0m00:55:26.058515 [debug] [Thread-1  ]: Finished running node model.bde.host_stg
[0m00:55:26.058937 [info ] [Thread-2  ]: 2 of 2 OK created sql view model staging.listings_stg .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m00:55:26.059545 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m00:55:26.060726 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:26.061009 [debug] [MainThread]: On master: BEGIN
[0m00:55:26.061243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:26.223002 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:55:26.224461 [debug] [MainThread]: On master: COMMIT
[0m00:55:26.225507 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:26.226525 [debug] [MainThread]: On master: COMMIT
[0m00:55:26.240926 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:55:26.242220 [debug] [MainThread]: On master: Close
[0m00:55:26.244241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:26.244931 [debug] [MainThread]: Connection 'model.bde.host_stg' was properly closed.
[0m00:55:26.245564 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m00:55:26.246333 [info ] [MainThread]: 
[0m00:55:26.247102 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m00:55:26.248681 [debug] [MainThread]: Command end result
[0m00:55:26.254825 [info ] [MainThread]: 
[0m00:55:26.255242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:26.255597 [info ] [MainThread]: 
[0m00:55:26.255950 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:55:26.256556 [debug] [MainThread]: Command `dbt run` succeeded at 00:55:26.256473 after 1.58 seconds
[0m00:55:26.256905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab03396a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa12f02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa1304490>]}
[0m00:55:26.257231 [debug] [MainThread]: Flushing usage events
[0m01:00:44.239888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7584f5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7592d78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7592d79a0>]}


============================== 01:00:44.244398 | f03866cc-7b4f-451e-9315-dc0165bec2f0 ==============================
[0m01:00:44.244398 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:00:44.245182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:44.392745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7592d7940>]}
[0m01:00:44.404574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778d792e0>]}
[0m01:00:44.405248 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m01:00:44.432767 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:00:44.473949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m01:00:44.474603 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/property_stg.sql
[0m01:00:44.474916 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/lga_stg.sql
[0m01:00:44.475205 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_listing.sql
[0m01:00:44.475478 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/room_stg.sql
[0m01:00:44.475760 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_host.sql
[0m01:00:44.476028 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/suburb_stg.sql
[0m01:00:44.476294 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/G02_stg.sql
[0m01:00:44.476558 [debug] [MainThread]: Partial parsing: added file: bde://models/staging/G01_stg.sql
[0m01:00:44.533381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m01:00:44.538242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd748eae0d0>]}
[0m01:00:44.556802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd748dff550>]}
[0m01:00:44.557445 [info ] [MainThread]: Found 3 snapshots, 10 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m01:00:44.557839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778d8bd60>]}
[0m01:00:44.559538 [info ] [MainThread]: 
[0m01:00:44.560216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:44.561418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:00:44.561979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:00:44.572371 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:00:44.575100 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:00:44.575522 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:00:44.575846 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:00:44.576156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:44.576449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:44.796629 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m01:00:44.797005 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m01:00:44.798393 [debug] [ThreadPool]: On list_postgres: Close
[0m01:00:44.799283 [debug] [ThreadPool]: On list_postgres: Close
[0m01:00:44.801490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_warehouse'
[0m01:00:44.802225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m01:00:44.806937 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:00:44.807570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m01:00:44.809621 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:00:44.809994 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m01:00:44.811404 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:00:44.811693 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:00:44.811959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:44.812235 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m01:00:44.812498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:44.812897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:44.996050 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:44.996403 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:44.996728 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:00:44.997038 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:00:44.997369 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m01:00:44.997763 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:00:44.998102 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:00:44.998500 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:00:44.998820 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:00:45.020848 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m01:00:45.021118 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:00:45.022142 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m01:00:45.023062 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:00:45.025042 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:00:45.026018 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m01:00:45.038599 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m01:00:45.038879 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:00:45.044881 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m01:00:45.049902 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.050227 [debug] [MainThread]: On master: BEGIN
[0m01:00:45.050480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:45.207805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.209556 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.211025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:45.234967 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m01:00:45.241934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778d8e4c0>]}
[0m01:00:45.242444 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:45.255658 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.256504 [debug] [MainThread]: On master: BEGIN
[0m01:00:45.287033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.288683 [debug] [MainThread]: On master: COMMIT
[0m01:00:45.290135 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:45.291231 [debug] [MainThread]: On master: COMMIT
[0m01:00:45.306180 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.307495 [debug] [MainThread]: On master: Close
[0m01:00:45.309516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:00:45.310291 [info ] [MainThread]: 
[0m01:00:45.314992 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m01:00:45.315418 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m01:00:45.315735 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m01:00:45.316446 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m01:00:45.316116 [info ] [Thread-1  ]: 1 of 10 START sql view model staging.G01_stg ................................... [RUN]
[0m01:00:45.317083 [info ] [Thread-2  ]: 2 of 10 START sql view model staging.G02_stg ................................... [RUN]
[0m01:00:45.317668 [info ] [Thread-3  ]: 3 of 10 START sql view model staging.host_stg .................................. [RUN]
[0m01:00:45.318114 [info ] [Thread-4  ]: 4 of 10 START sql view model staging.lga_stg ................................... [RUN]
[0m01:00:45.318793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.G01_stg)
[0m01:00:45.319267 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres, now model.bde.G02_stg)
[0m01:00:45.319804 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.host_stg)
[0m01:00:45.320278 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.lga_stg)
[0m01:00:45.320607 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m01:00:45.320921 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m01:00:45.321200 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m01:00:45.321485 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m01:00:45.330616 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m01:00:45.333807 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m01:00:45.337025 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m01:00:45.340050 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m01:00:45.341535 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 01:00:45.334184 => 01:00:45.341217
[0m01:00:45.342253 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m01:00:45.356897 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 01:00:45.337414 => 01:00:45.356610
[0m01:00:45.363675 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 01:00:45.331025 => 01:00:45.363491
[0m01:00:45.364072 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 01:00:45.321704 => 01:00:45.363901
[0m01:00:45.378489 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m01:00:45.378889 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m01:00:45.379248 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m01:00:45.379580 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m01:00:45.382776 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m01:00:45.385814 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m01:00:45.388938 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m01:00:45.389314 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.390207 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.390575 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.390863 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m01:00:45.391168 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m01:00:45.391465 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.391809 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m01:00:45.392302 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:45.392613 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:00:45.392920 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m01:00:45.393210 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:00:45.393820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:45.555417 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.555840 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.556234 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.556598 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.556962 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m01:00:45.557340 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m01:00:45.560070 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.560376 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.560694 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m01:00:45.562384 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.562723 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.563042 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m01:00:45.577809 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.583299 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.583617 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.583947 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m01:00:45.586499 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.586841 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.587177 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.587510 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m01:00:45.590576 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.627685 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.628105 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.628543 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m01:00:45.628885 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m01:00:45.631213 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.631692 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m01:00:45.642871 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.645086 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.645404 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m01:00:45.646752 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.653821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.654134 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.662701 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.660505 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:00:45.663082 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.665261 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.665589 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m01:00:45.665911 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.667289 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:00:45.667632 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m01:00:45.668013 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:00:45.668333 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.668733 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:00:45.682878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.684129 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:00:45.684433 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.684710 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:00:45.686301 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.687668 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:00:45.687964 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.688263 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.688554 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.695258 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:00:45.697397 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:00:45.697734 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:00:45.698064 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m01:00:45.698376 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m01:00:45.702704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.705771 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:00:45.706094 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m01:00:45.717397 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.717702 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.718048 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:45.719164 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 01:00:45.342748 => 01:00:45.719019
[0m01:00:45.720180 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 01:00:45.383061 => 01:00:45.720043
[0m01:00:45.722243 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:00:45.722579 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m01:00:45.722896 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m01:00:45.723218 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m01:00:45.724032 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778daaeb0>]}
[0m01:00:45.724542 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd778dfabe0>]}
[0m01:00:45.726310 [info ] [Thread-2  ]: 2 of 10 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.40s]
[0m01:00:45.726934 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m01:00:45.727326 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m01:00:45.727742 [info ] [Thread-3  ]: 3 of 10 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.40s]
[0m01:00:45.728297 [info ] [Thread-2  ]: 5 of 10 START sql view model staging.listings_stg .............................. [RUN]
[0m01:00:45.728792 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m01:00:45.729305 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.listings_stg)
[0m01:00:45.729607 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.729955 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m01:00:45.730280 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m01:00:45.731471 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 01:00:45.386069 => 01:00:45.731335
[0m01:00:45.731862 [info ] [Thread-3  ]: 6 of 10 START sql view model staging.property_stg .............................. [RUN]
[0m01:00:45.735035 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m01:00:45.735599 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m01:00:45.736303 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m01:00:45.737578 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m01:00:45.739150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768e21d60>]}
[0m01:00:45.739718 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 01:00:45.732144 => 01:00:45.739530
[0m01:00:45.742302 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m01:00:45.743201 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m01:00:45.742897 [info ] [Thread-1  ]: 1 of 10 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.42s]
[0m01:00:45.746543 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m01:00:45.747081 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m01:00:45.747452 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:45.748090 [debug] [Thread-1  ]: Began running node model.bde.room_stg
[0m01:00:45.748654 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 01:00:45.739940 => 01:00:45.748389
[0m01:00:45.750079 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 01:00:45.379884 => 01:00:45.749932
[0m01:00:45.750421 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:45.750844 [info ] [Thread-1  ]: 7 of 10 START sql view model staging.room_stg .................................. [RUN]
[0m01:00:45.751319 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m01:00:45.751659 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m01:00:45.751981 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m01:00:45.752500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.room_stg)
[0m01:00:45.757423 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m01:00:45.758256 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:00:45.759533 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768e4fee0>]}
[0m01:00:45.759890 [debug] [Thread-1  ]: Began compiling node model.bde.room_stg
[0m01:00:45.763509 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.room_stg"
[0m01:00:45.760846 [info ] [Thread-4  ]: 4 of 10 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.44s]
[0m01:00:45.763985 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:45.764576 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m01:00:45.764956 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m01:00:45.765377 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m01:00:45.765798 [debug] [Thread-1  ]: Timing info for model.bde.room_stg (compile): 01:00:45.761085 => 01:00:45.765650
[0m01:00:45.766067 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:45.766937 [debug] [Thread-1  ]: Began executing node model.bde.room_stg
[0m01:00:45.766484 [info ] [Thread-4  ]: 8 of 10 START sql view model staging.suburb_stg ................................ [RUN]
[0m01:00:45.771786 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.room_stg"
[0m01:00:45.772871 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.suburb_stg)
[0m01:00:45.773710 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m01:00:45.776516 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m01:00:45.777071 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:45.777539 [debug] [Thread-1  ]: On model.bde.room_stg: BEGIN
[0m01:00:45.778228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:45.779063 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 01:00:45.774087 => 01:00:45.778803
[0m01:00:45.779395 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m01:00:45.784153 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m01:00:45.784960 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:45.785281 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m01:00:45.785570 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:00:45.927681 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.928161 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:45.928641 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m01:00:45.932945 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.933293 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.933606 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:45.933944 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:45.934354 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m01:00:45.934772 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m01:00:45.946558 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.949406 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:45.949745 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m01:00:45.951883 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:45.952184 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:45.952511 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m01:00:45.954061 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.956670 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:45.956976 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.957308 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m01:00:45.959723 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:45.960113 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m01:00:45.965308 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.967619 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:45.967936 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m01:00:45.973270 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:45.973572 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.973894 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.976317 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:45.978544 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:45.980754 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:45.981092 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m01:00:45.981420 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m01:00:45.981748 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m01:00:45.985818 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.987158 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m01:00:45.987475 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:45.987755 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m01:00:45.996382 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.996664 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.996949 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:45.998267 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m01:00:46.001560 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.002848 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m01:00:46.003178 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.003496 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m01:00:46.003818 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.004124 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m01:00:46.004504 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m01:00:46.006949 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.008966 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m01:00:46.009280 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m01:00:46.018333 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.019570 [debug] [Thread-1  ]: On model.bde.room_stg: COMMIT
[0m01:00:46.019882 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.020170 [debug] [Thread-1  ]: On model.bde.room_stg: COMMIT
[0m01:00:46.020484 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.022655 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:00:46.022951 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.023270 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m01:00:46.025232 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m01:00:46.025613 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m01:00:46.028614 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.029694 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 01:00:45.752772 => 01:00:46.029536
[0m01:00:46.030010 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m01:00:46.030748 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75947f310>]}
[0m01:00:46.031221 [info ] [Thread-3  ]: 6 of 10 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:00:46.031731 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m01:00:46.032079 [debug] [Thread-3  ]: Began running node model.bde.dim_host
[0m01:00:46.032416 [info ] [Thread-3  ]: 9 of 10 START sql view model warehouse.dim_host ................................ [RUN]
[0m01:00:46.032970 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_host)
[0m01:00:46.033272 [debug] [Thread-3  ]: Began compiling node model.bde.dim_host
[0m01:00:46.035586 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_host"
[0m01:00:46.037035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.039468 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:00:46.039839 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m01:00:46.040213 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (compile): 01:00:46.033512 => 01:00:46.040057
[0m01:00:46.040586 [debug] [Thread-3  ]: Began executing node model.bde.dim_host
[0m01:00:46.043797 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_host"
[0m01:00:46.044104 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.044394 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.045546 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 01:00:45.779619 => 01:00:46.045410
[0m01:00:46.046625 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 01:00:45.743604 => 01:00:46.046485
[0m01:00:46.047059 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m01:00:46.047403 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.047718 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m01:00:46.048132 [debug] [Thread-3  ]: On model.bde.dim_host: BEGIN
[0m01:00:46.048694 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd759477ac0>]}
[0m01:00:46.049135 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:00:46.049642 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7486cc640>]}
[0m01:00:46.050172 [info ] [Thread-4  ]: 8 of 10 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m01:00:46.050859 [info ] [Thread-2  ]: 5 of 10 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m01:00:46.051399 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m01:00:46.051833 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m01:00:46.052396 [debug] [Thread-4  ]: Began running node model.bde.fact_listing
[0m01:00:46.052782 [info ] [Thread-4  ]: 10 of 10 START sql view model warehouse.fact_listing ........................... [RUN]
[0m01:00:46.053380 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.fact_listing)
[0m01:00:46.053690 [debug] [Thread-4  ]: Began compiling node model.bde.fact_listing
[0m01:00:46.058054 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m01:00:46.058690 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.060944 [debug] [Thread-1  ]: Timing info for model.bde.room_stg (execute): 01:00:45.767455 => 01:00:46.060791
[0m01:00:46.061344 [debug] [Thread-1  ]: On model.bde.room_stg: Close
[0m01:00:46.061853 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (compile): 01:00:46.053921 => 01:00:46.061628
[0m01:00:46.062403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768edb6a0>]}
[0m01:00:46.062734 [debug] [Thread-4  ]: Began executing node model.bde.fact_listing
[0m01:00:46.067983 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m01:00:46.063233 [info ] [Thread-1  ]: 7 of 10 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m01:00:46.068729 [debug] [Thread-1  ]: Finished running node model.bde.room_stg
[0m01:00:46.069438 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.069844 [debug] [Thread-4  ]: On model.bde.fact_listing: BEGIN
[0m01:00:46.070436 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:00:46.198095 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.198547 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.198853 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m01:00:46.218875 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.219225 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:00:46.219533 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m01:00:46.221976 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.222385 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
    host_neighbourhood,
    b.lga_name as host_neighbourhood_lga_name,
    b.lga_code as host_neighbourhood_lga_code,        
    listing_neighbourhood,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 'bayside'
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 'Canterbury-Bankstown'
        ELSE c.lga_name
    END as listing_neighbourhood_lga_name,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 11100
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 11570
        ELSE c.lga_code
    END as listing_neighbourhood_lga_code,
            property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM "postgres"."staging"."listings_stg" a
LEFT JOIN lga c ON a.listing_neighbourhood = c.suburb_name
LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name;
  );
[0m01:00:46.222815 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m01:00:46.237052 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:00:46.237448 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 52: LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name;
                                                                ^

[0m01:00:46.238666 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m01:00:46.239003 [debug] [Thread-4  ]: On model.bde.fact_listing: ROLLBACK
[0m01:00:46.239324 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.239732 [debug] [Thread-3  ]: On model.bde.dim_host: COMMIT
[0m01:00:46.251822 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (execute): 01:00:46.063426 => 01:00:46.251651
[0m01:00:46.252150 [debug] [Thread-4  ]: On model.bde.fact_listing: Close
[0m01:00:46.256370 [debug] [Thread-4  ]: Database Error in model fact_listing (models/warehouse/fact_listing.sql)
  syntax error at or near ";"
  LINE 52: LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name;
                                                                  ^
  compiled Code at target/run/bde/models/warehouse/fact_listing.sql
[0m01:00:46.256784 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd748ec4fd0>]}
[0m01:00:46.257266 [error] [Thread-4  ]: 10 of 10 ERROR creating sql view model warehouse.fact_listing .................. [[31mERROR[0m in 0.20s]
[0m01:00:46.257784 [debug] [Thread-4  ]: Finished running node model.bde.fact_listing
[0m01:00:46.259213 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.261479 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_host"
[0m01:00:46.261827 [debug] [Thread-3  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m01:00:46.280230 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:00:46.281583 [debug] [Thread-3  ]: Timing info for model.bde.dim_host (execute): 01:00:46.040803 => 01:00:46.281437
[0m01:00:46.281913 [debug] [Thread-3  ]: On model.bde.dim_host: Close
[0m01:00:46.282608 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f03866cc-7b4f-451e-9315-dc0165bec2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd758096760>]}
[0m01:00:46.283078 [info ] [Thread-3  ]: 9 of 10 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.25s]
[0m01:00:46.283653 [debug] [Thread-3  ]: Finished running node model.bde.dim_host
[0m01:00:46.285177 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.285476 [debug] [MainThread]: On master: BEGIN
[0m01:00:46.285723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:00:46.449115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:00:46.450875 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.451938 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:46.452893 [debug] [MainThread]: On master: COMMIT
[0m01:00:46.466620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:00:46.468045 [debug] [MainThread]: On master: Close
[0m01:00:46.470122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:46.470769 [debug] [MainThread]: Connection 'model.bde.room_stg' was properly closed.
[0m01:00:46.471031 [debug] [MainThread]: Connection 'model.bde.listings_stg' was properly closed.
[0m01:00:46.471259 [debug] [MainThread]: Connection 'model.bde.dim_host' was properly closed.
[0m01:00:46.471478 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m01:00:46.471819 [info ] [MainThread]: 
[0m01:00:46.472151 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m01:00:46.473724 [debug] [MainThread]: Command end result
[0m01:00:46.480520 [info ] [MainThread]: 
[0m01:00:46.480918 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:00:46.481226 [info ] [MainThread]: 
[0m01:00:46.481512 [error] [MainThread]:   Database Error in model fact_listing (models/warehouse/fact_listing.sql)
  syntax error at or near ";"
  LINE 52: LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name;
                                                                  ^
  compiled Code at target/run/bde/models/warehouse/fact_listing.sql
[0m01:00:46.481872 [info ] [MainThread]: 
[0m01:00:46.482204 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m01:00:46.482742 [debug] [MainThread]: Command `dbt run` failed at 01:00:46.482654 after 2.28 seconds
[0m01:00:46.483090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7584f5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7594c0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd748ec1790>]}
[0m01:00:46.483418 [debug] [MainThread]: Flushing usage events
[0m01:01:24.715294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4383496a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4393377c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4393378b0>]}


============================== 01:01:24.719966 | 3a66c428-6f2a-42bd-8140-f7223766c7bd ==============================
[0m01:01:24.719966 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:01:24.720729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:01:24.833140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff439337850>]}
[0m01:01:24.844875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff439420220>]}
[0m01:01:24.845558 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m01:01:24.867054 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:01:24.908151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:01:24.909051 [debug] [MainThread]: Partial parsing: updated file: bde://models/warehouse/fact_listing.sql
[0m01:01:24.945129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m01:01:24.949671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44960c0d0>]}
[0m01:01:24.964175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff418c833d0>]}
[0m01:01:24.964663 [info ] [MainThread]: Found 3 snapshots, 10 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m01:01:24.965007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff439432f70>]}
[0m01:01:24.966671 [info ] [MainThread]: 
[0m01:01:24.967378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:01:24.968582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:01:24.969174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:01:24.980668 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:01:24.982449 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:01:24.982842 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:01:24.983175 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:01:24.983508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:24.983798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:25.207644 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m01:01:25.208019 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m01:01:25.209391 [debug] [ThreadPool]: On list_postgres: Close
[0m01:01:25.210321 [debug] [ThreadPool]: On list_postgres: Close
[0m01:01:25.212488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m01:01:25.217132 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:01:25.217684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m01:01:25.217964 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m01:01:25.219660 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:01:25.220168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m01:01:25.220503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:25.220782 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m01:01:25.222839 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:01:25.223276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:25.223651 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:01:25.224058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:25.371220 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.371648 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:01:25.371939 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m01:01:25.395665 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:01:25.398256 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m01:01:25.398598 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.398874 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.399200 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:01:25.399507 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:01:25.399828 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:01:25.400166 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:01:25.412790 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m01:01:25.421181 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:01:25.421985 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:01:25.424409 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m01:01:25.425527 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:01:25.441059 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m01:01:25.441912 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:01:25.449470 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:25.449809 [debug] [MainThread]: On master: BEGIN
[0m01:01:25.450065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:25.610131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.611559 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:25.612715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:01:25.636235 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m01:01:25.643686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4394352e0>]}
[0m01:01:25.644192 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:25.657784 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:25.658742 [debug] [MainThread]: On master: BEGIN
[0m01:01:25.692790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.694458 [debug] [MainThread]: On master: COMMIT
[0m01:01:25.695488 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:25.696480 [debug] [MainThread]: On master: COMMIT
[0m01:01:25.712015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:01:25.713412 [debug] [MainThread]: On master: Close
[0m01:01:25.715668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:01:25.716507 [info ] [MainThread]: 
[0m01:01:25.721126 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m01:01:25.721591 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m01:01:25.721919 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m01:01:25.722747 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m01:01:25.722423 [info ] [Thread-1  ]: 1 of 10 START sql view model staging.G01_stg ................................... [RUN]
[0m01:01:25.723289 [info ] [Thread-2  ]: 2 of 10 START sql view model staging.G02_stg ................................... [RUN]
[0m01:01:25.723730 [info ] [Thread-3  ]: 3 of 10 START sql view model staging.host_stg .................................. [RUN]
[0m01:01:25.724840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G01_stg)
[0m01:01:25.724242 [info ] [Thread-4  ]: 4 of 10 START sql view model staging.lga_stg ................................... [RUN]
[0m01:01:25.725514 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.G02_stg)
[0m01:01:25.726011 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.host_stg)
[0m01:01:25.726341 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m01:01:25.726888 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.lga_stg'
[0m01:01:25.727202 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m01:01:25.727518 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m01:01:25.734637 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m01:01:25.735026 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m01:01:25.737364 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m01:01:25.740363 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m01:01:25.744008 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m01:01:25.744842 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 01:01:25.727755 => 01:01:25.744649
[0m01:01:25.745416 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 01:01:25.735265 => 01:01:25.745255
[0m01:01:25.745781 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m01:01:25.746181 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m01:01:25.746539 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 01:01:25.740957 => 01:01:25.746397
[0m01:01:25.753367 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 01:01:25.737626 => 01:01:25.753090
[0m01:01:25.790164 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m01:01:25.790926 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m01:01:25.791267 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m01:01:25.791625 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m01:01:25.795272 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m01:01:25.795769 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:01:25.798881 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m01:01:25.799206 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:01:25.799867 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m01:01:25.800347 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m01:01:25.800719 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:01:25.801021 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:01:25.801326 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:01:25.801615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:01:25.802114 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m01:01:25.802471 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m01:01:25.802871 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:01:25.803199 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:01:25.955250 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.955709 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:01:25.956039 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m01:01:25.962152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.962453 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:01:25.962747 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m01:01:25.964582 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.964914 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:01:25.965223 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m01:01:25.971645 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:25.971936 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:01:25.972261 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m01:01:25.972639 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:25.977783 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:01:25.978122 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m01:01:25.982063 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:25.984687 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:01:25.985030 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m01:01:25.992139 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:25.992474 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:25.992748 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:25.994967 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:01:25.997539 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:01:26.034354 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.035536 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:01:26.035912 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m01:01:26.036245 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m01:01:26.038494 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:01:26.038822 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m01:01:26.039298 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m01:01:26.053723 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.054010 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.056323 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:01:26.056674 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.063279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.069938 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m01:01:26.070419 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:01:26.071707 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:01:26.073999 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:01:26.074441 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:01:26.074792 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:01:26.075114 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m01:01:26.075415 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:01:26.075716 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:01:26.088835 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.090153 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:01:26.090458 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:01:26.090730 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:01:26.092154 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.098545 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:01:26.098865 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.099151 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.099476 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m01:01:26.100739 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:01:26.102859 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:01:26.103258 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:01:26.103652 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m01:01:26.103974 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:01:26.107667 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.109631 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:01:26.109934 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m01:01:26.118279 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.119360 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 01:01:25.792156 => 01:01:26.119217
[0m01:01:26.119663 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m01:01:26.120338 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4287be280>]}
[0m01:01:26.121169 [info ] [Thread-4  ]: 4 of 10 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.39s]
[0m01:01:26.121821 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m01:01:26.122168 [debug] [Thread-4  ]: Began running node model.bde.listings_stg
[0m01:01:26.122592 [info ] [Thread-4  ]: 5 of 10 START sql view model staging.listings_stg .............................. [RUN]
[0m01:01:26.123147 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.listings_stg)
[0m01:01:26.123527 [debug] [Thread-4  ]: Began compiling node model.bde.listings_stg
[0m01:01:26.123857 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.124127 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.126659 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m01:01:26.130181 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:01:26.130505 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.131593 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 01:01:25.760091 => 01:01:26.131451
[0m01:01:26.132023 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m01:01:26.133113 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 01:01:25.795988 => 01:01:26.132974
[0m01:01:26.133498 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m01:01:26.133964 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (compile): 01:01:26.124316 => 01:01:26.133775
[0m01:01:26.134273 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m01:01:26.134723 [debug] [Thread-4  ]: Began executing node model.bde.listings_stg
[0m01:01:26.135256 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff428890fd0>]}
[0m01:01:26.135855 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4394352e0>]}
[0m01:01:26.141077 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m01:01:26.141772 [info ] [Thread-2  ]: 2 of 10 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.41s]
[0m01:01:26.142348 [info ] [Thread-3  ]: 3 of 10 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.41s]
[0m01:01:26.143030 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m01:01:26.143588 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m01:01:26.143939 [debug] [Thread-2  ]: Began running node model.bde.property_stg
[0m01:01:26.144357 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:01:26.144747 [debug] [Thread-3  ]: Began running node model.bde.room_stg
[0m01:01:26.145233 [info ] [Thread-2  ]: 6 of 10 START sql view model staging.property_stg .............................. [RUN]
[0m01:01:26.145648 [debug] [Thread-4  ]: On model.bde.listings_stg: BEGIN
[0m01:01:26.146012 [info ] [Thread-3  ]: 7 of 10 START sql view model staging.room_stg .................................. [RUN]
[0m01:01:26.146592 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.property_stg)
[0m01:01:26.146891 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:01:26.147363 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.room_stg)
[0m01:01:26.148084 [debug] [Thread-2  ]: Began compiling node model.bde.property_stg
[0m01:01:26.148538 [debug] [Thread-3  ]: Began compiling node model.bde.room_stg
[0m01:01:26.151089 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.property_stg"
[0m01:01:26.154427 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.room_stg"
[0m01:01:26.155549 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (compile): 01:01:26.148823 => 01:01:26.155299
[0m01:01:26.156121 [debug] [Thread-2  ]: Began executing node model.bde.property_stg
[0m01:01:26.156631 [debug] [Thread-3  ]: Timing info for model.bde.room_stg (compile): 01:01:26.151372 => 01:01:26.156425
[0m01:01:26.160874 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.property_stg"
[0m01:01:26.161306 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.161825 [debug] [Thread-3  ]: Began executing node model.bde.room_stg
[0m01:01:26.163320 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 01:01:25.746777 => 01:01:26.163173
[0m01:01:26.166737 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.room_stg"
[0m01:01:26.167140 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m01:01:26.167488 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:01:26.168025 [debug] [Thread-2  ]: On model.bde.property_stg: BEGIN
[0m01:01:26.168663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44964fdf0>]}
[0m01:01:26.169013 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m01:01:26.169298 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:01:26.170161 [debug] [Thread-3  ]: On model.bde.room_stg: BEGIN
[0m01:01:26.169765 [info ] [Thread-1  ]: 1 of 10 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.44s]
[0m01:01:26.170951 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:01:26.171711 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m01:01:26.172367 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m01:01:26.173052 [info ] [Thread-1  ]: 8 of 10 START sql view model staging.suburb_stg ................................ [RUN]
[0m01:01:26.173656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.suburb_stg)
[0m01:01:26.173988 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m01:01:26.176590 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m01:01:26.177239 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 01:01:26.174201 => 01:01:26.177067
[0m01:01:26.177659 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m01:01:26.182569 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m01:01:26.183168 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:01:26.183474 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m01:01:26.183751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:01:26.319733 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.320202 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:01:26.320559 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m01:01:26.331204 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.331789 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m01:01:26.332238 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m01:01:26.338434 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.338762 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:01:26.339086 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m01:01:26.339532 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:26.342351 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:01:26.342674 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m01:01:26.354248 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:26.354565 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.357190 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m01:01:26.357521 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:01:26.357827 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m01:01:26.358188 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m01:01:26.358578 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:26.361103 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:01:26.361457 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.361769 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m01:01:26.364050 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:01:26.364462 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m01:01:26.373081 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.373380 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:26.375628 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m01:01:26.378058 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:01:26.378378 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m01:01:26.378692 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m01:01:26.382658 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.382940 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.384240 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m01:01:26.386577 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:01:26.386901 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:01:26.387229 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m01:01:26.387547 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m01:01:26.392110 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.393328 [debug] [Thread-3  ]: On model.bde.room_stg: COMMIT
[0m01:01:26.393636 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m01:01:26.393911 [debug] [Thread-3  ]: On model.bde.room_stg: COMMIT
[0m01:01:26.396052 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.398255 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:01:26.398571 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m01:01:26.400296 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.401541 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m01:01:26.401859 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:01:26.402164 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.402446 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m01:01:26.405527 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:01:26.405948 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m01:01:26.413205 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.415193 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m01:01:26.415487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.415786 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m01:01:26.417078 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m01:01:26.417440 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:01:26.417724 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m01:01:26.422594 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.422877 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.424959 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:01:26.426020 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (execute): 01:01:26.136176 => 01:01:26.425872
[0m01:01:26.426383 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m01:01:26.426704 [debug] [Thread-4  ]: On model.bde.listings_stg: Close
[0m01:01:26.427414 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff439435c70>]}
[0m01:01:26.427886 [info ] [Thread-4  ]: 5 of 10 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m01:01:26.428441 [debug] [Thread-4  ]: Finished running node model.bde.listings_stg
[0m01:01:26.428797 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m01:01:26.429205 [info ] [Thread-4  ]: 9 of 10 START sql view model warehouse.dim_host ................................ [RUN]
[0m01:01:26.429747 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_host)
[0m01:01:26.430042 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m01:01:26.432262 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m01:01:26.432882 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 01:01:26.430247 => 01:01:26.432734
[0m01:01:26.433177 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m01:01:26.436634 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m01:01:26.436945 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.439127 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:01:26.439444 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.439876 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m01:01:26.441006 [debug] [Thread-3  ]: Timing info for model.bde.room_stg (execute): 01:01:26.163627 => 01:01:26.440865
[0m01:01:26.441433 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m01:01:26.441734 [debug] [Thread-3  ]: On model.bde.room_stg: Close
[0m01:01:26.442037 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m01:01:26.442437 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:01:26.442960 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4394c1c10>]}
[0m01:01:26.443652 [info ] [Thread-3  ]: 7 of 10 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.30s]
[0m01:01:26.444177 [debug] [Thread-3  ]: Finished running node model.bde.room_stg
[0m01:01:26.446736 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.447880 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (execute): 01:01:26.156955 => 01:01:26.447738
[0m01:01:26.448187 [debug] [Thread-2  ]: On model.bde.property_stg: Close
[0m01:01:26.448826 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44953bc40>]}
[0m01:01:26.449259 [info ] [Thread-2  ]: 6 of 10 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m01:01:26.449808 [debug] [Thread-2  ]: Finished running node model.bde.property_stg
[0m01:01:26.456204 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.457985 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 01:01:26.177963 => 01:01:26.457789
[0m01:01:26.458351 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m01:01:26.459359 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44964fdf0>]}
[0m01:01:26.460576 [info ] [Thread-1  ]: 8 of 10 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:01:26.461239 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m01:01:26.461860 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m01:01:26.462383 [info ] [Thread-3  ]: 10 of 10 START sql view model warehouse.fact_listing ........................... [RUN]
[0m01:01:26.462994 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_listing)
[0m01:01:26.463299 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m01:01:26.466347 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m01:01:26.467104 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 01:01:26.463508 => 01:01:26.466941
[0m01:01:26.467407 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m01:01:26.470619 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m01:01:26.471383 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:01:26.471934 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m01:01:26.472364 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:01:26.607908 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.608726 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m01:01:26.609338 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m01:01:26.625702 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.626170 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:01:26.626538 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
    host_neighbourhood,
    b.lga_name as host_neighbourhood_lga_name,
    b.lga_code as host_neighbourhood_lga_code,        
    listing_neighbourhood,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 'bayside'
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 'Canterbury-Bankstown'
        ELSE c.lga_name
    END as listing_neighbourhood_lga_name,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 11100
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 11570
        ELSE c.lga_code
    END as listing_neighbourhood_lga_code,
            property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM "postgres"."staging"."listings_stg" a
LEFT JOIN lga c ON a.listing_neighbourhood = c.suburb_name
LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name
  );
[0m01:01:26.627019 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:26.630989 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m01:01:26.631334 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m01:01:26.648447 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:01:26.648761 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.651098 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:01:26.652234 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m01:01:26.652572 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m01:01:26.653051 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m01:01:26.653412 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m01:01:26.667017 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.669201 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m01:01:26.669491 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:01:26.669835 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m01:01:26.671067 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m01:01:26.671445 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:01:26.671737 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m01:01:26.686109 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.686429 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.688489 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:01:26.689564 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 01:01:26.433383 => 01:01:26.689421
[0m01:01:26.689888 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m01:01:26.690215 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m01:01:26.690987 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449621160>]}
[0m01:01:26.691455 [info ] [Thread-4  ]: 9 of 10 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.26s]
[0m01:01:26.691967 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m01:01:26.705155 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:01:26.707212 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 01:01:26.467616 => 01:01:26.707062
[0m01:01:26.707556 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m01:01:26.708292 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a66c428-6f2a-42bd-8140-f7223766c7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4496692b0>]}
[0m01:01:26.708759 [info ] [Thread-3  ]: 10 of 10 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m01:01:26.709261 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m01:01:26.710544 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:26.710809 [debug] [MainThread]: On master: BEGIN
[0m01:01:26.711041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:26.877660 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:01:26.879411 [debug] [MainThread]: On master: COMMIT
[0m01:01:26.880456 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:26.881357 [debug] [MainThread]: On master: COMMIT
[0m01:01:26.896864 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:01:26.898102 [debug] [MainThread]: On master: Close
[0m01:01:26.900136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:26.900877 [debug] [MainThread]: Connection 'model.bde.suburb_stg' was properly closed.
[0m01:01:26.901495 [debug] [MainThread]: Connection 'model.bde.property_stg' was properly closed.
[0m01:01:26.902105 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m01:01:26.902698 [debug] [MainThread]: Connection 'model.bde.dim_host' was properly closed.
[0m01:01:26.903131 [info ] [MainThread]: 
[0m01:01:26.903466 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m01:01:26.905026 [debug] [MainThread]: Command end result
[0m01:01:26.911800 [info ] [MainThread]: 
[0m01:01:26.912265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:01:26.912580 [info ] [MainThread]: 
[0m01:01:26.912879 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:01:26.913472 [debug] [MainThread]: Command `dbt run` succeeded at 01:01:26.913383 after 2.24 seconds
[0m01:01:26.913806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4383496a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff439420220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449692550>]}
[0m01:01:26.914118 [debug] [MainThread]: Flushing usage events
[0m01:02:45.459124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd04716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0e77820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0e77910>]}


============================== 01:02:45.463290 | 1cb150d1-76d8-4e69-b730-71b763d405ed ==============================
[0m01:02:45.463290 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:02:45.464056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:02:45.614231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0e77850>]}
[0m01:02:45.626104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0f20280>]}
[0m01:02:45.626774 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m01:02:45.649987 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:02:45.692339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m01:02:45.692959 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G02.sql
[0m01:02:45.693272 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_room.sql
[0m01:02:45.693551 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_census_G01.sql
[0m01:02:45.693831 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/dim_property.sql
[0m01:02:45.694098 [debug] [MainThread]: Partial parsing: added file: bde://models/warehouse/fact_lge.sql
[0m01:02:45.737330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.bde.datamart
[0m01:02:45.744721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0ff90d0>]}
[0m01:02:45.763336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe0d9b7f0>]}
[0m01:02:45.763927 [info ] [MainThread]: Found 3 snapshots, 15 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m01:02:45.764358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc086c1c0>]}
[0m01:02:45.766190 [info ] [MainThread]: 
[0m01:02:45.766867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:45.768271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:45.768852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:45.779794 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:45.781628 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:45.781976 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:45.782308 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:45.782603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:45.782896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:46.003804 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m01:02:46.005282 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:46.007192 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m01:02:46.008116 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:46.010080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m01:02:46.014704 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:02:46.015099 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m01:02:46.015603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m01:02:46.016230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m01:02:46.016495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:46.018583 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:02:46.020035 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:02:46.020546 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m01:02:46.020858 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m01:02:46.021230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:46.021536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:46.187120 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.188569 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m01:02:46.189515 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:02:46.196231 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.197140 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m01:02:46.197965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.198886 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m01:02:46.199665 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m01:02:46.200574 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m01:02:46.209792 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:02:46.212567 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m01:02:46.221309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:02:46.221989 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:02:46.224248 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m01:02:46.225484 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m01:02:46.227545 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m01:02:46.244320 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m01:02:46.245201 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m01:02:46.252854 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.253203 [debug] [MainThread]: On master: BEGIN
[0m01:02:46.253541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:46.411766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.413668 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.415137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:02:46.438760 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m01:02:46.446412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe0d9b7f0>]}
[0m01:02:46.446926 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:46.459433 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.460300 [debug] [MainThread]: On master: BEGIN
[0m01:02:46.496086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.497818 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.499013 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:46.500028 [debug] [MainThread]: On master: COMMIT
[0m01:02:46.513905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:02:46.515209 [debug] [MainThread]: On master: Close
[0m01:02:46.517439 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:46.518310 [info ] [MainThread]: 
[0m01:02:46.522962 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m01:02:46.523804 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m01:02:46.524202 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m01:02:46.524543 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m01:02:46.525050 [info ] [Thread-1  ]: 1 of 15 START sql view model staging.G01_stg ................................... [RUN]
[0m01:02:46.525476 [info ] [Thread-2  ]: 2 of 15 START sql view model staging.G02_stg ................................... [RUN]
[0m01:02:46.525925 [info ] [Thread-3  ]: 3 of 15 START sql view model staging.host_stg .................................. [RUN]
[0m01:02:46.526579 [info ] [Thread-4  ]: 4 of 15 START sql view model staging.lga_stg ................................... [RUN]
[0m01:02:46.527285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.G01_stg)
[0m01:02:46.527803 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G02_stg)
[0m01:02:46.528303 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.host_stg)
[0m01:02:46.528874 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.bde.lga_stg'
[0m01:02:46.529193 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m01:02:46.529495 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m01:02:46.529813 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m01:02:46.530107 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m01:02:46.537419 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m01:02:46.540193 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m01:02:46.544526 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m01:02:46.547118 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m01:02:46.548470 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 01:02:46.544949 => 01:02:46.548280
[0m01:02:46.548954 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 01:02:46.540810 => 01:02:46.548753
[0m01:02:46.549400 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 01:02:46.530343 => 01:02:46.549251
[0m01:02:46.549742 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 01:02:46.537720 => 01:02:46.549596
[0m01:02:46.550070 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m01:02:46.550380 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m01:02:46.550674 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m01:02:46.550962 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m01:02:46.582381 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m01:02:46.585821 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m01:02:46.588938 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m01:02:46.593588 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m01:02:46.594935 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:02:46.595499 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:02:46.596126 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:02:46.596550 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:02:46.596923 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m01:02:46.597449 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m01:02:46.598016 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m01:02:46.598460 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m01:02:46.598843 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:02:46.599262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:02:46.599650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:46.600083 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:02:46.752867 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.753330 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:02:46.753657 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m01:02:46.761629 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.761919 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:02:46.762242 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m01:02:46.767151 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.767461 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:46.767779 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:02:46.768092 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:02:46.768413 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m01:02:46.768752 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m01:02:46.773505 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:46.778812 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:02:46.779226 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m01:02:46.779551 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:46.782125 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:02:46.782445 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m01:02:46.788041 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:46.790612 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:02:46.790928 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m01:02:46.794587 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:46.797700 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:02:46.798000 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.798277 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.798587 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m01:02:46.834221 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.835607 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:02:46.837874 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:02:46.840120 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:02:46.840456 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m01:02:46.840790 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m01:02:46.841100 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m01:02:46.852841 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.855177 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:02:46.855487 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m01:02:46.857253 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.863596 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.863907 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.879215 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:02:46.880485 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:02:46.881513 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:02:46.881818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:46.882152 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:02:46.882463 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:02:46.882765 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:02:46.883994 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:02:46.884305 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m01:02:46.884598 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m01:02:46.884900 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m01:02:46.885242 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:02:46.885714 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m01:02:46.901576 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:46.908333 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m01:02:46.908680 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:46.908977 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:46.909283 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:46.909608 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m01:02:46.911584 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m01:02:46.913627 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m01:02:46.916426 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m01:02:46.916841 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m01:02:46.917175 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m01:02:46.917506 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m01:02:46.933338 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:46.934537 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 01:02:46.551181 => 01:02:46.934328
[0m01:02:46.934868 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m01:02:46.935573 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd1845e20>]}
[0m01:02:46.935889 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:46.936958 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 01:02:46.589303 => 01:02:46.936817
[0m01:02:46.937277 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m01:02:46.937907 [info ] [Thread-4  ]: 4 of 15 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.41s]
[0m01:02:46.938627 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0f74490>]}
[0m01:02:46.938920 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:46.939204 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:46.939653 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m01:02:46.940126 [info ] [Thread-2  ]: 2 of 15 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.41s]
[0m01:02:46.941290 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 01:02:46.586117 => 01:02:46.941158
[0m01:02:46.942568 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 01:02:46.582732 => 01:02:46.942384
[0m01:02:46.943045 [debug] [Thread-4  ]: Began running node model.bde.listings_stg
[0m01:02:46.943566 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m01:02:46.943906 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m01:02:46.944238 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m01:02:46.945072 [debug] [Thread-2  ]: Began running node model.bde.property_stg
[0m01:02:46.944721 [info ] [Thread-4  ]: 5 of 15 START sql view model staging.listings_stg .............................. [RUN]
[0m01:02:46.945939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd1824fa0>]}
[0m01:02:46.946877 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa000e6d0>]}
[0m01:02:46.946369 [info ] [Thread-2  ]: 6 of 15 START sql view model staging.property_stg .............................. [RUN]
[0m01:02:46.947471 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.listings_stg)
[0m01:02:46.947957 [info ] [Thread-1  ]: 1 of 15 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.42s]
[0m01:02:46.948454 [info ] [Thread-3  ]: 3 of 15 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.42s]
[0m01:02:46.948983 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.property_stg)
[0m01:02:46.949289 [debug] [Thread-4  ]: Began compiling node model.bde.listings_stg
[0m01:02:46.949711 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m01:02:46.950290 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m01:02:46.950689 [debug] [Thread-2  ]: Began compiling node model.bde.property_stg
[0m01:02:46.953611 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m01:02:46.954013 [debug] [Thread-1  ]: Began running node model.bde.room_stg
[0m01:02:46.954553 [debug] [Thread-3  ]: Began running node model.bde.suburb_stg
[0m01:02:46.958522 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.property_stg"
[0m01:02:46.959321 [info ] [Thread-1  ]: 7 of 15 START sql view model staging.room_stg .................................. [RUN]
[0m01:02:46.959838 [info ] [Thread-3  ]: 8 of 15 START sql view model staging.suburb_stg ................................ [RUN]
[0m01:02:46.960624 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (compile): 01:02:46.950919 => 01:02:46.960458
[0m01:02:46.961172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.room_stg)
[0m01:02:46.961668 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.suburb_stg)
[0m01:02:46.962001 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (compile): 01:02:46.954983 => 01:02:46.961863
[0m01:02:46.962301 [debug] [Thread-4  ]: Began executing node model.bde.listings_stg
[0m01:02:46.962600 [debug] [Thread-1  ]: Began compiling node model.bde.room_stg
[0m01:02:46.962893 [debug] [Thread-3  ]: Began compiling node model.bde.suburb_stg
[0m01:02:46.963178 [debug] [Thread-2  ]: Began executing node model.bde.property_stg
[0m01:02:46.966498 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m01:02:46.969030 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.room_stg"
[0m01:02:46.971207 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m01:02:46.975434 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.property_stg"
[0m01:02:46.976833 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:02:46.977656 [debug] [Thread-3  ]: Timing info for model.bde.suburb_stg (compile): 01:02:46.969286 => 01:02:46.977305
[0m01:02:46.978137 [debug] [Thread-4  ]: On model.bde.listings_stg: BEGIN
[0m01:02:46.978678 [debug] [Thread-3  ]: Began executing node model.bde.suburb_stg
[0m01:02:46.979045 [debug] [Thread-1  ]: Timing info for model.bde.room_stg (compile): 01:02:46.966822 => 01:02:46.978908
[0m01:02:46.979414 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:02:46.979724 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:02:46.983215 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m01:02:46.983583 [debug] [Thread-1  ]: Began executing node model.bde.room_stg
[0m01:02:46.983910 [debug] [Thread-2  ]: On model.bde.property_stg: BEGIN
[0m01:02:46.988285 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.room_stg"
[0m01:02:46.988961 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:02:46.989423 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:02:46.990198 [debug] [Thread-3  ]: On model.bde.suburb_stg: BEGIN
[0m01:02:46.990676 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:02:46.991434 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:02:46.991885 [debug] [Thread-1  ]: On model.bde.room_stg: BEGIN
[0m01:02:46.992170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:47.134732 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.135204 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:02:47.135560 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m01:02:47.138839 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.139289 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:02:47.139658 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m01:02:47.144896 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.145193 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:02:47.145490 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m01:02:47.149081 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.149377 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:02:47.149695 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m01:02:47.154270 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.157372 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:02:47.157772 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m01:02:47.158164 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.160615 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:02:47.160933 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m01:02:47.161317 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.163755 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:02:47.164078 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m01:02:47.166298 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.168616 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:02:47.168941 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m01:02:47.174337 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.176538 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:02:47.176856 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m01:02:47.178747 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.180985 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:02:47.181303 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m01:02:47.181643 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.183709 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:02:47.184016 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m01:02:47.184365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.186454 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:02:47.186760 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m01:02:47.195079 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.197398 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m01:02:47.197722 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:02:47.198002 [debug] [Thread-4  ]: On model.bde.listings_stg: COMMIT
[0m01:02:47.198363 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.198666 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.199921 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m01:02:47.201124 [debug] [Thread-3  ]: On model.bde.suburb_stg: COMMIT
[0m01:02:47.201441 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:02:47.201744 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:02:47.202051 [debug] [Thread-2  ]: On model.bde.property_stg: COMMIT
[0m01:02:47.202349 [debug] [Thread-3  ]: On model.bde.suburb_stg: COMMIT
[0m01:02:47.202725 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.203958 [debug] [Thread-1  ]: On model.bde.room_stg: COMMIT
[0m01:02:47.204253 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:02:47.204525 [debug] [Thread-1  ]: On model.bde.room_stg: COMMIT
[0m01:02:47.215029 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.217240 [debug] [Thread-4  ]: Using postgres connection "model.bde.listings_stg"
[0m01:02:47.217558 [debug] [Thread-4  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m01:02:47.219121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.219424 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.221405 [debug] [Thread-1  ]: Using postgres connection "model.bde.room_stg"
[0m01:02:47.221693 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.223623 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m01:02:47.223942 [debug] [Thread-1  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m01:02:47.225876 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m01:02:47.226197 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m01:02:47.226571 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m01:02:47.235024 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.236113 [debug] [Thread-4  ]: Timing info for model.bde.listings_stg (execute): 01:02:46.963408 => 01:02:47.235968
[0m01:02:47.236419 [debug] [Thread-4  ]: On model.bde.listings_stg: Close
[0m01:02:47.237097 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb114a400>]}
[0m01:02:47.237555 [info ] [Thread-4  ]: 5 of 15 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:02:47.238089 [debug] [Thread-4  ]: Finished running node model.bde.listings_stg
[0m01:02:47.238444 [debug] [Thread-4  ]: Began running node model.bde.fact_census_G02
[0m01:02:47.238895 [info ] [Thread-4  ]: 9 of 15 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m01:02:47.239408 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_census_G02)
[0m01:02:47.239699 [debug] [Thread-4  ]: Began compiling node model.bde.fact_census_G02
[0m01:02:47.241996 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m01:02:47.242306 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.243440 [debug] [Thread-1  ]: Timing info for model.bde.room_stg (execute): 01:02:46.984452 => 01:02:47.243301
[0m01:02:47.243786 [debug] [Thread-1  ]: On model.bde.room_stg: Close
[0m01:02:47.244566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe00c88b0>]}
[0m01:02:47.244977 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.246528 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (execute): 01:02:46.971488 => 01:02:47.246390
[0m01:02:47.245447 [info ] [Thread-1  ]: 7 of 15 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.28s]
[0m01:02:47.246968 [debug] [Thread-2  ]: On model.bde.property_stg: Close
[0m01:02:47.247534 [debug] [Thread-1  ]: Finished running node model.bde.room_stg
[0m01:02:47.247919 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.248269 [debug] [Thread-4  ]: Timing info for model.bde.fact_census_G02 (compile): 01:02:47.239905 => 01:02:47.248127
[0m01:02:47.248771 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa0022fd0>]}
[0m01:02:47.249177 [debug] [Thread-1  ]: Began running node model.bde.fact_census_G01
[0m01:02:47.250391 [debug] [Thread-3  ]: Timing info for model.bde.suburb_stg (execute): 01:02:46.979956 => 01:02:47.250256
[0m01:02:47.250705 [debug] [Thread-4  ]: Began executing node model.bde.fact_census_G02
[0m01:02:47.251142 [info ] [Thread-2  ]: 6 of 15 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m01:02:47.251598 [info ] [Thread-1  ]: 10 of 15 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m01:02:47.252028 [debug] [Thread-3  ]: On model.bde.suburb_stg: Close
[0m01:02:47.255364 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m01:02:47.256228 [debug] [Thread-2  ]: Finished running node model.bde.property_stg
[0m01:02:47.257103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_census_G01)
[0m01:02:47.257959 [debug] [Thread-2  ]: Began running node model.bde.dim_host
[0m01:02:47.259135 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0fc60a0>]}
[0m01:02:47.259882 [debug] [Thread-1  ]: Began compiling node model.bde.fact_census_G01
[0m01:02:47.260718 [info ] [Thread-2  ]: 11 of 15 START sql view model warehouse.dim_host ............................... [RUN]
[0m01:02:47.261642 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:02:47.264162 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m01:02:47.261300 [info ] [Thread-3  ]: 8 of 15 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m01:02:47.264814 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_host)
[0m01:02:47.265141 [debug] [Thread-4  ]: On model.bde.fact_census_G02: BEGIN
[0m01:02:47.265644 [debug] [Thread-3  ]: Finished running node model.bde.suburb_stg
[0m01:02:47.265960 [debug] [Thread-2  ]: Began compiling node model.bde.dim_host
[0m01:02:47.266401 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G01 (compile): 01:02:47.261851 => 01:02:47.266259
[0m01:02:47.266689 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:02:47.267179 [debug] [Thread-3  ]: Began running node model.bde.dim_room
[0m01:02:47.269590 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_host"
[0m01:02:47.270275 [debug] [Thread-1  ]: Began executing node model.bde.fact_census_G01
[0m01:02:47.271072 [info ] [Thread-3  ]: 12 of 15 START sql view model warehouse.dim_room ............................... [RUN]
[0m01:02:47.277382 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m01:02:47.278097 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_room)
[0m01:02:47.278510 [debug] [Thread-2  ]: Timing info for model.bde.dim_host (compile): 01:02:47.267462 => 01:02:47.278334
[0m01:02:47.278919 [debug] [Thread-3  ]: Began compiling node model.bde.dim_room
[0m01:02:47.279286 [debug] [Thread-2  ]: Began executing node model.bde.dim_host
[0m01:02:47.279599 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:02:47.281898 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_room"
[0m01:02:47.285582 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_host"
[0m01:02:47.285970 [debug] [Thread-1  ]: On model.bde.fact_census_G01: BEGIN
[0m01:02:47.286434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:47.287117 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m01:02:47.287499 [debug] [Thread-2  ]: On model.bde.dim_host: BEGIN
[0m01:02:47.287816 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:02:47.288192 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (compile): 01:02:47.279824 => 01:02:47.288038
[0m01:02:47.288601 [debug] [Thread-3  ]: Began executing node model.bde.dim_room
[0m01:02:47.293532 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_room"
[0m01:02:47.294531 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:02:47.295136 [debug] [Thread-3  ]: On model.bde.dim_room: BEGIN
[0m01:02:47.295478 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:02:47.415101 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.415567 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:02:47.415878 [debug] [Thread-4  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m01:02:47.425563 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.425901 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:02:47.426205 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m01:02:47.432777 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.435675 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:02:47.435997 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.436356 [debug] [Thread-4  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m01:02:47.436680 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m01:02:47.437064 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m01:02:47.439331 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.439635 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:02:47.439923 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m01:02:47.445308 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.447755 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:02:47.448081 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m01:02:47.451548 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.452797 [debug] [Thread-4  ]: On model.bde.fact_census_G02: COMMIT
[0m01:02:47.453108 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.453406 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:02:47.455631 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m01:02:47.455967 [debug] [Thread-4  ]: On model.bde.fact_census_G02: COMMIT
[0m01:02:47.456279 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m01:02:47.456719 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.458939 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:02:47.459260 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m01:02:47.465123 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.467083 [debug] [Thread-1  ]: On model.bde.fact_census_G01: COMMIT
[0m01:02:47.467393 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:02:47.467673 [debug] [Thread-1  ]: On model.bde.fact_census_G01: COMMIT
[0m01:02:47.469575 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.470712 [debug] [Thread-2  ]: On model.bde.dim_host: COMMIT
[0m01:02:47.471018 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m01:02:47.471315 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.471598 [debug] [Thread-2  ]: On model.bde.dim_host: COMMIT
[0m01:02:47.473595 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_census_G02"
[0m01:02:47.474030 [debug] [Thread-4  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m01:02:47.474414 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.475512 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m01:02:47.475821 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:02:47.476096 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m01:02:47.485056 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.487205 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m01:02:47.487524 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m01:02:47.489532 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.489829 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.491835 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m01:02:47.492136 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.493251 [debug] [Thread-4  ]: Timing info for model.bde.fact_census_G02 (execute): 01:02:47.252251 => 01:02:47.493101
[0m01:02:47.493584 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m01:02:47.495544 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m01:02:47.495878 [debug] [Thread-4  ]: On model.bde.fact_census_G02: Close
[0m01:02:47.496267 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m01:02:47.496952 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb114a400>]}
[0m01:02:47.497439 [info ] [Thread-4  ]: 9 of 15 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.26s]
[0m01:02:47.498085 [debug] [Thread-4  ]: Finished running node model.bde.fact_census_G02
[0m01:02:47.498451 [debug] [Thread-4  ]: Began running node model.bde.dim_property
[0m01:02:47.498857 [info ] [Thread-4  ]: 13 of 15 START sql view model warehouse.dim_property ........................... [RUN]
[0m01:02:47.499434 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.dim_property)
[0m01:02:47.499734 [debug] [Thread-4  ]: Began compiling node model.bde.dim_property
[0m01:02:47.501977 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_property"
[0m01:02:47.503371 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (compile): 01:02:47.499948 => 01:02:47.503220
[0m01:02:47.503755 [debug] [Thread-4  ]: Began executing node model.bde.dim_property
[0m01:02:47.504070 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.507476 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_property"
[0m01:02:47.508676 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G01 (execute): 01:02:47.271700 => 01:02:47.508534
[0m01:02:47.509123 [debug] [Thread-1  ]: On model.bde.fact_census_G01: Close
[0m01:02:47.509654 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.510226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb1055be0>]}
[0m01:02:47.510541 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m01:02:47.511641 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (execute): 01:02:47.288909 => 01:02:47.511506
[0m01:02:47.511987 [debug] [Thread-4  ]: On model.bde.dim_property: BEGIN
[0m01:02:47.512425 [info ] [Thread-1  ]: 10 of 15 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.25s]
[0m01:02:47.512857 [debug] [Thread-3  ]: On model.bde.dim_room: Close
[0m01:02:47.513162 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:02:47.513620 [debug] [Thread-1  ]: Finished running node model.bde.fact_census_G01
[0m01:02:47.514231 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.514595 [debug] [Thread-1  ]: Began running node model.bde.fact_lge
[0m01:02:47.515160 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb10dcc10>]}
[0m01:02:47.516310 [debug] [Thread-2  ]: Timing info for model.bde.dim_host (execute): 01:02:47.282200 => 01:02:47.516170
[0m01:02:47.516710 [info ] [Thread-1  ]: 14 of 15 START sql view model warehouse.fact_lge ............................... [RUN]
[0m01:02:47.517229 [info ] [Thread-3  ]: 12 of 15 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m01:02:47.517613 [debug] [Thread-2  ]: On model.bde.dim_host: Close
[0m01:02:47.518128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.fact_lge)
[0m01:02:47.518565 [debug] [Thread-3  ]: Finished running node model.bde.dim_room
[0m01:02:47.518970 [debug] [Thread-1  ]: Began compiling node model.bde.fact_lge
[0m01:02:47.519830 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb104d520>]}
[0m01:02:47.520236 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m01:02:47.524809 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m01:02:47.525457 [info ] [Thread-2  ]: 11 of 15 OK created sql view model warehouse.dim_host .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m01:02:47.525984 [info ] [Thread-3  ]: 15 of 15 START sql view model warehouse.fact_listing ........................... [RUN]
[0m01:02:47.526591 [debug] [Thread-2  ]: Finished running node model.bde.dim_host
[0m01:02:47.527207 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.dim_room, now model.bde.fact_listing)
[0m01:02:47.527651 [debug] [Thread-1  ]: Timing info for model.bde.fact_lge (compile): 01:02:47.520731 => 01:02:47.527500
[0m01:02:47.528025 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m01:02:47.528376 [debug] [Thread-1  ]: Began executing node model.bde.fact_lge
[0m01:02:47.531192 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m01:02:47.536267 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m01:02:47.537005 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m01:02:47.537335 [debug] [Thread-1  ]: On model.bde.fact_lge: BEGIN
[0m01:02:47.537648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:02:47.538037 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 01:02:47.528613 => 01:02:47.537873
[0m01:02:47.538491 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m01:02:47.543385 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m01:02:47.544725 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:02:47.545090 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m01:02:47.545383 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:02:47.668391 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.668864 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m01:02:47.669171 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m01:02:47.688198 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.690641 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m01:02:47.690960 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m01:02:47.693136 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.693441 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:02:47.693732 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.694212 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
    host_neighbourhood,
    b.lga_name as host_neighbourhood_lga_name,
    b.lga_code as host_neighbourhood_lga_code,        
    listing_neighbourhood,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 'bayside'
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 'Canterbury-Bankstown'
        ELSE c.lga_name
    END as listing_neighbourhood_lga_name,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 11100
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 11570
        ELSE c.lga_code
    END as listing_neighbourhood_lga_code,
            property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM "postgres"."staging"."listings_stg" a
LEFT JOIN lga c ON a.listing_neighbourhood = c.suburb_name
LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name
  );
[0m01:02:47.694593 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m01:02:47.695002 [debug] [Thread-1  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m01:02:47.706159 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.707298 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m01:02:47.707603 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m01:02:47.707893 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m01:02:47.712879 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.715271 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m01:02:47.715575 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:02:47.715900 [debug] [Thread-1  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m01:02:47.718087 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:02:47.718489 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m01:02:47.725379 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.727316 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m01:02:47.727629 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m01:02:47.734784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.735060 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:02:47.736205 [debug] [Thread-1  ]: On model.bde.fact_lge: COMMIT
[0m01:02:47.737348 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m01:02:47.737676 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m01:02:47.737980 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:02:47.738292 [debug] [Thread-1  ]: On model.bde.fact_lge: COMMIT
[0m01:02:47.738592 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m01:02:47.745303 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.746340 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (execute): 01:02:47.504497 => 01:02:47.746196
[0m01:02:47.746642 [debug] [Thread-4  ]: On model.bde.dim_property: Close
[0m01:02:47.747333 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfe0e85490>]}
[0m01:02:47.747791 [info ] [Thread-4  ]: 13 of 15 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m01:02:47.748274 [debug] [Thread-4  ]: Finished running node model.bde.dim_property
[0m01:02:47.754973 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.755309 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.757569 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m01:02:47.759526 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m01:02:47.759854 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m01:02:47.760238 [debug] [Thread-1  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m01:02:47.773726 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.774115 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m01:02:47.775918 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 01:02:47.538773 => 01:02:47.775684
[0m01:02:47.777678 [debug] [Thread-1  ]: Timing info for model.bde.fact_lge (execute): 01:02:47.531452 => 01:02:47.777439
[0m01:02:47.778097 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m01:02:47.778461 [debug] [Thread-1  ]: On model.bde.fact_lge: Close
[0m01:02:47.779328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa001a2e0>]}
[0m01:02:47.779854 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb150d1-76d8-4e69-b730-71b763d405ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb1080b50>]}
[0m01:02:47.780359 [info ] [Thread-1  ]: 14 of 15 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m01:02:47.780924 [debug] [Thread-1  ]: Finished running node model.bde.fact_lge
[0m01:02:47.781321 [info ] [Thread-3  ]: 15 of 15 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m01:02:47.781945 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m01:02:47.783113 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:47.783380 [debug] [MainThread]: On master: BEGIN
[0m01:02:47.783614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:47.930191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:02:47.931390 [debug] [MainThread]: On master: COMMIT
[0m01:02:47.932211 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:47.933003 [debug] [MainThread]: On master: COMMIT
[0m01:02:47.946578 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:02:47.947590 [debug] [MainThread]: On master: Close
[0m01:02:47.949507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:47.949955 [debug] [MainThread]: Connection 'model.bde.fact_lge' was properly closed.
[0m01:02:47.950217 [debug] [MainThread]: Connection 'model.bde.dim_host' was properly closed.
[0m01:02:47.950442 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m01:02:47.950663 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m01:02:47.951002 [info ] [MainThread]: 
[0m01:02:47.951327 [info ] [MainThread]: Finished running 15 view models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m01:02:47.953419 [debug] [MainThread]: Command end result
[0m01:02:47.961964 [info ] [MainThread]: 
[0m01:02:47.962422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:47.962765 [info ] [MainThread]: 
[0m01:02:47.963072 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m01:02:47.963620 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:47.963542 after 2.54 seconds
[0m01:02:47.963951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfd04716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0f20280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb0f33c10>]}
[0m01:02:47.964269 [debug] [MainThread]: Flushing usage events
[0m16:13:36.549700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff468bf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ad08820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ad08910>]}


============================== 16:13:36.554015 | 5bb0b390-cc0e-4728-879a-5392d2dcd547 ==============================
[0m16:13:36.554015 [info ] [MainThread]: Running with dbt=1.6.6
[0m16:13:36.554680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:13:36.755335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ad08850>]}
[0m16:13:36.766325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ae32280>]}
[0m16:13:36.766906 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m16:13:36.788861 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m16:13:36.824976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m16:13:36.825538 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_host_neighbourhood.sql
[0m16:13:36.825826 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_property_type.sql
[0m16:13:36.826081 [debug] [MainThread]: Partial parsing: added file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m16:13:36.868504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4587660d0>]}
[0m16:13:36.883468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4481eec10>]}
[0m16:13:36.883874 [info ] [MainThread]: Found 3 snapshots, 18 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m16:13:36.884170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4481eef10>]}
[0m16:13:36.885833 [info ] [MainThread]: 
[0m16:13:36.886416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:36.887732 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:13:36.895295 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:13:36.895832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:13:36.896082 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:13:36.896614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:13:36.898164 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:13:36.898436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:36.899861 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:13:36.900171 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:13:36.901999 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:13:36.902431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:36.902728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:37.330931 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m16:13:37.331599 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m16:13:37.332160 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m16:13:37.334351 [debug] [ThreadPool]: On list_postgres: Close
[0m16:13:37.335766 [debug] [ThreadPool]: On list_postgres: Close
[0m16:13:37.337074 [debug] [ThreadPool]: On list_postgres: Close
[0m16:13:37.339345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_datamart)
[0m16:13:37.340171 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "datamart"
"
[0m16:13:37.346717 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m16:13:37.347110 [debug] [ThreadPool]: On create_postgres_datamart: BEGIN
[0m16:13:37.347434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:37.530541 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:13:37.531646 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m16:13:37.532398 [debug] [ThreadPool]: On create_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_datamart"} */
create schema if not exists "datamart"
[0m16:13:37.549010 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:13:37.551111 [debug] [ThreadPool]: On create_postgres_datamart: COMMIT
[0m16:13:37.552057 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m16:13:37.552769 [debug] [ThreadPool]: On create_postgres_datamart: COMMIT
[0m16:13:37.569077 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:13:37.570311 [debug] [ThreadPool]: On create_postgres_datamart: Close
[0m16:13:37.577486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_datamart, now list_postgres_warehouse)
[0m16:13:37.585394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m16:13:37.591136 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m16:13:37.594886 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m16:13:37.595967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m16:13:37.597205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m16:13:37.597710 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m16:13:37.598332 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m16:13:37.601449 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m16:13:37.604525 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m16:13:37.605074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:37.605560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:37.606050 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m16:13:37.606519 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m16:13:37.607344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:37.607778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:37.793687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:13:37.794976 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m16:13:37.795982 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:13:37.797647 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:13:37.798639 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:13:37.799684 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:13:37.800527 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m16:13:37.801339 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m16:13:37.802034 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m16:13:37.802779 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:13:37.803624 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:13:37.804422 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m16:13:37.816377 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:13:37.819305 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m16:13:37.830021 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m16:13:37.830987 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:13:37.834428 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m16:13:37.835266 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m16:13:37.837542 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m16:13:37.838190 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m16:13:37.841152 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m16:13:37.852905 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m16:13:37.853545 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m16:13:37.858165 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m16:13:37.870582 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:37.871152 [debug] [MainThread]: On master: BEGIN
[0m16:13:37.871626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:38.060991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.062907 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:38.064278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:38.091664 [debug] [MainThread]: SQL status: SELECT 18 in 0.0 seconds
[0m16:13:38.104067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4481ee190>]}
[0m16:13:38.105144 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:38.119378 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:38.120074 [debug] [MainThread]: On master: BEGIN
[0m16:13:38.154127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.155592 [debug] [MainThread]: On master: COMMIT
[0m16:13:38.156478 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:38.157168 [debug] [MainThread]: On master: COMMIT
[0m16:13:38.171693 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.173160 [debug] [MainThread]: On master: Close
[0m16:13:38.175619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:13:38.176833 [info ] [MainThread]: 
[0m16:13:38.183275 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m16:13:38.184299 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m16:13:38.185309 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m16:13:38.187129 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m16:13:38.186388 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m16:13:38.188347 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m16:13:38.189344 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m16:13:38.190278 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m16:13:38.191498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G01_stg)
[0m16:13:38.192602 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.G02_stg)
[0m16:13:38.193675 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.host_stg)
[0m16:13:38.194719 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.lga_stg)
[0m16:13:38.195434 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m16:13:38.196070 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m16:13:38.196695 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m16:13:38.197317 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m16:13:38.210463 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m16:13:38.215833 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m16:13:38.220126 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m16:13:38.223588 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m16:13:38.225499 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 16:13:38.216360 => 16:13:38.225229
[0m16:13:38.226088 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 16:13:38.220632 => 16:13:38.225826
[0m16:13:38.226597 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m16:13:38.227104 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 16:13:38.197810 => 16:13:38.226896
[0m16:13:38.227566 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m16:13:38.228115 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 16:13:38.210993 => 16:13:38.227893
[0m16:13:38.253039 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m16:13:38.261677 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m16:13:38.264899 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m16:13:38.265246 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m16:13:38.268313 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m16:13:38.272064 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m16:13:38.272599 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m16:13:38.272959 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m16:13:38.273234 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m16:13:38.273516 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m16:13:38.273817 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m16:13:38.274087 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m16:13:38.274364 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:13:38.274640 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m16:13:38.274907 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:13:38.275185 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m16:13:38.275542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:38.275910 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:13:38.440362 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.441394 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m16:13:38.442218 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m16:13:38.447399 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.448041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.448697 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.449411 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m16:13:38.450033 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m16:13:38.450650 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m16:13:38.451351 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m16:13:38.452103 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m16:13:38.452861 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m16:13:38.463196 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.512400 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.512813 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.513121 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.517028 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m16:13:38.519746 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m16:13:38.522246 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m16:13:38.524791 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m16:13:38.525120 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m16:13:38.525435 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m16:13:38.525746 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m16:13:38.526029 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m16:13:38.540246 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.542869 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m16:13:38.543241 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m16:13:38.543836 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.546508 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m16:13:38.546879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.547219 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.547536 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m16:13:38.549994 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m16:13:38.552429 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m16:13:38.552896 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m16:13:38.553255 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m16:13:38.559574 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.574248 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.574594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.574878 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.575924 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m16:13:38.577275 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m16:13:38.578548 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m16:13:38.579736 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m16:13:38.580038 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m16:13:38.580315 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m16:13:38.580585 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m16:13:38.580849 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m16:13:38.581112 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m16:13:38.581376 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m16:13:38.581634 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m16:13:38.581897 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m16:13:38.602077 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.602447 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.602765 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.603111 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.611029 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m16:13:38.613283 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m16:13:38.615429 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m16:13:38.617433 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m16:13:38.617757 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m16:13:38.618067 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m16:13:38.618384 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m16:13:38.618684 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m16:13:38.634454 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.635805 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 16:13:38.228421 => 16:13:38.635630
[0m16:13:38.636182 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m16:13:38.636579 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.637273 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46afb3430>]}
[0m16:13:38.637635 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.638834 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 16:13:38.261971 => 16:13:38.638673
[0m16:13:38.639215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.640708 [info ] [Thread-3  ]: 3 of 18 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.44s]
[0m16:13:38.641908 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 16:13:38.268690 => 16:13:38.641751
[0m16:13:38.642254 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m16:13:38.643354 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 16:13:38.265471 => 16:13:38.643206
[0m16:13:38.643842 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m16:13:38.644169 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m16:13:38.644537 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m16:13:38.644909 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m16:13:38.645425 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458784370>]}
[0m16:13:38.646095 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458782a30>]}
[0m16:13:38.646541 [info ] [Thread-3  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m16:13:38.647079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458d5f6d0>]}
[0m16:13:38.647561 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m16:13:38.647985 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m16:13:38.648517 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.listings_stg)
[0m16:13:38.649014 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m16:13:38.649407 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m16:13:38.649870 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m16:13:38.650174 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m16:13:38.650505 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m16:13:38.650975 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m16:13:38.651323 [debug] [Thread-2  ]: Began running node model.bde.room_stg
[0m16:13:38.654166 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m16:13:38.654598 [info ] [Thread-4  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m16:13:38.654993 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m16:13:38.655402 [info ] [Thread-2  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m16:13:38.656084 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.property_stg)
[0m16:13:38.656490 [info ] [Thread-1  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m16:13:38.657051 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.room_stg)
[0m16:13:38.657406 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 16:13:38.651624 => 16:13:38.657258
[0m16:13:38.657689 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m16:13:38.658132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.suburb_stg)
[0m16:13:38.658413 [debug] [Thread-2  ]: Began compiling node model.bde.room_stg
[0m16:13:38.658691 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m16:13:38.660916 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m16:13:38.661239 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m16:13:38.663461 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.room_stg"
[0m16:13:38.667627 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m16:13:38.670323 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m16:13:38.671084 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 16:13:38.658898 => 16:13:38.670925
[0m16:13:38.671593 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m16:13:38.674680 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m16:13:38.675056 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (compile): 16:13:38.661456 => 16:13:38.674910
[0m16:13:38.675353 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m16:13:38.675707 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 16:13:38.668008 => 16:13:38.675555
[0m16:13:38.676040 [debug] [Thread-2  ]: Began executing node model.bde.room_stg
[0m16:13:38.676347 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m16:13:38.676634 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m16:13:38.679395 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.room_stg"
[0m16:13:38.679689 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:13:38.682520 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m16:13:38.683139 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m16:13:38.683652 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m16:13:38.684038 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m16:13:38.684389 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:13:38.684719 [debug] [Thread-2  ]: On model.bde.room_stg: BEGIN
[0m16:13:38.685052 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m16:13:38.685462 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:13:38.685763 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m16:13:38.686126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:38.848749 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.849432 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m16:13:38.849978 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.850590 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m16:13:38.851174 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m16:13:38.851809 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m16:13:38.852424 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.852910 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m16:13:38.853402 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m16:13:38.853948 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:38.854495 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m16:13:38.855050 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m16:13:38.868688 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.873822 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m16:13:38.874357 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m16:13:38.875093 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.879063 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m16:13:38.879564 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.880029 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:38.880447 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m16:13:38.884070 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m16:13:38.888602 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m16:13:38.889042 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.889566 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m16:13:38.889992 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m16:13:38.892833 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m16:13:38.893350 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m16:13:38.907325 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.910491 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m16:13:38.910939 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m16:13:38.916216 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.916733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.917144 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.919075 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m16:13:38.921934 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m16:13:38.924758 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m16:13:38.925169 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m16:13:38.925564 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m16:13:38.925948 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.926323 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m16:13:38.926699 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m16:13:38.928209 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m16:13:38.928813 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m16:13:38.929152 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m16:13:38.943411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.945122 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m16:13:38.945541 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.945916 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:38.946264 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.946641 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m16:13:38.949297 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m16:13:38.950866 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m16:13:38.953386 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m16:13:38.953761 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m16:13:38.954122 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m16:13:38.954473 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m16:13:38.954820 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m16:13:38.955252 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m16:13:38.969128 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.969480 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.971836 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m16:13:38.973103 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 16:13:38.671822 => 16:13:38.972930
[0m16:13:38.973476 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m16:13:38.973839 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m16:13:38.974204 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:38.976690 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m16:13:38.977073 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.977679 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46afbe0a0>]}
[0m16:13:38.978041 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m16:13:38.980395 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (execute): 16:13:38.676835 => 16:13:38.980243
[0m16:13:38.980917 [info ] [Thread-4  ]: 6 of 18 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m16:13:38.981350 [debug] [Thread-2  ]: On model.bde.room_stg: Close
[0m16:13:38.981832 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m16:13:38.982260 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m16:13:38.982661 [info ] [Thread-4  ]: 9 of 18 START sql view model warehouse.dim_host ................................ [RUN]
[0m16:13:38.983227 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_host)
[0m16:13:38.983557 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m16:13:38.986016 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m16:13:38.986699 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44832e0d0>]}
[0m16:13:38.987254 [info ] [Thread-2  ]: 7 of 18 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:13:38.987775 [debug] [Thread-2  ]: Finished running node model.bde.room_stg
[0m16:13:38.988170 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G02
[0m16:13:38.988599 [info ] [Thread-2  ]: 10 of 18 START sql view model warehouse.fact_census_G02 ........................ [RUN]
[0m16:13:38.989152 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_census_G02)
[0m16:13:38.989472 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G02
[0m16:13:38.991765 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m16:13:38.992266 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 16:13:38.983793 => 16:13:38.992111
[0m16:13:38.992586 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m16:13:38.995687 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m16:13:38.996092 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G02 (compile): 16:13:38.989704 => 16:13:38.995932
[0m16:13:38.996414 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:38.996770 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G02
[0m16:13:38.997888 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 16:13:38.679901 => 16:13:38.997755
[0m16:13:39.000958 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m16:13:39.001438 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.001769 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m16:13:39.002119 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m16:13:39.003335 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 16:13:38.663701 => 16:13:39.003196
[0m16:13:39.003650 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m16:13:39.004049 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m16:13:39.004333 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m16:13:39.004854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46afbe460>]}
[0m16:13:39.005164 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:13:39.005458 [debug] [Thread-2  ]: On model.bde.fact_census_G02: BEGIN
[0m16:13:39.005952 [info ] [Thread-1  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.35s]
[0m16:13:39.006482 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ae1e9a0>]}
[0m16:13:39.006902 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:13:39.007351 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m16:13:39.007771 [info ] [Thread-3  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m16:13:39.008236 [debug] [Thread-1  ]: Began running node model.bde.fact_census_G01
[0m16:13:39.008762 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m16:13:39.009111 [info ] [Thread-1  ]: 11 of 18 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m16:13:39.009496 [debug] [Thread-3  ]: Began running node model.bde.dim_property
[0m16:13:39.010023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.fact_census_G01)
[0m16:13:39.010355 [info ] [Thread-3  ]: 12 of 18 START sql view model warehouse.dim_property ........................... [RUN]
[0m16:13:39.010681 [debug] [Thread-1  ]: Began compiling node model.bde.fact_census_G01
[0m16:13:39.011128 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_property)
[0m16:13:39.013524 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m16:13:39.013873 [debug] [Thread-3  ]: Began compiling node model.bde.dim_property
[0m16:13:39.016001 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_property"
[0m16:13:39.016545 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G01 (compile): 16:13:39.011340 => 16:13:39.016383
[0m16:13:39.016933 [debug] [Thread-3  ]: Timing info for model.bde.dim_property (compile): 16:13:39.014146 => 16:13:39.016754
[0m16:13:39.017282 [debug] [Thread-1  ]: Began executing node model.bde.fact_census_G01
[0m16:13:39.017604 [debug] [Thread-3  ]: Began executing node model.bde.dim_property
[0m16:13:39.020987 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m16:13:39.024949 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_property"
[0m16:13:39.025594 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m16:13:39.025903 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m16:13:39.026203 [debug] [Thread-1  ]: On model.bde.fact_census_G01: BEGIN
[0m16:13:39.026482 [debug] [Thread-3  ]: On model.bde.dim_property: BEGIN
[0m16:13:39.026762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:39.027055 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:13:39.166206 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.166842 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m16:13:39.167301 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m16:13:39.172353 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.172780 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m16:13:39.173208 [debug] [Thread-2  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m16:13:39.186958 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.187494 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.191611 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m16:13:39.192064 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.192522 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.192925 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m16:13:39.193359 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m16:13:39.193785 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m16:13:39.197047 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m16:13:39.197511 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m16:13:39.198019 [debug] [Thread-3  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m16:13:39.198482 [debug] [Thread-2  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m16:13:39.210888 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.212623 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m16:13:39.213070 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m16:13:39.213484 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m16:13:39.216951 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.218587 [debug] [Thread-2  ]: On model.bde.fact_census_G02: COMMIT
[0m16:13:39.219054 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m16:13:39.219489 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.219891 [debug] [Thread-2  ]: On model.bde.fact_census_G02: COMMIT
[0m16:13:39.223119 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m16:13:39.223567 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.224084 [debug] [Thread-3  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m16:13:39.227286 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m16:13:39.227801 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m16:13:39.228352 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.230983 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m16:13:39.231392 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m16:13:39.239022 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.241554 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m16:13:39.241974 [debug] [Thread-2  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m16:13:39.242470 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.242827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.244322 [debug] [Thread-3  ]: On model.bde.dim_property: COMMIT
[0m16:13:39.245787 [debug] [Thread-1  ]: On model.bde.fact_census_G01: COMMIT
[0m16:13:39.246195 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m16:13:39.246590 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m16:13:39.246995 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.247346 [debug] [Thread-3  ]: On model.bde.dim_property: COMMIT
[0m16:13:39.247712 [debug] [Thread-1  ]: On model.bde.fact_census_G01: COMMIT
[0m16:13:39.248988 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 16:13:38.992831 => 16:13:39.248817
[0m16:13:39.249459 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m16:13:39.250233 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ae32190>]}
[0m16:13:39.250782 [info ] [Thread-4  ]: 9 of 18 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:13:39.251331 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m16:13:39.251732 [debug] [Thread-4  ]: Began running node model.bde.dim_room
[0m16:13:39.252202 [info ] [Thread-4  ]: 13 of 18 START sql view model warehouse.dim_room ............................... [RUN]
[0m16:13:39.252816 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dim_room)
[0m16:13:39.253173 [debug] [Thread-4  ]: Began compiling node model.bde.dim_room
[0m16:13:39.255989 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_room"
[0m16:13:39.257226 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.258579 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G02 (execute): 16:13:38.998121 => 16:13:39.258398
[0m16:13:39.258974 [debug] [Thread-2  ]: On model.bde.fact_census_G02: Close
[0m16:13:39.259390 [debug] [Thread-4  ]: Timing info for model.bde.dim_room (compile): 16:13:39.253422 => 16:13:39.259217
[0m16:13:39.259754 [debug] [Thread-4  ]: Began executing node model.bde.dim_room
[0m16:13:39.260335 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46b021d00>]}
[0m16:13:39.264990 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_room"
[0m16:13:39.265549 [info ] [Thread-2  ]: 10 of 18 OK created sql view model warehouse.fact_census_G02 ................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:13:39.266290 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G02
[0m16:13:39.266744 [debug] [Thread-2  ]: Began running node model.bde.fact_lge
[0m16:13:39.267116 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.267445 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.267897 [info ] [Thread-2  ]: 14 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m16:13:39.268270 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m16:13:39.270483 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G01"
[0m16:13:39.272541 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_property"
[0m16:13:39.273163 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.fact_lge)
[0m16:13:39.273481 [debug] [Thread-4  ]: On model.bde.dim_room: BEGIN
[0m16:13:39.273785 [debug] [Thread-1  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m16:13:39.274076 [debug] [Thread-3  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m16:13:39.274358 [debug] [Thread-2  ]: Began compiling node model.bde.fact_lge
[0m16:13:39.274624 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:13:39.277072 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m16:13:39.277787 [debug] [Thread-2  ]: Timing info for model.bde.fact_lge (compile): 16:13:39.274926 => 16:13:39.277630
[0m16:13:39.278081 [debug] [Thread-2  ]: Began executing node model.bde.fact_lge
[0m16:13:39.281006 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m16:13:39.281475 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m16:13:39.281755 [debug] [Thread-2  ]: On model.bde.fact_lge: BEGIN
[0m16:13:39.282017 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:13:39.287067 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.287476 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.288650 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G01 (execute): 16:13:39.017829 => 16:13:39.288505
[0m16:13:39.289658 [debug] [Thread-3  ]: Timing info for model.bde.dim_property (execute): 16:13:39.021349 => 16:13:39.289527
[0m16:13:39.289963 [debug] [Thread-1  ]: On model.bde.fact_census_G01: Close
[0m16:13:39.290239 [debug] [Thread-3  ]: On model.bde.dim_property: Close
[0m16:13:39.290890 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458782b50>]}
[0m16:13:39.291392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46afe1880>]}
[0m16:13:39.291814 [info ] [Thread-3  ]: 12 of 18 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:13:39.292673 [debug] [Thread-3  ]: Finished running node model.bde.dim_property
[0m16:13:39.292304 [info ] [Thread-1  ]: 11 of 18 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:13:39.293121 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m16:13:39.293560 [debug] [Thread-1  ]: Finished running node model.bde.fact_census_G01
[0m16:13:39.293929 [info ] [Thread-3  ]: 15 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m16:13:39.294472 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.dim_property, now model.bde.fact_listing)
[0m16:13:39.294746 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m16:13:39.297572 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m16:13:39.298403 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 16:13:39.294939 => 16:13:39.298191
[0m16:13:39.298754 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m16:13:39.301826 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m16:13:39.302360 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m16:13:39.302637 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m16:13:39.302888 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:13:39.442674 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.443341 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.443950 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m16:13:39.444458 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m16:13:39.444981 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m16:13:39.445528 [debug] [Thread-4  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m16:13:39.460257 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.460800 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m16:13:39.461398 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
    host_neighbourhood,
    b.lga_name as host_neighbourhood_lga_name,
    b.lga_code as host_neighbourhood_lga_code,        
    listing_neighbourhood,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 'bayside'
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 'Canterbury-Bankstown'
        ELSE c.lga_name
    END as listing_neighbourhood_lga_name,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 11100
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 11570
        ELSE c.lga_code
    END as listing_neighbourhood_lga_code,
            property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM "postgres"."staging"."listings_stg" a
LEFT JOIN lga c ON a.listing_neighbourhood = c.suburb_name
LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name
  );
[0m16:13:39.462176 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.466170 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m16:13:39.466660 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.467079 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m16:13:39.470764 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m16:13:39.471457 [debug] [Thread-4  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m16:13:39.484235 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.484792 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.486836 [debug] [Thread-2  ]: On model.bde.fact_lge: COMMIT
[0m16:13:39.492065 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m16:13:39.492567 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.493098 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m16:13:39.493598 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m16:13:39.495434 [debug] [Thread-4  ]: On model.bde.dim_room: COMMIT
[0m16:13:39.495951 [debug] [Thread-2  ]: On model.bde.fact_lge: COMMIT
[0m16:13:39.496428 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m16:13:39.496945 [debug] [Thread-4  ]: On model.bde.dim_room: COMMIT
[0m16:13:39.510288 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.512395 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m16:13:39.512924 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m16:13:39.513351 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m16:13:39.515680 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.516199 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.520120 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m16:13:39.523714 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m16:13:39.524278 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m16:13:39.524700 [debug] [Thread-4  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m16:13:39.528933 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.532009 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m16:13:39.532545 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m16:13:39.538499 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.540197 [debug] [Thread-2  ]: Timing info for model.bde.fact_lge (execute): 16:13:39.278286 => 16:13:39.539991
[0m16:13:39.540878 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.541760 [debug] [Thread-2  ]: On model.bde.fact_lge: Close
[0m16:13:39.544365 [debug] [Thread-4  ]: Timing info for model.bde.dim_room (execute): 16:13:39.260574 => 16:13:39.543636
[0m16:13:39.546542 [debug] [Thread-4  ]: On model.bde.dim_room: Close
[0m16:13:39.547682 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458d9a0d0>]}
[0m16:13:39.548105 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.555912 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46ae7b490>]}
[0m16:13:39.555098 [info ] [Thread-2  ]: 14 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:13:39.557434 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 16:13:39.298963 => 16:13:39.557230
[0m16:13:39.558036 [debug] [Thread-2  ]: Finished running node model.bde.fact_lge
[0m16:13:39.558912 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m16:13:39.558513 [info ] [Thread-4  ]: 13 of 18 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m16:13:39.559670 [debug] [Thread-4  ]: Finished running node model.bde.dim_room
[0m16:13:39.560235 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458db94c0>]}
[0m16:13:39.560754 [debug] [Thread-1  ]: Began running node model.bde.dm_host_neighbourhood
[0m16:13:39.561133 [info ] [Thread-1  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m16:13:39.561506 [info ] [Thread-3  ]: 15 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:13:39.562836 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m16:13:39.562216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dm_host_neighbourhood)
[0m16:13:39.580844 [debug] [Thread-4  ]: Began running node model.bde.dm_listing_neighbourhood
[0m16:13:39.581660 [debug] [Thread-1  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m16:13:39.582036 [debug] [Thread-2  ]: Began running node model.bde.dm_property_type
[0m16:13:39.582510 [info ] [Thread-4  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m16:13:39.586467 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m16:13:39.587013 [info ] [Thread-2  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m16:13:39.587632 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_room, now model.bde.dm_listing_neighbourhood)
[0m16:13:39.588229 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_lge, now model.bde.dm_property_type)
[0m16:13:39.588572 [debug] [Thread-4  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m16:13:39.588917 [debug] [Thread-2  ]: Began compiling node model.bde.dm_property_type
[0m16:13:39.591859 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m16:13:39.592242 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 16:13:39.582799 => 16:13:39.592090
[0m16:13:39.594814 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m16:13:39.595249 [debug] [Thread-1  ]: Began executing node model.bde.dm_host_neighbourhood
[0m16:13:39.598339 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m16:13:39.598746 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 16:13:39.589142 => 16:13:39.598584
[0m16:13:39.599169 [debug] [Thread-2  ]: Timing info for model.bde.dm_property_type (compile): 16:13:39.592480 => 16:13:39.599024
[0m16:13:39.599485 [debug] [Thread-4  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m16:13:39.599888 [debug] [Thread-2  ]: Began executing node model.bde.dm_property_type
[0m16:13:39.600231 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m16:13:39.604632 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m16:13:39.607372 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m16:13:39.607703 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m16:13:39.608136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:39.608626 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m16:13:39.608934 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m16:13:39.609238 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m16:13:39.609509 [debug] [Thread-2  ]: On model.bde.dm_property_type: BEGIN
[0m16:13:39.609774 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:13:39.610042 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:13:39.775139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.775927 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m16:13:39.776647 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    with joined_table as (
	select 
		p.property_type,
		p.room_type,
		p.accommodates,
		p.scraped_date, 
		h.host_id,
		h.host_is_superhost,
		p.price,
		r.has_availability,
		r.availability_30,
		r.review_scores_rating
	from 
		"postgres"."warehouse"."dim_property" p
	join 
		"postgres"."warehouse"."dim_host" h
	on p.listing_id = h.listing_id
	join 
		"postgres"."warehouse"."dim_room" r
	on p.listing_id = r.listing_id
)
select 
	property_type,
	room_type,
	accommodates,
	to_char(scraped_date, 'MM/YYYY') as month_year,
	count(distinct host_id) as distinct_host,
	round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_rate,
	min(case when has_availability = 't' then price end) as minimum_price,
	max(case when has_availability = 't' then price end) as maximum_price,
	round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
	round(avg(case when has_availability = 't' then price end),2) as average_price,
	round((sum(case when host_is_superhost = 't' then  1 else  0 end )::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
	round(avg(case when has_availability = 't' then review_scores_rating end),2) as average_review_scores_rating,
	round((lead(sum(case when has_availability = 't' then 1 else 0 end)) over (partition by property_type, room_type, accommodates order by to_char(scraped_date, 'MM/YYYY')) - sum(case when has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
	round((lead(sum(case when has_availability = 'f' then 1 else 0 end)) over (partition by property_type, room_type, accommodates order by to_char(scraped_date, 'MM/YYYY')) - sum(case when has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
	sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
	round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from joined_table
group by 
	property_type,
	room_type,
	accommodates,
	to_char(scraped_date, 'MM/YYYY')
order by 
	property_type, 
	room_type, 
	accommodates,
	to_char(scraped_date, 'MM/YYYY')
  );
[0m16:13:39.779131 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.779624 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m16:13:39.780264 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  p.property_type,
  p.room_type,
  p.accommodates,
  to_char(l.scraped_date, 'MM/YYYY') AS month_year,
  ROUND(SUM(CASE WHEN l.has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(l.has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN l.has_availability = 't' THEN p.price END) AS min_price,
  MAX(CASE WHEN l.has_availability = 't' THEN p.price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN l.has_availability = 't' THEN p.price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN l.has_availability = 't' THEN p.price END), 2) AS avg_price,
  COUNT(DISTINCT h.host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN h.host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(h.host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN l.has_availability = 't' THEN l.review_scores_rating END), 2) AS avg_review_scores_rating,
  ROUND((LEAD(SUM(CASE WHEN l.has_availability = 't' THEN 1 ELSE 0 END)) OVER (PARTITION BY p.property_type, p.room_type, p.accommodates ORDER BY to_char(l.scraped_date, 'MM/YYYY')) - SUM(CASE WHEN l.has_availability = 't' THEN 1 ELSE 0 END))::NUMERIC / NULLIF(SUM(CASE WHEN l.has_availability = 't' THEN 1 ELSE 0 END), 0)::NUMERIC * 100, 2) AS pct_change_active_listings,
  ROUND((LEAD(SUM(CASE WHEN l.has_availability = 'f' THEN 1 ELSE 0 END)) OVER (PARTITION BY p.property_type, p.room_type, p.accommodates ORDER BY to_char(l.scraped_date, 'MM/YYYY')) - SUM(CASE WHEN l.has_availability = 'f' THEN 1 ELSE 0 END))::NUMERIC / NULLIF(SUM(CASE WHEN l.has_availability = 't' THEN 1 ELSE 0 END), 0)::NUMERIC * 100, 2) AS pct_change_inactive_listings,
  (SUM(CASE WHEN l.has_availability = 't' THEN (30 - l.availability_30) ELSE 0 END)) AS total_stays,
  ROUND(AVG(CASE WHEN l.has_availability = 't' THEN (30 - l.availability_30) * p.price ELSE 0 END), 2) AS avg_estimated_revenue
FROM
  "postgres"."warehouse"."dim_property" p
JOIN
  "postgres"."warehouse"."fact_listing" l
ON p.listing_id = l.listing_id
JOIN
  "postgres"."warehouse"."dim_host" h
ON p.listing_id = h.listing_id
GROUP BY
  p.property_type,
  p.room_type,
  p.accommodates,
  to_char(l.scraped_date, 'MM/YYYY')
ORDER BY
  p.property_type,
  p.room_type,
  p.accommodates,
  to_char(l.scraped_date, 'MM/YYYY')
  );
[0m16:13:39.784868 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m16:13:39.785350 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m16:13:39.786011 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  p.listing_neighbourhood,
  to_char(l.scraped_date, 'MM/YYYY') as month_year,
  round((sum(case when r.has_availability = 't' then  1 else  0 end )::numeric / count(r.has_availability)) *100,2) as active_listings_ratio,
  min(case when r.has_availability = 't' then p.price end) as minimum_price,
  max(case when r.has_availability = 't' then p.price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when r.has_availability = 't' then p.price end)::numeric,2) as median_price,
  round(avg(case when r.has_availability = 't' then p.price end),2) as average_price,
  count(distinct h.host_id) as distinct_host,
  round((sum(case when h.host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(h.host_is_superhost),0))*100,2) as superhost_rate,
  round(avg(case when r.has_availability = 't' then r.review_scores_rating end),2) as average_review_scores_rating,
  round((lead(sum(case when r.has_availability = 't' then 1 else 0 end)) over (partition by p.listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) - sum(case when r.has_availability = 't' then 1 else 0 end))::numeric / nullif(sum(case when r.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as active_change,
  round((lead(sum(case when r.has_availability = 'f' then 1 else 0 end)) over (partition by p.listing_neighbourhood order by to_char(l.scraped_date, 'MM/YYYY')) - sum(case when r.has_availability = 'f' then 1 else 0 end))::numeric / nullif(sum(case when r.has_availability = 't' then 1 else 0 end),0)::numeric *100,2) as inactive_change,
  sum(case when r.has_availability = 't' then 30 - r.availability_30  else 0 end) as number_of_stays,
  round(avg(case when r.has_availability = 't' then (30 - r.availability_30)*p.price  else 0 end),2) as avg_estimate_revenue
from
  "postgres"."warehouse"."dim_property" p
join 
  "postgres"."warehouse"."fact_listing" l
on p.listing_id = l.listing_id
join  
  "postgres"."warehouse"."dim_host" h
on p.listing_id = h.listing_id
join 
  "postgres"."warehouse"."dim_room" r
on
  p.listing_id = r.listing_id
group by 
  p.listing_neighbourhood,
  to_char(l.scraped_date, 'MM/YYYY')
order by 
  p.listing_neighbourhood, 
  to_char(l.scraped_date, 'MM/YYYY')
  );
[0m16:13:39.801476 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.806147 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m16:13:39.806738 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m16:13:39.807328 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.811116 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m16:13:39.811654 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m16:13:39.812376 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:13:39.815743 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m16:13:39.816204 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m16:13:39.824708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.827161 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m16:13:39.827720 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m16:13:39.828172 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m16:13:39.829033 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.830801 [debug] [Thread-2  ]: On model.bde.dm_property_type: COMMIT
[0m16:13:39.831284 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m16:13:39.831701 [debug] [Thread-2  ]: On model.bde.dm_property_type: COMMIT
[0m16:13:39.833919 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:13:39.835763 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m16:13:39.836254 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m16:13:39.836681 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m16:13:39.845427 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.848616 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m16:13:39.849080 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.849515 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m16:13:39.852505 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m16:13:39.853033 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m16:13:39.853486 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m16:13:39.856248 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m16:13:39.856649 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m16:13:39.869498 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.869937 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.871481 [debug] [Thread-2  ]: Timing info for model.bde.dm_property_type (execute): 16:13:39.604963 => 16:13:39.871269
[0m16:13:39.872948 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 16:13:39.595573 => 16:13:39.872747
[0m16:13:39.873411 [debug] [Thread-2  ]: On model.bde.dm_property_type: Close
[0m16:13:39.873856 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: Close
[0m16:13:39.874522 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:13:39.875358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458db9160>]}
[0m16:13:39.876078 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46b0282e0>]}
[0m16:13:39.877627 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 16:13:39.600476 => 16:13:39.877415
[0m16:13:39.878273 [info ] [Thread-1  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.31s]
[0m16:13:39.878869 [info ] [Thread-2  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:13:39.879327 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: Close
[0m16:13:39.879902 [debug] [Thread-1  ]: Finished running node model.bde.dm_host_neighbourhood
[0m16:13:39.880449 [debug] [Thread-2  ]: Finished running node model.bde.dm_property_type
[0m16:13:39.881354 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bb0b390-cc0e-4728-879a-5392d2dcd547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff458dee0d0>]}
[0m16:13:39.881958 [info ] [Thread-4  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.29s]
[0m16:13:39.882570 [debug] [Thread-4  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m16:13:39.885486 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:39.885857 [debug] [MainThread]: On master: BEGIN
[0m16:13:39.886175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:40.054788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:13:40.055820 [debug] [MainThread]: On master: COMMIT
[0m16:13:40.056527 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:40.057187 [debug] [MainThread]: On master: COMMIT
[0m16:13:40.072294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:13:40.073004 [debug] [MainThread]: On master: Close
[0m16:13:40.074674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:40.075364 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m16:13:40.075981 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m16:13:40.076624 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m16:13:40.077232 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m16:13:40.078106 [info ] [MainThread]: 
[0m16:13:40.078919 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m16:13:40.084948 [debug] [MainThread]: Command end result
[0m16:13:40.102636 [info ] [MainThread]: 
[0m16:13:40.103358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:40.103912 [info ] [MainThread]: 
[0m16:13:40.104429 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m16:13:40.105340 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:40.105197 after 3.60 seconds
[0m16:13:40.105924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff468bf16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4587660a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff448216220>]}
[0m16:13:40.106447 [debug] [MainThread]: Flushing usage events
[0m23:30:53.119115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a382616a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2aa50820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2aa50910>]}


============================== 23:30:53.123251 | 233981ea-819a-4929-801c-ddbe953255f1 ==============================
[0m23:30:53.123251 [info ] [MainThread]: Running with dbt=1.6.6
[0m23:30:53.123911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:30:53.343655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2aa508b0>]}
[0m23:30:53.354496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ab89280>]}
[0m23:30:53.355064 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m23:30:53.378478 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m23:30:53.416494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:30:53.417093 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m23:30:53.417421 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_property_type.sql
[0m23:30:53.417723 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_host_neighbourhood.sql
[0m23:30:53.459528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a38fb90d0>]}
[0m23:30:53.473906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2abb4c40>]}
[0m23:30:53.474340 [info ] [MainThread]: Found 3 snapshots, 18 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m23:30:53.474662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2abb4f40>]}
[0m23:30:53.476570 [info ] [MainThread]: 
[0m23:30:53.477181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:53.478586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:30:53.479167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:30:53.487411 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:30:53.488087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:30:53.489672 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:30:53.489964 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:30:53.491322 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:30:53.491592 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:30:53.492230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:53.492469 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:30:53.492693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:53.494369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:53.979992 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m23:30:53.980754 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m23:30:53.982815 [debug] [ThreadPool]: On list_postgres: Close
[0m23:30:53.983270 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m23:30:53.984659 [debug] [ThreadPool]: On list_postgres: Close
[0m23:30:53.986182 [debug] [ThreadPool]: On list_postgres: Close
[0m23:30:53.989868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m23:30:53.990687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m23:30:53.996859 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m23:30:53.997541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m23:30:53.998398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m23:30:54.000479 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:30:54.000928 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m23:30:54.002805 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m23:30:54.004588 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m23:30:54.004914 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m23:30:54.005234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:54.005556 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m23:30:54.005890 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m23:30:54.006224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:54.006657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:54.006960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:54.196955 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.197683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.198335 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m23:30:54.198849 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m23:30:54.199377 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:30:54.199911 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m23:30:54.206529 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.207048 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.207630 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m23:30:54.208188 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:30:54.208755 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m23:30:54.209357 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:30:54.221066 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:30:54.221634 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:30:54.223857 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m23:30:54.225661 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m23:30:54.230726 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:30:54.231235 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:30:54.232923 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m23:30:54.234775 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m23:30:54.242804 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m23:30:54.243293 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m23:30:54.253101 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m23:30:54.253566 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m23:30:54.264020 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:54.264558 [debug] [MainThread]: On master: BEGIN
[0m23:30:54.264986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:54.439557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.440685 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:54.441946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:54.477985 [debug] [MainThread]: SQL status: SELECT 28 in 0.0 seconds
[0m23:30:54.495931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ac48f40>]}
[0m23:30:54.497041 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:54.510679 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:54.511384 [debug] [MainThread]: On master: BEGIN
[0m23:30:54.547256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.548923 [debug] [MainThread]: On master: COMMIT
[0m23:30:54.550035 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:54.551208 [debug] [MainThread]: On master: COMMIT
[0m23:30:54.565483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:30:54.567373 [debug] [MainThread]: On master: Close
[0m23:30:54.570492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:54.571367 [info ] [MainThread]: 
[0m23:30:54.578600 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m23:30:54.579569 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m23:30:54.580536 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m23:30:54.582319 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m23:30:54.581594 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m23:30:54.583564 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m23:30:54.584613 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m23:30:54.585514 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m23:30:54.586791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.G01_stg)
[0m23:30:54.587916 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.G02_stg)
[0m23:30:54.589068 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.host_stg)
[0m23:30:54.590274 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.lga_stg)
[0m23:30:54.591161 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m23:30:54.591924 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m23:30:54.592612 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m23:30:54.593384 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m23:30:54.606890 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m23:30:54.611098 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m23:30:54.616262 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m23:30:54.619655 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m23:30:54.621330 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 23:30:54.611531 => 23:30:54.620991
[0m23:30:54.621938 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m23:30:54.622664 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 23:30:54.616639 => 23:30:54.622399
[0m23:30:54.623211 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 23:30:54.607509 => 23:30:54.622989
[0m23:30:54.628874 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 23:30:54.594008 => 23:30:54.628654
[0m23:30:54.651308 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m23:30:54.657461 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m23:30:54.657852 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m23:30:54.658172 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m23:30:54.661331 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m23:30:54.664560 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m23:30:54.667644 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m23:30:54.668085 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:54.668490 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:30:54.668813 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m23:30:54.669174 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m23:30:54.669481 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:30:54.669760 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:30:54.670038 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:54.670321 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:30:54.670600 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m23:30:54.670875 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m23:30:54.671347 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:54.671642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:54.854441 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.855389 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.856079 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.856834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:54.857517 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:54.858222 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:30:54.858881 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:30:54.859520 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:30:54.860286 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m23:30:54.861121 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m23:30:54.861840 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m23:30:54.862555 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m23:30:54.884554 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:54.895159 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:54.899651 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:30:54.900246 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:54.900878 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:54.950996 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:54.951448 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m23:30:54.954159 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:30:54.956761 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:30:54.957100 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m23:30:54.957495 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m23:30:54.957839 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m23:30:54.970163 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:54.972806 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:30:54.973178 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m23:30:54.978448 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:54.981082 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:30:54.981468 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m23:30:54.981835 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:54.982196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:54.984769 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:54.987131 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:30:54.987479 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m23:30:54.987792 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:54.988119 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m23:30:55.001052 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.002464 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m23:30:55.003765 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m23:30:55.004105 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.004374 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:30:55.004667 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:30:55.005843 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m23:30:55.006143 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m23:30:55.006414 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m23:30:55.006683 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:55.007022 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m23:30:55.018964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.020652 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m23:30:55.020997 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:30:55.021307 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m23:30:55.029768 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.036371 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.038531 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:30:55.038891 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.041248 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:30:55.041579 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.041922 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m23:30:55.043985 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:30:55.044314 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m23:30:55.046402 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:30:55.046839 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m23:30:55.047211 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m23:30:55.061614 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.062929 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 23:30:54.661644 => 23:30:55.062752
[0m23:30:55.063314 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m23:30:55.064168 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2adec0a0>]}
[0m23:30:55.065840 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.48s]
[0m23:30:55.066387 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m23:30:55.066776 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m23:30:55.067229 [info ] [Thread-2  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m23:30:55.067880 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.listings_stg)
[0m23:30:55.068221 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m23:30:55.070915 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m23:30:55.071808 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 23:30:55.068459 => 23:30:55.071627
[0m23:30:55.072143 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.072448 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.072778 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m23:30:55.073988 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 23:30:54.664823 => 23:30:55.073835
[0m23:30:55.075104 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 23:30:54.658407 => 23:30:55.074964
[0m23:30:55.078313 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m23:30:55.078666 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.079015 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m23:30:55.079335 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m23:30:55.080491 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 23:30:54.623507 => 23:30:55.080352
[0m23:30:55.080984 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m23:30:55.081603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a390d7e80>]}
[0m23:30:55.082175 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a39071e80>]}
[0m23:30:55.082694 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ae15520>]}
[0m23:30:55.083044 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:55.083482 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.50s]
[0m23:30:55.083950 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.49s]
[0m23:30:55.084411 [info ] [Thread-3  ]: 3 of 18 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.49s]
[0m23:30:55.084751 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m23:30:55.085176 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m23:30:55.085578 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m23:30:55.085976 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m23:30:55.086252 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:55.086586 [debug] [Thread-1  ]: Began running node model.bde.property_stg
[0m23:30:55.086952 [debug] [Thread-4  ]: Began running node model.bde.room_stg
[0m23:30:55.087326 [debug] [Thread-3  ]: Began running node model.bde.suburb_stg
[0m23:30:55.087851 [info ] [Thread-1  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m23:30:55.088308 [info ] [Thread-4  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m23:30:55.088709 [info ] [Thread-3  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m23:30:55.089317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.property_stg)
[0m23:30:55.089897 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.room_stg)
[0m23:30:55.090401 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.suburb_stg)
[0m23:30:55.090733 [debug] [Thread-1  ]: Began compiling node model.bde.property_stg
[0m23:30:55.091025 [debug] [Thread-4  ]: Began compiling node model.bde.room_stg
[0m23:30:55.091310 [debug] [Thread-3  ]: Began compiling node model.bde.suburb_stg
[0m23:30:55.094090 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.property_stg"
[0m23:30:55.096238 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.room_stg"
[0m23:30:55.098375 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m23:30:55.099066 [debug] [Thread-4  ]: Timing info for model.bde.room_stg (compile): 23:30:55.094336 => 23:30:55.098899
[0m23:30:55.099430 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (compile): 23:30:55.091522 => 23:30:55.099294
[0m23:30:55.099693 [debug] [Thread-4  ]: Began executing node model.bde.room_stg
[0m23:30:55.099990 [debug] [Thread-3  ]: Timing info for model.bde.suburb_stg (compile): 23:30:55.096487 => 23:30:55.099867
[0m23:30:55.100265 [debug] [Thread-1  ]: Began executing node model.bde.property_stg
[0m23:30:55.105041 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.room_stg"
[0m23:30:55.105531 [debug] [Thread-3  ]: Began executing node model.bde.suburb_stg
[0m23:30:55.108521 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.property_stg"
[0m23:30:55.111559 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m23:30:55.112131 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m23:30:55.112435 [debug] [Thread-4  ]: On model.bde.room_stg: BEGIN
[0m23:30:55.112710 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:30:55.113092 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:55.113410 [debug] [Thread-1  ]: On model.bde.property_stg: BEGIN
[0m23:30:55.113692 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:55.113969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:55.114245 [debug] [Thread-3  ]: On model.bde.suburb_stg: BEGIN
[0m23:30:55.114597 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:55.249728 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.250282 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:55.250736 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m23:30:55.263628 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.264086 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:55.264506 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m23:30:55.268733 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.269175 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:55.269637 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m23:30:55.270320 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.270743 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m23:30:55.271209 [debug] [Thread-4  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m23:30:55.273698 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.277241 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:55.277663 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m23:30:55.280025 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.283214 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:55.283617 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m23:30:55.293961 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.294410 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.298009 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m23:30:55.298391 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.298736 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.301596 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:55.302009 [debug] [Thread-4  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m23:30:55.306051 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:55.308658 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:55.309043 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m23:30:55.309466 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m23:30:55.309842 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m23:30:55.324278 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.327136 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m23:30:55.327538 [debug] [Thread-4  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m23:30:55.329342 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.330948 [debug] [Thread-3  ]: On model.bde.suburb_stg: COMMIT
[0m23:30:55.331382 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.331819 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:55.332158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.333893 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m23:30:55.334275 [debug] [Thread-3  ]: On model.bde.suburb_stg: COMMIT
[0m23:30:55.336861 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:55.337246 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:55.337663 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m23:30:55.338030 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m23:30:55.346762 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.348253 [debug] [Thread-4  ]: On model.bde.room_stg: COMMIT
[0m23:30:55.348613 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m23:30:55.348942 [debug] [Thread-4  ]: On model.bde.room_stg: COMMIT
[0m23:30:55.352665 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.355075 [debug] [Thread-3  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:30:55.355450 [debug] [Thread-3  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m23:30:55.355849 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.358268 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:30:55.358647 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m23:30:55.358996 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.360423 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m23:30:55.360753 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:55.361071 [debug] [Thread-1  ]: On model.bde.property_stg: COMMIT
[0m23:30:55.366310 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.368666 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m23:30:55.369026 [debug] [Thread-4  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m23:30:55.372709 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.373935 [debug] [Thread-3  ]: Timing info for model.bde.suburb_stg (execute): 23:30:55.108839 => 23:30:55.373765
[0m23:30:55.374317 [debug] [Thread-3  ]: On model.bde.suburb_stg: Close
[0m23:30:55.375089 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a390710a0>]}
[0m23:30:55.375599 [info ] [Thread-3  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:30:55.376115 [debug] [Thread-3  ]: Finished running node model.bde.suburb_stg
[0m23:30:55.376493 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m23:30:55.376936 [info ] [Thread-3  ]: 9 of 18 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m23:30:55.377571 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.fact_census_G02)
[0m23:30:55.377905 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m23:30:55.380512 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m23:30:55.381498 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.381827 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.384021 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m23:30:55.385268 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 23:30:55.075344 => 23:30:55.385120
[0m23:30:55.385605 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m23:30:55.385955 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 23:30:55.378136 => 23:30:55.385814
[0m23:30:55.386277 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m23:30:55.386642 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m23:30:55.390784 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m23:30:55.391350 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a181d2460>]}
[0m23:30:55.391688 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.392226 [info ] [Thread-2  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m23:30:55.393383 [debug] [Thread-4  ]: Timing info for model.bde.room_stg (execute): 23:30:55.100468 => 23:30:55.393237
[0m23:30:55.393709 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:30:55.394168 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m23:30:55.394501 [debug] [Thread-4  ]: On model.bde.room_stg: Close
[0m23:30:55.394784 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m23:30:55.395120 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m23:30:55.395532 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:55.396006 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3906e820>]}
[0m23:30:55.396352 [info ] [Thread-2  ]: 10 of 18 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m23:30:55.396920 [info ] [Thread-4  ]: 7 of 18 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m23:30:55.397422 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_census_G01)
[0m23:30:55.397842 [debug] [Thread-4  ]: Finished running node model.bde.room_stg
[0m23:30:55.398119 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m23:30:55.398441 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m23:30:55.400947 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m23:30:55.401333 [info ] [Thread-4  ]: 11 of 18 START sql view model warehouse.dim_host ............................... [RUN]
[0m23:30:55.401931 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.dim_host)
[0m23:30:55.402300 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m23:30:55.402664 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 23:30:55.398731 => 23:30:55.402510
[0m23:30:55.405055 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m23:30:55.405561 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m23:30:55.408732 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m23:30:55.409052 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.409539 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 23:30:55.402888 => 23:30:55.409382
[0m23:30:55.410582 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (execute): 23:30:55.105760 => 23:30:55.410453
[0m23:30:55.410928 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m23:30:55.411257 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:30:55.411588 [debug] [Thread-1  ]: On model.bde.property_stg: Close
[0m23:30:55.414521 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m23:30:55.414881 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m23:30:55.415312 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:55.415861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a181d2370>]}
[0m23:30:55.416330 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m23:30:55.417090 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m23:30:55.416818 [info ] [Thread-1  ]: 6 of 18 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m23:30:55.417484 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:30:55.417920 [debug] [Thread-1  ]: Finished running node model.bde.property_stg
[0m23:30:55.418380 [debug] [Thread-1  ]: Began running node model.bde.fact_lge
[0m23:30:55.418957 [info ] [Thread-1  ]: 12 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m23:30:55.419642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_lge)
[0m23:30:55.419974 [debug] [Thread-1  ]: Began compiling node model.bde.fact_lge
[0m23:30:55.422521 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m23:30:55.423504 [debug] [Thread-1  ]: Timing info for model.bde.fact_lge (compile): 23:30:55.420198 => 23:30:55.423339
[0m23:30:55.423802 [debug] [Thread-1  ]: Began executing node model.bde.fact_lge
[0m23:30:55.426599 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m23:30:55.427063 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m23:30:55.427344 [debug] [Thread-1  ]: On model.bde.fact_lge: BEGIN
[0m23:30:55.427594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:55.560461 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.561038 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:30:55.561449 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m23:30:55.578898 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.582227 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:30:55.582664 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m23:30:55.589846 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.590268 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.590676 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m23:30:55.591089 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.591449 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m23:30:55.591854 [debug] [Thread-1  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m23:30:55.592250 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:30:55.592629 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m23:30:55.593095 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m23:30:55.600987 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.602517 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m23:30:55.602925 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:30:55.603293 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m23:30:55.613440 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.617456 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m23:30:55.617873 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.618237 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m23:30:55.618637 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.621457 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m23:30:55.621808 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.624462 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:30:55.624845 [debug] [Thread-1  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m23:30:55.627209 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:30:55.627592 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m23:30:55.628004 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m23:30:55.636517 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.637878 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m23:30:55.638246 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m23:30:55.638577 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m23:30:55.640565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.641895 [debug] [Thread-1  ]: On model.bde.fact_lge: COMMIT
[0m23:30:55.642262 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m23:30:55.642597 [debug] [Thread-1  ]: On model.bde.fact_lge: COMMIT
[0m23:30:55.649319 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.649696 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.651063 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 23:30:55.386919 => 23:30:55.650875
[0m23:30:55.652431 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m23:30:55.652821 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m23:30:55.653176 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:30:55.653562 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m23:30:55.653960 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.654623 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a38f59d90>]}
[0m23:30:55.657085 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m23:30:55.657675 [info ] [Thread-3  ]: 9 of 18 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:30:55.658065 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m23:30:55.658576 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m23:30:55.659039 [debug] [Thread-3  ]: Began running node model.bde.fact_listing
[0m23:30:55.659487 [info ] [Thread-3  ]: 13 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m23:30:55.660054 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.fact_listing)
[0m23:30:55.660388 [debug] [Thread-3  ]: Began compiling node model.bde.fact_listing
[0m23:30:55.663558 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m23:30:55.663914 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.666360 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_lge"
[0m23:30:55.666747 [debug] [Thread-1  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m23:30:55.667315 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (compile): 23:30:55.660621 => 23:30:55.667139
[0m23:30:55.667657 [debug] [Thread-3  ]: Began executing node model.bde.fact_listing
[0m23:30:55.671142 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m23:30:55.671563 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.674839 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:30:55.675198 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m23:30:55.675523 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.676852 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 23:30:55.411809 => 23:30:55.676699
[0m23:30:55.677188 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m23:30:55.677490 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m23:30:55.677843 [debug] [Thread-3  ]: On model.bde.fact_listing: BEGIN
[0m23:30:55.678377 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a3906e820>]}
[0m23:30:55.678655 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:55.679207 [info ] [Thread-4  ]: 11 of 18 OK created sql view model warehouse.dim_host .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:30:55.679690 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m23:30:55.680026 [debug] [Thread-4  ]: Began running node model.bde.dim_room
[0m23:30:55.680400 [info ] [Thread-4  ]: 14 of 18 START sql view model warehouse.dim_room ............................... [RUN]
[0m23:30:55.680883 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dim_room)
[0m23:30:55.681164 [debug] [Thread-4  ]: Began compiling node model.bde.dim_room
[0m23:30:55.683405 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_room"
[0m23:30:55.683989 [debug] [Thread-4  ]: Timing info for model.bde.dim_room (compile): 23:30:55.681369 => 23:30:55.683847
[0m23:30:55.684273 [debug] [Thread-4  ]: Began executing node model.bde.dim_room
[0m23:30:55.687370 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_room"
[0m23:30:55.687867 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.689093 [debug] [Thread-1  ]: Timing info for model.bde.fact_lge (execute): 23:30:55.423995 => 23:30:55.688941
[0m23:30:55.689551 [debug] [Thread-1  ]: On model.bde.fact_lge: Close
[0m23:30:55.689928 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m23:30:55.690233 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.690567 [debug] [Thread-4  ]: On model.bde.dim_room: BEGIN
[0m23:30:55.691115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ad64790>]}
[0m23:30:55.692220 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 23:30:55.405858 => 23:30:55.692084
[0m23:30:55.692508 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:30:55.692966 [info ] [Thread-1  ]: 12 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m23:30:55.693311 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m23:30:55.693881 [debug] [Thread-1  ]: Finished running node model.bde.fact_lge
[0m23:30:55.694281 [debug] [Thread-1  ]: Began running node model.bde.dim_property
[0m23:30:55.694881 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a390662b0>]}
[0m23:30:55.695240 [info ] [Thread-1  ]: 15 of 18 START sql view model warehouse.dim_property ........................... [RUN]
[0m23:30:55.696171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_lge, now model.bde.dim_property)
[0m23:30:55.695747 [info ] [Thread-2  ]: 10 of 18 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:30:55.696549 [debug] [Thread-1  ]: Began compiling node model.bde.dim_property
[0m23:30:55.696948 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m23:30:55.699341 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_property"
[0m23:30:55.700194 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (compile): 23:30:55.697154 => 23:30:55.700042
[0m23:30:55.700494 [debug] [Thread-1  ]: Began executing node model.bde.dim_property
[0m23:30:55.703693 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_property"
[0m23:30:55.704427 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m23:30:55.704756 [debug] [Thread-1  ]: On model.bde.dim_property: BEGIN
[0m23:30:55.705032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:55.839097 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.839672 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m23:30:55.840159 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
    host_neighbourhood,
    b.lga_name as host_neighbourhood_lga_name,
    b.lga_code as host_neighbourhood_lga_code,        
    listing_neighbourhood,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 'bayside'
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 'Canterbury-Bankstown'
        ELSE c.lga_name
    END as listing_neighbourhood_lga_name,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 11100
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 11570
        ELSE c.lga_code
    END as listing_neighbourhood_lga_code,
            property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM "postgres"."staging"."listings_stg" a
LEFT JOIN lga c ON a.listing_neighbourhood = c.suburb_name
LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name
  );
[0m23:30:55.850154 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.850552 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m23:30:55.850941 [debug] [Thread-4  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m23:30:55.856662 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:55.857086 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m23:30:55.857499 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m23:30:55.859960 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.863491 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m23:30:55.863964 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m23:30:55.871246 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.874448 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m23:30:55.874905 [debug] [Thread-4  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m23:30:55.875589 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:55.878855 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m23:30:55.879304 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.879719 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m23:30:55.881282 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m23:30:55.881767 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m23:30:55.882154 [debug] [Thread-3  ]: On model.bde.fact_listing: COMMIT
[0m23:30:55.890104 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.891635 [debug] [Thread-4  ]: On model.bde.dim_room: COMMIT
[0m23:30:55.892037 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m23:30:55.892417 [debug] [Thread-4  ]: On model.bde.dim_room: COMMIT
[0m23:30:55.899530 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:55.901169 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m23:30:55.901619 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.902026 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m23:30:55.906343 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_listing"
[0m23:30:55.906767 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m23:30:55.907170 [debug] [Thread-3  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m23:30:55.909087 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.911688 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_room"
[0m23:30:55.912092 [debug] [Thread-4  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m23:30:55.923717 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.925279 [debug] [Thread-3  ]: Timing info for model.bde.fact_listing (execute): 23:30:55.667882 => 23:30:55.925068
[0m23:30:55.925721 [debug] [Thread-3  ]: On model.bde.fact_listing: Close
[0m23:30:55.926097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:55.928661 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m23:30:55.929072 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m23:30:55.929803 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ad0caf0>]}
[0m23:30:55.930248 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.930780 [info ] [Thread-3  ]: 13 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m23:30:55.932320 [debug] [Thread-4  ]: Timing info for model.bde.dim_room (execute): 23:30:55.684476 => 23:30:55.932130
[0m23:30:55.932930 [debug] [Thread-3  ]: Finished running node model.bde.fact_listing
[0m23:30:55.933341 [debug] [Thread-4  ]: On model.bde.dim_room: Close
[0m23:30:55.933986 [debug] [Thread-2  ]: Began running node model.bde.dm_host_neighbourhood
[0m23:30:55.934390 [debug] [Thread-3  ]: Began running node model.bde.dm_listing_neighbourhood
[0m23:30:55.934965 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a38f6bb20>]}
[0m23:30:55.935386 [info ] [Thread-2  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m23:30:55.935871 [info ] [Thread-3  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m23:30:55.936427 [info ] [Thread-4  ]: 14 of 18 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m23:30:55.937035 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dm_host_neighbourhood)
[0m23:30:55.937589 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_listing, now model.bde.dm_listing_neighbourhood)
[0m23:30:55.938108 [debug] [Thread-4  ]: Finished running node model.bde.dim_room
[0m23:30:55.938458 [debug] [Thread-2  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m23:30:55.938797 [debug] [Thread-3  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m23:30:55.939178 [debug] [Thread-4  ]: Began running node model.bde.dm_property_type
[0m23:30:55.942036 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m23:30:55.944558 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m23:30:55.944981 [info ] [Thread-4  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m23:30:55.945679 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_room, now model.bde.dm_property_type)
[0m23:30:55.946064 [debug] [Thread-4  ]: Began compiling node model.bde.dm_property_type
[0m23:30:55.948624 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m23:30:55.948992 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:55.949503 [debug] [Thread-2  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 23:30:55.939472 => 23:30:55.949347
[0m23:30:55.950636 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (execute): 23:30:55.700700 => 23:30:55.950497
[0m23:30:55.951087 [debug] [Thread-3  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 23:30:55.942328 => 23:30:55.950895
[0m23:30:55.951429 [debug] [Thread-2  ]: Began executing node model.bde.dm_host_neighbourhood
[0m23:30:55.951810 [debug] [Thread-4  ]: Timing info for model.bde.dm_property_type (compile): 23:30:55.946308 => 23:30:55.951644
[0m23:30:55.952164 [debug] [Thread-1  ]: On model.bde.dim_property: Close
[0m23:30:55.952488 [debug] [Thread-3  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m23:30:55.955912 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m23:30:55.956484 [debug] [Thread-4  ]: Began executing node model.bde.dm_property_type
[0m23:30:55.959858 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m23:30:55.960401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a390d7e80>]}
[0m23:30:55.964085 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m23:30:55.964671 [info ] [Thread-1  ]: 15 of 18 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m23:30:55.965194 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:30:55.965621 [debug] [Thread-1  ]: Finished running node model.bde.dim_property
[0m23:30:55.965912 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:30:55.966191 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m23:30:55.966516 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:30:55.966871 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m23:30:55.967186 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:30:55.967519 [debug] [Thread-4  ]: On model.bde.dm_property_type: BEGIN
[0m23:30:55.967807 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:55.968211 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:30:56.150574 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:56.151500 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:56.152222 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:30:56.153025 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:30:56.153723 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:30:56.154374 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:30:56.155301 [debug] [Thread-4  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  property_type,
  room_type,
  accommodates,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  ROUND(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN has_availability = 't' THEN price END) AS min_price,
  MAX(CASE WHEN has_availability = 't' THEN price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN has_availability = 't' THEN price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN price END), 2) AS avg_price,
  COUNT(DISTINCT host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
   CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,	
  (SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) ELSE 0 END)) AS total_stay,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) AS avg_estimated_revenue
FROM "postgres"."warehouse"."fact_listing"
GROUP BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY
  property_type,
  room_type,
  accommodates,
  scraped_month_year
  );
[0m23:30:56.156296 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    SELECT 
    host_neighbourhood_lga_name,
	CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
    count(DISTINCT host_id) as number_of_distinct_host,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) as estimate_revenue_per_active,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END) / COUNT(DISTINCT host_id), 2) as estimate_revenue_per_host
FROM 
    "postgres"."warehouse"."fact_listing"
GROUP BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY 
    host_neighbourhood_lga_name,
    scraped_month_year
  );
[0m23:30:56.157268 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  listing_neighbourhood,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  min(case when has_availability = 't' then price end) as minimum_price,
  max(case when has_availability = 't' then price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
  round(avg(case when has_availability = 't' then price end),2) as average_price,
  count(distinct host_id) as distinct_host,
  round((sum(case when host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,
  sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
  round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from
    "postgres"."warehouse"."fact_listing"
group by 
  listing_neighbourhood,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
order by 
  listing_neighbourhood, 
  scraped_month_year
  );
[0m23:30:56.182390 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:56.183069 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:56.189320 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:30:56.189056 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:30:56.194415 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:30:56.198680 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:30:56.199307 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m23:30:56.199946 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m23:30:56.200539 [debug] [Thread-4  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m23:30:56.214589 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:56.215213 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:56.217744 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m23:30:56.218369 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:30:56.220589 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m23:30:56.221239 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:30:56.223385 [debug] [Thread-4  ]: On model.bde.dm_property_type: COMMIT
[0m23:30:56.224006 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:30:56.224597 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m23:30:56.225140 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:30:56.225678 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m23:30:56.226273 [debug] [Thread-4  ]: On model.bde.dm_property_type: COMMIT
[0m23:30:56.244575 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:56.245115 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:56.249321 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:30:56.249869 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:30:56.253777 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:30:56.254391 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m23:30:56.257850 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:30:56.258361 [debug] [Thread-4  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m23:30:56.258935 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m23:30:56.272203 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:56.274341 [debug] [Thread-4  ]: Timing info for model.bde.dm_property_type (execute): 23:30:55.960705 => 23:30:56.274054
[0m23:30:56.274906 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:56.275502 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:30:56.276049 [debug] [Thread-4  ]: On model.bde.dm_property_type: Close
[0m23:30:56.277788 [debug] [Thread-2  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 23:30:55.952725 => 23:30:56.277564
[0m23:30:56.279478 [debug] [Thread-3  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 23:30:55.956776 => 23:30:56.279245
[0m23:30:56.280065 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: Close
[0m23:30:56.280603 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: Close
[0m23:30:56.281509 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ae73cd0>]}
[0m23:30:56.283307 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2abb7460>]}
[0m23:30:56.284172 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233981ea-819a-4929-801c-ddbe953255f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1815a070>]}
[0m23:30:56.282497 [info ] [Thread-4  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.34s]
[0m23:30:56.285059 [info ] [Thread-2  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.35s]
[0m23:30:56.285771 [info ] [Thread-3  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.35s]
[0m23:30:56.286495 [debug] [Thread-4  ]: Finished running node model.bde.dm_property_type
[0m23:30:56.287124 [debug] [Thread-2  ]: Finished running node model.bde.dm_host_neighbourhood
[0m23:30:56.287723 [debug] [Thread-3  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m23:30:56.289692 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:56.290106 [debug] [MainThread]: On master: BEGIN
[0m23:30:56.290460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:56.485787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:30:56.487819 [debug] [MainThread]: On master: COMMIT
[0m23:30:56.488546 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:56.489309 [debug] [MainThread]: On master: COMMIT
[0m23:30:56.508919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:30:56.509994 [debug] [MainThread]: On master: Close
[0m23:30:56.512266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:56.513346 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m23:30:56.514380 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m23:30:56.515168 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m23:30:56.515764 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m23:30:56.516641 [info ] [MainThread]: 
[0m23:30:56.517454 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m23:30:56.523994 [debug] [MainThread]: Command end result
[0m23:30:56.541696 [info ] [MainThread]: 
[0m23:30:56.542462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:30:56.543007 [info ] [MainThread]: 
[0m23:30:56.543559 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m23:30:56.544535 [debug] [MainThread]: Command `dbt run` succeeded at 23:30:56.544383 after 3.47 seconds
[0m23:30:56.545171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a382616a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ab89280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a2ab13a30>]}
[0m23:30:56.545760 [debug] [MainThread]: Flushing usage events
[0m23:37:52.903205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe808c316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b5487f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b5488e0>]}


============================== 23:37:52.907014 | 57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc ==============================
[0m23:37:52.907014 [info ] [MainThread]: Running with dbt=1.6.6
[0m23:37:52.907649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:37:53.012597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b548880>]}
[0m23:37:53.023243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b66f250>]}
[0m23:37:53.023772 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m23:37:53.042420 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m23:37:53.074883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:37:53.075666 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_listing_neighbourhood.sql
[0m23:37:53.076089 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_host_neighbourhood.sql
[0m23:37:53.076422 [debug] [MainThread]: Partial parsing: updated file: bde://models/datamart/dm_property_type.sql
[0m23:37:53.115161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e84940d0>]}
[0m23:37:53.128979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f814d940>]}
[0m23:37:53.129417 [info ] [MainThread]: Found 3 snapshots, 18 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m23:37:53.129711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f814dc40>]}
[0m23:37:53.131423 [info ] [MainThread]: 
[0m23:37:53.132026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:53.133375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:37:53.140269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:37:53.142059 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:37:53.142845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:37:53.144530 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:37:53.144836 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:37:53.146236 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:37:53.146530 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:37:53.146800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:53.147045 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:37:53.147270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:53.148897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:53.391987 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m23:37:53.392607 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m23:37:53.394698 [debug] [ThreadPool]: On list_postgres: Close
[0m23:37:53.395113 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m23:37:53.397107 [debug] [ThreadPool]: On list_postgres: Close
[0m23:37:53.398427 [debug] [ThreadPool]: On list_postgres: Close
[0m23:37:53.401730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m23:37:53.402446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m23:37:53.403155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m23:37:53.408817 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:37:53.409649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_datamart'
[0m23:37:53.411340 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m23:37:53.413014 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m23:37:53.413339 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m23:37:53.415008 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m23:37:53.415322 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m23:37:53.415582 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m23:37:53.415846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:53.416097 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m23:37:53.416341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:53.416587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:53.416966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:53.589826 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:37:53.590782 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:37:53.591392 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m23:37:53.592008 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m23:37:53.592680 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m23:37:53.593414 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m23:37:53.595533 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:37:53.596068 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m23:37:53.596643 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:37:53.597242 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m23:37:53.597896 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m23:37:53.598522 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m23:37:53.619012 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:37:53.619579 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:37:53.622047 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m23:37:53.624130 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m23:37:53.624698 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:37:53.625220 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:37:53.627458 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m23:37:53.629450 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m23:37:53.641776 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m23:37:53.645315 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m23:37:53.645896 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m23:37:53.646457 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m23:37:53.659958 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:53.660488 [debug] [MainThread]: On master: BEGIN
[0m23:37:53.660909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:53.832832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:37:53.835770 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:53.837137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:53.867938 [debug] [MainThread]: SQL status: SELECT 21 in 0.0 seconds
[0m23:37:53.882984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e8516760>]}
[0m23:37:53.884144 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:53.897967 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:53.898668 [debug] [MainThread]: On master: BEGIN
[0m23:37:53.931352 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:37:53.932966 [debug] [MainThread]: On master: COMMIT
[0m23:37:53.934095 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:53.935166 [debug] [MainThread]: On master: COMMIT
[0m23:37:53.954762 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:37:53.955781 [debug] [MainThread]: On master: Close
[0m23:37:53.957914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:53.958925 [info ] [MainThread]: 
[0m23:37:53.965688 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m23:37:53.966689 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m23:37:53.967681 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m23:37:53.968736 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m23:37:53.969719 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m23:37:53.970813 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m23:37:53.971869 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m23:37:53.973280 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.G01_stg)
[0m23:37:53.974110 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m23:37:53.975278 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G02_stg)
[0m23:37:53.976415 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.host_stg)
[0m23:37:53.977137 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m23:37:53.978172 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.lga_stg)
[0m23:37:53.978855 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m23:37:53.979510 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m23:37:53.993169 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m23:37:53.993880 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m23:37:53.998005 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m23:37:54.003317 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m23:37:54.006914 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m23:37:54.007813 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 23:37:53.980043 => 23:37:54.007510
[0m23:37:54.008782 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 23:37:53.998525 => 23:37:54.008508
[0m23:37:54.009404 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 23:37:53.994284 => 23:37:54.009165
[0m23:37:54.009937 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 23:37:54.003830 => 23:37:54.009717
[0m23:37:54.010385 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m23:37:54.010856 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m23:37:54.011329 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m23:37:54.011766 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m23:37:54.055899 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m23:37:54.056291 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m23:37:54.059311 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m23:37:54.062194 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m23:37:54.063038 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:37:54.063345 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m23:37:54.063634 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:37:54.063936 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:37:54.064237 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:37:54.064531 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:37:54.064815 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m23:37:54.065097 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m23:37:54.065487 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m23:37:54.065771 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:37:54.066049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:54.066310 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:37:54.237859 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.238813 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:37:54.239534 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m23:37:54.242289 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.242855 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:37:54.243460 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m23:37:54.247395 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.247976 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:37:54.248585 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m23:37:54.255596 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.256245 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:37:54.256915 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m23:37:54.261798 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.317614 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.318062 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.318408 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.320487 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:37:54.323236 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:37:54.325805 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:37:54.328275 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:37:54.328610 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m23:37:54.328936 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m23:37:54.329249 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m23:37:54.329554 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m23:37:54.349058 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.351816 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:37:54.352212 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.352546 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m23:37:54.352862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.353186 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.355720 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:37:54.358224 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:37:54.360681 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:37:54.361041 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m23:37:54.361386 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m23:37:54.361714 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m23:37:54.372966 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.383848 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.384177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.388333 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m23:37:54.388646 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.389950 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m23:37:54.391273 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m23:37:54.391600 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:37:54.392887 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m23:37:54.393213 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:37:54.393512 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:37:54.393804 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m23:37:54.394095 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:37:54.394386 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m23:37:54.394673 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m23:37:54.395001 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m23:37:54.409620 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.409991 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.410317 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.410624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.433749 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m23:37:54.436019 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m23:37:54.438277 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m23:37:54.440423 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m23:37:54.440776 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m23:37:54.441121 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m23:37:54.441431 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m23:37:54.441738 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m23:37:54.461310 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.462639 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 23:37:54.056562 => 23:37:54.462465
[0m23:37:54.463021 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m23:37:54.463819 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b6a1970>]}
[0m23:37:54.464209 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.464596 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.464955 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.465672 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.49s]
[0m23:37:54.466985 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 23:37:54.012113 => 23:37:54.466816
[0m23:37:54.468118 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 23:37:54.029888 => 23:37:54.467969
[0m23:37:54.469207 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 23:37:54.059559 => 23:37:54.469058
[0m23:37:54.469699 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m23:37:54.470036 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m23:37:54.470357 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m23:37:54.470675 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m23:37:54.471043 [debug] [Thread-2  ]: Began running node model.bde.listings_stg
[0m23:37:54.471893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d806ee50>]}
[0m23:37:54.472487 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e8445910>]}
[0m23:37:54.473054 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e86588e0>]}
[0m23:37:54.473447 [info ] [Thread-2  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m23:37:54.473985 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.49s]
[0m23:37:54.474448 [info ] [Thread-3  ]: 3 of 18 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.50s]
[0m23:37:54.474885 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.50s]
[0m23:37:54.475412 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.listings_stg)
[0m23:37:54.475868 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m23:37:54.476297 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m23:37:54.476719 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m23:37:54.477016 [debug] [Thread-2  ]: Began compiling node model.bde.listings_stg
[0m23:37:54.477362 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m23:37:54.477736 [debug] [Thread-3  ]: Began running node model.bde.room_stg
[0m23:37:54.478091 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m23:37:54.480943 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m23:37:54.481368 [info ] [Thread-4  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m23:37:54.481781 [info ] [Thread-3  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m23:37:54.482180 [info ] [Thread-1  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m23:37:54.482790 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.property_stg)
[0m23:37:54.483291 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.room_stg)
[0m23:37:54.483807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.suburb_stg)
[0m23:37:54.484190 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (compile): 23:37:54.478420 => 23:37:54.484035
[0m23:37:54.484492 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m23:37:54.484783 [debug] [Thread-3  ]: Began compiling node model.bde.room_stg
[0m23:37:54.485072 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m23:37:54.485357 [debug] [Thread-2  ]: Began executing node model.bde.listings_stg
[0m23:37:54.487583 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m23:37:54.489869 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.room_stg"
[0m23:37:54.492495 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m23:37:54.496938 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m23:37:54.497627 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 23:37:54.485561 => 23:37:54.497469
[0m23:37:54.498004 [debug] [Thread-3  ]: Timing info for model.bde.room_stg (compile): 23:37:54.487822 => 23:37:54.497859
[0m23:37:54.498412 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 23:37:54.490203 => 23:37:54.498262
[0m23:37:54.498682 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m23:37:54.499014 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:37:54.499283 [debug] [Thread-3  ]: Began executing node model.bde.room_stg
[0m23:37:54.499566 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m23:37:54.502488 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m23:37:54.502796 [debug] [Thread-2  ]: On model.bde.listings_stg: BEGIN
[0m23:37:54.505520 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.room_stg"
[0m23:37:54.508329 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m23:37:54.508737 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:37:54.509256 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m23:37:54.509727 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m23:37:54.510102 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:37:54.510396 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m23:37:54.510750 [debug] [Thread-3  ]: On model.bde.room_stg: BEGIN
[0m23:37:54.511076 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m23:37:54.511376 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:37:54.511674 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:37:54.511967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:54.685005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.685846 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:37:54.686476 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m23:37:54.692229 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.692796 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:37:54.693445 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m23:37:54.697423 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.698043 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:54.698641 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m23:37:54.699251 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m23:37:54.699892 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m23:37:54.700669 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m23:37:54.701521 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.707219 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:37:54.707833 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m23:37:54.716264 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.721197 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:37:54.721748 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.722199 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:54.722636 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.723098 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m23:37:54.727333 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m23:37:54.731555 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m23:37:54.735706 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:37:54.736251 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m23:37:54.736713 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m23:37:54.737159 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m23:37:54.752290 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.755523 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:37:54.755991 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m23:37:54.756410 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.756802 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.757172 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.759224 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m23:37:54.762342 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m23:37:54.765350 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m23:37:54.765773 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:37:54.766175 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m23:37:54.766577 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m23:37:54.766960 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m23:37:54.776781 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.778448 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m23:37:54.778840 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:37:54.779205 [debug] [Thread-2  ]: On model.bde.listings_stg: COMMIT
[0m23:37:54.781005 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.781394 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.784148 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m23:37:54.784519 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:54.786169 [debug] [Thread-3  ]: On model.bde.room_stg: COMMIT
[0m23:37:54.786589 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m23:37:54.788160 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m23:37:54.788565 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m23:37:54.789010 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m23:37:54.789396 [debug] [Thread-3  ]: On model.bde.room_stg: COMMIT
[0m23:37:54.789742 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m23:37:54.793462 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.796078 [debug] [Thread-2  ]: Using postgres connection "model.bde.listings_stg"
[0m23:37:54.796448 [debug] [Thread-2  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m23:37:54.807236 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.809910 [debug] [Thread-3  ]: Using postgres connection "model.bde.room_stg"
[0m23:37:54.810317 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.810675 [debug] [Thread-3  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m23:37:54.811022 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:54.812380 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 23:37:54.505749 => 23:37:54.812193
[0m23:37:54.814960 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m23:37:54.815339 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m23:37:54.815693 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m23:37:54.816483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe808216760>]}
[0m23:37:54.817029 [info ] [Thread-1  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m23:37:54.817586 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m23:37:54.817999 [debug] [Thread-1  ]: Began running node model.bde.fact_census_G02
[0m23:37:54.818417 [info ] [Thread-1  ]: 9 of 18 START sql view model warehouse.fact_census_G02 ......................... [RUN]
[0m23:37:54.818819 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.819364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.fact_census_G02)
[0m23:37:54.820697 [debug] [Thread-2  ]: Timing info for model.bde.listings_stg (execute): 23:37:54.492854 => 23:37:54.820533
[0m23:37:54.821130 [debug] [Thread-1  ]: Began compiling node model.bde.fact_census_G02
[0m23:37:54.821491 [debug] [Thread-2  ]: On model.bde.listings_stg: Close
[0m23:37:54.824169 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m23:37:54.824990 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e8628940>]}
[0m23:37:54.825546 [info ] [Thread-2  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m23:37:54.827263 [debug] [Thread-2  ]: Finished running node model.bde.listings_stg
[0m23:37:54.827672 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G02 (compile): 23:37:54.821752 => 23:37:54.827504
[0m23:37:54.828037 [debug] [Thread-2  ]: Began running node model.bde.dim_host
[0m23:37:54.828401 [debug] [Thread-1  ]: Began executing node model.bde.fact_census_G02
[0m23:37:54.828826 [info ] [Thread-2  ]: 10 of 18 START sql view model warehouse.dim_host ............................... [RUN]
[0m23:37:54.831921 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m23:37:54.832250 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.832770 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_host)
[0m23:37:54.834033 [debug] [Thread-3  ]: Timing info for model.bde.room_stg (execute): 23:37:54.503016 => 23:37:54.833884
[0m23:37:54.834409 [debug] [Thread-2  ]: Began compiling node model.bde.dim_host
[0m23:37:54.834746 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:37:54.835073 [debug] [Thread-3  ]: On model.bde.room_stg: Close
[0m23:37:54.837610 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dim_host"
[0m23:37:54.837952 [debug] [Thread-1  ]: On model.bde.fact_census_G02: BEGIN
[0m23:37:54.838371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:54.838935 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e8435490>]}
[0m23:37:54.839276 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:54.839755 [debug] [Thread-2  ]: Timing info for model.bde.dim_host (compile): 23:37:54.835304 => 23:37:54.839603
[0m23:37:54.840227 [info ] [Thread-3  ]: 7 of 18 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.36s]
[0m23:37:54.841393 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 23:37:54.499776 => 23:37:54.841252
[0m23:37:54.841764 [debug] [Thread-2  ]: Began executing node model.bde.dim_host
[0m23:37:54.842215 [debug] [Thread-3  ]: Finished running node model.bde.room_stg
[0m23:37:54.842525 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m23:37:54.845711 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dim_host"
[0m23:37:54.846230 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G01
[0m23:37:54.847321 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f8207dc0>]}
[0m23:37:54.846825 [info ] [Thread-3  ]: 11 of 18 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m23:37:54.847892 [info ] [Thread-4  ]: 6 of 18 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m23:37:54.848404 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_census_G01)
[0m23:37:54.848716 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m23:37:54.849144 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m23:37:54.849430 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G01
[0m23:37:54.849708 [debug] [Thread-2  ]: On model.bde.dim_host: BEGIN
[0m23:37:54.850022 [debug] [Thread-4  ]: Began running node model.bde.fact_lge
[0m23:37:54.852418 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m23:37:54.852776 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:37:54.853172 [info ] [Thread-4  ]: 12 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m23:37:54.853902 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_lge)
[0m23:37:54.854187 [debug] [Thread-4  ]: Began compiling node model.bde.fact_lge
[0m23:37:54.854518 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G01 (compile): 23:37:54.850268 => 23:37:54.854368
[0m23:37:54.856789 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m23:37:54.857113 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G01
[0m23:37:54.860385 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m23:37:54.861471 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (compile): 23:37:54.854746 => 23:37:54.861246
[0m23:37:54.861906 [debug] [Thread-4  ]: Began executing node model.bde.fact_lge
[0m23:37:54.862265 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:37:54.865443 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m23:37:54.865785 [debug] [Thread-3  ]: On model.bde.fact_census_G01: BEGIN
[0m23:37:54.866144 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:37:54.866605 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m23:37:54.866899 [debug] [Thread-4  ]: On model.bde.fact_lge: BEGIN
[0m23:37:54.867167 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:37:55.015601 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.016342 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m23:37:55.016819 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m23:37:55.028843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.029306 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:37:55.029752 [debug] [Thread-1  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m23:37:55.038479 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.044249 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m23:37:55.044824 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m23:37:55.049936 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.050486 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.051000 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m23:37:55.051515 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:37:55.052025 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.052506 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m23:37:55.053062 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m23:37:55.056475 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:37:55.057077 [debug] [Thread-1  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m23:37:55.064312 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.065976 [debug] [Thread-2  ]: On model.bde.dim_host: COMMIT
[0m23:37:55.066415 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m23:37:55.066823 [debug] [Thread-2  ]: On model.bde.dim_host: COMMIT
[0m23:37:55.073787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.075425 [debug] [Thread-1  ]: On model.bde.fact_census_G02: COMMIT
[0m23:37:55.075867 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:37:55.076275 [debug] [Thread-1  ]: On model.bde.fact_census_G02: COMMIT
[0m23:37:55.076887 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.080229 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m23:37:55.080689 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.081134 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m23:37:55.084336 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:37:55.084818 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m23:37:55.085221 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.087882 [debug] [Thread-2  ]: Using postgres connection "model.bde.dim_host"
[0m23:37:55.088289 [debug] [Thread-2  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m23:37:55.093051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.095528 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m23:37:55.095935 [debug] [Thread-1  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m23:37:55.104537 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.106139 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m23:37:55.106592 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.107002 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m23:37:55.107378 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.108812 [debug] [Thread-2  ]: Timing info for model.bde.dim_host (execute): 23:37:54.842739 => 23:37:55.108618
[0m23:37:55.109216 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m23:37:55.110675 [debug] [Thread-3  ]: On model.bde.fact_census_G01: COMMIT
[0m23:37:55.111099 [debug] [Thread-2  ]: On model.bde.dim_host: Close
[0m23:37:55.111544 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:37:55.112000 [debug] [Thread-3  ]: On model.bde.fact_census_G01: COMMIT
[0m23:37:55.112719 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b6998b0>]}
[0m23:37:55.113138 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.114525 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G02 (execute): 23:37:54.829095 => 23:37:55.114358
[0m23:37:55.114900 [debug] [Thread-1  ]: On model.bde.fact_census_G02: Close
[0m23:37:55.115414 [info ] [Thread-2  ]: 10 of 18 OK created sql view model warehouse.dim_host .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:37:55.116020 [debug] [Thread-2  ]: Finished running node model.bde.dim_host
[0m23:37:55.116758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b703970>]}
[0m23:37:55.117175 [debug] [Thread-2  ]: Began running node model.bde.fact_listing
[0m23:37:55.117748 [info ] [Thread-1  ]: 9 of 18 OK created sql view model warehouse.fact_census_G02 .................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:37:55.118207 [info ] [Thread-2  ]: 13 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m23:37:55.118756 [debug] [Thread-1  ]: Finished running node model.bde.fact_census_G02
[0m23:37:55.119331 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.fact_listing)
[0m23:37:55.119741 [debug] [Thread-1  ]: Began running node model.bde.dim_room
[0m23:37:55.120131 [debug] [Thread-2  ]: Began compiling node model.bde.fact_listing
[0m23:37:55.120559 [info ] [Thread-1  ]: 14 of 18 START sql view model warehouse.dim_room ............................... [RUN]
[0m23:37:55.123976 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m23:37:55.124586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.dim_room)
[0m23:37:55.125020 [debug] [Thread-1  ]: Began compiling node model.bde.dim_room
[0m23:37:55.127421 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_room"
[0m23:37:55.128112 [debug] [Thread-2  ]: Timing info for model.bde.fact_listing (compile): 23:37:55.120860 => 23:37:55.127931
[0m23:37:55.128526 [debug] [Thread-1  ]: Timing info for model.bde.dim_room (compile): 23:37:55.125281 => 23:37:55.128362
[0m23:37:55.128853 [debug] [Thread-2  ]: Began executing node model.bde.fact_listing
[0m23:37:55.129206 [debug] [Thread-1  ]: Began executing node model.bde.dim_room
[0m23:37:55.129548 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.129845 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.134161 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m23:37:55.137292 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_room"
[0m23:37:55.139335 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m23:37:55.141298 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m23:37:55.141776 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m23:37:55.142115 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m23:37:55.142416 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_listing"
[0m23:37:55.142825 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_room"
[0m23:37:55.143197 [debug] [Thread-2  ]: On model.bde.fact_listing: BEGIN
[0m23:37:55.143486 [debug] [Thread-1  ]: On model.bde.dim_room: BEGIN
[0m23:37:55.143761 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:37:55.144030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:55.155830 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.156238 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.157647 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (execute): 23:37:54.862524 => 23:37:55.157473
[0m23:37:55.159086 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G01 (execute): 23:37:54.857389 => 23:37:55.158913
[0m23:37:55.159509 [debug] [Thread-4  ]: On model.bde.fact_lge: Close
[0m23:37:55.159842 [debug] [Thread-3  ]: On model.bde.fact_census_G01: Close
[0m23:37:55.160640 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e865aa30>]}
[0m23:37:55.161250 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e861eb20>]}
[0m23:37:55.161785 [info ] [Thread-4  ]: 12 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:37:55.162278 [info ] [Thread-3  ]: 11 of 18 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:37:55.162840 [debug] [Thread-4  ]: Finished running node model.bde.fact_lge
[0m23:37:55.163369 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G01
[0m23:37:55.163803 [debug] [Thread-4  ]: Began running node model.bde.dim_property
[0m23:37:55.164308 [info ] [Thread-4  ]: 15 of 18 START sql view model warehouse.dim_property ........................... [RUN]
[0m23:37:55.164891 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_lge, now model.bde.dim_property)
[0m23:37:55.165213 [debug] [Thread-4  ]: Began compiling node model.bde.dim_property
[0m23:37:55.167731 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_property"
[0m23:37:55.168353 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (compile): 23:37:55.165441 => 23:37:55.168192
[0m23:37:55.168673 [debug] [Thread-4  ]: Began executing node model.bde.dim_property
[0m23:37:55.171951 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_property"
[0m23:37:55.172444 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m23:37:55.172730 [debug] [Thread-4  ]: On model.bde.dim_property: BEGIN
[0m23:37:55.173000 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:37:55.318034 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.318799 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_listing"
[0m23:37:55.319418 [debug] [Thread-2  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as
(SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
)

SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
    host_neighbourhood,
    b.lga_name as host_neighbourhood_lga_name,
    b.lga_code as host_neighbourhood_lga_code,        
    listing_neighbourhood,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 'bayside'
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 'Canterbury-Bankstown'
        ELSE c.lga_name
    END as listing_neighbourhood_lga_name,
    CASE
        WHEN a.listing_neighbourhood = 'bayside' THEN 11100
        WHEN a.listing_neighbourhood = 'canterbury-bankstown' THEN 11570
        ELSE c.lga_code
    END as listing_neighbourhood_lga_code,
            property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM "postgres"."staging"."listings_stg" a
LEFT JOIN lga c ON a.listing_neighbourhood = c.suburb_name
LEFT JOIN lga b ON a.host_neighbourhood = b.suburb_name
  );
[0m23:37:55.322145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.322695 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_room"
[0m23:37:55.323198 [debug] [Thread-1  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m23:37:55.341432 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.341982 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.346285 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_listing"
[0m23:37:55.349971 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_room"
[0m23:37:55.350514 [debug] [Thread-2  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m23:37:55.351031 [debug] [Thread-1  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m23:37:55.353078 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.353565 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m23:37:55.354054 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m23:37:55.367770 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.368255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.370178 [debug] [Thread-2  ]: On model.bde.fact_listing: COMMIT
[0m23:37:55.372143 [debug] [Thread-1  ]: On model.bde.dim_room: COMMIT
[0m23:37:55.372645 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_listing"
[0m23:37:55.373131 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.373579 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_room"
[0m23:37:55.374046 [debug] [Thread-2  ]: On model.bde.fact_listing: COMMIT
[0m23:37:55.379227 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m23:37:55.379695 [debug] [Thread-1  ]: On model.bde.dim_room: COMMIT
[0m23:37:55.380199 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m23:37:55.393829 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.397078 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_listing"
[0m23:37:55.397608 [debug] [Thread-2  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m23:37:55.401558 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.402060 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.404178 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m23:37:55.407345 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_room"
[0m23:37:55.407854 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m23:37:55.408341 [debug] [Thread-1  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m23:37:55.408835 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m23:37:55.411507 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.413129 [debug] [Thread-2  ]: Timing info for model.bde.fact_listing (execute): 23:37:55.130060 => 23:37:55.412888
[0m23:37:55.413614 [debug] [Thread-2  ]: On model.bde.fact_listing: Close
[0m23:37:55.414715 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b6998b0>]}
[0m23:37:55.415461 [info ] [Thread-2  ]: 13 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:37:55.416208 [debug] [Thread-2  ]: Finished running node model.bde.fact_listing
[0m23:37:55.416972 [debug] [Thread-3  ]: Began running node model.bde.dm_host_neighbourhood
[0m23:37:55.417531 [info ] [Thread-3  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m23:37:55.418058 [debug] [Thread-2  ]: Began running node model.bde.dm_listing_neighbourhood
[0m23:37:55.418868 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dm_host_neighbourhood)
[0m23:37:55.419438 [info ] [Thread-2  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m23:37:55.419935 [debug] [Thread-3  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m23:37:55.420644 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_listing, now model.bde.dm_listing_neighbourhood)
[0m23:37:55.423952 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m23:37:55.424460 [debug] [Thread-2  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m23:37:55.428062 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m23:37:55.428566 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.428960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.431670 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m23:37:55.432145 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 23:37:55.420993 => 23:37:55.431933
[0m23:37:55.433550 [debug] [Thread-1  ]: Timing info for model.bde.dim_room (execute): 23:37:55.134432 => 23:37:55.433386
[0m23:37:55.433984 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 23:37:55.424861 => 23:37:55.433805
[0m23:37:55.434363 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m23:37:55.434757 [debug] [Thread-3  ]: Began executing node model.bde.dm_host_neighbourhood
[0m23:37:55.435124 [debug] [Thread-1  ]: On model.bde.dim_room: Close
[0m23:37:55.435482 [debug] [Thread-2  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m23:37:55.439145 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m23:37:55.442599 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m23:37:55.443480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b6c0e50>]}
[0m23:37:55.444229 [info ] [Thread-1  ]: 14 of 18 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m23:37:55.444831 [debug] [Thread-1  ]: Finished running node model.bde.dim_room
[0m23:37:55.445269 [debug] [Thread-1  ]: Began running node model.bde.dm_property_type
[0m23:37:55.445692 [info ] [Thread-1  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m23:37:55.446097 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:37:55.446666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.dim_room, now model.bde.dm_property_type)
[0m23:37:55.446987 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:37:55.447307 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m23:37:55.447615 [debug] [Thread-1  ]: Began compiling node model.bde.dm_property_type
[0m23:37:55.447913 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m23:37:55.448206 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:37:55.451884 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m23:37:55.452236 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.452577 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:37:55.453946 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (execute): 23:37:55.168898 => 23:37:55.453796
[0m23:37:55.454423 [debug] [Thread-4  ]: On model.bde.dim_property: Close
[0m23:37:55.454822 [debug] [Thread-1  ]: Timing info for model.bde.dm_property_type (compile): 23:37:55.448432 => 23:37:55.454663
[0m23:37:55.455180 [debug] [Thread-1  ]: Began executing node model.bde.dm_property_type
[0m23:37:55.455720 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e86e0070>]}
[0m23:37:55.459117 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m23:37:55.459994 [info ] [Thread-4  ]: 15 of 18 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.29s]
[0m23:37:55.460496 [debug] [Thread-4  ]: Finished running node model.bde.dim_property
[0m23:37:55.460960 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:37:55.461251 [debug] [Thread-1  ]: On model.bde.dm_property_type: BEGIN
[0m23:37:55.461524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:37:55.636007 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.636789 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.637481 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.638050 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:37:55.638652 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:37:55.639230 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:37:55.640031 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  listing_neighbourhood,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  min(case when has_availability = 't' then price end) as minimum_price,
  max(case when has_availability = 't' then price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
  round(avg(case when has_availability = 't' then price end),2) as average_price,
  count(distinct host_id) as distinct_host,
  round((sum(case when host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,
  sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
  round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from
    "postgres"."warehouse"."fact_listing"
group by 
  listing_neighbourhood,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
order by 
  listing_neighbourhood, 
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m23:37:55.641115 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  property_type,
  room_type,
  accommodates,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  ROUND(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN has_availability = 't' THEN price END) AS min_price,
  MAX(CASE WHEN has_availability = 't' THEN price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN has_availability = 't' THEN price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN price END), 2) AS avg_price,
  COUNT(DISTINCT host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
   CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,	
  (SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) ELSE 0 END)) AS total_stay,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) AS avg_estimated_revenue
FROM "postgres"."warehouse"."fact_listing"
GROUP BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m23:37:55.642020 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    SELECT 
    host_neighbourhood_lga_name,
	CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
    count(DISTINCT host_id) as number_of_distinct_host,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) as estimate_revenue_per_active,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END) / COUNT(DISTINCT host_id), 2) as estimate_revenue_per_host
FROM 
    "postgres"."warehouse"."fact_listing"
GROUP BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m23:37:55.668627 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.669285 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.674872 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:37:55.675561 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:37:55.679948 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:37:55.680643 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m23:37:55.684778 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:37:55.685326 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m23:37:55.685933 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m23:37:55.699882 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.702231 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m23:37:55.702832 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:37:55.703370 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m23:37:55.705762 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.706345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:37:55.708510 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m23:37:55.710481 [debug] [Thread-1  ]: On model.bde.dm_property_type: COMMIT
[0m23:37:55.711019 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:37:55.711514 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:37:55.712012 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m23:37:55.712480 [debug] [Thread-1  ]: On model.bde.dm_property_type: COMMIT
[0m23:37:55.721333 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.725392 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m23:37:55.725991 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m23:37:55.728647 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.732094 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m23:37:55.732584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.733076 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m23:37:55.736468 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m23:37:55.737071 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m23:37:55.743639 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.745516 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 23:37:55.435791 => 23:37:55.745245
[0m23:37:55.746066 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: Close
[0m23:37:55.747299 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d80a5a60>]}
[0m23:37:55.748125 [info ] [Thread-3  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.33s]
[0m23:37:55.748938 [debug] [Thread-3  ]: Finished running node model.bde.dm_host_neighbourhood
[0m23:37:55.753609 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.755349 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 23:37:55.439474 => 23:37:55.755115
[0m23:37:55.755907 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:37:55.756466 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: Close
[0m23:37:55.758270 [debug] [Thread-1  ]: Timing info for model.bde.dm_property_type (execute): 23:37:55.455982 => 23:37:55.758057
[0m23:37:55.758807 [debug] [Thread-1  ]: On model.bde.dm_property_type: Close
[0m23:37:55.759763 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d80c6280>]}
[0m23:37:55.760640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a99a8b-9bd8-4a7f-9e72-0a02941bb6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b6c0e50>]}
[0m23:37:55.761446 [info ] [Thread-2  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.34s]
[0m23:37:55.762121 [info ] [Thread-1  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.31s]
[0m23:37:55.762803 [debug] [Thread-2  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m23:37:55.763428 [debug] [Thread-1  ]: Finished running node model.bde.dm_property_type
[0m23:37:55.765151 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.765553 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.765903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:55.933447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:37:55.934483 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.935226 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:55.935909 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.953422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:37:55.954159 [debug] [MainThread]: On master: Close
[0m23:37:55.955872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:55.956553 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m23:37:55.957191 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m23:37:55.957798 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m23:37:55.958401 [debug] [MainThread]: Connection 'model.bde.dim_property' was properly closed.
[0m23:37:55.959301 [info ] [MainThread]: 
[0m23:37:55.960107 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m23:37:55.966345 [debug] [MainThread]: Command end result
[0m23:37:55.983008 [info ] [MainThread]: 
[0m23:37:55.983763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:37:55.984311 [info ] [MainThread]: 
[0m23:37:55.984850 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m23:37:55.985787 [debug] [MainThread]: Command `dbt run` succeeded at 23:37:55.985638 after 3.11 seconds
[0m23:37:55.986344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe808c316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e86588e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80b60b9d0>]}
[0m23:37:55.986880 [debug] [MainThread]: Flushing usage events
[0m13:10:04.826741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa730b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732ca8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732ca8850>]}


============================== 13:10:04.830920 | 65e8172f-9065-4118-8bac-c82bd777b759 ==============================
[0m13:10:04.830920 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:10:04.831551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:10:05.026741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732cc23d0>]}
[0m13:10:05.037584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732dde1c0>]}
[0m13:10:05.038144 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m13:10:05.061323 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:10:05.098927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:05.099556 [debug] [MainThread]: Partial parsing: updated file: bde://models/warehouse/fact_listing.sql
[0m13:10:05.135840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720b90f70>]}
[0m13:10:05.151137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa700165cd0>]}
[0m13:10:05.151577 [info ] [MainThread]: Found 3 snapshots, 18 models, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m13:10:05.151871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720b81280>]}
[0m13:10:05.153593 [info ] [MainThread]: 
[0m13:10:05.154202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:05.155542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:10:05.161647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:10:05.163984 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:10:05.164651 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:10:05.166376 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:10:05.166752 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:10:05.168345 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:10:05.168650 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:10:05.168967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:05.169270 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:10:05.169611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:05.170938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:05.651392 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:10:05.651896 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:10:05.652233 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:10:05.653990 [debug] [ThreadPool]: On list_postgres: Close
[0m13:10:05.655129 [debug] [ThreadPool]: On list_postgres: Close
[0m13:10:05.656223 [debug] [ThreadPool]: On list_postgres: Close
[0m13:10:05.659656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m13:10:05.660347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_raw)
[0m13:10:05.665869 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m13:10:05.666429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m13:10:05.667072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_staging'
[0m13:10:05.668718 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m13:10:05.669106 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m13:10:05.670573 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m13:10:05.672054 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:10:05.672322 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m13:10:05.672585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:05.672862 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m13:10:05.673111 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m13:10:05.673352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:05.673689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:05.673927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:05.850226 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:05.851086 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m13:10:05.851748 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m13:10:05.857656 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:05.858329 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m13:10:05.859010 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m13:10:05.863450 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:05.864035 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m13:10:05.864640 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:10:05.867316 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:05.867873 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m13:10:05.868465 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:10:05.874781 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:10:05.877222 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m13:10:05.877836 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:10:05.879937 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m13:10:05.888075 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:10:05.888647 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:10:05.890835 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m13:10:05.892928 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m13:10:05.893523 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m13:10:05.897229 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m13:10:05.908015 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m13:10:05.908544 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m13:10:05.922136 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.922723 [debug] [MainThread]: On master: BEGIN
[0m13:10:05.923210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:06.101275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.102883 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:06.104319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:06.134764 [debug] [MainThread]: SQL status: SELECT 21 in 0.0 seconds
[0m13:10:06.148713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa700165520>]}
[0m13:10:06.149709 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:06.164395 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:06.165102 [debug] [MainThread]: On master: BEGIN
[0m13:10:06.200982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.202652 [debug] [MainThread]: On master: COMMIT
[0m13:10:06.203770 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:06.204682 [debug] [MainThread]: On master: COMMIT
[0m13:10:06.219820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.221608 [debug] [MainThread]: On master: Close
[0m13:10:06.224799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:06.225943 [info ] [MainThread]: 
[0m13:10:06.233047 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m13:10:06.233992 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m13:10:06.235014 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m13:10:06.236288 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m13:10:06.237288 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m13:10:06.238287 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m13:10:06.239191 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m13:10:06.240455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G01_stg)
[0m13:10:06.241261 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m13:10:06.242463 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.G02_stg)
[0m13:10:06.243551 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.host_stg)
[0m13:10:06.244263 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m13:10:06.245303 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.lga_stg)
[0m13:10:06.245961 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m13:10:06.246582 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m13:10:06.259723 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m13:10:06.260402 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m13:10:06.264327 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m13:10:06.268528 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m13:10:06.273460 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m13:10:06.274731 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 13:10:06.247069 => 13:10:06.274431
[0m13:10:06.275337 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 13:10:06.260798 => 13:10:06.275106
[0m13:10:06.275831 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 13:10:06.264902 => 13:10:06.275632
[0m13:10:06.276386 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 13:10:06.269050 => 13:10:06.276150
[0m13:10:06.276935 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m13:10:06.277393 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m13:10:06.277819 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m13:10:06.278199 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m13:10:06.319129 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m13:10:06.319635 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m13:10:06.322590 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m13:10:06.325513 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m13:10:06.326643 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m13:10:06.326945 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m13:10:06.327239 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m13:10:06.327524 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m13:10:06.327819 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m13:10:06.328072 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:06.328339 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m13:10:06.328598 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m13:10:06.328857 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m13:10:06.329231 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:06.329524 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:06.329800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:06.490373 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.491186 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m13:10:06.491738 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m13:10:06.509685 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.520766 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m13:10:06.521370 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.521896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.522367 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.522926 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m13:10:06.523437 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m13:10:06.523927 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m13:10:06.524400 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m13:10:06.525049 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m13:10:06.525676 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m13:10:06.526228 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m13:10:06.540577 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.585074 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.585475 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.585774 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.586963 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m13:10:06.589712 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m13:10:06.592043 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m13:10:06.594424 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m13:10:06.594734 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m13:10:06.595034 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m13:10:06.595315 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m13:10:06.595599 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg" rename to "host_stg__dbt_backup"
[0m13:10:06.608966 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.620491 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.620847 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.621130 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.623481 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m13:10:06.626823 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m13:10:06.629072 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m13:10:06.631232 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m13:10:06.631551 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m13:10:06.631848 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m13:10:06.632135 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m13:10:06.632418 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m13:10:06.632749 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m13:10:06.645389 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.646934 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m13:10:06.647306 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m13:10:06.647646 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m13:10:06.649887 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.650238 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.651756 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m13:10:06.653266 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m13:10:06.653637 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m13:10:06.653956 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.654298 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m13:10:06.654650 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m13:10:06.662969 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m13:10:06.663328 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m13:10:06.663683 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m13:10:06.663991 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.666174 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m13:10:06.666497 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m13:10:06.678260 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.680761 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m13:10:06.681133 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m13:10:06.683244 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.685592 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m13:10:06.685937 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m13:10:06.687808 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:06.689025 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 13:10:06.319903 => 13:10:06.688865
[0m13:10:06.689384 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m13:10:06.690175 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7100f7fd0>]}
[0m13:10:06.690563 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:06.692434 [info ] [Thread-3  ]: 3 of 18 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.45s]
[0m13:10:06.693619 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 13:10:06.322838 => 13:10:06.693467
[0m13:10:06.694127 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m13:10:06.694464 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m13:10:06.694834 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m13:10:06.695386 [info ] [Thread-3  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m13:10:06.695964 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.listings_stg)
[0m13:10:06.696545 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732dfef40>]}
[0m13:10:06.696870 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m13:10:06.699549 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m13:10:06.700025 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m13:10:06.700359 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:06.700945 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m13:10:06.702131 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 13:10:06.303131 => 13:10:06.701987
[0m13:10:06.702516 [debug] [Thread-4  ]: Began running node model.bde.property_stg
[0m13:10:06.702923 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 13:10:06.697160 => 13:10:06.702759
[0m13:10:06.703264 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m13:10:06.703638 [info ] [Thread-4  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m13:10:06.703990 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m13:10:06.704525 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.property_stg)
[0m13:10:06.704836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:06.705369 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7330cd850>]}
[0m13:10:06.708751 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m13:10:06.709087 [debug] [Thread-4  ]: Began compiling node model.bde.property_stg
[0m13:10:06.710110 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 13:10:06.278477 => 13:10:06.709976
[0m13:10:06.710567 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m13:10:06.712930 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.property_stg"
[0m13:10:06.713271 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m13:10:06.713770 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m13:10:06.714095 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:10:06.714617 [debug] [Thread-2  ]: Began running node model.bde.room_stg
[0m13:10:06.715315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c1f430>]}
[0m13:10:06.715722 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (compile): 13:10:06.710866 => 13:10:06.715562
[0m13:10:06.716119 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m13:10:06.716530 [info ] [Thread-2  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m13:10:06.716975 [debug] [Thread-4  ]: Began executing node model.bde.property_stg
[0m13:10:06.717451 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.48s]
[0m13:10:06.717867 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:06.718461 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.room_stg)
[0m13:10:06.721756 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.property_stg"
[0m13:10:06.722236 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m13:10:06.722646 [debug] [Thread-2  ]: Began compiling node model.bde.room_stg
[0m13:10:06.723146 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m13:10:06.725693 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.room_stg"
[0m13:10:06.726175 [info ] [Thread-1  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m13:10:06.726522 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m13:10:06.727068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.suburb_stg)
[0m13:10:06.727378 [debug] [Thread-4  ]: On model.bde.property_stg: BEGIN
[0m13:10:06.727677 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m13:10:06.727970 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:06.728339 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (compile): 13:10:06.723491 => 13:10:06.728193
[0m13:10:06.731781 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m13:10:06.732326 [debug] [Thread-2  ]: Began executing node model.bde.room_stg
[0m13:10:06.736154 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.room_stg"
[0m13:10:06.736927 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 13:10:06.728527 => 13:10:06.736761
[0m13:10:06.737237 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m13:10:06.737579 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m13:10:06.740610 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m13:10:06.740928 [debug] [Thread-2  ]: On model.bde.room_stg: BEGIN
[0m13:10:06.741266 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:06.741753 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:10:06.742055 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m13:10:06.742302 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:06.894533 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.895204 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m13:10:06.895703 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m13:10:06.899647 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.900085 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:10:06.900571 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m13:10:06.914306 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.919126 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m13:10:06.919680 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg" rename to "property_stg__dbt_backup"
[0m13:10:06.920419 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.920973 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:06.921509 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.922001 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:10:06.922461 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m13:10:06.926334 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:10:06.926851 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m13:10:06.927391 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m13:10:06.927881 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m13:10:06.934372 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.937652 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m13:10:06.938105 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m13:10:06.944130 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.947389 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:10:06.947872 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.948313 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:06.948735 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m13:10:06.952497 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m13:10:06.952899 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.957018 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:10:06.957508 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg" rename to "room_stg__dbt_backup"
[0m13:10:06.959363 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m13:10:06.959768 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m13:10:06.960192 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m13:10:06.960596 [debug] [Thread-4  ]: On model.bde.property_stg: COMMIT
[0m13:10:06.973235 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.974870 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:10:06.975274 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:10:06.975647 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m13:10:06.976229 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.976616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:06.979507 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m13:10:06.979892 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.982675 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:10:06.983061 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m13:10:06.985613 [debug] [Thread-4  ]: Using postgres connection "model.bde.property_stg"
[0m13:10:06.985992 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m13:10:06.986419 [debug] [Thread-4  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m13:10:06.991949 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:06.994345 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m13:10:06.994717 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m13:10:07.001490 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.003027 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m13:10:07.003383 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m13:10:07.003714 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m13:10:07.005912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.007491 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m13:10:07.007868 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.008212 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:10:07.009474 [debug] [Thread-4  ]: Timing info for model.bde.property_stg (execute): 13:10:06.718703 => 13:10:07.009294
[0m13:10:07.009838 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m13:10:07.010198 [debug] [Thread-4  ]: On model.bde.property_stg: Close
[0m13:10:07.011013 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c1d220>]}
[0m13:10:07.011565 [info ] [Thread-4  ]: 6 of 18 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:10:07.012125 [debug] [Thread-4  ]: Finished running node model.bde.property_stg
[0m13:10:07.012491 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.012880 [debug] [Thread-4  ]: Began running node model.bde.dim_host
[0m13:10:07.014181 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 13:10:06.705616 => 13:10:07.014015
[0m13:10:07.014673 [info ] [Thread-4  ]: 9 of 18 START sql view model warehouse.dim_host ................................ [RUN]
[0m13:10:07.015077 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m13:10:07.015630 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.dim_host)
[0m13:10:07.016007 [debug] [Thread-4  ]: Began compiling node model.bde.dim_host
[0m13:10:07.018675 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_host"
[0m13:10:07.019279 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732e14670>]}
[0m13:10:07.019885 [info ] [Thread-3  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:10:07.020410 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m13:10:07.020784 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m13:10:07.021141 [info ] [Thread-3  ]: 10 of 18 START sql view model warehouse.fact_census_G02 ........................ [RUN]
[0m13:10:07.021674 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_census_G02)
[0m13:10:07.021998 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m13:10:07.024288 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m13:10:07.024633 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.026952 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m13:10:07.027358 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m13:10:07.027713 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.028107 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 13:10:07.022221 => 13:10:07.027952
[0m13:10:07.028446 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (compile): 13:10:07.016258 => 13:10:07.028309
[0m13:10:07.031928 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m13:10:07.032469 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m13:10:07.032837 [debug] [Thread-4  ]: Began executing node model.bde.dim_host
[0m13:10:07.033156 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m13:10:07.036271 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m13:10:07.039170 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_host"
[0m13:10:07.039787 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m13:10:07.040087 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m13:10:07.040384 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m13:10:07.040669 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:07.040946 [debug] [Thread-4  ]: On model.bde.dim_host: BEGIN
[0m13:10:07.041331 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:07.045634 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.046814 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (execute): 13:10:06.732629 => 13:10:07.046663
[0m13:10:07.047134 [debug] [Thread-2  ]: On model.bde.room_stg: Close
[0m13:10:07.047844 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732e0a460>]}
[0m13:10:07.048358 [info ] [Thread-2  ]: 7 of 18 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m13:10:07.048908 [debug] [Thread-2  ]: Finished running node model.bde.room_stg
[0m13:10:07.049312 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m13:10:07.049838 [info ] [Thread-2  ]: 11 of 18 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m13:10:07.050417 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_census_G01)
[0m13:10:07.050728 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m13:10:07.053163 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m13:10:07.053766 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 13:10:07.050946 => 13:10:07.053613
[0m13:10:07.054060 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m13:10:07.057088 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m13:10:07.057449 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.058585 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 13:10:06.737792 => 13:10:07.058445
[0m13:10:07.058900 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m13:10:07.059318 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m13:10:07.059852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c912b0>]}
[0m13:10:07.060138 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m13:10:07.060590 [info ] [Thread-1  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m13:10:07.060922 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:07.061381 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m13:10:07.061820 [debug] [Thread-1  ]: Began running node model.bde.dim_property
[0m13:10:07.062281 [info ] [Thread-1  ]: 12 of 18 START sql view model warehouse.dim_property ........................... [RUN]
[0m13:10:07.062804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_property)
[0m13:10:07.063098 [debug] [Thread-1  ]: Began compiling node model.bde.dim_property
[0m13:10:07.065671 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_property"
[0m13:10:07.066408 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (compile): 13:10:07.063302 => 13:10:07.066250
[0m13:10:07.066708 [debug] [Thread-1  ]: Began executing node model.bde.dim_property
[0m13:10:07.069828 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_property"
[0m13:10:07.070330 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m13:10:07.070605 [debug] [Thread-1  ]: On model.bde.dim_property: BEGIN
[0m13:10:07.070863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:07.206163 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.206729 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.207264 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m13:10:07.207713 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m13:10:07.208173 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m13:10:07.208645 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m13:10:07.228132 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.228662 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.229198 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.229726 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.233712 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m13:10:07.234207 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m13:10:07.238549 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m13:10:07.239089 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m13:10:07.239564 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m13:10:07.240066 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m13:10:07.240533 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m13:10:07.240993 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m13:10:07.255793 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.256250 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.257982 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m13:10:07.258427 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.260380 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m13:10:07.260851 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m13:10:07.264100 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m13:10:07.264571 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.264978 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m13:10:07.265405 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m13:10:07.265842 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m13:10:07.268911 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m13:10:07.269325 [debug] [Thread-4  ]: On model.bde.dim_host: COMMIT
[0m13:10:07.269820 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m13:10:07.282810 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.284660 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m13:10:07.285122 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m13:10:07.285539 [debug] [Thread-1  ]: On model.bde.dim_property: COMMIT
[0m13:10:07.285939 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.288498 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m13:10:07.288923 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.289287 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.289637 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m13:10:07.292230 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_host"
[0m13:10:07.293864 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m13:10:07.294332 [debug] [Thread-4  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m13:10:07.294734 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m13:10:07.295167 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m13:10:07.302670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.305589 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_property"
[0m13:10:07.305979 [debug] [Thread-1  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m13:10:07.308047 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.309487 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 13:10:07.033397 => 13:10:07.309287
[0m13:10:07.309929 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m13:10:07.310858 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7100f7fd0>]}
[0m13:10:07.311462 [info ] [Thread-3  ]: 10 of 18 OK created sql view model warehouse.fact_census_G02 ................... [[32mCREATE VIEW[0m in 0.29s]
[0m13:10:07.312055 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m13:10:07.312431 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.312904 [debug] [Thread-3  ]: Began running node model.bde.dim_room
[0m13:10:07.313320 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.314762 [debug] [Thread-4  ]: Timing info for model.bde.dim_host (execute): 13:10:07.036530 => 13:10:07.314585
[0m13:10:07.315249 [info ] [Thread-3  ]: 13 of 18 START sql view model warehouse.dim_room ............................... [RUN]
[0m13:10:07.318130 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m13:10:07.318617 [debug] [Thread-4  ]: On model.bde.dim_host: Close
[0m13:10:07.319224 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.dim_room)
[0m13:10:07.319609 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m13:10:07.320034 [debug] [Thread-3  ]: Began compiling node model.bde.dim_room
[0m13:10:07.320619 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c83c70>]}
[0m13:10:07.323558 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_room"
[0m13:10:07.323962 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.324561 [info ] [Thread-4  ]: 9 of 18 OK created sql view model warehouse.dim_host ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:10:07.325993 [debug] [Thread-1  ]: Timing info for model.bde.dim_property (execute): 13:10:07.066910 => 13:10:07.325834
[0m13:10:07.326537 [debug] [Thread-4  ]: Finished running node model.bde.dim_host
[0m13:10:07.326916 [debug] [Thread-1  ]: On model.bde.dim_property: Close
[0m13:10:07.327293 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (compile): 13:10:07.320933 => 13:10:07.327147
[0m13:10:07.327691 [debug] [Thread-4  ]: Began running node model.bde.fact_lge
[0m13:10:07.328300 [debug] [Thread-3  ]: Began executing node model.bde.dim_room
[0m13:10:07.328958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c67730>]}
[0m13:10:07.329455 [info ] [Thread-4  ]: 14 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m13:10:07.334792 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_room"
[0m13:10:07.335455 [info ] [Thread-1  ]: 12 of 18 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:10:07.336628 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.fact_lge)
[0m13:10:07.337456 [debug] [Thread-1  ]: Finished running node model.bde.dim_property
[0m13:10:07.338148 [debug] [Thread-4  ]: Began compiling node model.bde.fact_lge
[0m13:10:07.338558 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m13:10:07.339133 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.339888 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m13:10:07.343790 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m13:10:07.344284 [debug] [Thread-3  ]: On model.bde.dim_room: BEGIN
[0m13:10:07.345731 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 13:10:07.054266 => 13:10:07.345564
[0m13:10:07.346215 [info ] [Thread-1  ]: 15 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m13:10:07.346905 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:07.347667 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m13:10:07.348583 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (compile): 13:10:07.340444 => 13:10:07.348047
[0m13:10:07.349426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.dim_property, now model.bde.fact_listing)
[0m13:10:07.350074 [debug] [Thread-4  ]: Began executing node model.bde.fact_lge
[0m13:10:07.350657 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c67b20>]}
[0m13:10:07.350974 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m13:10:07.354194 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m13:10:07.354787 [info ] [Thread-2  ]: 11 of 18 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.30s]
[0m13:10:07.361244 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m13:10:07.362434 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m13:10:07.363248 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m13:10:07.364316 [debug] [Thread-4  ]: On model.bde.fact_lge: BEGIN
[0m13:10:07.365865 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:07.366678 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 13:10:07.355031 => 13:10:07.366413
[0m13:10:07.384516 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m13:10:07.388850 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m13:10:07.389592 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m13:10:07.389934 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m13:10:07.390235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:07.512453 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.513028 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m13:10:07.513446 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m13:10:07.515679 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.516130 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m13:10:07.516553 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m13:10:07.532896 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.537184 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m13:10:07.537723 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m13:10:07.538580 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.541674 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m13:10:07.542108 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m13:10:07.549046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.549437 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m13:10:07.549963 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as(
SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    c.lga_name as host_neighbourhood_lga_name,        
	    listing_neighbourhood,
		b.lga_name as listing_neighbourhood_lga_name,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM  "postgres"."staging"."listings_stg" a
left join "postgres"."staging"."suburb_stg" b 
ON a.listing_neighbourhood = b.suburb_name
left join "postgres"."staging"."suburb_stg" c
ON a.host_neighbourhood = c.suburb_name
),
lga_name AS(
select 
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    CASE
	        WHEN host_neighbourhood_lga_name is Null THEN host_neighbourhood_lga_name
	        ELSE host_neighbourhood_lga_name end as host_neighbourhood_lga_name,   
	    listing_neighbourhood,    
	    CASE
	        WHEN listing_neighbourhood_lga_name is Null THEN listing_neighbourhood
	        ELSE listing_neighbourhood_lga_name end as listing_neighbourhood_lga_name, 
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga
)
select
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
		host_neighbourhood_lga_name,
	    s.lga_code as host_neighbourhood_lga_code,
	    listing_neighbourhood,    
		listing_neighbourhood_lga_name,    
		ls.lga_code as listing_neighbourhood_lga_code,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga_name l
left join staging.lga_stg s
on l.host_neighbourhood_lga_name = s.lga_name 
left join staging.lga_stg ls
on l.listing_neighbourhood_lga_name = ls.lga_name
  );
[0m13:10:07.557374 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.559106 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m13:10:07.559543 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m13:10:07.559949 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m13:10:07.560395 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.562220 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m13:10:07.562625 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m13:10:07.562994 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m13:10:07.571740 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.575188 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m13:10:07.575649 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m13:10:07.577990 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.581535 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m13:10:07.581961 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m13:10:07.582370 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.584974 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m13:10:07.585385 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m13:10:07.591522 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.592990 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m13:10:07.593389 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m13:10:07.593757 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m13:10:07.602314 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.602705 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.604043 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (execute): 13:10:07.351203 => 13:10:07.603853
[0m13:10:07.605367 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (execute): 13:10:07.329779 => 13:10:07.605183
[0m13:10:07.605775 [debug] [Thread-4  ]: On model.bde.fact_lge: Close
[0m13:10:07.606164 [debug] [Thread-3  ]: On model.bde.dim_room: Close
[0m13:10:07.607054 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720d03250>]}
[0m13:10:07.607780 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7001fc3d0>]}
[0m13:10:07.608391 [info ] [Thread-4  ]: 14 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:10:07.608973 [info ] [Thread-3  ]: 13 of 18 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m13:10:07.609573 [debug] [Thread-4  ]: Finished running node model.bde.fact_lge
[0m13:10:07.610091 [debug] [Thread-3  ]: Finished running node model.bde.dim_room
[0m13:10:07.611369 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.613859 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m13:10:07.614241 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m13:10:07.630156 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.631741 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 13:10:07.385298 => 13:10:07.631553
[0m13:10:07.632148 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m13:10:07.633049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720c5a490>]}
[0m13:10:07.633711 [info ] [Thread-1  ]: 15 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m13:10:07.634335 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m13:10:07.635135 [debug] [Thread-2  ]: Began running node model.bde.dm_host_neighbourhood
[0m13:10:07.635543 [debug] [Thread-4  ]: Began running node model.bde.dm_listing_neighbourhood
[0m13:10:07.636018 [info ] [Thread-2  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m13:10:07.636441 [debug] [Thread-3  ]: Began running node model.bde.dm_property_type
[0m13:10:07.636852 [info ] [Thread-4  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m13:10:07.637508 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dm_host_neighbourhood)
[0m13:10:07.637942 [info ] [Thread-3  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m13:10:07.638526 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.fact_lge, now model.bde.dm_listing_neighbourhood)
[0m13:10:07.638900 [debug] [Thread-2  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m13:10:07.639438 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.dim_room, now model.bde.dm_property_type)
[0m13:10:07.639792 [debug] [Thread-4  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m13:10:07.642452 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m13:10:07.642820 [debug] [Thread-3  ]: Began compiling node model.bde.dm_property_type
[0m13:10:07.645364 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m13:10:07.648170 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m13:10:07.648874 [debug] [Thread-2  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 13:10:07.640048 => 13:10:07.648687
[0m13:10:07.649497 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 13:10:07.643066 => 13:10:07.649296
[0m13:10:07.649829 [debug] [Thread-2  ]: Began executing node model.bde.dm_host_neighbourhood
[0m13:10:07.650251 [debug] [Thread-3  ]: Timing info for model.bde.dm_property_type (compile): 13:10:07.645713 => 13:10:07.650094
[0m13:10:07.650544 [debug] [Thread-4  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m13:10:07.653901 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m13:10:07.654258 [debug] [Thread-3  ]: Began executing node model.bde.dm_property_type
[0m13:10:07.657389 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m13:10:07.661095 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m13:10:07.661552 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m13:10:07.661938 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m13:10:07.662228 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:07.662644 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m13:10:07.662957 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m13:10:07.663235 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m13:10:07.663519 [debug] [Thread-3  ]: On model.bde.dm_property_type: BEGIN
[0m13:10:07.663796 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:07.664099 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:07.835708 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.836575 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.837272 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:07.838033 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m13:10:07.838709 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m13:10:07.839354 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m13:10:07.840366 [debug] [Thread-3  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  property_type,
  room_type,
  accommodates,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  ROUND(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN has_availability = 't' THEN price END) AS min_price,
  MAX(CASE WHEN has_availability = 't' THEN price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN has_availability = 't' THEN price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN price END), 2) AS avg_price,
  COUNT(DISTINCT host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
   CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,	
  (SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) ELSE 0 END)) AS total_stay,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) AS avg_estimated_revenue
FROM "postgres"."warehouse"."fact_listing"
GROUP BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m13:10:07.841569 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  listing_neighbourhood,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  min(case when has_availability = 't' then price end) as minimum_price,
  max(case when has_availability = 't' then price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
  round(avg(case when has_availability = 't' then price end),2) as average_price,
  count(distinct host_id) as distinct_host,
  round((sum(case when host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,
  sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
  round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from
    "postgres"."warehouse"."fact_listing"
group by 
  listing_neighbourhood,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
order by 
  listing_neighbourhood, 
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m13:10:07.842586 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    SELECT 
    host_neighbourhood_lga_name,
	CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
    count(DISTINCT host_id) as number_of_distinct_host,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) as estimate_revenue_per_active,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END) / COUNT(DISTINCT host_id), 2) as estimate_revenue_per_host
FROM 
    "postgres"."warehouse"."fact_listing"
GROUP BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m13:10:07.873884 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.874820 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.875699 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:10:07.881965 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m13:10:07.887175 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m13:10:07.891825 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m13:10:07.892481 [debug] [Thread-3  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m13:10:07.893106 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m13:10:07.893738 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m13:10:07.908290 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.908977 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.909598 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:07.912213 [debug] [Thread-3  ]: On model.bde.dm_property_type: COMMIT
[0m13:10:07.914469 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m13:10:07.916729 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m13:10:07.917344 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m13:10:07.917919 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m13:10:07.918469 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m13:10:07.919025 [debug] [Thread-3  ]: On model.bde.dm_property_type: COMMIT
[0m13:10:07.919566 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m13:10:07.920106 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m13:10:07.935839 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.936418 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.937001 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:07.941133 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m13:10:07.945010 [debug] [Thread-4  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m13:10:07.948294 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m13:10:07.948827 [debug] [Thread-3  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m13:10:07.949347 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m13:10:07.949850 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m13:10:07.966452 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.967015 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.967544 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m13:10:07.969696 [debug] [Thread-3  ]: Timing info for model.bde.dm_property_type (execute): 13:10:07.657720 => 13:10:07.969379
[0m13:10:07.971479 [debug] [Thread-4  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 13:10:07.654500 => 13:10:07.971249
[0m13:10:07.973127 [debug] [Thread-2  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 13:10:07.650786 => 13:10:07.972896
[0m13:10:07.973654 [debug] [Thread-3  ]: On model.bde.dm_property_type: Close
[0m13:10:07.974149 [debug] [Thread-4  ]: On model.bde.dm_listing_neighbourhood: Close
[0m13:10:07.974645 [debug] [Thread-2  ]: On model.bde.dm_host_neighbourhood: Close
[0m13:10:07.975905 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7002000a0>]}
[0m13:10:07.976778 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7001e5ca0>]}
[0m13:10:07.977644 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e8172f-9065-4118-8bac-c82bd777b759', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa720e039d0>]}
[0m13:10:07.978456 [info ] [Thread-2  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.34s]
[0m13:10:07.979005 [info ] [Thread-3  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.34s]
[0m13:10:07.979880 [info ] [Thread-4  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.34s]
[0m13:10:07.980542 [debug] [Thread-2  ]: Finished running node model.bde.dm_host_neighbourhood
[0m13:10:07.981172 [debug] [Thread-3  ]: Finished running node model.bde.dm_property_type
[0m13:10:07.981806 [debug] [Thread-4  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m13:10:07.983659 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:07.984078 [debug] [MainThread]: On master: BEGIN
[0m13:10:07.984437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:08.147953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:08.148554 [debug] [MainThread]: On master: COMMIT
[0m13:10:08.148951 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:08.149332 [debug] [MainThread]: On master: COMMIT
[0m13:10:08.166721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:08.167164 [debug] [MainThread]: On master: Close
[0m13:10:08.168208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:08.168623 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m13:10:08.169012 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m13:10:08.169398 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m13:10:08.169777 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m13:10:08.170320 [info ] [MainThread]: 
[0m13:10:08.170804 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m13:10:08.174327 [debug] [MainThread]: Command end result
[0m13:10:08.186157 [info ] [MainThread]: 
[0m13:10:08.186648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:08.187020 [info ] [MainThread]: 
[0m13:10:08.187380 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m13:10:08.188024 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:08.187924 after 3.41 seconds
[0m13:10:08.188442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa730b716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732e9dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa732d5f760>]}
[0m13:10:08.188864 [debug] [MainThread]: Flushing usage events
[0m18:50:53.974027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c08cb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0aac0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0aac0940>]}


============================== 18:50:53.978641 | 05a71168-933a-40d5-a636-af9f27cea0af ==============================
[0m18:50:53.978641 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:50:53.979347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:54.182713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0aac0880>]}
[0m18:50:54.193422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0abf92b0>]}
[0m18:50:54.193975 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:50:54.211091 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:50:54.223981 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:50:54.224533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ab85940>]}
[0m18:50:54.875617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf8ffbbb0>]}
[0m18:50:54.890679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0abfd430>]}
[0m18:50:54.891128 [info ] [MainThread]: Found 18 models, 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:50:54.891417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0abf4880>]}
[0m18:50:54.893017 [info ] [MainThread]: 
[0m18:50:54.893611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:54.894895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:50:54.901805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:50:54.903003 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:50:54.903586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:50:54.905457 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:50:54.905735 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:50:54.907086 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:50:54.907359 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:50:54.907614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:54.907869 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:50:54.908105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:54.909416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:55.377273 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:50:55.378918 [debug] [ThreadPool]: On list_postgres: Close
[0m18:50:55.381294 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:50:55.381680 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:50:55.382836 [debug] [ThreadPool]: On list_postgres: Close
[0m18:50:55.383912 [debug] [ThreadPool]: On list_postgres: Close
[0m18:50:55.385445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_datamart)
[0m18:50:55.386073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_warehouse)
[0m18:50:55.386742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_staging)
[0m18:50:55.387851 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "datamart"
"
[0m18:50:55.388562 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "warehouse"
"
[0m18:50:55.389219 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "staging"
"
[0m18:50:55.395317 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m18:50:55.397614 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m18:50:55.399912 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m18:50:55.400327 [debug] [ThreadPool]: On create_postgres_datamart: BEGIN
[0m18:50:55.400707 [debug] [ThreadPool]: On create_postgres_warehouse: BEGIN
[0m18:50:55.401069 [debug] [ThreadPool]: On create_postgres_staging: BEGIN
[0m18:50:55.401426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:55.401774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:55.402116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:55.593094 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.594066 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.594923 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.595610 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m18:50:55.596338 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m18:50:55.597035 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m18:50:55.597789 [debug] [ThreadPool]: On create_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_staging"} */
create schema if not exists "staging"
[0m18:50:55.598561 [debug] [ThreadPool]: On create_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_warehouse"} */
create schema if not exists "warehouse"
[0m18:50:55.599275 [debug] [ThreadPool]: On create_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "create_postgres_datamart"} */
create schema if not exists "datamart"
[0m18:50:55.619712 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:50:55.620384 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:50:55.621130 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:50:55.623172 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m18:50:55.625012 [debug] [ThreadPool]: On create_postgres_datamart: COMMIT
[0m18:50:55.626727 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m18:50:55.627454 [debug] [ThreadPool]: Using postgres connection "create_postgres_warehouse"
[0m18:50:55.628171 [debug] [ThreadPool]: Using postgres connection "create_postgres_datamart"
[0m18:50:55.628848 [debug] [ThreadPool]: Using postgres connection "create_postgres_staging"
[0m18:50:55.629554 [debug] [ThreadPool]: On create_postgres_warehouse: COMMIT
[0m18:50:55.630237 [debug] [ThreadPool]: On create_postgres_datamart: COMMIT
[0m18:50:55.630952 [debug] [ThreadPool]: On create_postgres_staging: COMMIT
[0m18:50:55.646473 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:50:55.647142 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:50:55.647828 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:50:55.648524 [debug] [ThreadPool]: On create_postgres_datamart: Close
[0m18:50:55.649253 [debug] [ThreadPool]: On create_postgres_staging: Close
[0m18:50:55.649919 [debug] [ThreadPool]: On create_postgres_warehouse: Close
[0m18:50:55.657567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_staging, now list_postgres_datamart)
[0m18:50:55.665079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_warehouse, now list_postgres_warehouse)
[0m18:50:55.669743 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:50:55.672983 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:50:55.673961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_datamart, now list_postgres_staging)
[0m18:50:55.674675 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m18:50:55.675621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m18:50:55.676218 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m18:50:55.678780 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:50:55.679267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:55.683284 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:50:55.683733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:55.684154 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:50:55.684768 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:50:55.685357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:55.685779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:55.857202 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.858187 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:50:55.858937 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.859603 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m18:50:55.860298 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:50:55.861075 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:50:55.862002 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.862593 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:50:55.863245 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:50:55.866066 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:55.866617 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:50:55.867227 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:50:55.887513 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:50:55.888206 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:50:55.890761 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m18:50:55.891458 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:50:55.892098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:50:55.894347 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:50:55.896931 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:50:55.898748 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m18:50:55.909817 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m18:50:55.913885 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m18:50:55.914641 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:50:55.915319 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:50:55.928555 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:55.929148 [debug] [MainThread]: On master: BEGIN
[0m18:50:55.929632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:56.110395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.111166 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:56.111981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:56.139388 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:50:56.141781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0acafd90>]}
[0m18:50:56.142787 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:56.158417 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:56.159298 [debug] [MainThread]: On master: BEGIN
[0m18:50:56.195507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.197753 [debug] [MainThread]: On master: COMMIT
[0m18:50:56.199513 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:56.200649 [debug] [MainThread]: On master: COMMIT
[0m18:50:56.215676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:56.217843 [debug] [MainThread]: On master: Close
[0m18:50:56.221944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:56.223231 [info ] [MainThread]: 
[0m18:50:56.232031 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m18:50:56.233650 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m18:50:56.234687 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m18:50:56.236558 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m18:50:56.235805 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m18:50:56.237822 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m18:50:56.238860 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m18:50:56.239871 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m18:50:56.241375 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.G01_stg)
[0m18:50:56.242786 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G02_stg)
[0m18:50:56.243898 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.host_stg)
[0m18:50:56.244993 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.lga_stg)
[0m18:50:56.245737 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m18:50:56.246399 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m18:50:56.247052 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m18:50:56.247672 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m18:50:56.261298 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m18:50:56.265298 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m18:50:56.269052 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m18:50:56.273229 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m18:50:56.275116 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 18:50:56.265739 => 18:50:56.274675
[0m18:50:56.276120 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m18:50:56.283296 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 18:50:56.261748 => 18:50:56.282941
[0m18:50:56.283891 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 18:50:56.269594 => 18:50:56.283639
[0m18:50:56.302052 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 18:50:56.248179 => 18:50:56.301753
[0m18:50:56.313035 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m18:50:56.313385 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m18:50:56.313749 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m18:50:56.314086 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m18:50:56.318406 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m18:50:56.321507 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m18:50:56.321860 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:50:56.324745 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m18:50:56.325199 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m18:50:56.325634 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:50:56.325914 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:50:56.326227 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:50:56.326535 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m18:50:56.326829 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:50:56.327214 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m18:50:56.327508 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:50:56.327816 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m18:50:56.328090 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:50:56.328445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:56.494001 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.494853 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.495573 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.496147 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:50:56.496764 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:50:56.497318 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:50:56.497869 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.498563 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m18:50:56.499298 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m18:50:56.500069 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m18:50:56.500716 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:50:56.501537 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m18:50:56.520952 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "raw.host_snapshot" does not exist
LINE 13:     select * from "postgres"."raw"."host_snapshot"
                           ^

[0m18:50:56.521599 [debug] [Thread-3  ]: On model.bde.host_stg: ROLLBACK
[0m18:50:56.530061 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:56.530641 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:56.537107 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:56.541544 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:50:56.542477 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 18:50:56.276658 => 18:50:56.542213
[0m18:50:56.546247 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:50:56.550056 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:50:56.550536 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m18:50:56.551007 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m18:50:56.551460 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m18:50:56.551911 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m18:50:56.557317 [debug] [Thread-3  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  relation "raw.host_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."host_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m18:50:56.557951 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf8fd52b0>]}
[0m18:50:56.559023 [error] [Thread-3  ]: 3 of 18 ERROR creating sql view model staging.host_stg ......................... [[31mERROR[0m in 0.31s]
[0m18:50:56.559786 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m18:50:56.560263 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m18:50:56.560896 [info ] [Thread-3  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m18:50:56.561590 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.listings_stg)
[0m18:50:56.562001 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m18:50:56.565330 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m18:50:56.566036 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:56.572580 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:56.572979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:56.586147 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 18:50:56.562275 => 18:50:56.585861
[0m18:50:56.589250 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m18:50:56.589744 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m18:50:56.591087 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m18:50:56.591442 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m18:50:56.591774 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:50:56.592086 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:50:56.592378 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:50:56.596701 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m18:50:56.597156 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m18:50:56.597443 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m18:50:56.597719 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m18:50:56.598372 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:50:56.598655 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m18:50:56.598923 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:50:56.613236 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:56.613589 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:56.613945 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:56.621650 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:50:56.623805 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:50:56.625867 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:50:56.626200 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m18:50:56.626520 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m18:50:56.626827 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m18:50:56.640632 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:56.640991 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:56.642377 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 18:50:56.322103 => 18:50:56.642198
[0m18:50:56.642731 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:56.643934 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 18:50:56.314403 => 18:50:56.643784
[0m18:50:56.644275 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m18:50:56.645414 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 18:50:56.318814 => 18:50:56.645268
[0m18:50:56.645747 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m18:50:56.646125 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m18:50:56.646755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ad62940>]}
[0m18:50:56.647352 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.41s]
[0m18:50:56.648023 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0acb6a90>]}
[0m18:50:56.648565 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m18:50:56.649105 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf923edc0>]}
[0m18:50:56.649599 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.41s]
[0m18:50:56.649977 [debug] [Thread-1  ]: Began running node model.bde.property_stg
[0m18:50:56.650474 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.40s]
[0m18:50:56.651025 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m18:50:56.651393 [info ] [Thread-1  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m18:50:56.651846 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m18:50:56.652180 [debug] [Thread-2  ]: Began running node model.bde.room_stg
[0m18:50:56.652713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.property_stg)
[0m18:50:56.653131 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m18:50:56.653525 [info ] [Thread-2  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m18:50:56.653895 [debug] [Thread-1  ]: Began compiling node model.bde.property_stg
[0m18:50:56.654286 [info ] [Thread-4  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m18:50:56.654824 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.room_stg)
[0m18:50:56.657488 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.property_stg"
[0m18:50:56.658020 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.suburb_stg)
[0m18:50:56.658338 [debug] [Thread-2  ]: Began compiling node model.bde.room_stg
[0m18:50:56.658724 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m18:50:56.661134 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.room_stg"
[0m18:50:56.663648 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m18:50:56.664491 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (compile): 18:50:56.655059 => 18:50:56.664220
[0m18:50:56.664937 [debug] [Thread-1  ]: Began executing node model.bde.property_stg
[0m18:50:56.668388 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.property_stg"
[0m18:50:56.669025 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (compile): 18:50:56.658979 => 18:50:56.668870
[0m18:50:56.669392 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 18:50:56.661454 => 18:50:56.669218
[0m18:50:56.669736 [debug] [Thread-2  ]: Began executing node model.bde.room_stg
[0m18:50:56.670031 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m18:50:56.670338 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m18:50:56.674272 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.room_stg"
[0m18:50:56.674583 [debug] [Thread-1  ]: On model.bde.property_stg: BEGIN
[0m18:50:56.677364 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m18:50:56.677745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:56.678230 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:50:56.678534 [debug] [Thread-2  ]: On model.bde.room_stg: BEGIN
[0m18:50:56.678828 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:50:56.679086 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:50:56.679352 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m18:50:56.679693 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:50:56.776197 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.776848 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:50:56.777386 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m18:50:56.800613 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:56.804474 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:50:56.804975 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m18:50:56.820401 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:56.822201 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m18:50:56.822658 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:50:56.823077 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m18:50:56.840815 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:56.843944 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:50:56.844414 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m18:50:56.858394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.858875 [debug] [Thread-1  ]: Using postgres connection "model.bde.property_stg"
[0m18:50:56.859402 [debug] [Thread-1  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m18:50:56.861492 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.861985 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:50:56.862499 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:56.863042 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:56.863586 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m18:50:56.865430 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 18:50:56.592609 => 18:50:56.865181
[0m18:50:56.865964 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:50:56.866565 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m18:50:56.867121 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m18:50:56.868185 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf9015700>]}
[0m18:50:56.868905 [info ] [Thread-3  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m18:50:56.869593 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m18:50:56.870095 [debug] [Thread-3  ]: Began running node model.bde.dim_host
[0m18:50:56.870641 [info ] [Thread-3  ]: 9 of 18 SKIP relation warehouse.dim_host ....................................... [[33mSKIP[0m]
[0m18:50:56.871164 [debug] [Thread-3  ]: Finished running node model.bde.dim_host
[0m18:50:56.871641 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G01
[0m18:50:56.872193 [info ] [Thread-3  ]: 10 of 18 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m18:50:56.872937 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_census_G01)
[0m18:50:56.873375 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G01
[0m18:50:56.876564 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m18:50:56.877034 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.property_snapshot" does not exist
LINE 13:     select * from "postgres"."raw"."property_snapshot"
                           ^

[0m18:50:56.877580 [debug] [Thread-1  ]: On model.bde.property_stg: ROLLBACK
[0m18:50:56.878266 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G01 (compile): 18:50:56.873682 => 18:50:56.878058
[0m18:50:56.878683 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G01
[0m18:50:56.882988 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m18:50:56.883501 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "raw.room_snapshot" does not exist
LINE 13:     select * from "postgres"."raw"."room_snapshot"
                           ^

[0m18:50:56.884100 [debug] [Thread-2  ]: On model.bde.room_stg: ROLLBACK
[0m18:50:56.884716 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:50:56.885100 [debug] [Thread-3  ]: On model.bde.fact_census_G01: BEGIN
[0m18:50:56.885445 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:50:56.888502 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:56.891347 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:50:56.891731 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m18:50:56.892464 [debug] [Thread-1  ]: Timing info for model.bde.property_stg (execute): 18:50:56.665227 => 18:50:56.892281
[0m18:50:56.892818 [debug] [Thread-1  ]: On model.bde.property_stg: Close
[0m18:50:56.894096 [debug] [Thread-1  ]: Database Error in model property_stg (models/staging/property_stg.sql)
  relation "raw.property_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."property_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/property_stg.sql
[0m18:50:56.894525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be81a3d00>]}
[0m18:50:56.895059 [error] [Thread-1  ]: 6 of 18 ERROR creating sql view model staging.property_stg ..................... [[31mERROR[0m in 0.24s]
[0m18:50:56.895619 [debug] [Thread-1  ]: Finished running node model.bde.property_stg
[0m18:50:56.896021 [debug] [Thread-1  ]: Began running node model.bde.fact_census_G02
[0m18:50:56.896429 [info ] [Thread-1  ]: 11 of 18 START sql view model warehouse.fact_census_G02 ........................ [RUN]
[0m18:50:56.897149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_census_G02)
[0m18:50:56.897528 [debug] [Thread-1  ]: Began compiling node model.bde.fact_census_G02
[0m18:50:56.900466 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m18:50:56.901258 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G02 (compile): 18:50:56.897779 => 18:50:56.901080
[0m18:50:56.901766 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (execute): 18:50:56.670567 => 18:50:56.901588
[0m18:50:56.902152 [debug] [Thread-1  ]: Began executing node model.bde.fact_census_G02
[0m18:50:56.902755 [debug] [Thread-2  ]: On model.bde.room_stg: Close
[0m18:50:56.907222 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m18:50:56.907739 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:56.909401 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m18:50:56.909740 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:50:56.910049 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:50:56.910358 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m18:50:56.910713 [debug] [Thread-1  ]: On model.bde.fact_census_G02: BEGIN
[0m18:50:56.911335 [debug] [Thread-2  ]: Database Error in model room_stg (models/staging/room_stg.sql)
  relation "raw.room_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."room_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/room_stg.sql
[0m18:50:56.911703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:56.912064 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be81926a0>]}
[0m18:50:56.912660 [error] [Thread-2  ]: 7 of 18 ERROR creating sql view model staging.room_stg ......................... [[31mERROR[0m in 0.26s]
[0m18:50:56.913166 [debug] [Thread-2  ]: Finished running node model.bde.room_stg
[0m18:50:56.913520 [debug] [Thread-2  ]: Began running node model.bde.dim_property
[0m18:50:56.913984 [info ] [Thread-2  ]: 12 of 18 SKIP relation warehouse.dim_property .................................. [[33mSKIP[0m]
[0m18:50:56.914346 [debug] [Thread-2  ]: Finished running node model.bde.dim_property
[0m18:50:56.914661 [debug] [Thread-2  ]: Began running node model.bde.dim_room
[0m18:50:56.914983 [info ] [Thread-2  ]: 13 of 18 SKIP relation warehouse.dim_room ...................................... [[33mSKIP[0m]
[0m18:50:56.915296 [debug] [Thread-2  ]: Finished running node model.bde.dim_room
[0m18:50:56.926573 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:56.929272 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:50:56.929634 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m18:50:56.947501 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:56.949194 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 18:50:56.674800 => 18:50:56.948999
[0m18:50:56.949622 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m18:50:56.950433 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf9151880>]}
[0m18:50:56.950951 [info ] [Thread-4  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:50:56.951457 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m18:50:56.952018 [debug] [Thread-2  ]: Began running node model.bde.fact_lge
[0m18:50:56.952412 [debug] [Thread-4  ]: Began running node model.bde.fact_listing
[0m18:50:56.952772 [info ] [Thread-2  ]: 14 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m18:50:56.953173 [info ] [Thread-4  ]: 15 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m18:50:56.953726 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_lge)
[0m18:50:56.954229 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.fact_listing)
[0m18:50:56.954551 [debug] [Thread-2  ]: Began compiling node model.bde.fact_lge
[0m18:50:56.954857 [debug] [Thread-4  ]: Began compiling node model.bde.fact_listing
[0m18:50:56.957829 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m18:50:56.960886 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m18:50:56.961631 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (compile): 18:50:56.958132 => 18:50:56.961440
[0m18:50:56.961973 [debug] [Thread-4  ]: Began executing node model.bde.fact_listing
[0m18:50:56.965533 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m18:50:56.966384 [debug] [Thread-2  ]: Timing info for model.bde.fact_lge (compile): 18:50:56.955092 => 18:50:56.966180
[0m18:50:56.966753 [debug] [Thread-2  ]: Began executing node model.bde.fact_lge
[0m18:50:56.967090 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:50:56.970272 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m18:50:56.970618 [debug] [Thread-4  ]: On model.bde.fact_listing: BEGIN
[0m18:50:56.970963 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:50:56.971444 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:50:56.971737 [debug] [Thread-2  ]: On model.bde.fact_lge: BEGIN
[0m18:50:56.972003 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:50:57.054058 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.054707 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:50:57.055120 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m18:50:57.071602 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.072035 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:50:57.072466 [debug] [Thread-1  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m18:50:57.085352 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.088642 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:50:57.089074 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m18:50:57.093085 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.095779 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:50:57.096163 [debug] [Thread-1  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m18:50:57.104687 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.107158 [debug] [Thread-3  ]: On model.bde.fact_census_G01: COMMIT
[0m18:50:57.107543 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:50:57.107890 [debug] [Thread-3  ]: On model.bde.fact_census_G01: COMMIT
[0m18:50:57.116663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.118223 [debug] [Thread-1  ]: On model.bde.fact_census_G02: COMMIT
[0m18:50:57.118603 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:50:57.118933 [debug] [Thread-1  ]: On model.bde.fact_census_G02: COMMIT
[0m18:50:57.125986 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.159181 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.159563 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.159855 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.161081 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:50:57.162979 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:50:57.163276 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:50:57.163544 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:50:57.163817 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m18:50:57.164096 [debug] [Thread-1  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m18:50:57.164375 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m18:50:57.164763 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as(
SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    c.lga_name as host_neighbourhood_lga_name,        
	    listing_neighbourhood,
		b.lga_name as listing_neighbourhood_lga_name,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM  "postgres"."staging"."listings_stg" a
left join "postgres"."staging"."suburb_stg" b 
ON a.listing_neighbourhood = b.suburb_name
left join "postgres"."staging"."suburb_stg" c
ON a.host_neighbourhood = c.suburb_name
),
lga_name AS(
select 
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    CASE
	        WHEN host_neighbourhood_lga_name is Null THEN host_neighbourhood_lga_name
	        ELSE host_neighbourhood_lga_name end as host_neighbourhood_lga_name,   
	    listing_neighbourhood,    
	    CASE
	        WHEN listing_neighbourhood_lga_name is Null THEN listing_neighbourhood
	        ELSE listing_neighbourhood_lga_name end as listing_neighbourhood_lga_name, 
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga
)
select
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
		host_neighbourhood_lga_name,
	    s.lga_code as host_neighbourhood_lga_code,
	    listing_neighbourhood,    
		listing_neighbourhood_lga_name,    
		ls.lga_code as listing_neighbourhood_lga_code,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga_name l
left join staging.lga_stg s
on l.host_neighbourhood_lga_name = s.lga_name 
left join staging.lga_stg ls
on l.listing_neighbourhood_lga_name = ls.lga_name
  );
[0m18:50:57.181953 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.183260 [debug] [Thread-1  ]: Timing info for model.bde.fact_census_G02 (execute): 18:50:56.903083 => 18:50:57.183088
[0m18:50:57.183644 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.183988 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.184339 [debug] [Thread-1  ]: On model.bde.fact_census_G02: Close
[0m18:50:57.185585 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G01 (execute): 18:50:56.878966 => 18:50:57.185410
[0m18:50:57.185921 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.188327 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:50:57.188744 [debug] [Thread-3  ]: On model.bde.fact_census_G01: Close
[0m18:50:57.189366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf9260490>]}
[0m18:50:57.191848 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:50:57.192203 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m18:50:57.192760 [info ] [Thread-1  ]: 11 of 18 OK created sql view model warehouse.fact_census_G02 ................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:50:57.193362 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ad86730>]}
[0m18:50:57.193720 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m18:50:57.194233 [debug] [Thread-1  ]: Finished running node model.bde.fact_census_G02
[0m18:50:57.194704 [info ] [Thread-3  ]: 10 of 18 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.32s]
[0m18:50:57.195295 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G01
[0m18:50:57.212226 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.212621 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.214194 [debug] [Thread-4  ]: On model.bde.fact_listing: COMMIT
[0m18:50:57.215506 [debug] [Thread-2  ]: On model.bde.fact_lge: COMMIT
[0m18:50:57.215902 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:50:57.216258 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:50:57.216593 [debug] [Thread-4  ]: On model.bde.fact_listing: COMMIT
[0m18:50:57.216910 [debug] [Thread-2  ]: On model.bde.fact_lge: COMMIT
[0m18:50:57.231771 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.232245 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.234985 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:50:57.237198 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:50:57.237547 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m18:50:57.237886 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m18:50:57.253231 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.253657 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.255133 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (execute): 18:50:56.962209 => 18:50:57.254954
[0m18:50:57.256370 [debug] [Thread-2  ]: Timing info for model.bde.fact_lge (execute): 18:50:56.967348 => 18:50:57.256209
[0m18:50:57.256764 [debug] [Thread-4  ]: On model.bde.fact_listing: Close
[0m18:50:57.257113 [debug] [Thread-2  ]: On model.bde.fact_lge: Close
[0m18:50:57.258031 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf9142ac0>]}
[0m18:50:57.258662 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf9248e80>]}
[0m18:50:57.259177 [info ] [Thread-4  ]: 15 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.30s]
[0m18:50:57.259590 [info ] [Thread-2  ]: 14 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m18:50:57.260210 [debug] [Thread-4  ]: Finished running node model.bde.fact_listing
[0m18:50:57.260679 [debug] [Thread-2  ]: Finished running node model.bde.fact_lge
[0m18:50:57.261247 [debug] [Thread-1  ]: Began running node model.bde.dm_host_neighbourhood
[0m18:50:57.261590 [debug] [Thread-2  ]: Began running node model.bde.dm_listing_neighbourhood
[0m18:50:57.261899 [debug] [Thread-3  ]: Began running node model.bde.dm_property_type
[0m18:50:57.262312 [info ] [Thread-1  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m18:50:57.262716 [info ] [Thread-2  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m18:50:57.263110 [info ] [Thread-3  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m18:50:57.263673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.dm_host_neighbourhood)
[0m18:50:57.264185 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_lge, now model.bde.dm_listing_neighbourhood)
[0m18:50:57.264682 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dm_property_type)
[0m18:50:57.265020 [debug] [Thread-1  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m18:50:57.265344 [debug] [Thread-2  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m18:50:57.265689 [debug] [Thread-3  ]: Began compiling node model.bde.dm_property_type
[0m18:50:57.268699 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m18:50:57.271287 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m18:50:57.274905 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m18:50:57.275884 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 18:50:57.269075 => 18:50:57.275695
[0m18:50:57.276263 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 18:50:57.265936 => 18:50:57.276111
[0m18:50:57.276588 [debug] [Thread-3  ]: Timing info for model.bde.dm_property_type (compile): 18:50:57.271553 => 18:50:57.276454
[0m18:50:57.276876 [debug] [Thread-2  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m18:50:57.277180 [debug] [Thread-1  ]: Began executing node model.bde.dm_host_neighbourhood
[0m18:50:57.277471 [debug] [Thread-3  ]: Began executing node model.bde.dm_property_type
[0m18:50:57.280367 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m18:50:57.283663 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m18:50:57.286484 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m18:50:57.287195 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:50:57.287516 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:50:57.287818 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m18:50:57.288094 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:50:57.288375 [debug] [Thread-3  ]: On model.bde.dm_property_type: BEGIN
[0m18:50:57.288647 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:50:57.288918 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m18:50:57.289172 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:50:57.289542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:57.459719 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.460493 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.461096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.461741 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:50:57.462337 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:50:57.462944 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:50:57.463794 [debug] [Thread-3  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  property_type,
  room_type,
  accommodates,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  ROUND(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN has_availability = 't' THEN price END) AS min_price,
  MAX(CASE WHEN has_availability = 't' THEN price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN has_availability = 't' THEN price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN price END), 2) AS avg_price,
  COUNT(DISTINCT host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
   CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,	
  (SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) ELSE 0 END)) AS total_stay,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) AS avg_estimated_revenue
FROM "postgres"."warehouse"."fact_listing"
GROUP BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:50:57.464918 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  listing_neighbourhood,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  min(case when has_availability = 't' then price end) as minimum_price,
  max(case when has_availability = 't' then price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
  round(avg(case when has_availability = 't' then price end),2) as average_price,
  count(distinct host_id) as distinct_host,
  round((sum(case when host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,
  sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
  round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from
    "postgres"."warehouse"."fact_listing"
group by 
  listing_neighbourhood,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
order by 
  listing_neighbourhood, 
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:50:57.465854 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    SELECT 
    host_neighbourhood_lga_name,
	CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
    count(DISTINCT host_id) as number_of_distinct_host,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) as estimate_revenue_per_active,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END) / COUNT(DISTINCT host_id), 2) as estimate_revenue_per_host
FROM 
    "postgres"."warehouse"."fact_listing"
GROUP BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:50:57.493018 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.498920 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:50:57.499625 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.500293 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:57.501034 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m18:50:57.505784 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:50:57.510107 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:50:57.510819 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m18:50:57.511451 [debug] [Thread-3  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m18:50:57.523873 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.526023 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m18:50:57.526599 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:50:57.527138 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m18:50:57.530950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.531516 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:57.533586 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m18:50:57.535643 [debug] [Thread-3  ]: On model.bde.dm_property_type: COMMIT
[0m18:50:57.536161 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:50:57.536641 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:50:57.537118 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m18:50:57.537584 [debug] [Thread-3  ]: On model.bde.dm_property_type: COMMIT
[0m18:50:57.544023 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.548185 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:50:57.548731 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m18:50:57.552970 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.553519 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.558440 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:50:57.561964 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:50:57.562573 [debug] [Thread-3  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m18:50:57.563107 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m18:50:57.568999 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.571135 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 18:50:57.277692 => 18:50:57.570892
[0m18:50:57.571642 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: Close
[0m18:50:57.572750 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf9235670>]}
[0m18:50:57.573499 [info ] [Thread-2  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.31s]
[0m18:50:57.574209 [debug] [Thread-2  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m18:50:57.577522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.577989 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:57.579822 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 18:50:57.280769 => 18:50:57.579603
[0m18:50:57.581669 [debug] [Thread-3  ]: Timing info for model.bde.dm_property_type (execute): 18:50:57.283943 => 18:50:57.581435
[0m18:50:57.582248 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: Close
[0m18:50:57.582721 [debug] [Thread-3  ]: On model.bde.dm_property_type: Close
[0m18:50:57.583959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0adbac40>]}
[0m18:50:57.584784 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a71168-933a-40d5-a636-af9f27cea0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be8018910>]}
[0m18:50:57.585487 [info ] [Thread-1  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.32s]
[0m18:50:57.586157 [info ] [Thread-3  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.32s]
[0m18:50:57.586859 [debug] [Thread-1  ]: Finished running node model.bde.dm_host_neighbourhood
[0m18:50:57.587451 [debug] [Thread-3  ]: Finished running node model.bde.dm_property_type
[0m18:50:57.589012 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:57.589370 [debug] [MainThread]: On master: BEGIN
[0m18:50:57.589676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:57.760176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:57.761384 [debug] [MainThread]: On master: COMMIT
[0m18:50:57.762284 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:57.763129 [debug] [MainThread]: On master: COMMIT
[0m18:50:57.777222 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:57.778558 [debug] [MainThread]: On master: Close
[0m18:50:57.780736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:57.781725 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m18:50:57.782447 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m18:50:57.783036 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m18:50:57.783624 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m18:50:57.784457 [info ] [MainThread]: 
[0m18:50:57.785221 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m18:50:57.790585 [debug] [MainThread]: Command end result
[0m18:50:57.806229 [info ] [MainThread]: 
[0m18:50:57.807026 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:50:57.807527 [info ] [MainThread]: 
[0m18:50:57.808034 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  relation "raw.host_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."host_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m18:50:57.808532 [info ] [MainThread]: 
[0m18:50:57.809005 [error] [MainThread]:   Database Error in model property_stg (models/staging/property_stg.sql)
  relation "raw.property_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."property_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/property_stg.sql
[0m18:50:57.809479 [info ] [MainThread]: 
[0m18:50:57.809957 [error] [MainThread]:   Database Error in model room_stg (models/staging/room_stg.sql)
  relation "raw.room_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."room_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/room_stg.sql
[0m18:50:57.810468 [info ] [MainThread]: 
[0m18:50:57.810985 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=3 SKIP=3 TOTAL=18
[0m18:50:57.811957 [debug] [MainThread]: Command `dbt run` failed at 18:50:57.811809 after 3.88 seconds
[0m18:50:57.812586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c08cb16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ac683a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0abfd430>]}
[0m18:50:57.813341 [debug] [MainThread]: Flushing usage events
[0m18:52:16.066668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff8b516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb0287f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb0288e0>]}


============================== 18:52:16.070566 | e750b5ef-a451-4995-a825-484c27299e48 ==============================
[0m18:52:16.070566 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:52:16.071514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:16.174656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb028820>]}
[0m18:52:16.185494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb14f250>]}
[0m18:52:16.186078 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:52:16.203727 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:52:16.235919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:16.236369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:16.242183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe81f40d0>]}
[0m18:52:16.256127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe8113940>]}
[0m18:52:16.256562 [info ] [MainThread]: Found 18 models, 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:52:16.256866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe8113c40>]}
[0m18:52:16.258612 [info ] [MainThread]: 
[0m18:52:16.259321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:16.260846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:16.269551 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:16.270198 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:16.270801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:16.271138 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:16.272650 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:16.274415 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:16.274700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:16.274951 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:16.275191 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:16.276731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:16.276998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:16.512373 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:16.514747 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:16.515417 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:16.518046 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:16.516036 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:16.519965 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:16.524884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m18:52:16.526038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:52:16.532446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m18:52:16.533037 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:16.533738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m18:52:16.535718 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:16.537526 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:16.537887 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m18:52:16.539692 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:16.540004 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:52:16.540288 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m18:52:16.540554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:16.540821 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:52:16.541108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:16.541381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:16.541806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:16.727609 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:16.728504 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:16.729247 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:16.729900 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:16.730652 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:16.731323 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:16.731876 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:16.732424 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:16.733051 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:52:16.733740 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:52:16.734510 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m18:52:16.735196 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:52:16.760719 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:52:16.763558 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:52:16.764351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:52:16.764996 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:52:16.765609 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:52:16.768168 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m18:52:16.770104 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m18:52:16.772084 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:52:16.783154 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:52:16.786633 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m18:52:16.787181 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:52:16.787735 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m18:52:16.800970 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:16.801571 [debug] [MainThread]: On master: BEGIN
[0m18:52:16.802068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:16.977974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:16.979698 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:16.980779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:17.007677 [debug] [MainThread]: SQL status: SELECT 15 in 0.0 seconds
[0m18:52:17.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe8125eb0>]}
[0m18:52:17.019930 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:17.034378 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:17.035091 [debug] [MainThread]: On master: BEGIN
[0m18:52:17.070086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.071750 [debug] [MainThread]: On master: COMMIT
[0m18:52:17.072858 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:17.073914 [debug] [MainThread]: On master: COMMIT
[0m18:52:17.089680 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:17.090835 [debug] [MainThread]: On master: Close
[0m18:52:17.093577 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:17.094414 [info ] [MainThread]: 
[0m18:52:17.101920 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m18:52:17.102915 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m18:52:17.103899 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m18:52:17.105654 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m18:52:17.104923 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m18:52:17.106866 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m18:52:17.107906 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m18:52:17.108848 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m18:52:17.110064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G01_stg)
[0m18:52:17.111118 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.G02_stg)
[0m18:52:17.112203 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.host_stg)
[0m18:52:17.113251 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.lga_stg)
[0m18:52:17.113954 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m18:52:17.114595 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m18:52:17.115227 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m18:52:17.115833 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m18:52:17.129513 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m18:52:17.133473 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m18:52:17.139145 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m18:52:17.142519 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m18:52:17.143717 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 18:52:17.116326 => 18:52:17.143398
[0m18:52:17.144376 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 18:52:17.130142 => 18:52:17.144122
[0m18:52:17.144895 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m18:52:17.145427 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m18:52:17.146047 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 18:52:17.134012 => 18:52:17.145777
[0m18:52:17.146573 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 18:52:17.139639 => 18:52:17.146365
[0m18:52:17.185958 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m18:52:17.187280 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m18:52:17.187650 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m18:52:17.187961 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m18:52:17.191152 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m18:52:17.194151 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m18:52:17.194572 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:17.194922 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:17.195311 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m18:52:17.195599 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:17.196047 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m18:52:17.196324 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:17.196601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:17.196875 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m18:52:17.197130 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:17.197386 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m18:52:17.197752 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:17.198116 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:17.380417 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.381119 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:17.381612 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m18:52:17.393394 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.393879 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:17.394420 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m18:52:17.403097 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:17.403640 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.410909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.413895 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:17.414423 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "raw.host_snapshot" does not exist
LINE 13:     select * from "postgres"."raw"."host_snapshot"
                           ^

[0m18:52:17.414891 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:17.415326 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:17.415752 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m18:52:17.416183 [debug] [Thread-3  ]: On model.bde.host_stg: ROLLBACK
[0m18:52:17.416670 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m18:52:17.417165 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m18:52:17.431203 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 18:52:17.188342 => 18:52:17.430971
[0m18:52:17.431671 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m18:52:17.433899 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:17.437906 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:17.438439 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.438911 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m18:52:17.441984 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:17.442566 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m18:52:17.444793 [debug] [Thread-3  ]: Database Error in model host_stg (models/staging/host_stg.sql)
  relation "raw.host_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."host_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m18:52:17.445323 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb1b7580>]}
[0m18:52:17.445739 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:17.446652 [error] [Thread-3  ]: 3 of 18 ERROR creating sql view model staging.host_stg ......................... [[31mERROR[0m in 0.33s]
[0m18:52:17.450061 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:17.450667 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m18:52:17.451042 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m18:52:17.451470 [debug] [Thread-3  ]: Began running node model.bde.listings_stg
[0m18:52:17.452100 [info ] [Thread-3  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m18:52:17.452752 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.listings_stg)
[0m18:52:17.453118 [debug] [Thread-3  ]: Began compiling node model.bde.listings_stg
[0m18:52:17.456156 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m18:52:17.456626 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.459200 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:17.459592 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m18:52:17.460105 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (compile): 18:52:17.453375 => 18:52:17.459924
[0m18:52:17.460446 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.460779 [debug] [Thread-3  ]: Began executing node model.bde.listings_stg
[0m18:52:17.467403 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.475456 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m18:52:17.475846 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.479133 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m18:52:17.481356 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:17.481678 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:17.482911 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m18:52:17.483391 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m18:52:17.483752 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m18:52:17.484143 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:17.484571 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m18:52:17.484913 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:17.485222 [debug] [Thread-3  ]: On model.bde.listings_stg: BEGIN
[0m18:52:17.485495 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:17.500556 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:17.500909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.544065 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:17.544414 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:17.545707 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m18:52:17.546012 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m18:52:17.548051 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:17.548341 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:17.548701 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m18:52:17.548995 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m18:52:17.568733 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:17.571215 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:17.571596 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m18:52:17.572127 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:17.573329 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 18:52:17.172021 => 18:52:17.573168
[0m18:52:17.573680 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m18:52:17.574396 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80089a3b50>]}
[0m18:52:17.574909 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.46s]
[0m18:52:17.575425 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m18:52:17.575815 [debug] [Thread-2  ]: Began running node model.bde.property_stg
[0m18:52:17.576271 [info ] [Thread-2  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m18:52:17.576892 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.property_stg)
[0m18:52:17.577264 [debug] [Thread-2  ]: Began compiling node model.bde.property_stg
[0m18:52:17.579694 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.property_stg"
[0m18:52:17.580046 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:17.581340 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 18:52:17.191447 => 18:52:17.581173
[0m18:52:17.581761 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m18:52:17.582158 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (compile): 18:52:17.577496 => 18:52:17.582000
[0m18:52:17.582526 [debug] [Thread-2  ]: Began executing node model.bde.property_stg
[0m18:52:17.585762 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.property_stg"
[0m18:52:17.586395 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb1efc40>]}
[0m18:52:17.586881 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.47s]
[0m18:52:17.587401 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m18:52:17.587763 [debug] [Thread-4  ]: Began running node model.bde.room_stg
[0m18:52:17.588125 [info ] [Thread-4  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m18:52:17.588649 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.room_stg)
[0m18:52:17.588961 [debug] [Thread-4  ]: Began compiling node model.bde.room_stg
[0m18:52:17.591259 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.room_stg"
[0m18:52:17.591607 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:17.591998 [debug] [Thread-2  ]: On model.bde.property_stg: BEGIN
[0m18:52:17.592325 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:17.592785 [debug] [Thread-4  ]: Timing info for model.bde.room_stg (compile): 18:52:17.589207 => 18:52:17.592632
[0m18:52:17.593082 [debug] [Thread-4  ]: Began executing node model.bde.room_stg
[0m18:52:17.596066 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.room_stg"
[0m18:52:17.596405 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:17.597559 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 18:52:17.146880 => 18:52:17.597422
[0m18:52:17.597871 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m18:52:17.598285 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:17.598816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fe83ef2e0>]}
[0m18:52:17.599130 [debug] [Thread-4  ]: On model.bde.room_stg: BEGIN
[0m18:52:17.599602 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.49s]
[0m18:52:17.599939 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:17.600407 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m18:52:17.600923 [debug] [Thread-1  ]: Began running node model.bde.suburb_stg
[0m18:52:17.601349 [info ] [Thread-1  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m18:52:17.602176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.suburb_stg)
[0m18:52:17.602530 [debug] [Thread-1  ]: Began compiling node model.bde.suburb_stg
[0m18:52:17.605008 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m18:52:17.605607 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (compile): 18:52:17.602743 => 18:52:17.605447
[0m18:52:17.605908 [debug] [Thread-1  ]: Began executing node model.bde.suburb_stg
[0m18:52:17.609809 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m18:52:17.610515 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:17.610797 [debug] [Thread-1  ]: On model.bde.suburb_stg: BEGIN
[0m18:52:17.611054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:17.652841 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.653383 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:17.653813 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m18:52:17.679075 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:17.682740 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:17.683174 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m18:52:17.699378 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.702682 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:17.703132 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m18:52:17.719110 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.720593 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m18:52:17.720954 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:17.721278 [debug] [Thread-3  ]: On model.bde.listings_stg: COMMIT
[0m18:52:17.738365 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:17.740639 [debug] [Thread-3  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:17.740998 [debug] [Thread-3  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m18:52:17.760774 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:17.762229 [debug] [Thread-3  ]: Timing info for model.bde.listings_stg (execute): 18:52:17.476126 => 18:52:17.762045
[0m18:52:17.762634 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.763004 [debug] [Thread-3  ]: On model.bde.listings_stg: Close
[0m18:52:17.763382 [debug] [Thread-2  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:17.763863 [debug] [Thread-2  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m18:52:17.764573 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80089ae6d0>]}
[0m18:52:17.765188 [info ] [Thread-3  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m18:52:17.765769 [debug] [Thread-3  ]: Finished running node model.bde.listings_stg
[0m18:52:17.766133 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.766536 [debug] [Thread-3  ]: Began running node model.bde.dim_host
[0m18:52:17.766947 [debug] [Thread-4  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:17.767366 [info ] [Thread-3  ]: 9 of 18 SKIP relation warehouse.dim_host ....................................... [[33mSKIP[0m]
[0m18:52:17.767807 [debug] [Thread-4  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m18:52:17.768214 [debug] [Thread-3  ]: Finished running node model.bde.dim_host
[0m18:52:17.768629 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G02
[0m18:52:17.769048 [info ] [Thread-3  ]: 10 of 18 START sql view model warehouse.fact_census_G02 ........................ [RUN]
[0m18:52:17.769629 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.fact_census_G02)
[0m18:52:17.769959 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G02
[0m18:52:17.772615 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m18:52:17.773317 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (compile): 18:52:17.770209 => 18:52:17.773144
[0m18:52:17.773657 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G02
[0m18:52:17.776877 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m18:52:17.777412 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:17.777718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.778031 [debug] [Thread-3  ]: On model.bde.fact_census_G02: BEGIN
[0m18:52:17.778336 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:17.778636 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:17.778956 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m18:52:17.784060 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "raw.property_snapshot" does not exist
LINE 13:     select * from "postgres"."raw"."property_snapshot"
                           ^

[0m18:52:17.784461 [debug] [Thread-4  ]: Postgres adapter: Postgres error: relation "raw.room_snapshot" does not exist
LINE 13:     select * from "postgres"."raw"."room_snapshot"
                           ^

[0m18:52:17.784880 [debug] [Thread-2  ]: On model.bde.property_stg: ROLLBACK
[0m18:52:17.785245 [debug] [Thread-4  ]: On model.bde.room_stg: ROLLBACK
[0m18:52:17.799993 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:17.800580 [debug] [Thread-4  ]: Timing info for model.bde.room_stg (execute): 18:52:17.593286 => 18:52:17.800357
[0m18:52:17.801105 [debug] [Thread-2  ]: Timing info for model.bde.property_stg (execute): 18:52:17.582767 => 18:52:17.800922
[0m18:52:17.804568 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:17.804987 [debug] [Thread-4  ]: On model.bde.room_stg: Close
[0m18:52:17.805334 [debug] [Thread-2  ]: On model.bde.property_stg: Close
[0m18:52:17.805669 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m18:52:17.807549 [debug] [Thread-2  ]: Database Error in model property_stg (models/staging/property_stg.sql)
  relation "raw.property_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."property_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/property_stg.sql
[0m18:52:17.807998 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8008938250>]}
[0m18:52:17.808672 [debug] [Thread-4  ]: Database Error in model room_stg (models/staging/room_stg.sql)
  relation "raw.room_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."room_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/room_stg.sql
[0m18:52:17.809060 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb2034f0>]}
[0m18:52:17.809573 [error] [Thread-2  ]: 6 of 18 ERROR creating sql view model staging.property_stg ..................... [[31mERROR[0m in 0.23s]
[0m18:52:17.810094 [error] [Thread-4  ]: 7 of 18 ERROR creating sql view model staging.room_stg ......................... [[31mERROR[0m in 0.22s]
[0m18:52:17.810635 [debug] [Thread-2  ]: Finished running node model.bde.property_stg
[0m18:52:17.811117 [debug] [Thread-4  ]: Finished running node model.bde.room_stg
[0m18:52:17.811493 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G01
[0m18:52:17.812038 [info ] [Thread-2  ]: 11 of 18 START sql view model warehouse.fact_census_G01 ........................ [RUN]
[0m18:52:17.812480 [debug] [Thread-4  ]: Began running node model.bde.dim_property
[0m18:52:17.812968 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_census_G01)
[0m18:52:17.813319 [info ] [Thread-4  ]: 12 of 18 SKIP relation warehouse.dim_property .................................. [[33mSKIP[0m]
[0m18:52:17.813669 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G01
[0m18:52:17.814031 [debug] [Thread-4  ]: Finished running node model.bde.dim_property
[0m18:52:17.816570 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m18:52:17.817130 [debug] [Thread-4  ]: Began running node model.bde.dim_room
[0m18:52:17.817648 [info ] [Thread-4  ]: 13 of 18 SKIP relation warehouse.dim_room ...................................... [[33mSKIP[0m]
[0m18:52:17.818154 [debug] [Thread-4  ]: Finished running node model.bde.dim_room
[0m18:52:17.818610 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (compile): 18:52:17.814258 => 18:52:17.818432
[0m18:52:17.819002 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G01
[0m18:52:17.823168 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m18:52:17.823514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.825949 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:17.826325 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m18:52:17.826639 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:17.826977 [debug] [Thread-2  ]: On model.bde.fact_census_G01: BEGIN
[0m18:52:17.827256 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:17.840607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.842310 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m18:52:17.842673 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:17.842986 [debug] [Thread-1  ]: On model.bde.suburb_stg: COMMIT
[0m18:52:17.861838 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:17.864592 [debug] [Thread-1  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:17.864977 [debug] [Thread-1  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m18:52:17.884642 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:17.886350 [debug] [Thread-1  ]: Timing info for model.bde.suburb_stg (execute): 18:52:17.606107 => 18:52:17.886170
[0m18:52:17.886755 [debug] [Thread-1  ]: On model.bde.suburb_stg: Close
[0m18:52:17.887596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8008977340>]}
[0m18:52:17.888162 [info ] [Thread-1  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:52:17.888716 [debug] [Thread-1  ]: Finished running node model.bde.suburb_stg
[0m18:52:17.889284 [debug] [Thread-4  ]: Began running node model.bde.fact_lge
[0m18:52:17.889692 [debug] [Thread-1  ]: Began running node model.bde.fact_listing
[0m18:52:17.890083 [info ] [Thread-4  ]: 14 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m18:52:17.890516 [info ] [Thread-1  ]: 15 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m18:52:17.891119 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_lge)
[0m18:52:17.891667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.fact_listing)
[0m18:52:17.892021 [debug] [Thread-4  ]: Began compiling node model.bde.fact_lge
[0m18:52:17.892366 [debug] [Thread-1  ]: Began compiling node model.bde.fact_listing
[0m18:52:17.895263 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m18:52:17.898707 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m18:52:17.900564 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (compile): 18:52:17.895613 => 18:52:17.900367
[0m18:52:17.900989 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (compile): 18:52:17.892623 => 18:52:17.900804
[0m18:52:17.901352 [debug] [Thread-1  ]: Began executing node model.bde.fact_listing
[0m18:52:17.901709 [debug] [Thread-4  ]: Began executing node model.bde.fact_lge
[0m18:52:17.905159 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m18:52:17.908267 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m18:52:17.908945 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:17.909317 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:17.909642 [debug] [Thread-1  ]: On model.bde.fact_listing: BEGIN
[0m18:52:17.909959 [debug] [Thread-4  ]: On model.bde.fact_lge: BEGIN
[0m18:52:17.910266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:17.910557 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:17.940414 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.940917 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:17.941280 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m18:52:17.962277 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:17.965406 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:17.965869 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m18:52:17.981171 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:17.982543 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m18:52:17.982931 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:17.983275 [debug] [Thread-3  ]: On model.bde.fact_census_G02: COMMIT
[0m18:52:17.999478 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:17.999912 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.000317 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:18.004296 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:18.004728 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m18:52:18.005134 [debug] [Thread-3  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m18:52:18.024775 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.026110 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G02 (execute): 18:52:17.773896 => 18:52:18.025932
[0m18:52:18.026512 [debug] [Thread-3  ]: On model.bde.fact_census_G02: Close
[0m18:52:18.026889 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:18.029593 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:18.030300 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8008a774c0>]}
[0m18:52:18.030679 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m18:52:18.031244 [info ] [Thread-3  ]: 10 of 18 OK created sql view model warehouse.fact_census_G02 ................... [[32mCREATE VIEW[0m in 0.26s]
[0m18:52:18.031880 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G02
[0m18:52:18.046046 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:18.047530 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m18:52:18.047922 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:18.048265 [debug] [Thread-2  ]: On model.bde.fact_census_G01: COMMIT
[0m18:52:18.065154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:18.065643 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:18.066135 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as(
SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    c.lga_name as host_neighbourhood_lga_name,        
	    listing_neighbourhood,
		b.lga_name as listing_neighbourhood_lga_name,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM  "postgres"."staging"."listings_stg" a
left join "postgres"."staging"."suburb_stg" b 
ON a.listing_neighbourhood = b.suburb_name
left join "postgres"."staging"."suburb_stg" c
ON a.host_neighbourhood = c.suburb_name
),
lga_name AS(
select 
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    CASE
	        WHEN host_neighbourhood_lga_name is Null THEN host_neighbourhood_lga_name
	        ELSE host_neighbourhood_lga_name end as host_neighbourhood_lga_name,   
	    listing_neighbourhood,    
	    CASE
	        WHEN listing_neighbourhood_lga_name is Null THEN listing_neighbourhood
	        ELSE listing_neighbourhood_lga_name end as listing_neighbourhood_lga_name, 
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga
)
select
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
		host_neighbourhood_lga_name,
	    s.lga_code as host_neighbourhood_lga_code,
	    listing_neighbourhood,    
		listing_neighbourhood_lga_name,    
		ls.lga_code as listing_neighbourhood_lga_code,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga_name l
left join staging.lga_stg s
on l.host_neighbourhood_lga_name = s.lga_name 
left join staging.lga_stg ls
on l.listing_neighbourhood_lga_name = ls.lga_name
  );
[0m18:52:18.066673 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.069630 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:18.070057 [debug] [Thread-2  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m18:52:18.082754 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:18.083137 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:18.083529 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m18:52:18.088967 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.089421 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:18.090976 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G01 (execute): 18:52:17.819233 => 18:52:18.090781
[0m18:52:18.094122 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:18.094553 [debug] [Thread-2  ]: On model.bde.fact_census_G01: Close
[0m18:52:18.094924 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m18:52:18.095741 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb2034f0>]}
[0m18:52:18.096301 [info ] [Thread-2  ]: 11 of 18 OK created sql view model warehouse.fact_census_G01 ................... [[32mCREATE VIEW[0m in 0.28s]
[0m18:52:18.096862 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G01
[0m18:52:18.103590 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:18.106777 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:18.107255 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m18:52:18.112028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:18.113434 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m18:52:18.113816 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:18.114150 [debug] [Thread-1  ]: On model.bde.fact_listing: COMMIT
[0m18:52:18.123726 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:18.125369 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m18:52:18.125790 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:18.126136 [debug] [Thread-4  ]: On model.bde.fact_lge: COMMIT
[0m18:52:18.126692 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.129204 [debug] [Thread-1  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:18.129577 [debug] [Thread-1  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m18:52:18.143621 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.146305 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:18.146714 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.147074 [debug] [Thread-4  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m18:52:18.148427 [debug] [Thread-1  ]: Timing info for model.bde.fact_listing (execute): 18:52:17.901958 => 18:52:18.148253
[0m18:52:18.148871 [debug] [Thread-1  ]: On model.bde.fact_listing: Close
[0m18:52:18.149727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb190340>]}
[0m18:52:18.150327 [info ] [Thread-1  ]: 15 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m18:52:18.150891 [debug] [Thread-1  ]: Finished running node model.bde.fact_listing
[0m18:52:18.151477 [debug] [Thread-3  ]: Began running node model.bde.dm_host_neighbourhood
[0m18:52:18.151888 [debug] [Thread-2  ]: Began running node model.bde.dm_listing_neighbourhood
[0m18:52:18.152259 [info ] [Thread-3  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m18:52:18.152621 [debug] [Thread-1  ]: Began running node model.bde.dm_property_type
[0m18:52:18.153013 [info ] [Thread-2  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m18:52:18.153584 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.dm_host_neighbourhood)
[0m18:52:18.153975 [info ] [Thread-1  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m18:52:18.154525 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dm_listing_neighbourhood)
[0m18:52:18.154864 [debug] [Thread-3  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m18:52:18.155404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.fact_listing, now model.bde.dm_property_type)
[0m18:52:18.155748 [debug] [Thread-2  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m18:52:18.158388 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m18:52:18.158777 [debug] [Thread-1  ]: Began compiling node model.bde.dm_property_type
[0m18:52:18.161251 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m18:52:18.164916 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m18:52:18.165753 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 18:52:18.159024 => 18:52:18.165576
[0m18:52:18.166176 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 18:52:18.155989 => 18:52:18.165992
[0m18:52:18.166499 [debug] [Thread-2  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m18:52:18.166862 [debug] [Thread-1  ]: Timing info for model.bde.dm_property_type (compile): 18:52:18.161596 => 18:52:18.166716
[0m18:52:18.167168 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.167505 [debug] [Thread-3  ]: Began executing node model.bde.dm_host_neighbourhood
[0m18:52:18.170809 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m18:52:18.171303 [debug] [Thread-1  ]: Began executing node model.bde.dm_property_type
[0m18:52:18.172492 [debug] [Thread-4  ]: Timing info for model.bde.fact_lge (execute): 18:52:17.905460 => 18:52:18.172349
[0m18:52:18.175375 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m18:52:18.178370 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m18:52:18.178754 [debug] [Thread-4  ]: On model.bde.fact_lge: Close
[0m18:52:18.179174 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:18.179588 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:18.180127 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800895ce20>]}
[0m18:52:18.180471 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m18:52:18.180757 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:18.181044 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m18:52:18.181725 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:18.181502 [info ] [Thread-4  ]: 14 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:52:18.182091 [debug] [Thread-1  ]: On model.bde.dm_property_type: BEGIN
[0m18:52:18.182402 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:18.183005 [debug] [Thread-4  ]: Finished running node model.bde.fact_lge
[0m18:52:18.183316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:18.359220 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:18.360079 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:18.360867 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:18.361485 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:18.362098 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:18.362781 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    SELECT 
    host_neighbourhood_lga_name,
	CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
    count(DISTINCT host_id) as number_of_distinct_host,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) as estimate_revenue_per_active,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END) / COUNT(DISTINCT host_id), 2) as estimate_revenue_per_host
FROM 
    "postgres"."warehouse"."fact_listing"
GROUP BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:52:18.363731 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  listing_neighbourhood,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  min(case when has_availability = 't' then price end) as minimum_price,
  max(case when has_availability = 't' then price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
  round(avg(case when has_availability = 't' then price end),2) as average_price,
  count(distinct host_id) as distinct_host,
  round((sum(case when host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,
  sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
  round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from
    "postgres"."warehouse"."fact_listing"
group by 
  listing_neighbourhood,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
order by 
  listing_neighbourhood, 
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:52:18.364615 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:18.365587 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  property_type,
  room_type,
  accommodates,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  ROUND(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN has_availability = 't' THEN price END) AS min_price,
  MAX(CASE WHEN has_availability = 't' THEN price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN has_availability = 't' THEN price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN price END), 2) AS avg_price,
  COUNT(DISTINCT host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
   CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,	
  (SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) ELSE 0 END)) AS total_stay,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) AS avg_estimated_revenue
FROM "postgres"."warehouse"."fact_listing"
GROUP BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:52:18.389121 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:18.394846 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:18.395473 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:18.396070 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:18.396693 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m18:52:18.401095 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:18.405076 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:18.405706 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m18:52:18.406257 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m18:52:18.419393 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:18.421701 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m18:52:18.422300 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:18.422839 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m18:52:18.423548 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:18.424057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:18.426039 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m18:52:18.428340 [debug] [Thread-1  ]: On model.bde.dm_property_type: COMMIT
[0m18:52:18.428917 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:18.429433 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:18.429928 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m18:52:18.430420 [debug] [Thread-1  ]: On model.bde.dm_property_type: COMMIT
[0m18:52:18.439290 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.442672 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:18.443194 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m18:52:18.443938 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.448221 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:18.448682 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m18:52:18.449374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.452228 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:18.452746 [debug] [Thread-1  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m18:52:18.459249 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.460882 [debug] [Thread-2  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 18:52:18.167755 => 18:52:18.460622
[0m18:52:18.461364 [debug] [Thread-2  ]: On model.bde.dm_listing_neighbourhood: Close
[0m18:52:18.462345 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb24cd90>]}
[0m18:52:18.463043 [info ] [Thread-2  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.31s]
[0m18:52:18.463746 [debug] [Thread-2  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m18:52:18.464202 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.465783 [debug] [Thread-3  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 18:52:18.172729 => 18:52:18.465601
[0m18:52:18.466191 [debug] [Thread-3  ]: On model.bde.dm_host_neighbourhood: Close
[0m18:52:18.467008 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800893bca0>]}
[0m18:52:18.467565 [info ] [Thread-3  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.31s]
[0m18:52:18.468167 [debug] [Thread-3  ]: Finished running node model.bde.dm_host_neighbourhood
[0m18:52:18.468571 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:18.470046 [debug] [Thread-1  ]: Timing info for model.bde.dm_property_type (execute): 18:52:18.175702 => 18:52:18.469861
[0m18:52:18.470465 [debug] [Thread-1  ]: On model.bde.dm_property_type: Close
[0m18:52:18.471292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e750b5ef-a451-4995-a825-484c27299e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8008998340>]}
[0m18:52:18.471869 [info ] [Thread-1  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.32s]
[0m18:52:18.472478 [debug] [Thread-1  ]: Finished running node model.bde.dm_property_type
[0m18:52:18.473881 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:18.474275 [debug] [MainThread]: On master: BEGIN
[0m18:52:18.474605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:18.639495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:18.640658 [debug] [MainThread]: On master: COMMIT
[0m18:52:18.641353 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:18.641929 [debug] [MainThread]: On master: COMMIT
[0m18:52:18.657235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:18.658060 [debug] [MainThread]: On master: Close
[0m18:52:18.659852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:18.660556 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m18:52:18.661233 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m18:52:18.661912 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m18:52:18.662510 [debug] [MainThread]: Connection 'model.bde.fact_lge' was properly closed.
[0m18:52:18.663360 [info ] [MainThread]: 
[0m18:52:18.664017 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m18:52:18.669006 [debug] [MainThread]: Command end result
[0m18:52:18.682058 [info ] [MainThread]: 
[0m18:52:18.682796 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:52:18.683262 [info ] [MainThread]: 
[0m18:52:18.683728 [error] [MainThread]:   Database Error in model host_stg (models/staging/host_stg.sql)
  relation "raw.host_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."host_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/host_stg.sql
[0m18:52:18.684172 [info ] [MainThread]: 
[0m18:52:18.684595 [error] [MainThread]:   Database Error in model property_stg (models/staging/property_stg.sql)
  relation "raw.property_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."property_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/property_stg.sql
[0m18:52:18.685022 [info ] [MainThread]: 
[0m18:52:18.685429 [error] [MainThread]:   Database Error in model room_stg (models/staging/room_stg.sql)
  relation "raw.room_snapshot" does not exist
  LINE 13:     select * from "postgres"."raw"."room_snapshot"
                             ^
  compiled Code at target/run/bde/models/staging/room_stg.sql
[0m18:52:18.685883 [info ] [MainThread]: 
[0m18:52:18.686342 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=3 SKIP=3 TOTAL=18
[0m18:52:18.687215 [debug] [MainThread]: Command `dbt run` failed at 18:52:18.687085 after 2.65 seconds
[0m18:52:18.687776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff8b516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffb14f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff009cdf0>]}
[0m18:52:18.688393 [debug] [MainThread]: Flushing usage events
[0m18:52:25.336297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79489016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794abf0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794abf0910>]}


============================== 18:52:25.340323 | 00658cec-ecb6-4376-a0f9-132e80b61cd6 ==============================
[0m18:52:25.340323 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:52:25.340968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:52:25.430712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794abf0850>]}
[0m18:52:25.441765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794ad28250>]}
[0m18:52:25.442748 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:52:25.458085 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:52:25.489238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:25.489630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:25.495605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79281020d0>]}
[0m18:52:25.509234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7938d35940>]}
[0m18:52:25.509686 [info ] [MainThread]: Found 18 models, 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:52:25.509987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7938d35c40>]}
[0m18:52:25.511567 [info ] [MainThread]: 
[0m18:52:25.512200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:25.513221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:25.521827 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:25.522248 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:25.522515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:25.692011 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:25.694390 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:25.697618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:52:25.704833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_warehouse'
[0m18:52:25.706404 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:25.707313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_datamart'
[0m18:52:25.710479 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:25.711275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m18:52:25.711745 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:52:25.713737 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:25.714130 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m18:52:25.716159 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:25.716554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:25.716939 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m18:52:25.717307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:25.717662 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:52:25.718278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:25.718928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:25.891650 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:25.892544 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:25.893154 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:25.893821 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:25.894492 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:52:25.895095 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:25.895695 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:25.896251 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:25.896982 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:25.897754 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:52:25.898584 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:52:25.899362 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m18:52:25.921042 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:52:25.924260 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:52:25.924870 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:52:25.927004 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:52:25.927603 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:52:25.928122 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:52:25.930093 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m18:52:25.932005 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m18:52:25.939522 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:52:25.945810 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:52:25.948829 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m18:52:25.949361 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m18:52:25.960473 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:25.961097 [debug] [MainThread]: On master: BEGIN
[0m18:52:25.961584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:26.137059 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:26.138296 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:26.139562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:26.165249 [debug] [MainThread]: SQL status: SELECT 15 in 0.0 seconds
[0m18:52:26.176148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7928102160>]}
[0m18:52:26.177353 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:26.191909 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:26.192641 [debug] [MainThread]: On master: BEGIN
[0m18:52:26.224920 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:26.226479 [debug] [MainThread]: On master: COMMIT
[0m18:52:26.227614 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:26.228350 [debug] [MainThread]: On master: COMMIT
[0m18:52:26.243085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:26.244268 [debug] [MainThread]: On master: Close
[0m18:52:26.247155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:26.248432 [info ] [MainThread]: 
[0m18:52:26.254809 [debug] [Thread-1  ]: Began running node snapshot.bde.host_snapshot
[0m18:52:26.256336 [debug] [Thread-2  ]: Began running node snapshot.bde.property_snapshot
[0m18:52:26.257396 [info ] [Thread-1  ]: 1 of 3 START snapshot raw.host_snapshot ........................................ [RUN]
[0m18:52:26.258383 [debug] [Thread-3  ]: Began running node snapshot.bde.room_snapshot
[0m18:52:26.259454 [info ] [Thread-2  ]: 2 of 3 START snapshot raw.property_snapshot .................................... [RUN]
[0m18:52:26.261001 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now snapshot.bde.host_snapshot)
[0m18:52:26.261915 [info ] [Thread-3  ]: 3 of 3 START snapshot raw.room_snapshot ........................................ [RUN]
[0m18:52:26.263082 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now snapshot.bde.property_snapshot)
[0m18:52:26.263795 [debug] [Thread-1  ]: Began compiling node snapshot.bde.host_snapshot
[0m18:52:26.264889 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now snapshot.bde.room_snapshot)
[0m18:52:26.265630 [debug] [Thread-2  ]: Began compiling node snapshot.bde.property_snapshot
[0m18:52:26.280645 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (compile): 18:52:26.266125 => 18:52:26.280181
[0m18:52:26.281361 [debug] [Thread-3  ]: Began compiling node snapshot.bde.room_snapshot
[0m18:52:26.286111 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (compile): 18:52:26.281799 => 18:52:26.285769
[0m18:52:26.286890 [debug] [Thread-1  ]: Began executing node snapshot.bde.host_snapshot
[0m18:52:26.291861 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (compile): 18:52:26.287382 => 18:52:26.291512
[0m18:52:26.292512 [debug] [Thread-2  ]: Began executing node snapshot.bde.property_snapshot
[0m18:52:26.335235 [debug] [Thread-3  ]: Began executing node snapshot.bde.room_snapshot
[0m18:52:26.359774 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.bde.host_snapshot"
[0m18:52:26.362397 [debug] [Thread-2  ]: Writing runtime sql for node "snapshot.bde.property_snapshot"
[0m18:52:26.364702 [debug] [Thread-3  ]: Writing runtime sql for node "snapshot.bde.room_snapshot"
[0m18:52:26.383775 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:52:26.384280 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:52:26.384680 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:52:26.385095 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: BEGIN
[0m18:52:26.385484 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: BEGIN
[0m18:52:26.385896 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: BEGIN
[0m18:52:26.386266 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:26.386604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:26.386938 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:26.580706 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:26.581855 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:52:26.582812 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.property_snapshot"} */

      
  
    

  create  table "postgres"."raw"."property_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        


select
  distinct LISTING_ID,
  SCRAPE_ID,
  scraped_date,
  listing_neighbourhood,
  property_type,
  room_type,
  accommodates,
  price
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:52:26.585777 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:26.586634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:26.587576 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:52:26.588427 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:52:26.589323 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.room_snapshot"} */

      
  
    

  create  table "postgres"."raw"."room_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select 
  distinct listing_id,
  scrape_id,
  scraped_date,
  has_availability,
  availability_30,
  number_of_reviews,
  REVIEW_SCORES_RATING,
  REVIEW_SCORES_ACCURACY,
  REVIEW_SCORES_CLEANLINESS,
  REVIEW_SCORES_CHECKIN,
  REVIEW_SCORES_COMMUNICATION,
  REVIEW_SCORES_VALUE 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:52:26.590171 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "snapshot.bde.host_snapshot"} */

      
  
    

  create  table "postgres"."raw"."host_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(LISTING_ID as varchar ), '')
         || '|' || coalesce(cast(scraped_date as varchar ), '')
        ) as dbt_scd_id,
        scraped_date as dbt_updated_at,
        scraped_date as dbt_valid_from,
        nullif(scraped_date, scraped_date) as dbt_valid_to
    from (
        



select 
  distinct LISTING_ID,
  HOST_ID,
  SCRAPE_ID,
  SCRAPED_DATE,
  host_name,
  host_since,
  host_is_superhost,
  host_neighbourhood 
from "postgres"."raw"."listings"

    ) sbq



  );
  
  
[0m18:52:32.764737 [debug] [Thread-1  ]: SQL status: SELECT 412122 in 6.0 seconds
[0m18:52:32.804817 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m18:52:32.805599 [debug] [Thread-1  ]: Using postgres connection "snapshot.bde.host_snapshot"
[0m18:52:32.806119 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: COMMIT
[0m18:52:32.907077 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:32.911213 [debug] [Thread-1  ]: Timing info for snapshot.bde.host_snapshot (execute): 18:52:26.309962 => 18:52:32.910511
[0m18:52:32.912643 [debug] [Thread-1  ]: On snapshot.bde.host_snapshot: Close
[0m18:52:32.915237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794ad2cd00>]}
[0m18:52:32.917766 [info ] [Thread-1  ]: 1 of 3 OK snapshotted raw.host_snapshot ........................................ [[32mSELECT 412122[0m in 6.65s]
[0m18:52:32.919250 [debug] [Thread-1  ]: Finished running node snapshot.bde.host_snapshot
[0m18:52:33.204549 [debug] [Thread-2  ]: SQL status: SELECT 412122 in 7.0 seconds
[0m18:52:33.211131 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:52:33.211990 [debug] [Thread-2  ]: Using postgres connection "snapshot.bde.property_snapshot"
[0m18:52:33.212841 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: COMMIT
[0m18:52:33.322653 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:33.327247 [debug] [Thread-2  ]: Timing info for snapshot.bde.property_snapshot (execute): 18:52:26.360105 => 18:52:33.326575
[0m18:52:33.328502 [debug] [Thread-2  ]: On snapshot.bde.property_snapshot: Close
[0m18:52:33.331118 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794adb9fd0>]}
[0m18:52:33.333590 [info ] [Thread-2  ]: 2 of 3 OK snapshotted raw.property_snapshot .................................... [[32mSELECT 412122[0m in 7.07s]
[0m18:52:33.335103 [debug] [Thread-2  ]: Finished running node snapshot.bde.property_snapshot
[0m18:52:33.463089 [debug] [Thread-3  ]: SQL status: SELECT 412122 in 7.0 seconds
[0m18:52:33.471955 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:52:33.473137 [debug] [Thread-3  ]: Using postgres connection "snapshot.bde.room_snapshot"
[0m18:52:33.473985 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: COMMIT
[0m18:52:33.550741 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:33.555927 [debug] [Thread-3  ]: Timing info for snapshot.bde.room_snapshot (execute): 18:52:26.362655 => 18:52:33.554958
[0m18:52:33.557762 [debug] [Thread-3  ]: On snapshot.bde.room_snapshot: Close
[0m18:52:33.561044 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00658cec-ecb6-4376-a0f9-132e80b61cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7928102190>]}
[0m18:52:33.563190 [info ] [Thread-3  ]: 3 of 3 OK snapshotted raw.room_snapshot ........................................ [[32mSELECT 412122[0m in 7.30s]
[0m18:52:33.564556 [debug] [Thread-3  ]: Finished running node snapshot.bde.room_snapshot
[0m18:52:33.567542 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:33.568295 [debug] [MainThread]: On master: BEGIN
[0m18:52:33.568979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:33.761388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:33.763971 [debug] [MainThread]: On master: COMMIT
[0m18:52:33.765268 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:33.766619 [debug] [MainThread]: On master: COMMIT
[0m18:52:33.782416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:33.783333 [debug] [MainThread]: On master: Close
[0m18:52:33.785334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:33.786205 [debug] [MainThread]: Connection 'snapshot.bde.host_snapshot' was properly closed.
[0m18:52:33.786991 [debug] [MainThread]: Connection 'snapshot.bde.property_snapshot' was properly closed.
[0m18:52:33.787634 [debug] [MainThread]: Connection 'snapshot.bde.room_snapshot' was properly closed.
[0m18:52:33.788237 [debug] [MainThread]: Connection 'list_postgres_raw' was properly closed.
[0m18:52:33.788967 [info ] [MainThread]: 
[0m18:52:33.789812 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m18:52:33.791853 [debug] [MainThread]: Command end result
[0m18:52:33.807031 [info ] [MainThread]: 
[0m18:52:33.807891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:33.808487 [info ] [MainThread]: 
[0m18:52:33.809093 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:52:33.810280 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:52:33.810112 after 8.50 seconds
[0m18:52:33.811010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79489016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794adbd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794acb3790>]}
[0m18:52:33.811634 [debug] [MainThread]: Flushing usage events
[0m18:52:38.724036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b88d96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bac10820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bac10910>]}


============================== 18:52:38.727914 | cf791c5d-98ee-4aa0-a94b-9eb112d49eb1 ==============================
[0m18:52:38.727914 [info ] [MainThread]: Running with dbt=1.6.6
[0m18:52:38.728552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charlotteli/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charlotteli/Desktop/UTS/Year2 Sem1/bde_at3/dbt-dev/bde/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:52:38.817628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bac10850>]}
[0m18:52:38.828506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bad79280>]}
[0m18:52:38.829437 [info ] [MainThread]: Registered adapter: postgres=1.6.6
[0m18:52:38.844575 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m18:52:38.876039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:38.876432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:38.882240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99880f20d0>]}
[0m18:52:38.895536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998055970>]}
[0m18:52:38.895983 [info ] [MainThread]: Found 18 models, 3 snapshots, 5 sources, 0 exposures, 0 metrics, 353 macros, 0 groups, 0 semantic models
[0m18:52:38.896289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998055c70>]}
[0m18:52:38.898060 [info ] [MainThread]: 
[0m18:52:38.898691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:38.900208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:38.908161 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:38.908758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:38.909401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:38.909654 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:38.911190 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:38.912939 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:38.913224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:38.913477 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:38.913717 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:38.914168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:38.914457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:39.099575 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:39.100251 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:39.100785 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:39.103028 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:39.104486 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:39.105858 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:39.109893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_datamart)
[0m18:52:39.110849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_warehouse)
[0m18:52:39.118106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_staging)
[0m18:52:39.118813 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:39.119664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_raw'
[0m18:52:39.121991 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:39.123957 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:39.124334 [debug] [ThreadPool]: On list_postgres_datamart: BEGIN
[0m18:52:39.126371 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:39.126734 [debug] [ThreadPool]: On list_postgres_warehouse: BEGIN
[0m18:52:39.127059 [debug] [ThreadPool]: On list_postgres_staging: BEGIN
[0m18:52:39.127376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:39.127688 [debug] [ThreadPool]: On list_postgres_raw: BEGIN
[0m18:52:39.127995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:39.128293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:39.128775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:39.320734 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.321621 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.322521 [debug] [ThreadPool]: Using postgres connection "list_postgres_datamart"
[0m18:52:39.323254 [debug] [ThreadPool]: Using postgres connection "list_postgres_warehouse"
[0m18:52:39.324047 [debug] [ThreadPool]: On list_postgres_datamart: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_datamart"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'datamart'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'datamart'
  
[0m18:52:39.324796 [debug] [ThreadPool]: On list_postgres_warehouse: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_warehouse"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:52:39.325692 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.326328 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.326982 [debug] [ThreadPool]: Using postgres connection "list_postgres_raw"
[0m18:52:39.327577 [debug] [ThreadPool]: Using postgres connection "list_postgres_staging"
[0m18:52:39.328206 [debug] [ThreadPool]: On list_postgres_raw: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_raw"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m18:52:39.328925 [debug] [ThreadPool]: On list_postgres_staging: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "list_postgres_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:52:39.346573 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:52:39.349283 [debug] [ThreadPool]: On list_postgres_datamart: ROLLBACK
[0m18:52:39.350366 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:52:39.351189 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:39.351867 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:52:39.353918 [debug] [ThreadPool]: On list_postgres_warehouse: ROLLBACK
[0m18:52:39.356034 [debug] [ThreadPool]: On list_postgres_raw: ROLLBACK
[0m18:52:39.357986 [debug] [ThreadPool]: On list_postgres_staging: ROLLBACK
[0m18:52:39.365785 [debug] [ThreadPool]: On list_postgres_datamart: Close
[0m18:52:39.373450 [debug] [ThreadPool]: On list_postgres_raw: Close
[0m18:52:39.373988 [debug] [ThreadPool]: On list_postgres_staging: Close
[0m18:52:39.374532 [debug] [ThreadPool]: On list_postgres_warehouse: Close
[0m18:52:39.388634 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:39.389213 [debug] [MainThread]: On master: BEGIN
[0m18:52:39.389690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:39.580048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.581726 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:39.582866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:39.608390 [debug] [MainThread]: SQL status: SELECT 15 in 0.0 seconds
[0m18:52:39.619468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8def280>]}
[0m18:52:39.620598 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:39.634711 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:39.635410 [debug] [MainThread]: On master: BEGIN
[0m18:52:39.666525 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.667837 [debug] [MainThread]: On master: COMMIT
[0m18:52:39.668749 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:39.669559 [debug] [MainThread]: On master: COMMIT
[0m18:52:39.685154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:39.686492 [debug] [MainThread]: On master: Close
[0m18:52:39.689638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:39.690731 [info ] [MainThread]: 
[0m18:52:39.697945 [debug] [Thread-1  ]: Began running node model.bde.G01_stg
[0m18:52:39.698886 [debug] [Thread-2  ]: Began running node model.bde.G02_stg
[0m18:52:39.699898 [debug] [Thread-3  ]: Began running node model.bde.host_stg
[0m18:52:39.700767 [debug] [Thread-4  ]: Began running node model.bde.lga_stg
[0m18:52:39.701746 [info ] [Thread-1  ]: 1 of 18 START sql view model staging.G01_stg ................................... [RUN]
[0m18:52:39.702910 [info ] [Thread-2  ]: 2 of 18 START sql view model staging.G02_stg ................................... [RUN]
[0m18:52:39.703856 [info ] [Thread-3  ]: 3 of 18 START sql view model staging.host_stg .................................. [RUN]
[0m18:52:39.704674 [info ] [Thread-4  ]: 4 of 18 START sql view model staging.lga_stg ................................... [RUN]
[0m18:52:39.706204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_datamart, now model.bde.G01_stg)
[0m18:52:39.707514 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_postgres_warehouse, now model.bde.G02_stg)
[0m18:52:39.708767 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_postgres_staging, now model.bde.host_stg)
[0m18:52:39.709885 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly list_postgres_raw, now model.bde.lga_stg)
[0m18:52:39.710644 [debug] [Thread-1  ]: Began compiling node model.bde.G01_stg
[0m18:52:39.711337 [debug] [Thread-2  ]: Began compiling node model.bde.G02_stg
[0m18:52:39.712059 [debug] [Thread-3  ]: Began compiling node model.bde.host_stg
[0m18:52:39.712722 [debug] [Thread-4  ]: Began compiling node model.bde.lga_stg
[0m18:52:39.725477 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.G01_stg"
[0m18:52:39.729527 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.G02_stg"
[0m18:52:39.735015 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.host_stg"
[0m18:52:39.738585 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.lga_stg"
[0m18:52:39.739671 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (compile): 18:52:39.713183 => 18:52:39.739358
[0m18:52:39.740259 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (compile): 18:52:39.726067 => 18:52:39.740036
[0m18:52:39.740804 [debug] [Thread-1  ]: Began executing node model.bde.G01_stg
[0m18:52:39.741358 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (compile): 18:52:39.735531 => 18:52:39.741125
[0m18:52:39.741860 [debug] [Thread-2  ]: Began executing node model.bde.G02_stg
[0m18:52:39.742384 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (compile): 18:52:39.729979 => 18:52:39.742175
[0m18:52:39.766894 [debug] [Thread-4  ]: Began executing node model.bde.lga_stg
[0m18:52:39.776208 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.G01_stg"
[0m18:52:39.779632 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.G02_stg"
[0m18:52:39.780004 [debug] [Thread-3  ]: Began executing node model.bde.host_stg
[0m18:52:39.782869 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.lga_stg"
[0m18:52:39.786306 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.host_stg"
[0m18:52:39.786717 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:39.787140 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:39.787542 [debug] [Thread-1  ]: On model.bde.G01_stg: BEGIN
[0m18:52:39.787847 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:39.788142 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:39.788439 [debug] [Thread-2  ]: On model.bde.G02_stg: BEGIN
[0m18:52:39.788741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:39.789032 [debug] [Thread-4  ]: On model.bde.lga_stg: BEGIN
[0m18:52:39.789321 [debug] [Thread-3  ]: On model.bde.host_stg: BEGIN
[0m18:52:39.789601 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:39.789997 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:39.790283 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:39.955572 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.956503 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:39.957157 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */

  create view "postgres"."staging"."G01_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g01_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        *
    from source
)


select * from lga
  );
[0m18:52:39.959890 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.960606 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:39.961313 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */

  create view "postgres"."staging"."host_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."host_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        HOST_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
    where host_name <> '' and host_since <> '' and host_since <> 'NaN' and host_name <> ''
)

select * from to_date_format
  );
[0m18:52:39.971367 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.971924 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:39.972504 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:39.973088 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:39.973718 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */

  create view "postgres"."staging"."G02_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."census_g02_nsw_lga"

),

lga as (
    SELECT
    	cast(replace(lga_code_2016, 'LGA', '') as integer) as lga_code,
        Median_age_persons,
        Median_mortgage_repay_monthly,
        Median_tot_prsnl_inc_weekly,
        Median_rent_weekly,
        Median_tot_fam_inc_weekly,
        Average_num_psns_per_bedroom,
        Median_tot_hhd_inc_weekly,
        Average_household_size
    from source
)


select * from lga
  );
[0m18:52:39.974393 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */

  create view "postgres"."staging"."lga_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."nsw_lga_code"

),

lowercase_lga_name as (
    select
        lga_code,
        lower(lga_name) as lga_name 
    from source
)


select * from lowercase_lga_name
  );
[0m18:52:39.984849 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:39.985451 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:39.997014 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:39.997622 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:39.998097 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.001920 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:40.002460 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg" rename to "G01_stg__dbt_backup"
[0m18:52:40.006768 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:40.010325 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:40.010819 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
alter table "postgres"."staging"."host_stg__dbt_tmp" rename to "host_stg"
[0m18:52:40.011366 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg" rename to "G02_stg__dbt_backup"
[0m18:52:40.011854 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg" rename to "lga_stg__dbt_backup"
[0m18:52:40.026345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.029725 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:40.030199 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
alter table "postgres"."staging"."G01_stg__dbt_tmp" rename to "G01_stg"
[0m18:52:40.030682 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.031114 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.034510 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:40.034930 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.050015 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m18:52:40.050419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.050755 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
alter table "postgres"."staging"."G02_stg__dbt_tmp" rename to "G02_stg"
[0m18:52:40.053445 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:40.053799 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:40.056988 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m18:52:40.057428 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
alter table "postgres"."staging"."lga_stg__dbt_tmp" rename to "lga_stg"
[0m18:52:40.057783 [debug] [Thread-3  ]: On model.bde.host_stg: COMMIT
[0m18:52:40.058109 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:40.058525 [debug] [Thread-1  ]: On model.bde.G01_stg: COMMIT
[0m18:52:40.071678 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.073254 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m18:52:40.073637 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:40.073972 [debug] [Thread-2  ]: On model.bde.G02_stg: COMMIT
[0m18:52:40.075843 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.077349 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m18:52:40.077721 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.078053 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.078394 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:40.085780 [debug] [Thread-3  ]: Using postgres connection "model.bde.host_stg"
[0m18:52:40.088935 [debug] [Thread-1  ]: Using postgres connection "model.bde.G01_stg"
[0m18:52:40.089288 [debug] [Thread-4  ]: On model.bde.lga_stg: COMMIT
[0m18:52:40.089612 [debug] [Thread-3  ]: On model.bde.host_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.host_stg"} */
drop view if exists "postgres"."staging"."host_stg__dbt_backup" cascade
[0m18:52:40.089918 [debug] [Thread-1  ]: On model.bde.G01_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G01_stg"} */
drop view if exists "postgres"."staging"."G01_stg__dbt_backup" cascade
[0m18:52:40.091637 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.125397 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.125756 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.126008 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.127377 [debug] [Thread-2  ]: Using postgres connection "model.bde.G02_stg"
[0m18:52:40.128501 [debug] [Thread-1  ]: Timing info for model.bde.G01_stg (execute): 18:52:39.742708 => 18:52:40.128364
[0m18:52:40.130476 [debug] [Thread-4  ]: Using postgres connection "model.bde.lga_stg"
[0m18:52:40.131413 [debug] [Thread-3  ]: Timing info for model.bde.host_stg (execute): 18:52:39.783386 => 18:52:40.131292
[0m18:52:40.131696 [debug] [Thread-2  ]: On model.bde.G02_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.G02_stg"} */
drop view if exists "postgres"."staging"."G02_stg__dbt_backup" cascade
[0m18:52:40.131978 [debug] [Thread-1  ]: On model.bde.G01_stg: Close
[0m18:52:40.132239 [debug] [Thread-4  ]: On model.bde.lga_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.lga_stg"} */
drop view if exists "postgres"."staging"."lga_stg__dbt_backup" cascade
[0m18:52:40.132502 [debug] [Thread-3  ]: On model.bde.host_stg: Close
[0m18:52:40.133198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8e0e790>]}
[0m18:52:40.133818 [info ] [Thread-1  ]: 1 of 18 OK created sql view model staging.G01_stg .............................. [[32mCREATE VIEW[0m in 0.43s]
[0m18:52:40.134351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8e2ce80>]}
[0m18:52:40.134799 [debug] [Thread-1  ]: Finished running node model.bde.G01_stg
[0m18:52:40.135186 [info ] [Thread-3  ]: 3 of 18 OK created sql view model staging.host_stg ............................. [[32mCREATE VIEW[0m in 0.43s]
[0m18:52:40.135562 [debug] [Thread-1  ]: Began running node model.bde.listings_stg
[0m18:52:40.136053 [debug] [Thread-3  ]: Finished running node model.bde.host_stg
[0m18:52:40.136375 [info ] [Thread-1  ]: 5 of 18 START sql view model staging.listings_stg .............................. [RUN]
[0m18:52:40.136714 [debug] [Thread-3  ]: Began running node model.bde.property_stg
[0m18:52:40.137165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.G01_stg, now model.bde.listings_stg)
[0m18:52:40.137565 [info ] [Thread-3  ]: 6 of 18 START sql view model staging.property_stg .............................. [RUN]
[0m18:52:40.137876 [debug] [Thread-1  ]: Began compiling node model.bde.listings_stg
[0m18:52:40.138295 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.host_stg, now model.bde.property_stg)
[0m18:52:40.140633 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.listings_stg"
[0m18:52:40.140950 [debug] [Thread-3  ]: Began compiling node model.bde.property_stg
[0m18:52:40.143062 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.property_stg"
[0m18:52:40.143630 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (compile): 18:52:40.138495 => 18:52:40.143490
[0m18:52:40.143905 [debug] [Thread-1  ]: Began executing node model.bde.listings_stg
[0m18:52:40.146694 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.listings_stg"
[0m18:52:40.147082 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (compile): 18:52:40.141219 => 18:52:40.146929
[0m18:52:40.147416 [debug] [Thread-3  ]: Began executing node model.bde.property_stg
[0m18:52:40.150284 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.property_stg"
[0m18:52:40.150641 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.151900 [debug] [Thread-2  ]: Timing info for model.bde.G02_stg (execute): 18:52:39.776606 => 18:52:40.151760
[0m18:52:40.152323 [debug] [Thread-2  ]: On model.bde.G02_stg: Close
[0m18:52:40.152679 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:40.153015 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:40.153364 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.153947 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8e220d0>]}
[0m18:52:40.154245 [debug] [Thread-1  ]: On model.bde.listings_stg: BEGIN
[0m18:52:40.154556 [debug] [Thread-3  ]: On model.bde.property_stg: BEGIN
[0m18:52:40.155624 [debug] [Thread-4  ]: Timing info for model.bde.lga_stg (execute): 18:52:39.780233 => 18:52:40.155496
[0m18:52:40.156089 [info ] [Thread-2  ]: 2 of 18 OK created sql view model staging.G02_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m18:52:40.156392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:40.156671 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:40.156943 [debug] [Thread-4  ]: On model.bde.lga_stg: Close
[0m18:52:40.157333 [debug] [Thread-2  ]: Finished running node model.bde.G02_stg
[0m18:52:40.157916 [debug] [Thread-2  ]: Began running node model.bde.room_stg
[0m18:52:40.158494 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998184a90>]}
[0m18:52:40.158839 [info ] [Thread-2  ]: 7 of 18 START sql view model staging.room_stg .................................. [RUN]
[0m18:52:40.159288 [info ] [Thread-4  ]: 4 of 18 OK created sql view model staging.lga_stg .............................. [[32mCREATE VIEW[0m in 0.45s]
[0m18:52:40.159783 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.G02_stg, now model.bde.room_stg)
[0m18:52:40.160182 [debug] [Thread-4  ]: Finished running node model.bde.lga_stg
[0m18:52:40.160448 [debug] [Thread-2  ]: Began compiling node model.bde.room_stg
[0m18:52:40.160751 [debug] [Thread-4  ]: Began running node model.bde.suburb_stg
[0m18:52:40.163083 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.room_stg"
[0m18:52:40.163478 [info ] [Thread-4  ]: 8 of 18 START sql view model staging.suburb_stg ................................ [RUN]
[0m18:52:40.164034 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.lga_stg, now model.bde.suburb_stg)
[0m18:52:40.164306 [debug] [Thread-4  ]: Began compiling node model.bde.suburb_stg
[0m18:52:40.166278 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.suburb_stg"
[0m18:52:40.166827 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (compile): 18:52:40.160960 => 18:52:40.166670
[0m18:52:40.167181 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (compile): 18:52:40.164504 => 18:52:40.167038
[0m18:52:40.167458 [debug] [Thread-2  ]: Began executing node model.bde.room_stg
[0m18:52:40.167740 [debug] [Thread-4  ]: Began executing node model.bde.suburb_stg
[0m18:52:40.172316 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.room_stg"
[0m18:52:40.175193 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.suburb_stg"
[0m18:52:40.175794 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:40.176127 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:40.176471 [debug] [Thread-2  ]: On model.bde.room_stg: BEGIN
[0m18:52:40.176775 [debug] [Thread-4  ]: On model.bde.suburb_stg: BEGIN
[0m18:52:40.177056 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:40.177348 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:40.335810 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.336457 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.337071 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:40.337580 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:40.338202 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */

  create view "postgres"."staging"."listings_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."listings"


),

to_date_format as (
    select
        listing_id ,
        scrape_id ,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        host_id,
        host_name,
        CASE 
            WHEN host_since = 'NaN' THEN NULL
            WHEN host_since = '' THEN NULL
            ELSE TO_DATE(host_since, 'DD/MM/YYYY')
        END as host_since,
        host_is_superhost,
        lower(host_neighbourhood) as host_neighbourhood,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
    from source
)

select * from to_date_format
  );
[0m18:52:40.338844 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */

  create view "postgres"."staging"."property_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."property_snapshot"

),

to_date_format as (
    select
        LISTING_ID,
        SCRAPE_ID,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        lower(listing_neighbourhood) as listing_neighbourhood,
        property_type,
        room_type,
        accommodates,
        price,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)


select * from to_date_format
  );
[0m18:52:40.341300 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.341759 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:40.342224 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */

  create view "postgres"."staging"."suburb_stg__dbt_tmp"
    
    
  as (
    

with

source  as (


    select * from "postgres"."raw"."nsw_lga_suburb"

),

lowercase_lga_name as (
    select
        lower(lga_name) as lga_name,
        lower(suburb_name) as suburb_name
    from source
)


select * from lowercase_lga_name
  );
[0m18:52:40.359315 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.359814 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.363863 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:40.364388 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.364873 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.369011 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:40.369492 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
alter table "postgres"."staging"."property_stg__dbt_tmp" rename to "property_stg"
[0m18:52:40.369963 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:40.373627 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:40.374103 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg" rename to "listings_stg__dbt_backup"
[0m18:52:40.374695 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */

  create view "postgres"."staging"."room_stg__dbt_tmp"
    
    
  as (
    

with

source  as (

    select * from "postgres"."raw"."room_snapshot"


),

to_date_format as (
    SELECT
        listing_id,
        scrape_id,
        TO_DATE(scraped_date, 'YYYY-MM-DD') as scraped_date,
        has_availability,
        availability_30,
        number_of_reviews,
        REVIEW_SCORES_RATING,
        REVIEW_SCORES_ACCURACY,
        REVIEW_SCORES_CLEANLINESS,
        REVIEW_SCORES_CHECKIN,
        REVIEW_SCORES_COMMUNICATION,
        REVIEW_SCORES_VALUE,
        dbt_scd_id,
        TO_DATE(dbt_updated_at, 'YYYY-MM-DD') as dbt_updated_at,
        TO_DATE(dbt_valid_from, 'YYYY-MM-DD') as dbt_valid_from,
        TO_DATE(dbt_valid_to, 'YYYY-MM-DD') as dbt_valid_to
    from source
)

select * from to_date_format
  );
[0m18:52:40.375212 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg" rename to "suburb_stg__dbt_backup"
[0m18:52:40.389058 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.390825 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m18:52:40.391292 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:40.391709 [debug] [Thread-3  ]: On model.bde.property_stg: COMMIT
[0m18:52:40.395482 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.398985 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:40.399444 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.399840 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.400275 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
alter table "postgres"."staging"."listings_stg__dbt_tmp" rename to "listings_stg"
[0m18:52:40.403592 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:40.406675 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:40.407154 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
alter table "postgres"."staging"."suburb_stg__dbt_tmp" rename to "suburb_stg"
[0m18:52:40.407577 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
alter table "postgres"."staging"."room_stg__dbt_tmp" rename to "room_stg"
[0m18:52:40.408172 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.411824 [debug] [Thread-3  ]: Using postgres connection "model.bde.property_stg"
[0m18:52:40.412239 [debug] [Thread-3  ]: On model.bde.property_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.property_stg"} */
drop view if exists "postgres"."staging"."property_stg__dbt_backup" cascade
[0m18:52:40.420668 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.422394 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m18:52:40.422789 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:40.423152 [debug] [Thread-1  ]: On model.bde.listings_stg: COMMIT
[0m18:52:40.423697 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.425282 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m18:52:40.425677 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:40.426039 [debug] [Thread-4  ]: On model.bde.suburb_stg: COMMIT
[0m18:52:40.426450 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.427888 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m18:52:40.428295 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:40.428667 [debug] [Thread-2  ]: On model.bde.room_stg: COMMIT
[0m18:52:40.429018 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.430274 [debug] [Thread-3  ]: Timing info for model.bde.property_stg (execute): 18:52:40.147648 => 18:52:40.430103
[0m18:52:40.430645 [debug] [Thread-3  ]: On model.bde.property_stg: Close
[0m18:52:40.431515 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99981a1760>]}
[0m18:52:40.432066 [info ] [Thread-3  ]: 6 of 18 OK created sql view model staging.property_stg ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:52:40.432641 [debug] [Thread-3  ]: Finished running node model.bde.property_stg
[0m18:52:40.433045 [debug] [Thread-3  ]: Began running node model.bde.fact_census_G01
[0m18:52:40.433449 [info ] [Thread-3  ]: 9 of 18 START sql view model warehouse.fact_census_G01 ......................... [RUN]
[0m18:52:40.434106 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.property_stg, now model.bde.fact_census_G01)
[0m18:52:40.434507 [debug] [Thread-3  ]: Began compiling node model.bde.fact_census_G01
[0m18:52:40.437320 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.fact_census_G01"
[0m18:52:40.438090 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G01 (compile): 18:52:40.434786 => 18:52:40.437901
[0m18:52:40.438451 [debug] [Thread-3  ]: Began executing node model.bde.fact_census_G01
[0m18:52:40.441766 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.fact_census_G01"
[0m18:52:40.442120 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.442441 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.444744 [debug] [Thread-1  ]: Using postgres connection "model.bde.listings_stg"
[0m18:52:40.446833 [debug] [Thread-4  ]: Using postgres connection "model.bde.suburb_stg"
[0m18:52:40.447186 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.447524 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:40.447822 [debug] [Thread-1  ]: On model.bde.listings_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.listings_stg"} */
drop view if exists "postgres"."staging"."listings_stg__dbt_backup" cascade
[0m18:52:40.448140 [debug] [Thread-4  ]: On model.bde.suburb_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.suburb_stg"} */
drop view if exists "postgres"."staging"."suburb_stg__dbt_backup" cascade
[0m18:52:40.450263 [debug] [Thread-2  ]: Using postgres connection "model.bde.room_stg"
[0m18:52:40.450776 [debug] [Thread-3  ]: On model.bde.fact_census_G01: BEGIN
[0m18:52:40.451259 [debug] [Thread-2  ]: On model.bde.room_stg: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.room_stg"} */
drop view if exists "postgres"."staging"."room_stg__dbt_backup" cascade
[0m18:52:40.451600 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:40.468482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.468934 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.470471 [debug] [Thread-1  ]: Timing info for model.bde.listings_stg (execute): 18:52:40.144093 => 18:52:40.470308
[0m18:52:40.470804 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.472006 [debug] [Thread-4  ]: Timing info for model.bde.suburb_stg (execute): 18:52:40.172644 => 18:52:40.471848
[0m18:52:40.472364 [debug] [Thread-1  ]: On model.bde.listings_stg: Close
[0m18:52:40.473483 [debug] [Thread-2  ]: Timing info for model.bde.room_stg (execute): 18:52:40.167941 => 18:52:40.473337
[0m18:52:40.473815 [debug] [Thread-4  ]: On model.bde.suburb_stg: Close
[0m18:52:40.474204 [debug] [Thread-2  ]: On model.bde.room_stg: Close
[0m18:52:40.474811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f999819da00>]}
[0m18:52:40.475412 [info ] [Thread-1  ]: 5 of 18 OK created sql view model staging.listings_stg ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m18:52:40.476041 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ba58c220>]}
[0m18:52:40.476571 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998066e20>]}
[0m18:52:40.477026 [debug] [Thread-1  ]: Finished running node model.bde.listings_stg
[0m18:52:40.477492 [info ] [Thread-2  ]: 7 of 18 OK created sql view model staging.room_stg ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m18:52:40.477994 [info ] [Thread-4  ]: 8 of 18 OK created sql view model staging.suburb_stg ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m18:52:40.478363 [debug] [Thread-1  ]: Began running node model.bde.dim_host
[0m18:52:40.478854 [debug] [Thread-2  ]: Finished running node model.bde.room_stg
[0m18:52:40.479287 [debug] [Thread-4  ]: Finished running node model.bde.suburb_stg
[0m18:52:40.479637 [info ] [Thread-1  ]: 10 of 18 START sql view model warehouse.dim_host ............................... [RUN]
[0m18:52:40.480010 [debug] [Thread-2  ]: Began running node model.bde.fact_census_G02
[0m18:52:40.480437 [debug] [Thread-4  ]: Began running node model.bde.dim_property
[0m18:52:40.481037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.listings_stg, now model.bde.dim_host)
[0m18:52:40.481449 [info ] [Thread-2  ]: 11 of 18 START sql view model warehouse.fact_census_G02 ........................ [RUN]
[0m18:52:40.481837 [info ] [Thread-4  ]: 12 of 18 START sql view model warehouse.dim_property ........................... [RUN]
[0m18:52:40.482161 [debug] [Thread-1  ]: Began compiling node model.bde.dim_host
[0m18:52:40.482642 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.room_stg, now model.bde.fact_census_G02)
[0m18:52:40.483113 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.suburb_stg, now model.bde.dim_property)
[0m18:52:40.486011 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dim_host"
[0m18:52:40.486543 [debug] [Thread-2  ]: Began compiling node model.bde.fact_census_G02
[0m18:52:40.486886 [debug] [Thread-4  ]: Began compiling node model.bde.dim_property
[0m18:52:40.489631 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_census_G02"
[0m18:52:40.492900 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.dim_property"
[0m18:52:40.493432 [debug] [Thread-1  ]: Timing info for model.bde.dim_host (compile): 18:52:40.483343 => 18:52:40.493281
[0m18:52:40.493808 [debug] [Thread-1  ]: Began executing node model.bde.dim_host
[0m18:52:40.494177 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G02 (compile): 18:52:40.487215 => 18:52:40.494038
[0m18:52:40.497124 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dim_host"
[0m18:52:40.497478 [debug] [Thread-2  ]: Began executing node model.bde.fact_census_G02
[0m18:52:40.497816 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (compile): 18:52:40.489946 => 18:52:40.497685
[0m18:52:40.500619 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_census_G02"
[0m18:52:40.501062 [debug] [Thread-4  ]: Began executing node model.bde.dim_property
[0m18:52:40.501398 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:40.505050 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.dim_property"
[0m18:52:40.505537 [debug] [Thread-1  ]: On model.bde.dim_host: BEGIN
[0m18:52:40.505979 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:40.506268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:40.506611 [debug] [Thread-2  ]: On model.bde.fact_census_G02: BEGIN
[0m18:52:40.506906 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:40.507295 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:40.507590 [debug] [Thread-4  ]: On model.bde.dim_property: BEGIN
[0m18:52:40.507950 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:40.608019 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.608673 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:40.609143 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */

  create view "postgres"."warehouse"."fact_census_G01__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G01_stg"
  );
[0m18:52:40.632466 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.635789 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:40.636173 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
alter table "postgres"."warehouse"."fact_census_G01__dbt_tmp" rename to "fact_census_G01"
[0m18:52:40.649373 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.651068 [debug] [Thread-3  ]: On model.bde.fact_census_G01: COMMIT
[0m18:52:40.651503 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:40.651890 [debug] [Thread-3  ]: On model.bde.fact_census_G01: COMMIT
[0m18:52:40.667281 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.669890 [debug] [Thread-3  ]: Using postgres connection "model.bde.fact_census_G01"
[0m18:52:40.670306 [debug] [Thread-3  ]: On model.bde.fact_census_G01: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G01"} */
drop view if exists "postgres"."warehouse"."fact_census_G01__dbt_backup" cascade
[0m18:52:40.672407 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.672786 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:40.673159 [debug] [Thread-2  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */

  create view "postgres"."warehouse"."fact_census_G02__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."G02_stg"
  );
[0m18:52:40.681601 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.682061 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.682518 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:40.682969 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:40.683447 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */

  create view "postgres"."warehouse"."dim_property__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."property_stg"
  );
[0m18:52:40.683927 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */

  create view "postgres"."warehouse"."dim_host__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."host_stg"
  );
[0m18:52:40.686371 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.687939 [debug] [Thread-3  ]: Timing info for model.bde.fact_census_G01 (execute): 18:52:40.438688 => 18:52:40.687720
[0m18:52:40.688413 [debug] [Thread-3  ]: On model.bde.fact_census_G01: Close
[0m18:52:40.689355 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9988312b50>]}
[0m18:52:40.690038 [info ] [Thread-3  ]: 9 of 18 OK created sql view model warehouse.fact_census_G01 .................... [[32mCREATE VIEW[0m in 0.26s]
[0m18:52:40.690691 [debug] [Thread-3  ]: Finished running node model.bde.fact_census_G01
[0m18:52:40.691133 [debug] [Thread-3  ]: Began running node model.bde.dim_room
[0m18:52:40.691666 [info ] [Thread-3  ]: 13 of 18 START sql view model warehouse.dim_room ............................... [RUN]
[0m18:52:40.692354 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G01, now model.bde.dim_room)
[0m18:52:40.692749 [debug] [Thread-3  ]: Began compiling node model.bde.dim_room
[0m18:52:40.695798 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dim_room"
[0m18:52:40.696232 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.699399 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:40.699904 [debug] [Thread-2  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
alter table "postgres"."warehouse"."fact_census_G02__dbt_tmp" rename to "fact_census_G02"
[0m18:52:40.700453 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (compile): 18:52:40.693020 => 18:52:40.700222
[0m18:52:40.700872 [debug] [Thread-3  ]: Began executing node model.bde.dim_room
[0m18:52:40.705614 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dim_room"
[0m18:52:40.706045 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.706467 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.709167 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:40.711631 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:40.711979 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m18:52:40.712329 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
alter table "postgres"."warehouse"."dim_property__dbt_tmp" rename to "dim_property"
[0m18:52:40.712669 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
alter table "postgres"."warehouse"."dim_host__dbt_tmp" rename to "dim_host"
[0m18:52:40.712987 [debug] [Thread-3  ]: On model.bde.dim_room: BEGIN
[0m18:52:40.713403 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:40.715524 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.716759 [debug] [Thread-2  ]: On model.bde.fact_census_G02: COMMIT
[0m18:52:40.717107 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:40.717424 [debug] [Thread-2  ]: On model.bde.fact_census_G02: COMMIT
[0m18:52:40.727423 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.727795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.729209 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m18:52:40.730619 [debug] [Thread-1  ]: On model.bde.dim_host: COMMIT
[0m18:52:40.730976 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:40.731301 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:40.731615 [debug] [Thread-4  ]: On model.bde.dim_property: COMMIT
[0m18:52:40.731922 [debug] [Thread-1  ]: On model.bde.dim_host: COMMIT
[0m18:52:40.732509 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.734881 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_census_G02"
[0m18:52:40.735380 [debug] [Thread-2  ]: On model.bde.fact_census_G02: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_census_G02"} */
drop view if exists "postgres"."warehouse"."fact_census_G02__dbt_backup" cascade
[0m18:52:40.747933 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.748325 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.750856 [debug] [Thread-4  ]: Using postgres connection "model.bde.dim_property"
[0m18:52:40.751216 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.753385 [debug] [Thread-1  ]: Using postgres connection "model.bde.dim_host"
[0m18:52:40.753763 [debug] [Thread-4  ]: On model.bde.dim_property: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_property"} */
drop view if exists "postgres"."warehouse"."dim_property__dbt_backup" cascade
[0m18:52:40.755031 [debug] [Thread-2  ]: Timing info for model.bde.fact_census_G02 (execute): 18:52:40.498091 => 18:52:40.754862
[0m18:52:40.755380 [debug] [Thread-1  ]: On model.bde.dim_host: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_host"} */
drop view if exists "postgres"."warehouse"."dim_host__dbt_backup" cascade
[0m18:52:40.755800 [debug] [Thread-2  ]: On model.bde.fact_census_G02: Close
[0m18:52:40.756586 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8dfdf10>]}
[0m18:52:40.757096 [info ] [Thread-2  ]: 11 of 18 OK created sql view model warehouse.fact_census_G02 ................... [[32mCREATE VIEW[0m in 0.27s]
[0m18:52:40.757617 [debug] [Thread-2  ]: Finished running node model.bde.fact_census_G02
[0m18:52:40.757996 [debug] [Thread-2  ]: Began running node model.bde.fact_lge
[0m18:52:40.758425 [info ] [Thread-2  ]: 14 of 18 START sql view model warehouse.fact_lge ............................... [RUN]
[0m18:52:40.759025 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_census_G02, now model.bde.fact_lge)
[0m18:52:40.759355 [debug] [Thread-2  ]: Began compiling node model.bde.fact_lge
[0m18:52:40.762018 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.fact_lge"
[0m18:52:40.762690 [debug] [Thread-2  ]: Timing info for model.bde.fact_lge (compile): 18:52:40.759587 => 18:52:40.762535
[0m18:52:40.763007 [debug] [Thread-2  ]: Began executing node model.bde.fact_lge
[0m18:52:40.766579 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.fact_lge"
[0m18:52:40.767349 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:40.767664 [debug] [Thread-2  ]: On model.bde.fact_lge: BEGIN
[0m18:52:40.767965 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:40.773237 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.773595 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.774936 [debug] [Thread-4  ]: Timing info for model.bde.dim_property (execute): 18:52:40.501769 => 18:52:40.774769
[0m18:52:40.776056 [debug] [Thread-1  ]: Timing info for model.bde.dim_host (execute): 18:52:40.494387 => 18:52:40.775911
[0m18:52:40.776386 [debug] [Thread-4  ]: On model.bde.dim_property: Close
[0m18:52:40.776694 [debug] [Thread-1  ]: On model.bde.dim_host: Close
[0m18:52:40.777386 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998066e20>]}
[0m18:52:40.777872 [info ] [Thread-4  ]: 12 of 18 OK created sql view model warehouse.dim_property ...................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:52:40.778359 [debug] [Thread-4  ]: Finished running node model.bde.dim_property
[0m18:52:40.778717 [debug] [Thread-4  ]: Began running node model.bde.fact_listing
[0m18:52:40.779260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998175580>]}
[0m18:52:40.779643 [info ] [Thread-4  ]: 15 of 18 START sql view model warehouse.fact_listing ........................... [RUN]
[0m18:52:40.780117 [info ] [Thread-1  ]: 10 of 18 OK created sql view model warehouse.dim_host .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m18:52:40.780702 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bde.dim_property, now model.bde.fact_listing)
[0m18:52:40.781153 [debug] [Thread-1  ]: Finished running node model.bde.dim_host
[0m18:52:40.781454 [debug] [Thread-4  ]: Began compiling node model.bde.fact_listing
[0m18:52:40.786072 [debug] [Thread-4  ]: Writing injected SQL for node "model.bde.fact_listing"
[0m18:52:40.786765 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (compile): 18:52:40.781748 => 18:52:40.786610
[0m18:52:40.787053 [debug] [Thread-4  ]: Began executing node model.bde.fact_listing
[0m18:52:40.790146 [debug] [Thread-4  ]: Writing runtime sql for node "model.bde.fact_listing"
[0m18:52:40.790696 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:40.790993 [debug] [Thread-4  ]: On model.bde.fact_listing: BEGIN
[0m18:52:40.791263 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:52:40.879367 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.879920 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m18:52:40.880329 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */

  create view "postgres"."warehouse"."dim_room__dbt_tmp"
    
    
  as (
    

select * from "postgres"."staging"."room_stg"
  );
[0m18:52:40.900792 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.904068 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m18:52:40.904557 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
alter table "postgres"."warehouse"."dim_room__dbt_tmp" rename to "dim_room"
[0m18:52:40.918961 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.920496 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m18:52:40.920919 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m18:52:40.921287 [debug] [Thread-3  ]: On model.bde.dim_room: COMMIT
[0m18:52:40.933009 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.933404 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:40.933791 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */

  create view "postgres"."warehouse"."fact_lge__dbt_tmp"
    
    
  as (
    

SELECT a.lga_code, b.lga_name, b.suburb_name 
FROM "postgres"."staging"."suburb_stg" b 
LEFT JOIN "postgres"."staging"."lga_stg" a 
ON a.lga_name = b.lga_name
  );
[0m18:52:40.939233 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.942321 [debug] [Thread-3  ]: Using postgres connection "model.bde.dim_room"
[0m18:52:40.942733 [debug] [Thread-3  ]: On model.bde.dim_room: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dim_room"} */
drop view if exists "postgres"."warehouse"."dim_room__dbt_backup" cascade
[0m18:52:40.950793 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.953972 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:40.954432 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
alter table "postgres"."warehouse"."fact_lge__dbt_tmp" rename to "fact_lge"
[0m18:52:40.958598 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:40.959045 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:40.960572 [debug] [Thread-3  ]: Timing info for model.bde.dim_room (execute): 18:52:40.701137 => 18:52:40.960363
[0m18:52:40.961023 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:40.961469 [debug] [Thread-3  ]: On model.bde.dim_room: Close
[0m18:52:40.962054 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */

  create view "postgres"."warehouse"."fact_listing__dbt_tmp"
    
    
  as (
    

with lga as(
SELECT
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    c.lga_name as host_neighbourhood_lga_name,        
	    listing_neighbourhood,
		b.lga_name as listing_neighbourhood_lga_name,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
FROM  "postgres"."staging"."listings_stg" a
left join "postgres"."staging"."suburb_stg" b 
ON a.listing_neighbourhood = b.suburb_name
left join "postgres"."staging"."suburb_stg" c
ON a.host_neighbourhood = c.suburb_name
),
lga_name AS(
select 
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
	    CASE
	        WHEN host_neighbourhood_lga_name is Null THEN host_neighbourhood_lga_name
	        ELSE host_neighbourhood_lga_name end as host_neighbourhood_lga_name,   
	    listing_neighbourhood,    
	    CASE
	        WHEN listing_neighbourhood_lga_name is Null THEN listing_neighbourhood
	        ELSE listing_neighbourhood_lga_name end as listing_neighbourhood_lga_name, 
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga
)
select
		listing_id ,
        scraped_date,
        host_id,
        host_name,
		host_since,
        host_is_superhost,
	    host_neighbourhood,
		host_neighbourhood_lga_name,
	    s.lga_code as host_neighbourhood_lga_code,
	    listing_neighbourhood,    
		listing_neighbourhood_lga_name,    
		ls.lga_code as listing_neighbourhood_lga_code,
        property_type,
        room_type,
        accommodates,
        price,
        has_availability,
        availability_30,
        number_of_reviews,
        review_scores_rating,
        review_scores_accuracy,
        review_scores_cleanliness,
        review_scores_checkin,
        review_scores_communication,
        review_scores_value
from lga_name l
left join staging.lga_stg s
on l.host_neighbourhood_lga_name = s.lga_name 
left join staging.lga_stg ls
on l.listing_neighbourhood_lga_name = ls.lga_name
  );
[0m18:52:40.963059 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8e223d0>]}
[0m18:52:40.963650 [info ] [Thread-3  ]: 13 of 18 OK created sql view model warehouse.dim_room .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m18:52:40.964258 [debug] [Thread-3  ]: Finished running node model.bde.dim_room
[0m18:52:40.971784 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:40.973516 [debug] [Thread-2  ]: On model.bde.fact_lge: COMMIT
[0m18:52:40.973954 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:40.974323 [debug] [Thread-2  ]: On model.bde.fact_lge: COMMIT
[0m18:52:40.987645 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:40.991155 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:40.991588 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
alter table "postgres"."warehouse"."fact_listing__dbt_tmp" rename to "fact_listing"
[0m18:52:40.992246 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:40.994859 [debug] [Thread-2  ]: Using postgres connection "model.bde.fact_lge"
[0m18:52:40.995267 [debug] [Thread-2  ]: On model.bde.fact_lge: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_lge"} */
drop view if exists "postgres"."warehouse"."fact_lge__dbt_backup" cascade
[0m18:52:41.005233 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:41.006858 [debug] [Thread-4  ]: On model.bde.fact_listing: COMMIT
[0m18:52:41.007236 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:41.007569 [debug] [Thread-4  ]: On model.bde.fact_listing: COMMIT
[0m18:52:41.009457 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:41.010705 [debug] [Thread-2  ]: Timing info for model.bde.fact_lge (execute): 18:52:40.763231 => 18:52:41.010534
[0m18:52:41.011079 [debug] [Thread-2  ]: On model.bde.fact_lge: Close
[0m18:52:41.011956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99badd03a0>]}
[0m18:52:41.012541 [info ] [Thread-2  ]: 14 of 18 OK created sql view model warehouse.fact_lge .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m18:52:41.013113 [debug] [Thread-2  ]: Finished running node model.bde.fact_lge
[0m18:52:41.024358 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:41.027115 [debug] [Thread-4  ]: Using postgres connection "model.bde.fact_listing"
[0m18:52:41.027506 [debug] [Thread-4  ]: On model.bde.fact_listing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.fact_listing"} */
drop view if exists "postgres"."warehouse"."fact_listing__dbt_backup" cascade
[0m18:52:41.042721 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:41.044303 [debug] [Thread-4  ]: Timing info for model.bde.fact_listing (execute): 18:52:40.787257 => 18:52:41.044130
[0m18:52:41.044726 [debug] [Thread-4  ]: On model.bde.fact_listing: Close
[0m18:52:41.045579 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9998184a90>]}
[0m18:52:41.046135 [info ] [Thread-4  ]: 15 of 18 OK created sql view model warehouse.fact_listing ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m18:52:41.046698 [debug] [Thread-4  ]: Finished running node model.bde.fact_listing
[0m18:52:41.047452 [debug] [Thread-1  ]: Began running node model.bde.dm_host_neighbourhood
[0m18:52:41.047884 [debug] [Thread-3  ]: Began running node model.bde.dm_listing_neighbourhood
[0m18:52:41.048307 [debug] [Thread-2  ]: Began running node model.bde.dm_property_type
[0m18:52:41.048715 [info ] [Thread-1  ]: 16 of 18 START sql view model datamart.dm_host_neighbourhood ................... [RUN]
[0m18:52:41.049184 [info ] [Thread-3  ]: 17 of 18 START sql view model datamart.dm_listing_neighbourhood ................ [RUN]
[0m18:52:41.049637 [info ] [Thread-2  ]: 18 of 18 START sql view model datamart.dm_property_type ........................ [RUN]
[0m18:52:41.050313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bde.dim_host, now model.bde.dm_host_neighbourhood)
[0m18:52:41.050948 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bde.dim_room, now model.bde.dm_listing_neighbourhood)
[0m18:52:41.051490 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bde.fact_lge, now model.bde.dm_property_type)
[0m18:52:41.051838 [debug] [Thread-1  ]: Began compiling node model.bde.dm_host_neighbourhood
[0m18:52:41.052152 [debug] [Thread-3  ]: Began compiling node model.bde.dm_listing_neighbourhood
[0m18:52:41.052459 [debug] [Thread-2  ]: Began compiling node model.bde.dm_property_type
[0m18:52:41.055236 [debug] [Thread-1  ]: Writing injected SQL for node "model.bde.dm_host_neighbourhood"
[0m18:52:41.058881 [debug] [Thread-3  ]: Writing injected SQL for node "model.bde.dm_listing_neighbourhood"
[0m18:52:41.061213 [debug] [Thread-2  ]: Writing injected SQL for node "model.bde.dm_property_type"
[0m18:52:41.061973 [debug] [Thread-3  ]: Timing info for model.bde.dm_listing_neighbourhood (compile): 18:52:41.055542 => 18:52:41.061781
[0m18:52:41.062377 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (compile): 18:52:41.052699 => 18:52:41.062218
[0m18:52:41.062675 [debug] [Thread-3  ]: Began executing node model.bde.dm_listing_neighbourhood
[0m18:52:41.063021 [debug] [Thread-1  ]: Began executing node model.bde.dm_host_neighbourhood
[0m18:52:41.063382 [debug] [Thread-2  ]: Timing info for model.bde.dm_property_type (compile): 18:52:41.059144 => 18:52:41.063236
[0m18:52:41.066513 [debug] [Thread-3  ]: Writing runtime sql for node "model.bde.dm_listing_neighbourhood"
[0m18:52:41.069639 [debug] [Thread-1  ]: Writing runtime sql for node "model.bde.dm_host_neighbourhood"
[0m18:52:41.070168 [debug] [Thread-2  ]: Began executing node model.bde.dm_property_type
[0m18:52:41.073368 [debug] [Thread-2  ]: Writing runtime sql for node "model.bde.dm_property_type"
[0m18:52:41.074244 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:41.074560 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: BEGIN
[0m18:52:41.074864 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:41.075180 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:41.075439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:41.075724 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: BEGIN
[0m18:52:41.075993 [debug] [Thread-2  ]: On model.bde.dm_property_type: BEGIN
[0m18:52:41.076393 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:52:41.076689 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:41.254909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:41.255749 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:41.256558 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:41.257228 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:41.257919 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:52:41.258650 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */

  create view "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp"
    
    
  as (
    SELECT 
    host_neighbourhood_lga_name,
	CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
    count(DISTINCT host_id) as number_of_distinct_host,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) as estimate_revenue_per_active,
    ROUND(SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END) / COUNT(DISTINCT host_id), 2) as estimate_revenue_per_host
FROM 
    "postgres"."warehouse"."fact_listing"
GROUP BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY 
    host_neighbourhood_lga_name,
    EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:52:41.259715 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */

  create view "postgres"."datamart"."dm_property_type__dbt_tmp"
    
    
  as (
    SELECT
  property_type,
  room_type,
  accommodates,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  ROUND(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(has_availability), 0) * 100, 2) AS active_listings_rate,
  MIN(CASE WHEN has_availability = 't' THEN price END) AS min_price,
  MAX(CASE WHEN has_availability = 't' THEN price END) AS max_price,
  ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CASE WHEN has_availability = 't' THEN price END)::NUMERIC, 2) AS median_price,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN price END), 2) AS avg_price,
  COUNT(DISTINCT host_id) AS distinct_host_count,
  ROUND(SUM(CASE WHEN host_is_superhost = 't' THEN 1 ELSE 0 END)::NUMERIC / NULLIF(COUNT(host_is_superhost), 0) * 100, 2) AS superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
   CAST(ROUND(
      (100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY  property_type,room_type,accommodates ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,	
  (SUM(CASE WHEN has_availability = 't' THEN (30 - availability_30) ELSE 0 END)) AS total_stay,
  ROUND(AVG(CASE WHEN has_availability = 't' THEN (30 - availability_30) * price ELSE 0 END), 2) AS avg_estimated_revenue
FROM "postgres"."warehouse"."fact_listing"
GROUP BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
ORDER BY
  property_type,
  room_type,
  accommodates,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:52:41.260617 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:41.261621 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */

  create view "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp"
    
    
  as (
    select
  listing_neighbourhood,
  CONCAT( EXTRACT(MONTH FROM scraped_date),'/',EXTRACT(YEAR FROM scraped_date)) as scraped_month_year,
  round((sum(case when has_availability = 't' then  1 else  0 end )::numeric / count(has_availability)) *100,2) as active_listings_ratio,
  min(case when has_availability = 't' then price end) as minimum_price,
  max(case when has_availability = 't' then price end) as maximum_price,
  round(percentile_cont(0.5) within group (order by case when has_availability = 't' then price end)::numeric,2) as median_price,
  round(avg(case when has_availability = 't' then price end),2) as average_price,
  count(distinct host_id) as distinct_host,
  round((sum(case when host_is_superhost = 't' then  1 else  0 end)::numeric / nullif(count(host_is_superhost),0))*100,2) as superhost_rate,
  ROUND(AVG(CASE WHEN review_scores_rating = 'NaN' THEN 0 ELSE review_scores_rating END),2) as average_review_scores_rating,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 't' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS active_change,
  CAST(
    ROUND(
      (
        100.0 * (SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END) -
        LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)))
      ) / NULLIF(LAG(SUM(CASE WHEN has_availability = 'f' THEN 1 ELSE 0 END), 1) OVER (PARTITION BY listing_neighbourhood ORDER BY EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)), 0)
   , 2 )
 	AS DECIMAL(10, 2)) AS inactive_change,
  sum(case when has_availability = 't' then 30 - availability_30  else 0 end) as number_of_stays,
  round(avg(case when has_availability = 't' then (30 - availability_30)*price  else 0 end),2) as avg_estimate_revenue
from
    "postgres"."warehouse"."fact_listing"
group by 
  listing_neighbourhood,
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
order by 
  listing_neighbourhood, 
  EXTRACT(YEAR FROM scraped_date), EXTRACT(MONTH FROM scraped_date)
  );
[0m18:52:41.284612 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:41.290400 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:41.291126 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:41.291823 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:41.292476 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
alter table "postgres"."datamart"."dm_host_neighbourhood__dbt_tmp" rename to "dm_host_neighbourhood"
[0m18:52:41.296908 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:41.302519 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:41.303237 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
alter table "postgres"."datamart"."dm_property_type__dbt_tmp" rename to "dm_property_type"
[0m18:52:41.303864 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
alter table "postgres"."datamart"."dm_listing_neighbourhood__dbt_tmp" rename to "dm_listing_neighbourhood"
[0m18:52:41.317495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:41.319743 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m18:52:41.320335 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:41.320882 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: COMMIT
[0m18:52:41.321671 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:41.322255 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:41.324310 [debug] [Thread-2  ]: On model.bde.dm_property_type: COMMIT
[0m18:52:41.326155 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m18:52:41.326664 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:41.327141 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:41.327603 [debug] [Thread-2  ]: On model.bde.dm_property_type: COMMIT
[0m18:52:41.328067 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: COMMIT
[0m18:52:41.336190 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:41.345684 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:41.346189 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:52:41.355853 [debug] [Thread-1  ]: Using postgres connection "model.bde.dm_host_neighbourhood"
[0m18:52:41.359883 [debug] [Thread-2  ]: Using postgres connection "model.bde.dm_property_type"
[0m18:52:41.363465 [debug] [Thread-3  ]: Using postgres connection "model.bde.dm_listing_neighbourhood"
[0m18:52:41.363998 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_host_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_host_neighbourhood__dbt_backup" cascade
[0m18:52:41.364509 [debug] [Thread-2  ]: On model.bde.dm_property_type: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_property_type"} */
drop view if exists "postgres"."datamart"."dm_property_type__dbt_backup" cascade
[0m18:52:41.365041 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "bde", "target_name": "dev", "node_id": "model.bde.dm_listing_neighbourhood"} */
drop view if exists "postgres"."datamart"."dm_listing_neighbourhood__dbt_backup" cascade
[0m18:52:41.382471 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:41.383036 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:41.383557 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:41.385764 [debug] [Thread-1  ]: Timing info for model.bde.dm_host_neighbourhood (execute): 18:52:41.066771 => 18:52:41.385470
[0m18:52:41.387585 [debug] [Thread-3  ]: Timing info for model.bde.dm_listing_neighbourhood (execute): 18:52:41.063610 => 18:52:41.387325
[0m18:52:41.389323 [debug] [Thread-2  ]: Timing info for model.bde.dm_property_type (execute): 18:52:41.070615 => 18:52:41.389099
[0m18:52:41.389895 [debug] [Thread-1  ]: On model.bde.dm_host_neighbourhood: Close
[0m18:52:41.390417 [debug] [Thread-3  ]: On model.bde.dm_listing_neighbourhood: Close
[0m18:52:41.390887 [debug] [Thread-2  ]: On model.bde.dm_property_type: Close
[0m18:52:41.392251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bae07250>]}
[0m18:52:41.393171 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998813e460>]}
[0m18:52:41.394104 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf791c5d-98ee-4aa0-a94b-9eb112d49eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99981dea60>]}
[0m18:52:41.394820 [info ] [Thread-1  ]: 16 of 18 OK created sql view model datamart.dm_host_neighbourhood .............. [[32mCREATE VIEW[0m in 0.34s]
[0m18:52:41.395674 [info ] [Thread-3  ]: 17 of 18 OK created sql view model datamart.dm_listing_neighbourhood ........... [[32mCREATE VIEW[0m in 0.34s]
[0m18:52:41.396333 [info ] [Thread-2  ]: 18 of 18 OK created sql view model datamart.dm_property_type ................... [[32mCREATE VIEW[0m in 0.34s]
[0m18:52:41.397026 [debug] [Thread-1  ]: Finished running node model.bde.dm_host_neighbourhood
[0m18:52:41.397647 [debug] [Thread-3  ]: Finished running node model.bde.dm_listing_neighbourhood
[0m18:52:41.398273 [debug] [Thread-2  ]: Finished running node model.bde.dm_property_type
[0m18:52:41.399961 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:41.400360 [debug] [MainThread]: On master: BEGIN
[0m18:52:41.400706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:41.577723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:41.578850 [debug] [MainThread]: On master: COMMIT
[0m18:52:41.579592 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:41.580265 [debug] [MainThread]: On master: COMMIT
[0m18:52:41.596249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:41.596970 [debug] [MainThread]: On master: Close
[0m18:52:41.598689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:41.599381 [debug] [MainThread]: Connection 'model.bde.dm_host_neighbourhood' was properly closed.
[0m18:52:41.599999 [debug] [MainThread]: Connection 'model.bde.dm_property_type' was properly closed.
[0m18:52:41.600617 [debug] [MainThread]: Connection 'model.bde.dm_listing_neighbourhood' was properly closed.
[0m18:52:41.601213 [debug] [MainThread]: Connection 'model.bde.fact_listing' was properly closed.
[0m18:52:41.602099 [info ] [MainThread]: 
[0m18:52:41.602859 [info ] [MainThread]: Finished running 18 view models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m18:52:41.609353 [debug] [MainThread]: Command end result
[0m18:52:41.624254 [info ] [MainThread]: 
[0m18:52:41.625026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:41.625565 [info ] [MainThread]: 
[0m18:52:41.626120 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:52:41.627084 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:41.626928 after 2.93 seconds
[0m18:52:41.627716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b88d96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8dc8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bad139d0>]}
[0m18:52:41.628301 [debug] [MainThread]: Flushing usage events
